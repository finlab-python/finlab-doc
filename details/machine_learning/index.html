
<!doctype html>
<html lang="zh-TW" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="機器學習策略開發：特徵工程、標籤設計、模型訓練。整合 qlib、XGBoost、LightGBM，建立 ML 選股策略。">
      
      
      
        <link rel="canonical" href="https://doc.finlab.tw/details/machine_learning/">
      
      
        <link rel="prev" href="../order_api2/">
      
      
        <link rel="next" href="../finlab_plot/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>機器學習 - FinLab 量化交易工具文檔</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/material.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="機器學習 - FinLab 量化交易工具文檔" />
<meta property="og:description" content="機器學習策略開發：特徵工程、標籤設計、模型訓練。整合 qlib、XGBoost、LightGBM，建立 ML 選股策略。" />
<meta property="og:image" content="https://doc.finlab.tw/assets/images/social/details/machine_learning.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://doc.finlab.tw/details/machine_learning/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="機器學習 - FinLab 量化交易工具文檔" />
<meta property="twitter:description" content="機器學習策略開發：特徵工程、標籤設計、模型訓練。整合 qlib、XGBoost、LightGBM，建立 ML 選股策略。" />
<meta property="twitter:image" content="https://doc.finlab.tw/assets/images/social/details/machine_learning.png" />
</head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳轉到
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="頁首">
    <a href="https://ai.finlab.tw" title="FinLab 量化交易工具文檔" class="md-header__button md-logo" aria-label="FinLab 量化交易工具文檔" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FinLab 量化交易工具文檔
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              機器學習
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜尋" placeholder="搜尋" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="搜尋">
        
        <button type="reset" class="md-search__icon md-icon" title="清除" aria-label="清除" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜尋引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/finlab-python" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="標籤" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  三分鐘上手

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../get_data/" class="md-tabs__link">
          
  
  
  簡易教學

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/finlab/" class="md-tabs__link">
          
  
  
  詳細功能

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../workflows/complete_strategy_workflow/" class="md-tabs__link">
          
  
  
  完整工作流程

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/module_relationships/" class="md-tabs__link">
          
  
  
  架構與設計

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tools/guide_for_beginners/" class="md-tabs__link">
          
  
  
  實用範例

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../change-log/" class="md-tabs__link">
        
  
  
    
  
  更新日誌

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  常見問題 FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  術語表

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://discord.gg/tAr4ysPqvR" class="md-tabs__link">
        
  
  
    
  
  社群助教

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://ai.finlab.tw/pricing" class="md-tabs__link">
        
  
  
    
  
  價格

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="導覽列" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ai.finlab.tw" title="FinLab 量化交易工具文檔" class="md-nav__button md-logo" aria-label="FinLab 量化交易工具文檔" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    FinLab 量化交易工具文檔
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/finlab-python" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    三分鐘上手
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    簡易教學
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    簡易教學
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../get_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    數據
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tech_ind/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    指標
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backtest_decorator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    選股條件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../backtest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    歷史回測
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../factor_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    因子分析
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../order_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    下單(單策略)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../order_api2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    下單(多策略)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    機器學習
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    機器學習
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        相關函式庫安裝
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相關函式庫安裝">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        必要安裝
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        模型函式庫（選用）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        特徵處理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="特徵處理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Combine 函數合併特徵
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#talib" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Talib 產生技術指標
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        ta_names 函數
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta" class="md-nav__link">
    <span class="md-ellipsis">
      
        ta 函數
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        標籤生成
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="標籤生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#label" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Label 函數生成標籤
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daytrading_percentage" class="md-nav__link">
    <span class="md-ellipsis">
      
        預測 daytrading_percentage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    <span class="md-ellipsis">
      
        預測N天後的報酬率
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-adverse-excursion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maximum Adverse Excursion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-favorable-excursion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maximum Favorable Excursion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-median" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excess Over Median
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-mean" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excess Over Mean
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlib" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Qlib 套件模型訓練
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用 Qlib 套件模型訓練">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lgbmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LGBModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xgbmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        XGBModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#densmblemodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DEnsmbleModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catboostmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        CatBoostModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinearModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabnetmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        TabnetModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnnmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNNModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_models
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        進行回測
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../finlab_plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    資料視覺化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimize_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    策略參數優化
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    策略分析模組
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../market_customization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    自訂市場物件
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    詳細功能
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    詳細功能
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/finlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.dataframe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/backtest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.backtest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/report/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.report
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/machine_learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.ml
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/portfolio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.portfolio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/online/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.online
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.plot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/optimize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.optimize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/market/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    finlab.market
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    完整工作流程
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    完整工作流程
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/complete_strategy_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    從研究到實盤
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/ml_strategy_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    機器學習策略流程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/multi_strategy_portfolio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    多策略組合管理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/risk_management/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    風險管理指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    架構與設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    架構與設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/module_relationships/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    模組架構圖
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/data_flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    資料流程詳解
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/extending_finlab/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    擴充開發指南
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    實用範例
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    實用範例
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    台股
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    台股
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/guide_for_beginners/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    策略開發10分鐘上手
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pandas 策略開發基礎語法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    股價創新高動能
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99%E9%81%B8%E8%82%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術指標選股
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E4%B9%96%E9%9B%A2%E7%8E%87%E5%92%8C%E8%B2%A1%E5%A0%B1%E6%BF%BE%E7%B6%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    乖離率和財報濾網
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    本益成長比(月營收截止日換股)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%B0%8F%E8%B3%87%E6%97%8F%E5%84%AA%E7%AD%89%E7%94%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    小資族優等生
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%A4%9A%E7%A9%BA%E5%B0%8D%E6%B2%96/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    多空對沖
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E7%87%9F%E5%BB%BA%E7%94%A2%E6%A5%AD%E5%B0%88%E7%94%A8%E6%8C%87%E6%A8%99/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    營建產業專用指標
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    過濾全額交割股
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    過濾KY股財報
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%A4%A7%E7%9B%A4%E6%8C%87%E6%A8%99%E6%BF%BE%E7%B6%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    大盤指標濾網
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/2330_bband_rebound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    台積電逆勢抄底
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/cheap-stock-ratio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    大跌底部判斷
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/important_info_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    重訊公告搜尋 - 業外損失
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ml_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    機器學習範例策略
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../change-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    更新日誌
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    常見問題 FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    術語表
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://discord.gg/tAr4ysPqvR" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    社群助教
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://ai.finlab.tw/pricing" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    價格
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        相關函式庫安裝
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="相關函式庫安裝">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        必要安裝
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        模型函式庫（選用）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        特徵處理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="特徵處理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Combine 函數合併特徵
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#talib" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Talib 產生技術指標
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta_names" class="md-nav__link">
    <span class="md-ellipsis">
      
        ta_names 函數
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta" class="md-nav__link">
    <span class="md-ellipsis">
      
        ta 函數
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        標籤生成
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="標籤生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#label" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Label 函數生成標籤
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daytrading_percentage" class="md-nav__link">
    <span class="md-ellipsis">
      
        預測 daytrading_percentage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    <span class="md-ellipsis">
      
        預測N天後的報酬率
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-adverse-excursion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maximum Adverse Excursion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-favorable-excursion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maximum Favorable Excursion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-median" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excess Over Median
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-mean" class="md-nav__link">
    <span class="md-ellipsis">
      
        Excess Over Mean
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlib" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用 Qlib 套件模型訓練
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="使用 Qlib 套件模型訓練">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lgbmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LGBModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xgbmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        XGBModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#densmblemodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DEnsmbleModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catboostmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        CatBoostModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        LinearModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabnetmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        TabnetModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnnmodel" class="md-nav__link">
    <span class="md-ellipsis">
      
        DNNModel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_models" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_models
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        進行回測
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>機器學習</h1>

<h2 id="_1">相關函式庫安裝</h2>
<h3 id="_2">必要安裝</h3>
<p>安裝核心套件（finlab、TA-Lib）：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>finlab
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>pip<span class="w"> </span>install<span class="w"> </span>ta-lib
</code></pre></div>
<h3 id="_3">模型函式庫（選用）</h3>
<p><code>finlab.ml.qlib</code> 可搭配多種模型（LightGBM、XGBoost、CatBoost、PyTorch、TensorFlow 等）。需要時依官方文件安裝；Colab 多數已預裝。</p>
<ol>
<li><a href="https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html">安裝 LightGBM</a></li>
<li><a href="https://xgboost.readthedocs.io/en/latest/build.html">安裝 XGBoost</a></li>
<li><a href="https://catboost.ai/docs/concepts/python-installation.html">安裝 CatBoost</a></li>
<li><a href="https://pytorch.org/get-started/locally/">安裝 Pytorch</a></li>
<li><a href="https://www.tensorflow.org/install">安裝 Tensorflow</a></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">機器學習流程較複雜，推薦搭配 AI 助手</p>
<p>從特徵工程到模型訓練，ML 策略涉及多個步驟。安裝 <a href="https://finlab.finance">FinLab Skill</a> 後，AI 編程助手可協助選擇特徵、切分資料集、訓練模型與解讀回測結果。</p>
</div>
<h2 id="_4">特徵處理</h2>
<h3 id="combine">使用 Combine 函數合併特徵</h3>
<p><code>finlab.ml.feature.combine</code> 可合併多來源特徵（技術、基本面、自定義），並支援重採樣。範例如下：</p>
<ol>
<li><strong>合併股價淨值比和本益比為一個特徵集</strong> ：</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab</span><span class="w"> </span><span class="kn">import</span> <span class="n">data</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">features</span> <span class="o">=</span> <span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">({</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  <span class="s1">&#39;pb&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_earning_ratio:股價淨值比&#39;</span><span class="p">),</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  <span class="s1">&#39;pe&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_earning_ratio:本益比&#39;</span><span class="p">)</span>  
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">},</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">pb</th>
<th style="text-align: right;">pe</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1101')</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">18.85</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1102')</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">14.58</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1103')</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">40.89</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1104')</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">73.6</td>
</tr>
</tbody>
</table>
<p>將 pb 與 pe 合併為一個特徵集。</p>
<ol>
<li><strong>合併技術指標為一個特徵集</strong> ：</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">({</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  <span class="s1">&#39;talib&#39;</span><span class="p">:</span> <span class="n">mlf</span><span class="o">.</span><span class="n">ta</span><span class="p">(</span><span class="n">mlf</span><span class="o">.</span><span class="n">ta_names</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">})</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">talib.HT_DCPERIOD__real__</th>
<th style="text-align: right;">talib.HT_DCPHASE__real__</th>
<th style="text-align: right;">talib.HT_PHASOR__quadrature__</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9951')</td>
<td style="text-align: right;">23.4372</td>
<td style="text-align: right;">122.135</td>
<td style="text-align: right;">-0.0107087</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9955')</td>
<td style="text-align: right;">18.4416</td>
<td style="text-align: right;">68.0654</td>
<td style="text-align: right;">-0.0168584</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9958')</td>
<td style="text-align: right;">30.1035</td>
<td style="text-align: right;">-10.7866</td>
<td style="text-align: right;">0.159777</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9960')</td>
<td style="text-align: right;">17.5025</td>
<td style="text-align: right;">94.0009</td>
<td style="text-align: right;">0.00310615</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9962')</td>
<td style="text-align: right;">23.2931</td>
<td style="text-align: right;">90.0781</td>
<td style="text-align: right;">-0.0145453</td>
</tr>
</tbody>
</table>
<p>在這個範例中，我們使用 <code>mlf.ta</code> 函數和 <code>mlf.ta_names</code> 函數來生成一組技術指標特徵。這個過程首先通過 <code>mlf.ta_names(n=1)</code> 生成隨機的技術指標，然後 <code>mlf.ta</code> 函數根據這個列表計算出相應的指標值。最後，<code>combine</code> 函數將這些技術指標合併成一個 DataFrame，為量化策略的開發提供了一組豐富的特徵。</p>
<p>這兩個範例展示了 <code>combine</code> 函數的多樣性和靈活性，無論是對於基本面分析還是技術分析，它都能提供強大的數據支持，幫助投資者和分析師在複雜的金融市場中做出更加精準的決策。</p>
<h3 id="talib">使用 Talib 產生技術指標</h3>
<ul>
<li>當我們在使用 <code>finlab</code> 函式庫來開發量化交易策略時，技術指標扮演著極其重要的角色。<code>finlab</code> 提供了一套功能強大的工具來幫助我們生成和利用這些技術指標。其中，<code>ta</code> 和 <code>ta_names</code> 兩個函數是生成技術指標特徵的關鍵。</li>
</ul>
<h3 id="ta_names">ta_names 函數</h3>
<p><code>ta_names</code> 函數的作用是生成一系列 TALIB 技術指標的名稱。這些名稱反映了指標的計算方法及其參數。這個函數非常有用，因為它允許我們探索和實驗不同的指標配置，以尋找最佳的特徵組合。 </p>
<ul>
<li><strong>n 參數</strong> ：在 <code>ta_names</code> 中，<code>n</code> 參數指定了每個指標隨機生成的參數設置數量。舉例來說，如果 <code>n=10</code>，那麼對於 TALIB 中的每一個指標，<code>ta_names</code> 將會生成 10 種不同參數配置的指標名稱。這允許我們從多種不同的參數設置中選擇，以便更深入地探索數據和策略性能之間的關係。</li>
</ul>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">ta_names</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[&#39;talib.HT_DCPERIOD__real__&#39;,
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a> &#39;talib.HT_DCPHASE__real__&#39;,
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a> &#39;talib.HT_PHASOR__quadrature__&#39;,
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a> &#39;talib.HT_PHASOR__inphase__&#39;,
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a> &#39;talib.HT_SINE__sine__&#39;,
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a> &#39;talib.HT_SINE__leadsine__&#39;
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a> ...
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a> ]
</code></pre></div></p>
<h3 id="ta">ta 函數</h3>
<p>一旦我們有了指標名稱列表（可以通過 <code>ta_names</code> 函數獲得），就可以使用 <code>ta</code> 函數來計算這些指標的實際值。<code>ta</code> 函數是一個強大的工具，它根據指定的技術指標名稱和參數設置來計算這些指標的值。 </p>
<ul>
<li>
<p><strong>功能</strong> ：<code>ta</code> 函數接受一個或多個由 <code>ta_names</code> 生成的指標名稱，然後計算這些指標的值。這對於特徵工程來說非常重要，因為它讓我們可以根據指標的計算結果來構建預測模型。 </p>
</li>
<li>
<p><strong>靈活性</strong> ：這兩個函數的結合使用提供了極大的靈活性，允許量化分析師和交易者在不同的時間範圍、不同的市場條件下測試和優化他們的策略。</p>
</li>
<li>
<p><strong>resample 參數</strong> : <code>ta</code> 函數還支持 <code>resample</code> 參數，這個參數可以將計算出來的指標值重新取樣到指定的時間範圍。這對於時間序列數據的處理非常有用，可以幫助我們更好地理解和分析數據。</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">ta</span><span class="p">([</span><span class="s1">&#39;talib.HT_DCPERIOD__real__&#39;</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a> <span class="s1">&#39;talib.HT_DCPHASE__real__&#39;</span><span class="p">,</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a> <span class="s1">&#39;talib.HT_PHASOR__quadrature__&#39;</span><span class="p">],</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">talib.HT_DCPERIOD__real__</th>
<th style="text-align: right;">talib.HT_DCPHASE__real__</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9951')</td>
<td style="text-align: right;">23.4372</td>
<td style="text-align: right;">122.135</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9955')</td>
<td style="text-align: right;">18.4416</td>
<td style="text-align: right;">68.0654</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9958')</td>
<td style="text-align: right;">30.1035</td>
<td style="text-align: right;">-10.7866</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9960')</td>
<td style="text-align: right;">17.5025</td>
<td style="text-align: right;">94.0009</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9962')</td>
<td style="text-align: right;">23.2931</td>
<td style="text-align: right;">90.0781</td>
</tr>
</tbody>
</table>
<p>總結來說，<code>ta_names</code> 和 <code>ta</code> 函數是 <code>finlab</code> 函式庫中用於生成和計算技術指標特徵的兩個核心工具。通過實驗不同的參數設置（使用 <code>ta_names</code> 中的 <code>n</code> 參數）和計算這些設置下的指標值（使用 <code>ta</code> 函數），量化策略開發者可以深入挖掘數據，找到最佳的指標組合來指導他們的交易決策。這種方法為量化投資提供了一個堅實的基礎，幫助投資者在複雜多變的金融市場中保持競爭力。</p>
<h2 id="_5">標籤生成</h2>
<h3 id="label">使用 Label 函數生成標籤</h3>
<p><code>finlab.ml.label</code> 提供多種報酬/風險標籤計算，便於訓練預測模型。</p>
<h3 id="daytrading_percentage">預測 daytrading_percentage</h3>
<p>此函數計算給定周期內市場價格的百分比變化，特別是從開盤價到收盤價的變化。</p>
<ul>
<li><code>resample</code>：需與 <code>combine</code> 的 <code>resample</code> 一致，以對齊時間。</li>
<li><code>period</code>：計算未來 N 期（由 <code>resample</code> 定義）的變化。</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.ml</span><span class="w"> </span><span class="kn">import</span> <span class="n">label</span> <span class="k">as</span> <span class="n">mll</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">feature</span> <span class="o">=</span> <span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">daytrading_percentage</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>datetime    instrument
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>2007-04-23  0015          0.000000
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>            0050          0.003454
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>            0051          0.004874
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>            0052          0.006510
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>            01001T        0.001509
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>dtype: float64
</code></pre></div>
<h3 id="n">預測N天後的報酬率</h3>
<p>計算在給定周期內的百分比變化，用於分析中長期表現。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">return_percentage</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="maximum-adverse-excursion">Maximum Adverse Excursion</h3>
<p>MAE：持有期內的最大不利變動（目前不支援 <code>resample</code>）。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">maximum_adverse_excursion</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="maximum-favorable-excursion">Maximum Favorable Excursion</h3>
<p>MFE：持有期內的最大有利變動（目前不支援 <code>resample</code>）。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">maximum_favorable_excursion</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="excess-over-median">Excess Over Median</h3>
<p>相對同期全市場收益「中位數」的超額收益。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">excess_over_median</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="excess-over-mean">Excess Over Mean</h3>
<p>相對同期全市場收益「均值」的超額收益。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">excess_over_mean</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>請確保 <code>index</code> 與市場設定正確；標籤可直接搭配特徵用於模型訓練。</p>
<h2 id="qlib">使用 Qlib 套件模型訓練</h2>
<ul>
<li>這段程式碼示範了如何在 Qlib 框架中使用各種機器學習模型進行量化投資策略的開發。<code>WrapperModel</code> 是一個封裝類別，用於初始化和適配不同的機器學習模型，包括但不限於 LightGBM、XGBoost、CatBoost、線性模型、Tabnet 和深度神經網絡等。這個封裝使得在 Qlib 中使用這些模型變得更加簡單和統一。</li>
</ul>
<p>以下是每個模型封裝類別的簡單介紹和範例用法：</p>
<h3 id="lgbmodel">LGBModel</h3>
<p>封裝 LightGBM 模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">finlab.ml.qlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">q</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># 構建 X_train, y_train, X_test</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">LGBModel</span><span class="p">()</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip annotate">
<p class="admonition-title">如何建構 X_train, y_train, X_test?</p>
<p>以 2020 年前為訓練集的範例：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">is_train</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="s1">&#39;2020-01-01&#39;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">X_train</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">is_train</span><span class="p">]</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">is_train</span><span class="p">]</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">X_test</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="o">~</span><span class="n">is_train</span><span class="p">]</span>
</code></pre></div>
</div>
<h3 id="xgbmodel">XGBModel</h3>
<p>封裝 XGBoost 模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">()</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="densmblemodel">DEnsmbleModel</h3>
<p>封裝雙重集成模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">DEnsmbleModel</span><span class="p">()</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="catboostmodel">CatBoostModel</h3>
<p>封裝 CatBoost 模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">CatBoostModel</span><span class="p">()</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="linearmodel">LinearModel</h3>
<p>封裝線性模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">LinearModel</span><span class="p">()</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="tabnetmodel">TabnetModel</h3>
<p>封裝 TabNet 模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">TabnetModel</span><span class="p">()</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="dnnmodel">DNNModel</h3>
<p>封裝深度神經網絡模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">DNNModel</span><span class="p">()</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p>封裝讓你專注在特徵與策略，不必陷入模型細節。</p>
<h3 id="get_models">get_models</h3>
<p><code>get_models</code> 可快速取得可用模型清單並初始化，方便進行多模型試驗。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">finlab.ml.qlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">q</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1"># 獲取所有可用的模型</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">models</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_models</span><span class="p">()</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="c1"># 列印出所有模型的名稱</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># 選擇一個模型進行實例化，例如 LightGBM</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;LGBModel&#39;</span><span class="p">]()</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c1"># 假設已經準備好了訓練數據和測試數據 X_train, y_train, X_test</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c1"># model</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c1"># 使用訓練好的模型進行預測</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p>以上展示如何列出模型、建立 <code>LGBModel</code> 並訓練/預測。</p>
<h2 id="_6">進行回測</h2>
<p>使用 <code>sim</code> 進行回測，計算策略收益與風險指標：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">finlab.backtest</span><span class="w"> </span><span class="kn">import</span> <span class="n">sim</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">position</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">is_largest</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">sim</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;4W&#39;</span><span class="p">)</span>
</code></pre></div>
<p>以上用模型排名產生 <code>position</code>，以 <code>resample</code> 指定回測頻率並執行回測。</p>







  
  



  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到頂端
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u8907\u88fd", "clipboard.copy": "\u8907\u88fd", "search.result.more.one": "\u6b64\u9801\u5c1a\u6709 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.more.other": "\u6b64\u9801\u5c1a\u6709 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.none": "\u6c92\u6709\u7b26\u5408\u7684\u9805\u76ee", "search.result.one": "\u627e\u5230 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.other": "\u627e\u5230 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.placeholder": "\u6253\u5b57\u9032\u884c\u641c\u5c0b", "search.result.term.missing": "\u7f3a\u5c11\u5b57\u8a5e", "select.version": "\u9078\u64c7\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>