
<!doctype html>
<html lang="zh-TW" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../order_api2/">
      
      
        <link rel="next" href="../finlab_plot/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.1.8">
    
    
      
        <title>機器學習 - Package 程式文檔</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/material.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳轉到
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="頁首">
    <a href="https://ai.finlab.tw" title="Package 程式文檔" class="md-header__button md-logo" aria-label="Package 程式文檔" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Package 程式文檔
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              機器學習
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="白天模式"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="白天模式" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="夜晚模式"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="夜晚模式" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜尋" placeholder="搜尋" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="搜尋">
        
        <button type="reset" class="md-search__icon md-icon" title="清除" aria-label="清除" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜尋引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/finlab-python" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="標籤" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../getting-started/" class="md-tabs__link">
      三分鐘上手
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../get_data/" class="md-tabs__link md-tabs__link--active">
        簡易教學
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../reference/finlab/" class="md-tabs__link">
        詳細功能
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../tools/guide_for_beginners/" class="md-tabs__link">
        實用範例
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../cli/" class="md-tabs__link">
      CLI
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../change-log/" class="md-tabs__link">
      更新日誌
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../faq/" class="md-tabs__link">
      常見問題 FAQ
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://discord.gg/tAr4ysPqvR" class="md-tabs__link">
      社群助教
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="https://ai.finlab.tw/pricing" class="md-tabs__link">
      價格
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="導覽列" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ai.finlab.tw" title="Package 程式文檔" class="md-nav__button md-logo" aria-label="Package 程式文檔" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    Package 程式文檔
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/finlab-python" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        三分鐘上手
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          簡易教學
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          簡易教學
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../get_data/" class="md-nav__link">
        數據
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tech_ind/" class="md-nav__link">
        指標
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backtest_decorator/" class="md-nav__link">
        選股條件
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backtest/" class="md-nav__link">
        歷史回測
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../factor_analysis/" class="md-nav__link">
        因子分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../order_api/" class="md-nav__link">
        下單(單策略)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../order_api2/" class="md-nav__link">
        下單(多策略)
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          機器學習
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        機器學習
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    相關函式庫安裝
  </a>
  
    <nav class="md-nav" aria-label="相關函式庫安裝">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    必要安裝
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    模型函示庫（非必須）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    特徵處理
  </a>
  
    <nav class="md-nav" aria-label="特徵處理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    使用 Combine 函數合併特徵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#talib" class="md-nav__link">
    使用 Talib 產生技術指標
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta_names" class="md-nav__link">
    ta_names 函數
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta" class="md-nav__link">
    ta 函數
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    標籤生成
  </a>
  
    <nav class="md-nav" aria-label="標籤生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#label" class="md-nav__link">
    使用 Label 函數生成標籤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daytrading_percentage" class="md-nav__link">
    預測 daytrading_percentage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    預測N天後的報酬率
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-adverse-excursion" class="md-nav__link">
    Maximum Adverse Excursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-favorable-excursion" class="md-nav__link">
    Maximum Favorable Excursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-median" class="md-nav__link">
    Excess Over Median
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-mean" class="md-nav__link">
    Excess Over Mean
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlib" class="md-nav__link">
    使用 Qlib 套件模型訓練
  </a>
  
    <nav class="md-nav" aria-label="使用 Qlib 套件模型訓練">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lgbmodel" class="md-nav__link">
    LGBModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xgbmodel" class="md-nav__link">
    XGBModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#densmblemodel" class="md-nav__link">
    DEnsmbleModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catboostmodel" class="md-nav__link">
    CatBoostModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmodel" class="md-nav__link">
    LinearModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabnetmodel" class="md-nav__link">
    TabnetModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnnmodel" class="md-nav__link">
    DNNModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_models" class="md-nav__link">
    get_models
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    進行回測
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../finlab_plot/" class="md-nav__link">
        資料視覺化
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          詳細功能
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          詳細功能
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/finlab/" class="md-nav__link">
        finlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/data/" class="md-nav__link">
        finlab.data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/dataframe/" class="md-nav__link">
        finlab.dataframe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/backtest/" class="md-nav__link">
        finlab.backtest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/report/" class="md-nav__link">
        finlab.report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/machine_learning/" class="md-nav__link">
        finlab.ml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/portfolio/" class="md-nav__link">
        finlab.portfolio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/online/" class="md-nav__link">
        finlab.online
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/plot/" class="md-nav__link">
        finlab.plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/analysis/" class="md-nav__link">
        finlab.analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/optimize/" class="md-nav__link">
        finlab.optimize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/tools/" class="md-nav__link">
        finlab.tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/market/" class="md-nav__link">
        finlab.market
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          實用範例
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          實用範例
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
        
      
      <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
      
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          台股
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          台股
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/guide_for_beginners/" class="md-nav__link">
        策略開發10分鐘上手
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/" class="md-nav__link">
        Pandas 策略開發基礎語法
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/" class="md-nav__link">
        股價創新高動能
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99%E9%81%B8%E8%82%A1/" class="md-nav__link">
        技術指標選股
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E4%B9%96%E9%9B%A2%E7%8E%87%E5%92%8C%E8%B2%A1%E5%A0%B1%E6%BF%BE%E7%B6%B2/" class="md-nav__link">
        乖離率和財報濾網
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/" class="md-nav__link">
        本益成長比(月營收截止日換股)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%B0%8F%E8%B3%87%E6%97%8F%E5%84%AA%E7%AD%89%E7%94%9F/" class="md-nav__link">
        小資族優等生
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%A4%9A%E7%A9%BA%E5%B0%8D%E6%B2%96/" class="md-nav__link">
        多空對沖
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E7%87%9F%E5%BB%BA%E7%94%A2%E6%A5%AD%E5%B0%88%E7%94%A8%E6%8C%87%E6%A8%99/" class="md-nav__link">
        營建產業專用指標
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/" class="md-nav__link">
        過濾全額交割股
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/" class="md-nav__link">
        過濾KY股財報
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/%E5%A4%A7%E7%9B%A4%E6%8C%87%E6%A8%99%E6%BF%BE%E7%B6%B2/" class="md-nav__link">
        大盤指標濾網
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/2330_bband_rebound/" class="md-nav__link">
        台積電逆勢抄底
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/cheap-stock-ratio/" class="md-nav__link">
        大跌底部判斷
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/important_info_search/" class="md-nav__link">
        重訊公告搜尋 - 業外損失
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ml_example/" class="md-nav__link">
        機器學習範例策略
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/factor_analysis.md" class="md-nav__link">
        如何分析因子
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../change-log/" class="md-nav__link">
        更新日誌
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        常見問題 FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://discord.gg/tAr4ysPqvR" class="md-nav__link">
        社群助教
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://ai.finlab.tw/pricing" class="md-nav__link">
        價格
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    相關函式庫安裝
  </a>
  
    <nav class="md-nav" aria-label="相關函式庫安裝">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    必要安裝
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    模型函示庫（非必須）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    特徵處理
  </a>
  
    <nav class="md-nav" aria-label="特徵處理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    使用 Combine 函數合併特徵
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#talib" class="md-nav__link">
    使用 Talib 產生技術指標
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta_names" class="md-nav__link">
    ta_names 函數
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ta" class="md-nav__link">
    ta 函數
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    標籤生成
  </a>
  
    <nav class="md-nav" aria-label="標籤生成">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#label" class="md-nav__link">
    使用 Label 函數生成標籤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#daytrading_percentage" class="md-nav__link">
    預測 daytrading_percentage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    預測N天後的報酬率
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-adverse-excursion" class="md-nav__link">
    Maximum Adverse Excursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maximum-favorable-excursion" class="md-nav__link">
    Maximum Favorable Excursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-median" class="md-nav__link">
    Excess Over Median
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#excess-over-mean" class="md-nav__link">
    Excess Over Mean
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qlib" class="md-nav__link">
    使用 Qlib 套件模型訓練
  </a>
  
    <nav class="md-nav" aria-label="使用 Qlib 套件模型訓練">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lgbmodel" class="md-nav__link">
    LGBModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xgbmodel" class="md-nav__link">
    XGBModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#densmblemodel" class="md-nav__link">
    DEnsmbleModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catboostmodel" class="md-nav__link">
    CatBoostModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linearmodel" class="md-nav__link">
    LinearModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tabnetmodel" class="md-nav__link">
    TabnetModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnnmodel" class="md-nav__link">
    DNNModel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_models" class="md-nav__link">
    get_models
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    進行回測
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>機器學習</h1>

<h2 id="_1">相關函式庫安裝</h2>
<h3 id="_2">必要安裝</h3>
<p>為了讓您順利運行上述的量化投資模型和函數，您需要先安裝一些必要的 Python 套件。別擔心，這個過程非常簡單！以下是您需要添加到您的環境中的套件安裝指令： </p>
<ol>
<li>安裝 <code>finlab</code> 套件，它提供了許多方便的工具和函數來進行量化投資分析。</li>
<li>安裝 <code>ta-lib-bin</code> 套件，這是一個強大的技術分析庫，廣泛應用於金融市場分析中。</li>
<li>安裝 <code>Qlib</code>，這是由微軟開源的一個量化投資研究平台，支持全流程的策略開發。</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>finlab
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>pip<span class="w"> </span>install<span class="w"> </span>ta-lib-bin
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/microsoft/qlib.git
</code></pre></div>
<p>如果使用 Colab，會得到 Packaging version 重新安裝的相關提示，請按確認將 kernel 重新啟動(或 Session)，就能正常使用。通過執行上述指令，您將會獲得執行量化分析所需的基礎設施。</p>
<div class="admonition tip annotate">
<p class="admonition-title">LegacyVersion 錯誤處理</p>
<p>假如您是使用 Colab，請直接重新啟動，方法為「執行階段」-&gt;「重新啟動執行階段」</p>
</div>
<h3 id="_3">模型函示庫（非必須）</h3>
<p>由於 Qlib 當中引用諸多模型，如 LightGBM、XGBoost、CatBoost、線性模型、Pytorch、Tensorflow 和深度神經網絡等，
假如需要用到這些模型，請參考該模型的官方文件，安裝相對應的函式庫。假如您使用 Colab，這些函式庫已經預先安裝好了，不需要再次安裝。</p>
<ol>
<li><a href="https://lightgbm.readthedocs.io/en/latest/Installation-Guide.html">安裝 LightGBM</a></li>
<li><a href="https://xgboost.readthedocs.io/en/latest/build.html">安裝 XGBoost</a></li>
<li><a href="https://catboost.ai/docs/concepts/python-installation.html">安裝 CatBoost</a></li>
<li><a href="https://pytorch.org/get-started/locally/">安裝 Pytorch</a></li>
<li><a href="https://www.tensorflow.org/install">安裝 Tensorflow</a></li>
</ol>
<h2 id="_4">特徵處理</h2>
<h3 id="combine">使用 Combine 函數合併特徵</h3>
<p>在金融分析和量化投資領域中，「特徵」是對於預測模型來說至關重要的數據。<code>combine</code> 函數是 <code>finlab.ml.feature</code> 模組中的一個強大工具，它允許您將多個不同來源的特徵合併成一個統一的 DataFrame，這對於構建和訓練預測模型非常有幫助。</p>
<p>這個函數的優點在於，它可以處理來自不同數據源的特徵，無論是技術指標、基本面分析指標，還是自定義的數據集，都可以通過 <code>combine</code> 函數組合起來。此外，它還支持數據的重新取樣，這對於時間序列數據來說尤為重要。</p>
<p>以下是兩個使用 <code>combine</code> 函數的範例，展示了如何將不同的數據源合併為一個特徵集： </p>
<ol>
<li><strong>合併股價淨值比和本益比為一個特徵集</strong> ：</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">finlab</span> <span class="kn">import</span> <span class="n">data</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">features</span> <span class="o">=</span> <span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">({</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  <span class="s1">&#39;pb&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_earning_ratio:股價淨值比&#39;</span><span class="p">),</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  <span class="s1">&#39;pe&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;price_earning_ratio:本益比&#39;</span><span class="p">)</span>  
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">},</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">pb</th>
<th style="text-align: right;">pe</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1101')</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">18.85</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1102')</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">14.58</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1103')</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">40.89</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2010-01-04 00:00:00'), '1104')</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">73.6</td>
</tr>
</tbody>
</table>
<p>在這個範例中，<code>combine</code> 函數將股價淨值比（pb）和本益比（pe）這兩個來自 <code>data.get</code> 函數的特徵合併成一個 DataFrame。這可以幫助分析師快速地構建出包含這兩種基本面指標的數據集，用於進行後續的分析和模型訓練。 </p>
<ol>
<li><strong>合併技術指標為一個特徵集</strong> ：</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">({</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  <span class="s1">&#39;talib&#39;</span><span class="p">:</span> <span class="n">mlf</span><span class="o">.</span><span class="n">ta</span><span class="p">(</span><span class="n">mlf</span><span class="o">.</span><span class="n">ta_names</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">})</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">talib.HT_DCPERIOD__real__</th>
<th style="text-align: right;">talib.HT_DCPHASE__real__</th>
<th style="text-align: right;">talib.HT_PHASOR__quadrature__</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9951')</td>
<td style="text-align: right;">23.4372</td>
<td style="text-align: right;">122.135</td>
<td style="text-align: right;">-0.0107087</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9955')</td>
<td style="text-align: right;">18.4416</td>
<td style="text-align: right;">68.0654</td>
<td style="text-align: right;">-0.0168584</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9958')</td>
<td style="text-align: right;">30.1035</td>
<td style="text-align: right;">-10.7866</td>
<td style="text-align: right;">0.159777</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9960')</td>
<td style="text-align: right;">17.5025</td>
<td style="text-align: right;">94.0009</td>
<td style="text-align: right;">0.00310615</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-01 00:00:00'), '9962')</td>
<td style="text-align: right;">23.2931</td>
<td style="text-align: right;">90.0781</td>
<td style="text-align: right;">-0.0145453</td>
</tr>
</tbody>
</table>
<p>在這個範例中，我們使用 <code>mlf.ta</code> 函數和 <code>mlf.ta_names</code> 函數來生成一組技術指標特徵。這個過程首先通過 <code>mlf.ta_names(n=1)</code> 生成隨機的技術指標，然後 <code>mlf.ta</code> 函數根據這個列表計算出相應的指標值。最後，<code>combine</code> 函數將這些技術指標合併成一個 DataFrame，為量化策略的開發提供了一組豐富的特徵。</p>
<p>這兩個範例展示了 <code>combine</code> 函數的多樣性和靈活性，無論是對於基本面分析還是技術分析，它都能提供強大的數據支持，幫助投資者和分析師在複雜的金融市場中做出更加精準的決策。</p>
<h3 id="talib">使用 Talib 產生技術指標</h3>
<ul>
<li>當我們在使用 <code>finlab</code> 函式庫來開發量化交易策略時，技術指標扮演著極其重要的角色。<code>finlab</code> 提供了一套功能強大的工具來幫助我們生成和利用這些技術指標。其中，<code>ta</code> 和 <code>ta_names</code> 兩個函數是生成技術指標特徵的關鍵。</li>
</ul>
<h3 id="ta_names">ta_names 函數</h3>
<p><code>ta_names</code> 函數的作用是生成一系列 TALIB 技術指標的名稱。這些名稱反映了指標的計算方法及其參數。這個函數非常有用，因為它允許我們探索和實驗不同的指標配置，以尋找最佳的特徵組合。 </p>
<ul>
<li><strong>n 參數</strong> ：在 <code>ta_names</code> 中，<code>n</code> 參數指定了每個指標隨機生成的參數設置數量。舉例來說，如果 <code>n=10</code>，那麼對於 TALIB 中的每一個指標，<code>ta_names</code> 將會生成 10 種不同參數配置的指標名稱。這允許我們從多種不同的參數設置中選擇，以便更深入地探索數據和策略性能之間的關係。</li>
</ul>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">ta_names</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>[&#39;talib.HT_DCPERIOD__real__&#39;,
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a> &#39;talib.HT_DCPHASE__real__&#39;,
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a> &#39;talib.HT_PHASOR__quadrature__&#39;,
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a> &#39;talib.HT_PHASOR__inphase__&#39;,
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a> &#39;talib.HT_SINE__sine__&#39;,
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a> &#39;talib.HT_SINE__leadsine__&#39;
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a> ...
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a> ]
</code></pre></div></p>
<h3 id="ta">ta 函數</h3>
<p>一旦我們有了指標名稱列表（可以通過 <code>ta_names</code> 函數獲得），就可以使用 <code>ta</code> 函數來計算這些指標的實際值。<code>ta</code> 函數是一個強大的工具，它根據指定的技術指標名稱和參數設置來計算這些指標的值。 </p>
<ul>
<li>
<p><strong>功能</strong> ：<code>ta</code> 函數接受一個或多個由 <code>ta_names</code> 生成的指標名稱，然後計算這些指標的值。這對於特徵工程來說非常重要，因為它讓我們可以根據指標的計算結果來構建預測模型。 </p>
</li>
<li>
<p><strong>靈活性</strong> ：這兩個函數的結合使用提供了極大的靈活性，允許量化分析師和交易者在不同的時間範圍、不同的市場條件下測試和優化他們的策略。</p>
</li>
<li>
<p><strong>resample 參數</strong> : <code>ta</code> 函數還支持 <code>resample</code> 參數，這個參數可以將計算出來的指標值重新取樣到指定的時間範圍。這對於時間序列數據的處理非常有用，可以幫助我們更好地理解和分析數據。</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">mlf</span><span class="o">.</span><span class="n">ta</span><span class="p">([</span><span class="s1">&#39;talib.HT_DCPERIOD__real__&#39;</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a> <span class="s1">&#39;talib.HT_DCPHASE__real__&#39;</span><span class="p">,</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a> <span class="s1">&#39;talib.HT_PHASOR__quadrature__&#39;</span><span class="p">],</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">)</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">talib.HT_DCPERIOD__real__</th>
<th style="text-align: right;">talib.HT_DCPHASE__real__</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9951')</td>
<td style="text-align: right;">23.4372</td>
<td style="text-align: right;">122.135</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9955')</td>
<td style="text-align: right;">18.4416</td>
<td style="text-align: right;">68.0654</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9958')</td>
<td style="text-align: right;">30.1035</td>
<td style="text-align: right;">-10.7866</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9960')</td>
<td style="text-align: right;">17.5025</td>
<td style="text-align: right;">94.0009</td>
</tr>
<tr>
<td style="text-align: left;">(Timestamp('2024-04-07 00:00:00'), '9962')</td>
<td style="text-align: right;">23.2931</td>
<td style="text-align: right;">90.0781</td>
</tr>
</tbody>
</table>
<p>總結來說，<code>ta_names</code> 和 <code>ta</code> 函數是 <code>finlab</code> 函式庫中用於生成和計算技術指標特徵的兩個核心工具。通過實驗不同的參數設置（使用 <code>ta_names</code> 中的 <code>n</code> 參數）和計算這些設置下的指標值（使用 <code>ta</code> 函數），量化策略開發者可以深入挖掘數據，找到最佳的指標組合來指導他們的交易決策。這種方法為量化投資提供了一個堅實的基礎，幫助投資者在複雜多變的金融市場中保持競爭力。</p>
<h2 id="_5">標籤生成</h2>
<h3 id="label">使用 Label 函數生成標籤</h3>
<p>在金融領域中，標籤生成是一個非常重要的任務。標籤是指對於某個事件或狀態的標記，通常用於訓練機器學習模型或制定交易策略。<code>finlab</code> 函式庫提供了一個名為 <code>label</code> 的函數，可以幫助我們生成各種不同類型的標籤，從而更好地理解和分析金融數據。</p>
<p>這些函數都是用於計算市場價格在給定期間內的各種變化率，它們可以用於量化策略中，幫助分析和預測價格走勢。下面我將分別介紹每個函數及其使用範例：</p>
<h3 id="daytrading_percentage">預測 daytrading_percentage</h3>
<p>此函數計算給定周期內市場價格的百分比變化，特別是從開盤價到收盤價的變化。</p>
<ul>
<li>
<p><strong>resample 參數</strong> : <code>daytrading_percentage</code> 函數支持 <code>resample</code> 參數，這個參數必須設定與 <code>combine</code> 函數中的 <code>resample</code> 參數相同。這樣可以確保標籤和特徵之間的時間對齊。</p>
</li>
<li>
<p><strong>period 參數</strong> : <code>period</code> 參數指定了計算百分比變化的時間範圍，例如 <code>period=1</code> 表示計算未來一個單位的變化，單位根據 <code>resample</code> 參數來確定。</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">mlf</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span> <span class="nn">finlab.ml</span> <span class="kn">import</span> <span class="n">label</span> <span class="k">as</span> <span class="n">mll</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">feature</span> <span class="o">=</span> <span class="n">mlf</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">daytrading_percentage</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>datetime    instrument
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>2007-04-23  0015          0.000000
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>            0050          0.003454
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>            0051          0.004874
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>            0052          0.006510
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>            01001T        0.001509
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>dtype: float64
</code></pre></div>
<h3 id="n">預測N天後的報酬率</h3>
<p>這個函數計算了給定周期內市場價格的百分比變化。它可以用於分析股票的長期表現。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">return_percentage</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="maximum-adverse-excursion">Maximum Adverse Excursion</h3>
<p>MAE 計算在持有期內可能遭受的最大不利價格變動。這是衡量交易風險的一個重要指標。
目前此函數並不支援 resample，預設為「未來 period 天的最大不利變動」。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">maximum_adverse_excursion</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="maximum-favorable-excursion">Maximum Favorable Excursion</h3>
<p>MFE 計算在持有期內可能實現的最大有利價格變動。這可以幫助交易者評估潛在的獲利能力。
目目前此函數並不支援 resample，預設為「未來 period 天的最大有利變動」。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">maximum_favorable_excursion</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="excess-over-median">Excess Over Median</h3>
<p>這個函數計算的是相對於同期所有股票收益中位數的超額收益。這可以用來識別相對於市場表現較好或較差的股票。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">excess_over_median</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="excess-over-mean">Excess Over Mean</h3>
<p>這個函數計算的是相對於同期所有股票收益均值的超額收益。這也是一種評估股票相對表現的方法。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">label</span> <span class="o">=</span> <span class="n">mll</span><span class="o">.</span><span class="n">excess_over_mean</span><span class="p">(</span><span class="n">feature</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>在使用這些函數時，重要的是要確保 <code>index</code> 參數正確反映了你想要分析的日期和標的，並且 <code>ml.get_market()</code> 能夠正確獲取到相關的市場數據。這些函數的結果可以用來構建特徵，進一步用於建立預測模型或進行市場分析。</p>
<h2 id="qlib">使用 Qlib 套件模型訓練</h2>
<ul>
<li>這段程式碼示範了如何在 Qlib 框架中使用各種機器學習模型進行量化投資策略的開發。<code>WrapperModel</code> 是一個封裝類別，用於初始化和適配不同的機器學習模型，包括但不限於 LightGBM、XGBoost、CatBoost、線性模型、Tabnet 和深度神經網絡等。這個封裝使得在 Qlib 中使用這些模型變得更加簡單和統一。</li>
</ul>
<p>以下是每個模型封裝類別的簡單介紹和範例用法：</p>
<h3 id="lgbmodel">LGBModel</h3>
<p>封裝 LightGBM 模型，適用於迅速建立高效的樹模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span> <span class="nn">finlab.ml.qlib</span> <span class="k">as</span> <span class="nn">q</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># 構建 X_train, y_train, X_test</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">LGBModel</span><span class="p">()</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip annotate">
<p class="admonition-title">如何建構 X_train, y_train, X_test?</p>
<p>在使用 <code>LGBModel</code> 之前，您需要先準備好訓練數據 <code>X_train</code> 和 <code>y_train</code>，以及測試數據 <code>X_test</code>。這些數據應該是 Numpy 數組或 Pandas DataFrame 的形式，並且符合模型的輸入要求。假設 features 是特徵數據，labels 是標籤數據，並且希望以 2020 年以前的資料進行訓練，您可以按照以下方式構建訓練數據和測試數據：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">is_train</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s1">&#39;datetime&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="s1">&#39;2020-01-01&#39;</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">X_train</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">is_train</span><span class="p">]</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">y_train</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">is_train</span><span class="p">]</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">X_test</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="o">~</span><span class="n">is_train</span><span class="p">]</span>
</code></pre></div>
</div>
<h3 id="xgbmodel">XGBModel</h3>
<p>封裝 XGBoost 模型，是一個強大的分類和回歸樹模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">XGBModel</span><span class="p">()</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="densmblemodel">DEnsmbleModel</h3>
<p>封裝雙重集成模型，通過結合多個基模型提高預測準確率。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">DEnsmbleModel</span><span class="p">()</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="catboostmodel">CatBoostModel</h3>
<p>封裝 CatBoost 模型，一個處理類別特徵非常有效的梯度提升決策樹模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">CatBoostModel</span><span class="p">()</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="linearmodel">LinearModel</h3>
<p>封裝線性模型，適用於線性相關性強的數據集。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">LinearModel</span><span class="p">()</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="tabnetmodel">TabnetModel</h3>
<p>封裝 Tabnet 模型，一種基於神經網絡的表格數據學習模型。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">TabnetModel</span><span class="p">()</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<h3 id="dnnmodel">DNNModel</h3>
<p>封裝深度神經網絡模型，適用於複雜的非線性數據集。</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">DNNModel</span><span class="p">()</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p>這些封裝類別為量化策略開發提供了一種快速、高效的方式，使得研究人員可以專注於特徵工程和策略優化，而不需要深入了解每個模型的細節。通過這些封裝，Qlib 旨在簡化量化投資策略開發的複雜性，加速從數據到策略的研發過程。</p>
<h3 id="get_models">get_models</h3>
<ul>
<li><code>get_models</code> 函數提供了一個快捷方式，讓您能夠訪問並初始化一系列預定義的量化投資模型。這些模型包括了多種機器學習算法，如 LightGBM、XGBoost、CatBoost、線性回歸模型、Tabnet 和深度神經網絡等，涵蓋了從經典算法到最新研究成果的廣泛範圍。</li>
</ul>
<p>使用 <code>get_models</code> 函數，您可以輕鬆地獲取到所有可用模型的實例，而不需要手動初始化每一個模型。這在您需要試驗多種模型以找出最適合您數據的算法時特別有用。</p>
<p>下面是一個如何使用 <code>get_models</code> 函數來獲取模型列表和初始化特定模型的示例：</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span> <span class="nn">finlab.ml.qlib</span> <span class="k">as</span> <span class="nn">q</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1"># 獲取所有可用的模型</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="n">models</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get_models</span><span class="p">()</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="c1"># 列印出所有模型的名稱</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># 選擇一個模型進行實例化，例如 LightGBM</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="s1">&#39;LGBModel&#39;</span><span class="p">]()</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="c1"># 假設已經準備好了訓練數據和測試數據 X_train, y_train, X_test</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="c1"># model</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c1"># 使用訓練好的模型進行預測</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p>這段代碼首先從 <code>get_models</code> 函數獲取所有可用的模型，然後列印出這些模型的名稱。接著，選擇其中一個模型（例如 <code>LGBModel</code>）進行實例化，並使用準備好的訓練數據進行訓練。最後，使用訓練好的模型對測試數據進行預測。</p>
<p><code>get_models</code> 函數簡化了模型選擇和初始化的過程，讓您能夠更加專注於模型的訓練和評估，加快量化策略的研發周期。</p>
<h2 id="_6">進行回測</h2>
<ul>
<li>回測是量化投資策略開發過程中的一個重要步驟，它通過歷史數據模擬交易策略的表現，幫助研究人員評估策略的有效性和風險。<code>finlab</code> 函式庫提供了一個名為 <code>sim</code> 的函數，可以幫助您進行回測，並計算策略的收益率和風險指標。</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span> <span class="nn">finlab.backtest</span> <span class="kn">import</span> <span class="n">sim</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">position</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">is_largest</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="n">sim</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s1">&#39;4W&#39;</span><span class="p">)</span>
</code></pre></div>
<p>這段程式碼首先根據模型預測的結果生成交易信號 <code>position</code>，然後使用 <code>sim</code> 函數進行回測。<code>resample</code> 參數指定了回測的時間範圍，這對於計算收益率和風險指標非常重要。<code>sim</code> 函數將返回一個包含回測結果的 DataFrame，包括每個交易周期的收益率、最大回撤、夏普比率等指標。透過回測，您可以評估您的量化投資策略在歷史數據上的表現，並根據回測結果進行策略的優化和調整。這有助於提高策略的穩定性和收益率，並幫助您在真實市場中取得更好的投資表現。</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.expand", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "\u5df2\u8907\u88fd", "clipboard.copy": "\u8907\u88fd", "search.result.more.one": "\u6b64\u9801\u5c1a\u6709 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.more.other": "\u6b64\u9801\u5c1a\u6709 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.none": "\u6c92\u6709\u7b26\u5408\u7684\u9805\u76ee", "search.result.one": "\u627e\u5230 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.other": "\u627e\u5230 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.placeholder": "\u6253\u5b57\u9032\u884c\u641c\u5c0b", "search.result.term.missing": "\u7f3a\u5c11\u5b57\u8a5e", "select.version": "\u9078\u64c7\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>