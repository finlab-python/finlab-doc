{"config":{"lang":["ja"],"separator":"[\\s\\-\u3000\u3001\u3002\uff0c\uff0e\uff1f\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u7ffb\u8f49\u53f0\u80a1\u91cf\u5316\u4ea4\u6613","text":""},{"location":"#_2","title":"\u91cf\u5316\u5e73\u53f0\uff0c\u6c34\u5230\u6e20\u6210","text":""},{"location":"#2015","title":"2015 \u61f5\u61c2\u7121\u77e5\uff0c\u4e00\u80a1\u8166\u60f3\u5275\u696d","text":"<p>\u958b\u59cb\u5e74\uff0c\u6fdb\u6fdb\u61c2\u61c2\uff0c\u60f3\u8981\u5275\u696d\uff0c\u60f3\u8981\u5beb\u7a0b\u5f0f\uff0c\u60f3\u8981\u5de5\u4f5c\u81ea\u7531\uff0c\u624d\u958b\u59cb\u7814\u7a76\u53f0\u80a1\u3002\u7576\u521d\u9084\u771f\u7684\u662f\u4e0d\u61c2\uff0c\u505a\u51fa\u4f86\u7684\u5e73\u53f0\u4e0d\u5207\u5be6\u969b\uff0c\u4ee5\u70ba KD \u9ec3\u91d1\u4ea4\u53c9\u5c31\u53ef\u4ee5\u8cfa\u9322\u3002\u7576\u6162\u6162\u63a5\u89f8\u5230\u6295\u8cc7\uff0c\u958b\u59cb\u6574\u7406\u548c\u5206\u6790\u8ca1\u7d93\u8cc7\u6599\uff0c\u624d\u767c\u73fe\u7576\u521d\u7684\u60f3\u6cd5\u771f\u662f\u592a\u55ae\u7d14\u4e86\u3002\u9019\u6642\u624d\u9047\u898b\u4e86 Python \u548c Pandas \u5927\u70ba\u9a5a\u5606\uff01\u539f\u4f86\u8cc7\u6599\u8655\u7406\u53ef\u4ee5\u9019\u9ebc\u65b9\u4fbf\u7c21\u55ae\uff01\u5f9e\u6b64\u4ee5\u5f8c\u8b8a\u6210 Python \u7684\u4fe1\u5f92\u3002</p>"},{"location":"#2016-finlab","title":"2016 \u5e74\uff0c\u958b\u8a2d FinLab \u90e8\u843d\u683c","text":"<p>\u7576\u6642\u7684\u521d\u8877\uff0c\u55ae\u7d14\u60f3\u5beb\u4e00\u9ede\u8ca1\u7d93\u6578\u64da\u5206\u6790\uff0c\u7576\u6642\u7db2\u8def\u4e0a\u9084\u627e\u4e0d\u5230\u76f8\u95dc\u7684\u6587\u7ae0\uff0c\u65bc\u662f\u958b\u555f\u4e86\u53f0\u80a1\u91cf\u5316\u5206\u6790\u4e4b\u65c5\u3002\u6709\u5f88\u591a\u8e34\u8e8d\u7684\u7db2\u53cb\u5011\uff0c\u5e38\u5e38\u4e00\u8d77\u8a0e\u8ad6\u8ca1\u52d9\u6307\u6a19\u3002\u76f4\u5230\u73fe\u5728\u6216\u8a31\u4ed6\u5011\u5df2\u7d93\u6c92\u6709\u95dc\u6ce8 FinLab \u4e86\uff0c\u4f46\u6211\u4f9d\u7136\u5f88\u73cd\u60dc\u8ddf\u4ed6\u5011\u5207\u78cb\u7684\u90a3\u6bb5\u6642\u5149\u3002</p>"},{"location":"#2018-2020-python","title":"2018-2020 \u5e74\uff0c\u7db2\u8def\u4e0a\u7b2c\u4e00\u5802 Python \u91cf\u5316\u4ea4\u6613\u8ab2\u7a0b","text":"<p>\u9078\u80a1\u8ab2\u7a0b\uff0c\u53d7\u5230\u5f88\u597d\u7684\u8a55\u50f9\uff0c\u5c31\u7b97\u662f\u5df2\u7d932022\u5e74\u4e86\uff0c\u6211\u4f9d\u7136\u5f88\u6709\u81ea\u4fe1\uff0c\u5c31\u7b97\u5df2\u7d93\u6709\u5f88\u591a\u985e\u4f3c\u7684\u8ab2\u7a0b\uff0c\u4f46\u5b83\u4f9d\u7136\u662f\u9078\u80a1\u56de\u6e2c\u7684\u9996\u9078\u3002\u7576\u4e2d\u7684\u722c\u87f2\u7dad\u8b77\u5230\u73fe\u5728\uff0c\u9084\u6709\u5f88\u591a\u540c\u5b78\u5728\u4f7f\u7528\u3002 2019 \u5e74\uff0c\u7db2\u8def\u4e0a\u6307\u624b\u53ef\u6578\u7684\u6a5f\u5668\u5b78\u7fd2\u9078\u80a1\u8ab2\u7a0b\uff0c\u6211\u5230\u4eca\u5929\u505a\u52a0\u5bc6\u8ca8\u5e63\uff0c\u9084\u662f\u4f7f\u7528\u9019\u5802\u8ab2\u7a0b\u4e2d\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u4f86\u5be6\u505a\u3002\u7576\u5e74\u771f\u7684\u5f88\u591a\u4eba\u89ba\u5f97\u6a5f\u5668\u5b78\u7fd2\u4e0d\u80fd\u62ff\u4f86\u4ea4\u6613\uff0c\u4f46\u5982\u4eca\u5df2\u7d93 2022 \u5e74\u4e86\uff0c\u7d42\u65bc\u6bd4\u8f03\u5c11\u4eba\u5728\u5634\u6211\u4e86XDD\u3002 2020 \u5e74\uff0c\u958b\u8a2d Python \u4ea4\u6613\u52a0\u5bc6\u8ca8\u5e63\u8ab2\u7a0b\uff0c\u5e36\u5927\u5bb6\u6284\u5e95 9000 \u5143\u6bd4\u7279\u5e63\uff0c\u6211\u5c31\u4e0d\u4fe1\u9019\u6b21\u718a\u5e02\u53ef\u4ee5\u8dcc\u5230\u9019\u88e1\uff01</p>"},{"location":"#_3","title":"\u53ea\u6709\u8ab2\u7a0b\u662f\u4e0d\u8db3\u5920\u7684","text":"<p>\u8ab2\u7a0b\u4e2d\u7684\u5b78\u54e1\u5011\u90fd\u4f86\u4f86\u53bb\u53bb\uff0c\u6709\u5f88\u591a\u5be6\u8e10\u8005\uff0c\u771f\u7684\u7528\u8ab2\u7a0b\u4e2d\u7684\u5de5\u5177\u7372\u53d6\u8d85\u984d\u5831\u916c\uff0c\u4f46\u5c0d\u65bc\u5927\u90e8\u5206\u7684\u7fa4\u773e\uff0c\u9084\u662f\u5c0d\u65bc Python \u662f\u5426\u80fd\u771f\u7684\u62ff\u4f86\u4ea4\u6613\u534a\u4fe1\u534a\u7591\uff0c\u539f\u56e0\u5728\u65bc\u9019\u4e9b\u7dda\u4e0a\u8ab2\u7a0b\uff0c\u5305\u542b\u6211\u81ea\u5df1\u7684\u8ab2\u7a0b\uff0c\u70ba\u4e86\u517c\u9867\u521d\u5b78\u8005\uff0c\u6703\u82b1\u5f88\u591a\u6642\u9593\u5728\u5f9e\u982d\u4ecb\u7d39 Python \u8a9e\u6cd5\uff0c\u4f7f\u7528\u7db2\u8def\u4e0a\u73fe\u6210\u958b\u6e90\u7684\u5c08\u6848\uff0c\u505a\u5e7e\u500b\u7c21\u55ae\u7684\u5c0f\u7bc4\u4f8b\u3002\u751a\u81f3\u5f88\u591a\u7684 Python \u8ab2\u7a0b\u7684\u8ab2\u7a0b\u7bc4\u4f8b\uff0c\u662f\u4e0d\u80fd\u62ff\u4f86\u5be6\u6230\u7684\u3002\u9019\u9593\u63a5\u5c0e\u81f4\u4e86\u5927\u5bb6\u4e0a\u5b8c\u8ab2\u7a0b\uff0c\u89ba\u5f97 Python \u5c31\u53ea\u80fd\u505a\u73a9\u5177\u3002\u5be6\u6230\u9084\u662f\u8981\u7528 XQ \u6216\u662f Multicharts \u7b49\u5de5\u5177\u3002</p> <p>\u4f46\u5176\u5be6\u662f\u4e0d\u5c0d\u7684\uff0cPython \u66f4\u5ba2\u5236\u5316\uff0c\u5750\u64c1\u66f4\u591a\u5927\u578b\u958b\u6e90\u5c08\u6848\uff0c\u8cc7\u6599\u8655\u7406\u3001\u6a5f\u5668\u5b78\u7fd2\u3001\u5f8c\u7aef\u6846\u67b6\u3002Python \u61c9\u8a72\u662f\u624d\u662f\u5c08\u696d\u7d1a\u91cf\u5316\u4ea4\u6613\u8a72\u4f7f\u7528\u7684\u5de5\u5177\u3002\u53ea\u662f\u771f\u7684\u8981\u5beb\u5230\u80fd\u7372\u5229\u7684\u6a21\u578b\uff0c\u5f80\u5f80\u90fd\u9700\u8981\u5f88\u591a\u7684\u7a0b\u5f0f\u78bc\u3002\u4f60\u6709\u770b\u904e\u83ef\u723e\u8857\u7684\u5206\u6790\u5e2b\u4f7f\u7528 XQ \u55ce\uff1f\u6c92\u6709\uff0c\u4e00\u822c\u90fd\u662f\u4f7f\u7528 Python \u6216\u662f R \u5427\uff1f</p>"},{"location":"#_4","title":"\u7528\u7c21\u55ae\u5305\u88dd\u8907\u96dc\uff0c\u6709\u53ef\u80fd\u55ce\uff1f","text":"<p>\u9019\u500b\u5e73\u53f0\u7684\u76ee\u7684\uff0c\u5c31\u662f\u8b93\u4f60\u5728\u7c21\u55ae\u5b78\u7fd2 Python \u4e4b\u9918\uff0c\u99ac\u4e0a\u53ef\u4ee5\u5efa\u69cb\u4e00\u500b\u80fd\u7372\u5229\u7684\u9078\u80a1\u6e05\u55ae\uff0c\u6211\u5011\u6253\u9020\u51fa\u4f86\u7684\u7b56\u7565\uff0c\u7d93\u904e\u4e86\u5169\u5e74\u7684\u9a57\u8b49\uff0c\u7d93\u7684\u8d77\u5e02\u5834\u7684\u8003\u9a57\uff0c\u800c FinLab \u7814\u767c\u7684\u56de\u6e2c\u6846\u67b6\uff0c\u53ef\u4ee5\u5927\u5e45\u5ea6\u7684\u5c07\u8907\u96dc\u7a0b\u5f0f\u78bc\u5316\u7c21\u3002\u5c31\u7b97\u4f60\u662f\u521d\u5b78\u8005\uff0c\u99ac\u4e0a\u5c31\u80fd\u611f\u53d7 FinLab Package \u7684\u5a01\u529b\u3002</p> <p>\u7576\u521d\u60f3\u8981\u505a\u91cf\u5316\u9078\u80a1\u5e73\u53f0\uff0c\u7d93\u904e\u4e86\u597d\u5e7e\u5e74\uff0c\u73fe\u5728\u7d42\u65bc\u6c34\u5230\u6e20\u6210\u4e86\uff01\u6709\u5b89\u88dd\u7684 Python \u74b0\u5883\uff1aColab\uff0c\u6709 cloud function\u3001storage \u5728\u53f0\u7063\u53ef\u4ee5\u7bc0\u7701\u6210\u672c\uff0c\u6709 5G \u52a0\u901f\u4e0b\u8f09\u6b77\u53f2\u8cc7\u6599\u7684\u6642\u9593\uff0c\u6709 Kubernetes \u5e73\u8861\u5927\u5bb6\u4f7f\u7528\u56de\u6e2c\u8ca0\u8f09\u3002\u53ea\u80fd\u8aaa\u6c92\u6709\u9019\u4e9b\u529f\u80fd\uff0c\u6211\u5011\u4e5f\u6c92\u8fa6\u6cd5\u505a\u51fa\u4e00\u500b\u50cf\u6a23\u7684\u7522\u54c1\uff08\u611f\u8b1d Google XD\uff09\u3002</p>"},{"location":"#_5","title":"\u6210\u70ba\u5c08\u696d\u91cf\u5316\u6295\u8cc7\u4eba","text":"<p>FinLab \u81f4\u529b\u65bc\u63a8\u5ee3\u6211\u5011\u5728\u91cf\u5316\u6295\u8cc7\u4e0a\u7684\u77e5\u8b58\u8207 Python \u5be6\u4f5c\u7d93\u9a57\uff0c\u4e26\u4e14\u5206\u4eab\u5982\u4f55\u904b\u7528 Python \u5275\u9020\u5c6c\u65bc\u81ea\u5df1\u7684\u6295\u8cc7\u751f\u614b\u7cfb\uff0c\u9760\u81ea\u5df1\u7684\u80fd\u529b\u70ba\u81ea\u5df1\u5275\u9020\u6295\u8cc7\u6536\u5165\uff0c\u4e0d\u7528\u5728\u5916\u82b1\u9322\u807d\u4fe1\u7121\u6839\u64da\u7684\u660e\u724c\uff0c\u8b93\u5927\u5bb6\u7528\u5f88\u4f4e\u7684\u6210\u672c\u8907\u88fd\u6211\u5011\u5728\u8ca1\u7d93\u4e00\u8def\u4e0a\u7684\u6240\u5b78\u8207\u7d93\u9a57\u3002\u9664\u4e86\u904e\u53bb\u5728 Hahow \u958b\u8a2d\u8ab2\u7a0b\uff0c\u73fe\u5728\u70ba\u4e86\u6253\u9020\u66f4\u8c50\u5bcc\u7684 Python \u91cf\u5316\u6295\u8cc7\u751f\u614b\u7cfb\uff0c\u5efa\u7f6e\u4e86 SaaS \u8207\u5ef6\u4f38\u6559\u5b78\u5167\u5bb9\u5e73\u53f0\uff0c\u4e0d\u65b7\u7814\u767c\uff0c\u63d0\u4f9b\u7d66\u5927\u5bb6\u66f4\u591a\u6b66\u5668\u61c9\u5c0d\u8907\u96dc\u7684\u91d1\u878d\u5e02\u5834\u3002</p>"},{"location":"#_6","title":"\u5c55\u671b\u672a\u4f86","text":"<p>\u9019\u53ea\u662f\u4e00\u500b\u8d77\u9ede\uff0c\u6642\u4ee3\u7684\u8173\u6b65\u662f\u4e0d\u7b49\u4eba\u7684\uff0c\u672a\u4f86\u9084\u6709\u66f4\u591a\u7684\u9818\u57df\u60f3\u8981\u6574\u5408\uff0c\u66f4\u591a\u7684\u6280\u8853\uff0c\u50cf\u662f AI\u3001\u865b\u64ec\u8ca8\u5e63\u3001\u671f\u6b0a\u7b49\u7b49\u3002\u4e5f\u9700\u8981\u5927\u5bb6\u7684\u5171\u8944\u76db\u8209\uff0c\u8acb\u7763\u4fc3\u6211\u5011\u66f4\u8fd1\u4e00\u6b65\u5c07 Python \u9078\u80a1\u3001\u6295\u8cc7\u4ea4\u6613\u767c\u63da\u5149\u5927\uff01</p>"},{"location":"change-log/","title":"\u66f4\u65b0\u65e5\u8a8c","text":""},{"location":"change-log/#150-2025-08-01","title":"1.5.0 (2025-08-01)","text":""},{"location":"change-log/#features","title":"Features","text":"<ul> <li><code>factor_analysis</code>: \u65b0\u589e\u56e0\u5b50\u8da8\u52e2\u5206\u6790\u529f\u80fd\uff0c\u4e26\u65b0\u589e\u8aaa\u660e\u7c21\u6613\u7bc4\u4f8b\u6587\u6a94</li> <li><code>plot</code>: \u65b0\u589e\u7d71\u4e00\u7684 plotly \u6a23\u5f0f\uff0c\u591a\u7a2e\u984f\u8272\u7bc4\u570d\u53ca\u6a19\u8a18\u529f\u80fd\uff0c\u5f37\u5316\u7dda\u5716\u7684\u53ef\u8996\u5316\u6548\u679c\uff0c\u4e26\u652f\u63f4\u81ea\u5b9a\u7fa9\u984f\u8272\u5340\u9593</li> <li><code>plot</code>: \u589e\u5f37 <code>plot_line</code> \u51fd\u5f0f\uff0c\u65b0\u589e\u9032\u968e\u81ea\u5b9a\u7fa9\u9078\u9805\u548c\u7d9c\u5408\u7bc4\u4f8b\uff0c\u65b0\u589e <code>plot_line_example</code> \u548c <code>plot_line_financial_example</code> \u51fd\u5f0f</li> <li><code>tests</code>: \u589e\u52a0\u5c07\u56de\u6e2c\u7d50\u679c\u5e8f\u5217\u5316\u70ba pickle \u683c\u5f0f\u7684\u529f\u80fd</li> </ul>"},{"location":"change-log/#refactor","title":"Refactor","text":"<ul> <li><code>factor_analysis</code>: \u91cd\u69cb\u51fd\u5f0f\u540d\u7a31\u548c\u53c3\u6578\u4ee5\u63d0\u9ad8\u6e05\u6670\u5ea6\uff0c\u66f4\u65b0\u6587\u6a94\u4ee5\u53cd\u6620\u8b8a\u66f4</li> <li><code>docs</code>: \u66f4\u65b0\u8b8a\u66f4\u65e5\u8a8c\uff0c\u8abf\u6574\u6a21\u7d44\u7d50\u69cb\u53ca\u547d\u540d</li> </ul>"},{"location":"change-log/#fix","title":"Fix","text":"<ul> <li><code>data</code>: \u65b0\u589e <code>use_local_data_only</code> \u548c <code>force_cloud_download</code> \u529f\u80fd\u9078\u9805</li> <li><code>feature</code>: \u512a\u5316\u5e02\u5834\u914d\u7f6e\u908f\u8f2f\uff0c\u78ba\u4fdd\u5728\u591a\u6838\u74b0\u5883\u4e0b\u6b63\u78ba\u6062\u5fa9\u539f\u59cb\u5e02\u5834\u8a2d\u7f6e</li> <li><code>liquidityAnalysis</code>: \u78ba\u4fdd\u4ea4\u6613\u50f9\u683c\u548c\u6210\u4ea4\u91cf\u7684\u5f62\u72c0\u4e00\u81f4\uff0c\u4e26\u5c07\u5176\u8f49\u63db\u70ba DataFrame \u683c\u5f0f</li> <li><code>backtest</code>: \u4fee\u6b63\u4f4d\u7f6e\u904e\u6ffe\u908f\u8f2f\uff0c\u78ba\u4fdd\u53ea\u4fdd\u7559\u6709\u6548\u7684\u5e02\u5834\u6578\u64da\u4e26\u8f49\u63db\u70ba\u6d6e\u9ede\u6578</li> <li><code>doc</code>: \u4fee\u6b63 plotly \u7121\u6cd5\u6e32\u67d3\u7684\u554f\u984c\uff08\u6539\u7528\u975c\u614b png\uff09</li> </ul>"},{"location":"change-log/#docs","title":"Docs","text":"<ul> <li>\u65b0\u589e\u56e0\u5b50\u64c1\u64e0\u5ea6\u5206\u6790\u9801\u9762\u81f3\u5c0e\u822a</li> <li>\u65b0\u589e\u7c21\u6613\u6559\u5b78\u6587\u6a94\uff0c\u66f4\u65b0\u5be6\u7528\u7bc4\u4f8b\u6559\u5b78\uff0c\u8b93\u6559\u5b78\u66f4\u6e05\u695a</li> <li>\u4fee\u6539\u5be6\u7528\u7bc4\u4f8b\u6587\u6a94</li> <li>\u65b0\u589e KaTeX \u652f\u63f4\u7528\u65bc\u6578\u5b78\u6e32\u67d3\uff0c\u4e26\u79fb\u9664\u904e\u6642\u7684\u56e0\u5b50\u64c1\u64e0\u5ea6\u5206\u6790</li> <li>\u65b0\u589e\u5143\u5bcc\u8b49\u5238\u8a2d\u5b9a\u8aaa\u660e\u81f3\u4e0b\u55ae API \u6587\u6a94\uff0c\u4e26\u79fb\u9664\u904e\u6642\u7684 PE-PB \u5716\u8868\u5716\u7247</li> <li>\u4fee\u6b63\u4e0b\u55ae API \u6587\u6a94\u4e2d\u5c0d\u5143\u5bcc\u8b49\u5238\u7684\u5f15\u7528</li> </ul>"},{"location":"change-log/#140-2024-05-29","title":"1.4.0 (2024-05-29)","text":""},{"location":"change-log/#features_1","title":"Features","text":"<ul> <li><code>portfolio</code>: \u65b0\u589e <code>get_total_position</code> \u65b9\u6cd5\uff0c\u4ee5 DataFrame \u683c\u5f0f\u56de\u50b3\u7576\u524d\u6301\u80a1</li> <li><code>pyproject</code>: \u70ba\u958b\u767c\u7fa4\u7d44\u65b0\u589e <code>shioaji</code> \u652f\u63f4</li> </ul>"},{"location":"change-log/#refactor_1","title":"Refactor","text":"<ul> <li><code>backtest</code>: \u5c07 <code>Exception</code> \u66ff\u63db\u70ba <code>ValueError</code> \u548c <code>TypeError</code> \u4ee5\u9032\u884c\u66f4\u597d\u7684\u932f\u8aa4\u8655\u7406</li> <li><code>market</code>: \u5c07 <code>Market</code> \u985e\u5225\u8f49\u63db\u70ba\u62bd\u8c61\u57fa\u790e\u985e\u5225\u4e26\u66f4\u65b0 <code>tw</code> \u5e02\u5834</li> </ul>"},{"location":"change-log/#fix_1","title":"Fix","text":"<ul> <li><code>qlib</code>: \u6539\u5584\u7f3a\u5c11 <code>finlab[qlib]</code> \u6a21\u7d44\u7684\u932f\u8aa4\u8655\u7406\uff0c\u63d0\u4f9b\u66f4\u8a73\u7d30\u7684\u8a0a\u606f</li> <li><code>data</code>: \u65b0\u589e <code>use_local_data_only</code> \u548c <code>force_cloud_download</code> \u529f\u80fd</li> <li><code>data</code>: \u66f4\u65b0 <code>get</code> \u51fd\u5f0f\u7684\u56de\u50b3\u985e\u578b\u70ba <code>FinlabDataFrame</code></li> <li><code>data</code>: \u5728 <code>__all__</code> \u4e2d\u5305\u542b\u984d\u5916\u7684\u532f\u51fa</li> <li><code>pytorch_nn</code>: \u79fb\u9664\u640d\u58de\u7684 import \u4e26\u65b0\u589e <code>ICLoss</code> \u7528\u65bc\u8a08\u7b97\u8cc7\u8a0a\u4fc2\u6578\u640d\u5931</li> <li><code>portfolio</code>: \u512a\u5316\u79fb\u9664\u90e8\u4f4d\u7684\u908f\u8f2f\u4e26\u52a0\u5f37\u66f4\u65b0\u689d\u4ef6</li> <li><code>docker</code>: \u5c07 <code>finlab</code> \u7248\u672c\u9396\u5b9a\u5728 1.4.0</li> </ul>"},{"location":"change-log/#130-2024-05-24","title":"1.3.0 (2024-05-24)","text":""},{"location":"change-log/#features_2","title":"Features","text":"<ul> <li><code>online</code>: \u65b0\u589e\u53e3\u888b\u8b49\u5238 (pocket account) \u76f8\u95dc\u529f\u80fd</li> <li><code>fubon</code>: \u65b0\u589e\u5143\u5bcc\u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71</li> <li><code>data</code>: \u65b0\u589e\u8ca1\u52d9\u6578\u64da\u6307\u6a19\u7684 entry names</li> <li><code>dataframe</code>: <code>rank</code> \u65b9\u6cd5\u65b0\u589e\u672a\u4f86\u8cc7\u6599\u7aba\u770b\u8b66\u544a</li> <li><code>setup</code>: \u65b0\u589e Python 3.7 \u548c 3.8 \u7684 classifiers</li> <li><code>requirements</code>: \u65b0\u589e <code>Jinja2</code> \u8207 <code>ipython</code> \u5957\u4ef6</li> <li><code>test</code>: \u65b0\u589e <code>pytest</code> \u7684\u958b\u767c\u4f9d\u8cf4\u8207 <code>slow</code> \u6a19\u8a18</li> <li>\u66f4\u65b0\u4f7f\u7528 uv \u4f86\u7ba1\u7406\u4f9d\u8cf4</li> </ul>"},{"location":"change-log/#refactor_2","title":"Refactor","text":"<ul> <li><code>alphalens</code>: \u79fb\u9664 <code>alphalens</code> \u6a21\u7d44\u8207\u76f8\u95dc\u529f\u80fd</li> <li><code>portfolio</code>: \u512a\u5316 <code>PortfolioSyncManager</code> \u4e2d\u79fb\u9664\u90e8\u4f4d\u7684\u65e5\u8a8c\u7d00\u9304</li> <li><code>backtest</code>: \u8a3b\u89e3\u6389\u8a2d\u5b9a\u5168\u57df\u56de\u6e2c\u5831\u544a\u7684\u672a\u4f7f\u7528\u7a0b\u5f0f\u78bc</li> <li><code>plot</code>: \u5f9e <code>plot_test.py</code> \u79fb\u9664\u904e\u6642\u7684\u7e6a\u5716\u6e2c\u8a66</li> <li><code>ml</code>: \u6539\u5584 <code>combine</code> \u51fd\u5f0f\u4e2d\u7684\u5de5\u5ee0\u521d\u59cb\u5316\u548c\u578b\u5225\u63d0\u793a</li> </ul>"},{"location":"change-log/#fix_2","title":"Fix","text":"<ul> <li><code>setup</code>: \u555f\u7528 <code>find_namespace_packages</code> \u652f\u63f4\u4e26\u6539\u5584\u8def\u5f91\u8655\u7406</li> <li><code>liquidityAnalysis</code>: \u4fee\u6b63\u8655\u7f6e\u80a1\u7968\u7684\u5224\u65b7\u908f\u8f2f\u8207\u6f32\u8dcc\u5e45\u8a55\u4f30\u7684\u65e5\u671f\u57fa\u6e96</li> <li><code>docker</code>: \u66f4\u65b0 <code>pandas</code> \u8207 <code>ta-lib</code> \u7248\u672c</li> <li><code>backtest</code>: \u66f4\u65b0\u56de\u6e2c\u4e0a\u50b3\u8a0a\u606f</li> <li><code>ml</code>: \u4fee\u6b63 <code>combine</code> \u51fd\u5f0f\u4e2d\u7684\u8b8a\u6578\u5f15\u7528</li> <li><code>analysis</code>: \u4fee\u6b63 <code>drawdown</code> \u7684\u7d50\u675f\u65e5\u671f</li> <li><code>parallel</code>: \u4fee\u6b63 <code>ParallelExt</code> \u4ee5\u652f\u63f4\u8f03\u65b0\u7248\u672c\u7684 <code>joblib</code></li> <li><code>pyproject</code>: \u6307\u5b9a <code>Cython</code> \u7248\u672c\u4ee5\u78ba\u4fdd\u76f8\u5bb9\u6027</li> </ul>"},{"location":"change-log/#docs_1","title":"Docs","text":"<ul> <li><code>docs</code>: \u91cd\u65b0\u547d\u540d <code>getting-start.md</code> \u4e26\u66f4\u65b0 <code>mkdocs.yml</code></li> <li><code>order_api</code>: \u66f4\u65b0\u6191\u8b49\u53d6\u5f97\u8207\u5957\u4ef6\u5b89\u88dd\u8aaa\u660e</li> </ul>"},{"location":"change-log/#type-safety","title":"Type Safety","text":"<ul> <li><code>core</code>: \u70ba <code>FinlabDataFrame</code> \u548c <code>backtest</code> \u6a21\u7d44\u65b0\u589e\u578b\u5225\u63d0\u793a</li> </ul>"},{"location":"change-log/#1227-2025-05-15","title":"1.2.27 (2025-05-15)","text":""},{"location":"change-log/#features_3","title":"Features","text":"<ul> <li>\u65b0\u589e\u5143\u5bcc\u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71</li> <li><code>finlab.ml.feature.combine</code> \u652f\u63f4 dictionary of function \u4f86\u7522\u751f\u7279\u5fb5</li> <li><code>finlab.dataframe.FinlabDataFrame</code> \u91cd\u69cb <code>rank</code> \u65b9\u6cd5\uff0c\u81ea\u52d5\u8655\u7406\u8ca1\u5831\u6a6b\u5411\u6bd4\u8f03\uff0c\u907f\u514d look ahead \u7684\u53ef\u80fd\u3002</li> <li><code>finlab.dataframe.FinlabDataFrame</code> \u91cd\u69cb <code>rank</code> \u65b9\u6cd5\uff0c\u8b66\u544a\u4f7f\u7528\u8005\u4f7f\u7528\u4e86 look ahead \u7684\u53ef\u80fd\u3002</li> </ul>"},{"location":"change-log/#fix_3","title":"Fix","text":"<ul> <li>qlib \u6a21\u578b\u5f15\u7528\u4fee\u6b63</li> </ul>"},{"location":"change-log/#1224-2025-05-02","title":"1.2.24 (2025-05-02)","text":""},{"location":"change-log/#features_4","title":"Features","text":"<ul> <li>\u5c07\u6574\u500b qlib \u7684\u529f\u80fd\u6574\u5408\u5230 finlab.ml \u4e2d\uff0c\u53ea\u9700\u8981\u5b89\u88dd finlab \u5c31\u53ef\u4ee5\u4f7f\u7528 qlib \u7684\u529f\u80fd(pip install finlab[qlib])</li> </ul>"},{"location":"change-log/#refactor_3","title":"Refactor","text":"<ul> <li><code>report</code> \u652f\u63f4 <code>report.to_html(path)</code> \u5c07\u5831\u544a\u8f49\u63db\u6210 HTML \u6a94\u6848</li> <li><code>report</code> \u652f\u63f4 <code>report._repr_html_()</code> \u76f4\u63a5\u5728 Jupyter Notebook \u4e2d\u986f\u793a\u5831\u544a</li> <li>\u5c07 <code>dashboard</code> \u79fb\u51fa <code>report</code> \u6a21\u7d44\uff0c\u7368\u7acb\u6210\u70ba <code>finlab.core.dashboard</code> \u6a21\u7d44</li> </ul>"},{"location":"change-log/#fix_4","title":"Fix","text":"<ul> <li>\u4fee\u5fa9 <code>report.trades</code> \u4e2d\u95dc\u65bc\u8b66\u793a\u80a1\u3001\u8655\u7f6e\u80a1\u3001\u5168\u984d\u4ea4\u5272\u80a1\u5c11\u90e8\u5206\u7684\u8cc7\u6599\u932f\u8aa4</li> <li>\u4fee\u5fa9 <code>report.weights.name</code> \u4ee5\u53ca <code>report.next_weights.name</code> \u53ef\u80fd\u70ba None \u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#1223-2025-03-25","title":"1.2.23 (2025-03-25)","text":""},{"location":"change-log/#fix_5","title":"Fix","text":"<ul> <li>\u4fee\u6b63 <code>report.upload</code> \u5728 resample=pd.DatetimeIndex \u6703\u5831\u932f\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#1222-2025-03-25","title":"1.2.22 (2025-03-25)","text":""},{"location":"change-log/#features_5","title":"Features","text":"<ul> <li><code>PositionScheduler</code> \u652f\u63f4\u591a\u7b56\u7565\u8207\u91cd\u65b0\u5e73\u8861\u908f\u8f2f</li> <li><code>backtest.sim</code> \u65b0\u589e <code>resample=None</code> \u6642\u81ea\u52d5\u8a08\u7b97\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5</li> </ul>"},{"location":"change-log/#fixes","title":"Fixes","text":"<ul> <li>\u66f4\u65b0 macOS \u69cb\u5efa\u67b6\u69cb\u8a2d\u5b9a\uff0c\u50c5\u4fdd\u7559 <code>universal2</code></li> <li>\u4fee\u6b63 <code>resample</code> \u53c3\u6578\u7684\u908f\u8f2f\uff0c\u5141\u8a31\u76f4\u63a5\u4f7f\u7528</li> <li>\u8abf\u6574 <code>PositionScheduler.from_report</code> \u65b9\u6cd5\u4ee5\u7b26\u5408\u65b0\u7684 <code>resample</code> \u908f\u8f2f</li> <li>\u66f4\u65b0\u4e26\u4fee\u6b63\u76f8\u95dc\u7684\u55ae\u5143\u6e2c\u8a66</li> </ul>"},{"location":"change-log/#1221-2025-03-12","title":"1.2.21 (2025-03-12)","text":""},{"location":"change-log/#features_6","title":"Features","text":"<ul> <li><code>report.is_stop_triggered()</code> \u76e3\u6e2c\u662f\u5426\u6709\u505c\u640d\u505c\u5229\u89f8\u767c</li> <li><code>report.is_rebalance_due()</code> \u76e3\u6e2c\u662f\u5426\u6709\u518d\u5e73\u8861\u89f8\u767c</li> <li><code>report.to_pickle('PATH')</code> \u5c07\u5831\u544a\u5b58\u6210 pickle \u6a94\u6848</li> <li><code>report.from_pickle('PATH')</code> \u5f9e pickle \u6a94\u6848\u8b80\u53d6\u5831\u544a</li> <li><code>backtest.sim</code> \u56de\u6e2c\u901f\u5ea6\u512a\u5316</li> </ul>"},{"location":"change-log/#fixes_1","title":"Fixes","text":"<ul> <li><code>PortfolioSyncManager</code> \u8003\u616e weight = 0 \u7684\u60c5\u6cc1</li> <li><code>data.get</code> \u5728\u4e0b\u8f09\u7570\u5e38\u6642\uff0c\u6703\u81ea\u52d5\u91cd\u8a66</li> <li><code>backtest.sim</code> \u91dd\u5c0d\u80a1\u7968\u4ee3\u865f\u7570\u5e38\u6642\uff0c\u6703\u81ea\u52d5\u8df3\u904e</li> <li><code>backtest.sim</code> \u4fee\u6b63\u505a\u7a7a\u7684\u5831\u916c\u7387\u986f\u793a\u932f\u8aa4</li> </ul>"},{"location":"change-log/#1220-2024-12-09","title":"1.2.20 (2024-12-09)","text":""},{"location":"change-log/#refactor_4","title":"Refactor","text":"<ul> <li><code>MarketInfo</code> \u73fe\u5728\u79fb\u52d5\u81f3 <code>finlab.market</code> \u6a21\u7d44\u4e4b\u4e2d</li> <li><code>TWMarketInfo</code> \u73fe\u5728\u79fb\u52d5\u81f3 <code>finlab.markets.tw</code> \u6a21\u7d44\u4e4b\u4e2d\uff0c\u4e26\u4e14\u6539\u540d\u70ba <code>TWMarket</code></li> <li>fix(market_info): rename loop variable for clarity in shared memory creation</li> <li>\u4f7f\u7528 <code>finlab.config.set_market</code> \u4f86\u8a2d\u5b9a\u5168\u57df\u5e02\u5834\u8cc7\u8a0a</li> <li>\u53d6\u6d88 <code>ml.get_market</code> \u4ee5\u53ca <code>ml.set_market</code>\uff0c\u4f7f\u7528 <code>finlab.config.set_market</code> \u4ee3\u66ff</li> <li>\u53d6\u6d88 <code>data.indicator(...market)</code> \u8207 <code>finlab.config.set_market</code> \u5408\u4f75</li> <li>\u53d6\u6d88 <code>df.hold_until(...market)</code> \u8207 <code>finlab.config.set_market</code> \u5408\u4f75</li> </ul>"},{"location":"change-log/#1217-2024-10-19","title":"1.2.17 (2024-10-19)","text":""},{"location":"change-log/#features_7","title":"Features","text":"<ul> <li><code>report.weight.name</code> \u7684\u540d\u7a31\u6539\u6210\u56de\u6e2c\u6700\u5f8c\u4e00\u5929\u7684\u65e5\u671f\uff0c\u65b9\u4fbf\u67e5\u770b\uff0c</li> <li><code>report.next_weight.name</code> \u7684\u540d\u7a31\u6539\u6210\u63db\u80a1\u65e5\u671f\uff0c\u65b9\u4fbf\u67e5\u770b\uff0c</li> <li><code>\u652f\u63f4 numpy&gt;=2.0</code> \u7136\u800c <code>talib</code> \u9084\u6c92\u652f\u63f4\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528 talib \u7684\u8a71\u9700\u8981\u518d\u7b49\u7b49\u3002</li> <li><code>Position</code> \u652f\u63f4 <code>weight</code> (optional) \u7684\u5132\u5b58\u8207\u8a08\u7b97\uff0c\u65b9\u4fbf\u5feb\u901f\u6bd4\u8f03\u5f35\u6578\u8207\u6b0a\u91cd\u3002</li> <li><code>FugleAccount</code> \u6539\u6210\u4f7f\u7528 websocket \u9032\u884c\u8a02\u55ae\u7684\u9023\u7dda\u8207\u66f4\u65b0</li> <li><code>OrderExecutor</code> \u65b0\u589e progress \u53ef\u4ee5\u91dd\u5c0d\u300c\u7576\u524d\u90e8\u4f4d\u300d\u8207\u300c\u76ee\u6a19\u90e8\u4f4d\u300d\u9032\u884c\u5167\u5dee\uff0c\u65b9\u4fbf\u8f49\u5009\u5e73\u6ed1\u904e\u5ea6</li> </ul>"},{"location":"change-log/#fixes_2","title":"Fixes","text":"<ul> <li><code>finlab.online.sinopac</code> \u8655\u7406\u7576\u80a1\u7968\u7576\u5929\u7121\u4ea4\u6613\u6642\uff0c\u907f\u514d\u76f4\u63a5\u5831\u932f</li> </ul>"},{"location":"change-log/#1216-2024-10-02","title":"1.2.16 (2024-10-02)","text":""},{"location":"change-log/#fixed","title":"Fixed","text":"<ul> <li><code>data.get</code> \u6e1b\u5c11\u975e\u5fc5\u8981\u7684\u9023\u7dda\u6b21\u6578</li> <li><code>cli</code> \u4fee\u6b63 webview \u975e\u5fc5\u8981 import \u7684\u932f\u8aa4</li> <li><code>finlab.online.sinopac</code> \u4fee\u6b63 <code>get_trades</code> \u5728\u8a08\u7b97\u6642\u9593\u6642\uff0c\u6703\u5c07\u6642\u9593\u8f49\u63db\u6210 UTC \u6642\u9593</li> <li><code>finlab.portfolio</code> \u4fee\u6b63 <code>PortfolioSyncManager</code> \u5728 <code>to_cloud</code> \u6216 <code>to_json</code> \u6642\uff0c\u53ef\u80fd\u6703\u7522\u751f\u4e0d\u76f8\u5bb9\u7684\u683c\u5f0f</li> </ul>"},{"location":"change-log/#1215-2024-09-08","title":"1.2.15 (2024-09-08)","text":""},{"location":"change-log/#fixed_1","title":"Fixed","text":"<ul> <li><code>position.from_report</code> \u4fee\u6b63 <code>weight.index</code> \u70ba\u975e str \u7684\u554f\u984c</li> <li><code>finlab.portfolio</code> \u4fee\u6b63\u6301\u6709\u7121\u6cd5\u4ea4\u6613\u80a1\u7968\u6642\uff0c\u6703\u5831\u932f\u7684\u554f\u984c</li> <li><code>finlab.online</code> \u4fee\u6b63\u6b32\u7121\u6cd5\u4ea4\u6613\u80a1\u7968\u6642\uff0c\u6703\u5831\u932f\u7684\u554f\u984c\uff08\u6539\u6210\u8df3\u51fa\u8b66\u793a\uff09</li> <li><code>finlab.data</code> \u4fee\u6b63 <code>data.search</code> \u6642\u641c\u7d22\u6578\u64da\u70ba\u7a7a\u7684\u554f\u984c</li> <li><code>finlab.portfolio</code> \u4fee\u6b63\u505c\u640d\u505c\u5229\u6642\uff0c\u5728\u67d0\u4e9b\u6642\u523b\u4e0b\u6703\u8df3\u904e\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#1212-2024-8-27","title":"1.2.12 (2024-8-27)","text":""},{"location":"change-log/#features_8","title":"Features","text":"<ul> <li>dashboard: \u65b0\u589e\u5100\u8868\u677f\u4e2d\u7684\u300c\u8207\u5927\u76e4\u76f8\u95dc\u6027\u300d\uff0c\u4e26\u4e14\u80fd\u5920\u9078\u64c7\u6642\u9593\u5340\u9593</li> <li>portfolio: \u65b0\u589e <code>PortfolioSyncManager</code> \u7684 <code>get_position(at='open')</code> \u7684\u529f\u80fd\uff0c\u7528\u65bc\u898f\u5283\u7576\u65e5\u958b\u76e4\u7684\u90e8\u4f4d</li> <li>online.position: \u512a\u5316\u986f\u793a\u90e8\u4f4d\u7684\u529f\u80fd</li> <li>online.position: \u589e\u52a0\u4ee5 for loop \u63d0\u53d6\u90e8\u4f4d\u8cc7\u8a0a\u7684\u529f\u80fd</li> <li>tool.factor_analysis: \u589e\u52a0\u56e0\u5b50\u5206\u6790\u529f\u80fd\uff0c\u9664\u4e86 IC \u4ee5\u5916\uff0c\u652f\u63f4 <code>get_metric</code> \u4f86\u904b\u7b97\u56e0\u5b50\u7684\u5404\u7a2e\u6307\u6a19</li> <li>portfolio: \u65b0\u589e <code>PortfolioSyncManager</code> \u81ea\u52d5\u5224\u65b7 <code>smooth_transition</code> \u7684\u6642\u6a5f\uff0c\u5728\u521d\u59cb\u5316\u6642\u4e0d\u9700\u5e73\u6ed1\u904e\u5ea6\uff0c\u65bc\u4e4b\u5f8c\u90fd\u4f7f\u7528\u5e73\u6ed1\u904e\u5ea6</li> <li>doc: \u512a\u5316 <code>portfolio</code> \u4e0b\u55ae\u7684\u6559\u5b78\u6587\u4ef6</li> <li>sinopac: \u6c38\u8c50\u8b49\u5238\u652f\u63f4 <code>get_trades</code> \u529f\u80fd\u7528\u65bc\u6bd4\u5c0d\u5e33\u6236\u4ea4\u6613\u7d00\u9304</li> </ul>"},{"location":"change-log/#fixed_2","title":"Fixed","text":"<ul> <li>data: \u4fee\u6b63 <code>data.get</code> \u6703\u65bc\u5c11\u6578\u4f5c\u696d\u7cfb\u7d71\u7522\u751f circular import \u7684\u554f\u984c</li> <li>cli: \u4fee\u6b63 <code>finlab nb</code> \u6307\u4ee4\u6703\u7522\u751f <code>import webview</code> \u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#1211-2024-8-19","title":"1.2.11 (2024-8-19)","text":""},{"location":"change-log/#fixed_3","title":"Fixed","text":"<ul> <li>backtest: \u4fee\u6b63\u505c\u640d\u505c\u5229\u6642\uff0c\u5728\u5c11\u6578\u60c5\u6cc1\u6703\u7528\u5230\u672a\u4f86\u8cc7\u6599\u7684\u554f\u984c</li> <li>test: \u6e2c\u8a66\u56de\u6e2c\u7cfb\u7d71\u6642\uff0c\u4f7f\u7528\u6b77\u53f2\u8cc7\u6599</li> <li>report: \u4fee\u6b63\u56de\u6e2c\u5831\u544a\u4e2d\u7684\u7522\u696d\u5225\u986f\u793a\u932f\u8aa4</li> <li>online: \u4fee\u6b63\u4e0b\u55ae\u6642\uff0c\u986f\u793a\u904e\u591a\u5c0f\u6578\u9ede\u7684\u554f\u984c</li> <li>schedule: \u4fee\u6b63\u57f7\u884c\u7b56\u7565\u6642\uff0c\u4f7f\u7528\u5230\u932f\u8aa4 Token \u7684\u554f\u984c</li> <li>portfolio.cloud_report: \u4fee\u6b63\u652f\u63f4 int \u578b\u614b\u7684 return \uff08\u5728\u5c11\u6578\u60c5\u6cc1\u4e0b\u6703\u7528\u5230\uff09</li> <li>backtest: \u56de\u6e2c in-sample \u6642\uff0c\u5c07 out-sample \u7684\u8cc7\u6599\u96b1\u85cf</li> <li>data: \u7576\u4e0b\u8f09\u8d85\u904e 5 \u5206\u9418\u6642\uff0c\u6703\u81ea\u52d5\u7d42\u6b62\u4e26\u4e14\u986f\u793a\u932f\u8aa4\u8a0a\u606f</li> </ul>"},{"location":"change-log/#129-2024-8-3","title":"1.2.9 (2024-8-3)","text":""},{"location":"change-log/#feature","title":"Feature","text":"<ul> <li>\u65b0\u589e <code>finlab.portfolio</code> \u7684 <code>PortfolioSyncManager.update</code> \u4f7f\u7528 <code>custom_position</code> \u4f86\u8a2d\u5b9a\u80a1\u7968\u5f35\u6578</li> <li>\u65b0\u589e <code>finlab.portfolio</code> \u7684 <code>PortfolioSyncManager.update</code> \u4f7f\u7528 <code>excluded_stock_ids</code> \u4f86\u8a2d\u5b9a\u5ffd\u7565\u7684\u80a1\u7968</li> </ul>"},{"location":"change-log/#128-2024-8-1","title":"1.2.8 (2024-8-1)","text":""},{"location":"change-log/#fix_6","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u5728\u67d0\u4e9b\u72c0\u6cc1\u4e0b\uff0c\u56de\u6e2c\u5831\u932f\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#127-2024-8-1","title":"1.2.7 (2024-8-1)","text":""},{"location":"change-log/#fix_7","title":"Fix","text":"<ul> <li>\u80a1\u7968\u7d50\u7b97\u65bc\u975e\u6536\u76e4\u50f9\uff0c\u5c0e\u81f4\u7684\u5831\u916c\u7387\u8a08\u7b97\u932f\u8aa4</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> \u4e2d <code>PortfolioSyncManager</code> \u5728 <code>update</code> \u6642\uff0c\u7522\u751f\u975e\u5fc5\u8981\u6027 <code>warning</code></li> </ul>"},{"location":"change-log/#125-2024-7-29","title":"1.2.5 (2024-7-29)","text":""},{"location":"change-log/#feature_1","title":"Feature","text":"<ul> <li>\u65b0\u589e\u80a1\u7968\u5100\u8868\u677f\u4e2d\uff0c\u96b1\u85cf\u80a1\u7968\u540d\u7a31\u7684\u529f\u80fd</li> </ul>"},{"location":"change-log/#fix_8","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u80a1\u7968\u5100\u8868\u677f\u4e2d <code>open_close_avg</code> \u70ba\u300c\u5e73\u5747\u50f9\u300d</li> <li>\u4fee\u6b63\u5831\u916c\u7387\u7684\u8a08\u7b97\u65b9\u5f0f\uff0c\u4e0d\u540c\u671f\u4e4b\u9593\u4e0d\u9700\u8981\u8a08\u7b97\u4ea4\u6613\u624b\u7e8c\u8cbb</li> <li>\u4fee\u6b63\u5100\u8868\u677f\u4e2d <code>NaN</code> \u7684\u72c0\u6cc1</li> </ul>"},{"location":"change-log/#124-2024-7-28","title":"1.2.4 (2024-7-28)","text":""},{"location":"change-log/#feature_2","title":"Feature","text":"<ul> <li>\u65b0\u589e <code>finlab.portfolio</code> \u7684 <code>PortfolioSyncManager</code> \u4f7f\u7528 <code>to_file</code> \u548c <code>from_file</code> \u4f86\u8b80\u53d6\u8cc7\u6599</li> </ul>"},{"location":"change-log/#fix_9","title":"Fix","text":"<ul> <li>\u4fee\u6b63 <code>finlab.portfolio</code> \u4f7f\u7528 <code>PortfolioSyncManager</code> \u8655\u7406\u96f6\u80a1\u5831\u932f\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> \u4f7f\u7528 <code>PortfolioSyncManager</code> \u96f6\u80a1\u986f\u793a\u5c0f\u6578\u9ede\u7b2c\u56db\u4f4d</li> </ul>"},{"location":"change-log/#122-2024-7-27","title":"1.2.2 (2024-7-27)","text":""},{"location":"change-log/#fix_10","title":"Fix","text":"<ul> <li>\u4fee\u6b63 <code>finlab.cli</code> \u5047\u5982\u5c1a\u672a\u521d\u59cb\u5316 nb \u6307\u4ee4\u6703\u5831\u932f\u7684\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> \u96f2\u7aef\u4e0b\u8f09\u7b56\u7565\uff0c\u627e\u4e0d\u5230\u7b56\u7565 raise Error \u63d0\u4f9b\u66f4\u8a73\u7d30\u7684\u932f\u8aa4\u8a0a\u606f</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> \u91dd\u5c0d live_trading_performance \u70ba None \u5831\u932f\u7684\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> create_mutli_asset_report \u8def\u5f91\u8207\u56de\u50b3\u6578\u503c\u7684\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.portfolio</code> syn manager \u5728\u505c\u640d\u505c\u5229\u6642\u7684\u5831\u932f\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.backtest</code> \u5c07 resample=None \u7684\u6642\u5019\uff0c\u5831\u916c\u7387\u8a08\u7b97\u65b9\u5f0f\u70ba\u6301\u6709\u671f\u9593\u5831\u916c\u7387</li> <li>\u4fee\u6b63 <code>finlab.backtest</code> \u5728\u76e4\u4e2d\u6a21\u64ec\u6642\uff0c\u8a08\u7b97\u6536\u76e4\u7d50\u7b97\u5f15\u5165NaN\u9020\u6210\u7684\u554f\u984c</li> <li>\u4fee\u6b63 <code>finlab.report</code> \u91dd\u5c0d\u6bcf\u671f\u5831\u916c\u7387\u5206\u958b\u6642\uff0c\u986f\u793a\u51fa\u5834\u539f\u56e0\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#120-2024-7-27","title":"1.2.0 (2024-7-27)","text":""},{"location":"change-log/#features_9","title":"Features","text":"<ul> <li>\u65b0\u589e <code>finlab.backtest</code> \u7684\u76e4\u4e2d\u5100\u8868\u677f\u548c\u7d2f\u8a08\u5831\u916c\u5100\u8868\u677f</li> <li>\u65b0\u589e <code>finlab.backtest</code> \u6a21\u64ec\u6642\uff0c\u4e0d\u8ad6 <code>trade_at_price</code> \u70ba\u4f55\uff0c\u6240\u6709\u7d50\u7b97\u5747\u65bc\u76e4\u5f8c\u9032\u884c\u7d50\u7b97</li> <li>\u65b0\u589e <code>finlab.backtest</code> \u8003\u616e\u958b\u76e4\u8cb7\u8ce3\uff0c\u6536\u76e4\u50f9\u6c7a\u5b9a\u505c\u640d\u505c\u5229</li> <li>\u65b0\u589e <code>finlab.report</code> \u5c07 <code>report.trades</code> \u65b0\u589e\u7522\u696d\u5225</li> <li>\u65b0\u589e <code>finlab.portfolio</code> \u6a21\u7d44\uff0c\u7528\u65bc\u5c07\u7b56\u7565\u7528\u65bc\u5be6\u969b\u6295\u8cc7\u7d44\u5408</li> <li>\u65b0\u589e <code>finlab.portfolio</code> \u6587\u4ef6\u6559\u5b78\uff0c\u7528\u65bc\u6559\u5b78\u5982\u4f55\u5c07\u7b56\u7565\u7528\u65bc\u5be6\u969b\u6295\u8cc7\u7d44\u5408</li> <li>\u65b0\u589e <code>finlab.cli</code> \u6a21\u7d44\uff0c\u7528\u65bc\u547d\u4ee4\u884c\u64cd\u4f5c\u8207\u4e0b\u55ae</li> <li>\u65b0\u589e <code>finlab.cli</code> \u6587\u4ef6\u6559\u5b78\uff0c\u7528\u65bc\u6559\u5b78\u5982\u4f55\u4f7f\u7528\u547d\u4ee4\u884c\u64cd\u4f5c\u8207\u4e0b\u55ae</li> <li>\u65b0\u589e doc \u4ecb\u7d39\u5229\u7528 regex \u4f86\u9078\u53d6\u7522\u696d\u5225</li> <li>\u65b0\u589e <code>finlab.online</code> \u529f\u80fd\uff0c\u8b93 <code>Fugle API</code> \u53ef\u4ee5\u81ea\u52d5\u767b\u5165\u4e0d\u9700\u4eba\u5de5\u8f38\u5165\u5bc6\u78bc</li> </ul>"},{"location":"change-log/#fix_11","title":"Fix","text":"<ul> <li>\u4fee\u6b63 <code>finlab.sinopac</code> \u4e2d\u7684\u5e33\u6236\u9918\u984d\u8a08\u7b97\u65bc\u661f\u671f\u5929\u51cc\u6668\u63d0\u65e9\u7d50\u7b97\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#116-2024-7-11","title":"1.1.6 (2024-7-11)","text":""},{"location":"change-log/#fix_12","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u56de\u6e2c\u4e2d\uff0c\u96e2\u7dda\u7248\u91dd\u5c0d\u8cc7\u6599\u5feb\u53d6\u8b80\u53d6\u7684\u554f\u984c</li> <li>\u4fee\u6b63\u56de\u6e2c\u4e2d\uff0cWindows datetime \u8f49\u63db\u6210 int32 \u4e0d\u652f\u63f4\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#114-2024-7-9","title":"1.1.4 (2024-7-9)","text":""},{"location":"change-log/#features_10","title":"Features","text":"<ul> <li>\u65b0\u589e\u7b56\u7565\u5230\u671f\u6642\u9593\uff0c\u7528\u65bc\u63d0\u9192\u8cc7\u6599\u5df2\u7d93\u904e\u671f\uff0c\u9700\u8981\u91cd\u65b0\u57f7\u884c</li> <li>\u56de\u5074\u9762\u7248\uff1a\u540c\u6642\u986f\u793a\u9032\u5834\u8207\u7576\u524d\u50f9\u683c</li> <li>\u56de\u6e2c\u9762\u7248\uff1a\u5c07\u9810\u8a2d\u5831\u916c\u7387\u986f\u793a\u5f9e\u5f8c\u5f80\u524d</li> <li>\u56de\u6e2c\u9762\u7248\uff1a\u6301\u80a1\u50f9\u683c\u986f\u793a\u512a\u5316</li> </ul>"},{"location":"change-log/#fix_13","title":"Fix","text":"<ul> <li>\u4fee\u6b63 finlab.tools.factor_analysis \u6703\u56e0\u70ba\u56e0\u5b50\u65e5\u671f\u6c92\u6709\u5c0d\u9f4a\u800c\u5831\u932f\u7684\u554f\u984c</li> <li>\u4fee\u6b63 Pandas 2.2.0 \u7248\u672c\u4e0b\uff0c\u929c\u63a5 Pandas 3.0.0 \u7522\u751f\u7684 Warning</li> <li>\u4fee\u6b63 ffn_core \u4e2d\uff0cTabular \u5efa\u69cb\u932f\u8aa4\u7684\u554f\u984c</li> <li>\u4fee\u6b63 ffn_core \u4e2d\uff0c\u91dd\u5c0d Pandas 3.0.0 \u7248\u672c\u7684\u517c\u5bb9\u6027\u554f\u984c</li> <li>\u4fee\u6b63\u56de\u6e2c\u9801\u9762\u80a1\u7968\u9032\u5834\u50f9\u683c\u986f\u793a\u932f\u8aa4\u7684\u554f\u984c</li> <li>\u56de\u6e2c\u9801\u9762\uff1a\u4fee\u6b63\u80a1\u7968\u6b77\u53f2\u7d00\u9304</li> <li>\u56de\u6e2c\u9801\u9762\uff1a\u8003\u616e\u8fd1\u671f\u6700\u5927\u4e0b\u8dcc</li> <li>\u4fee\u6b63 plot \u4e2d\u6bcf\u5e74\u5e73\u5747\u5831\u916c\uff0c\u8003\u616e\u6c92\u6709\u56de\u6e2c\u7684\u72c0\u6cc1</li> </ul>"},{"location":"change-log/#113-2024-6-4","title":"1.1.3 (2024-6-4)","text":""},{"location":"change-log/#features_11","title":"Features","text":"<ul> <li>\u5c07finlab.tools.factor_analysis \u9032\u884c\u4fee\u6b63\uff0c\u652f\u63f4\u591a\u56e0\u5b50</li> <li>LINE Notify \u65b0\u589e\u7b56\u7565\u540d\u7a31\u767c\u9001</li> </ul>"},{"location":"change-log/#fix_14","title":"Fix","text":"<ul> <li>\u4fee\u6b63 show_alerting_stocks \u7121\u6cd5\u4f7f\u7528\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#112-2024-5-23","title":"1.1.2 (2024-5-23)","text":""},{"location":"change-log/#feature_3","title":"Feature","text":"<ul> <li>\u65b0\u589e finlab.tools.factor_analysis \u6a21\u7d44\uff0c\u7528\u65bc\u56e0\u5b50\u5206\u6790</li> </ul>"},{"location":"change-log/#fix_15","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u50f9\u683c NaN \u7684\u61c9\u5c0d\u8655\u7406</li> <li>\u4fee\u6b63 finlab.ml.feature.ta \u51fd\u5f0f\u7684\u591a\u6838\u8655\u7406\u908f\u8f2f\uff0c\u6839\u64da\u55ae\u6838\u5fc3\u5831\u932f</li> <li>\u4fee\u6b63\u53c3\u7167\u4e0b\u6b21\u518d\u5e73\u8861\u7684\u6642\u6a5f\uff0c\u4ee5\u90e8\u4f4d\u8b8a\u5316\u65e5\u671f\u70ba\u6e96\uff0c\u6539\u6210\u7576\u524d\u7684\u6536\u76e4\u50f9\u683c\u65e5\u671f\u70ba\u6e96\uff0c\u907f\u514d\u5728\u4e0b\u6b21\u518d\u5e73\u8861\u6642\uff0c\u53c3\u7167\u5230\u932f\u8aa4\u7684\u50f9\u683c</li> <li>\u4fee\u6b63 finlab.ml.qlib.get_models \u4e2d\u7684\u6a21\u578b\uff0c\u5728\u8a13\u7df4\u6642 label \u6703\u6709 inf \u6216 NaN \u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#refactor_5","title":"Refactor","text":"<ul> <li>\u91dd\u5c0d\u9280\u884c\u9918\u984d\u8207\u4ea4\u5272\u8a0a\u606f\u91cd\u69cb</li> </ul>"},{"location":"change-log/#111-2024-4-25","title":"1.1.1 (2024-4-25)","text":""},{"location":"change-log/#refactor_6","title":"Refactor","text":"<ul> <li>\u5728 machine_learning.md \u4e2d\u65b0\u589e \"\u5fc5\u8981\u5b89\u88dd\" \u548c \"\u6a21\u578b\u51fd\u5f0f\u5eab\uff08\u975e\u5fc5\u9808\uff09\" \u5169\u500b\u5c0f\u7bc0\uff0c\u6e05\u6670\u5283\u5206\u5b89\u88dd\u6307\u4ee4\u3002</li> <li>market_info.py \u4e2d MarketInfo \u548c TWMarketInfo \u985e\u5225\u7684\u65b9\u6cd5 market_close_at_timestamp \u548c tzinfo \u9032\u884c\u4e86\u4fee\u6b63\u548c\u6a19\u6e96\u5316\uff0c\u4ee5\u6539\u5584\u65b9\u6cd5\u7684\u53ef\u8b80\u6027\u548c\u4e00\u81f4\u6027\u3002</li> <li>\u5c07\u90e8\u5206\u65b9\u6cd5\u7684\u5be6\u73fe\u5f9e\u52d5\u614b\u5230\u975c\u614b\uff0c\u4ee5\u63d0\u9ad8\u6548\u7387\u548c\u6e1b\u5c11\u4f9d\u8cf4\u3002</li> <li>\u65b0\u589e qlib.py \u4e2d WrapperModel \u7684 fit \u65b9\u6cd5\u4e2d\u5c0d segments \u53c3\u6578\u7684\u8655\u7406\uff0c\u78ba\u4fdd\u81ea\u5b9a\u7fa9\u6578\u64da\u6bb5\u53ef\u4ee5\u88ab\u6b63\u78ba\u8655\u7406\u3002</li> </ul>"},{"location":"change-log/#fix_16","title":"Fix","text":"<ul> <li>\u4fee\u6b63 market_info.py \u4e2d\u908f\u8f2f\u689d\u4ef6\u5224\u65b7\u932f\u8aa4\uff0c\u6b63\u78ba\u5340\u5206\u689d\u4ef6\u5224\u65b7\u5f0f\u3002</li> <li>\u4fee\u6539 data.py \u4e2d\u5c0d\u65bc NaN \u503c\u7684\u8655\u7406\u65b9\u5f0f\uff0c\u907f\u514d\u5728\u8a08\u7b97\u6307\u6a19\u6642\u5305\u542b\u7121\u6548\u6578\u64da\u3002</li> <li>feature.py \u4e2d ta \u51fd\u5f0f\u7684\u591a\u6838\u8655\u7406\u908f\u8f2f\u8abf\u6574\uff0c\u6839\u64da\u6838\u5fc3\u6578\u91cf\u6c7a\u5b9a\u6578\u64da\u8655\u7406\u65b9\u5f0f\uff0c\u907f\u514d\u5728 docker \u4e2d\u7121\u6cd5\u4f7f\u7528\u3002</li> <li>\u4fee\u6b63 label.py \u4e2d\uff0c\u4f7f\u7528 maximum_adverse_excursion \u51fd\u5f0f\u6642\u7684\u932f\u8aa4\uff0c\u78ba\u4fdd\u51fd\u5f0f\u6b63\u78ba\u904b\u884c\u3002</li> <li>\u4fee\u6b63 label.py \u4e2d\uff0c\u4f7f\u7528 maximum_favorable_excursion \u51fd\u5f0f\u6642\u7684\u932f\u8aa4\uff0c\u78ba\u4fdd\u51fd\u5f0f\u6b63\u78ba\u904b\u884c\u3002</li> </ul>"},{"location":"change-log/#110","title":"1.1.0","text":""},{"location":"change-log/#features_12","title":"Features","text":"<ul> <li>\u65b0\u589e\u4e86\u5c0d Microsoft Qlib \u7684\u652f\u6301\uff0c\u900f\u904e\u5728 Dockerfile \u4e2d\u6dfb\u52a0 pyqlib \u4f9d\u8cf4\uff0c\u4f7f\u5f97\u7528\u6236\u80fd\u5920\u76f4\u63a5\u5728 Docker \u5bb9\u5668\u4e2d\u4f7f\u7528 Qlib\u3002</li> </ul>"},{"location":"change-log/#fix_17","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u4e86\u7248\u672c\u865f\u5728\u591a\u500b\u6a94\u6848\u4e2d\u7684\u4e0d\u4e00\u81f4\u554f\u984c\uff0c\u7d71\u4e00\u5c07\u7248\u672c\u865f\u66f4\u6539\u70ba 1.0.10\u3002</li> <li>\u91cd\u69cb\u4e86 finlab/ml/qlib.py \u4e2d\u7684\u4ee3\u78bc\uff0c\u79fb\u9664\u4e86\u904e\u6642\u7684\u8a3b\u91cb\u548c\u672a\u4f7f\u7528\u7684\u4ee3\u78bc\uff0c\u63d0\u9ad8\u4e86\u4ee3\u78bc\u7684\u6e05\u6670\u5ea6\u548c\u7dad\u8b77\u6027\u3002</li> <li>\u66f4\u65b0\u4e86 finlab/online \u5b50\u6a21\u7d44\u7684\u5f15\u7528\uff0c\u4ee5\u7372\u53d6\u6700\u65b0\u7684\u529f\u80fd\u548c\u4fee\u5fa9\u3002</li> <li>\u7c21\u5316\u4e86 run_online_test.sh \u548c run_all_test.sh \u8173\u672c\uff0c\u79fb\u9664\u4e86\u4e0d\u5fc5\u8981\u7684\u8a3b\u91cb\u548c\u4ee3\u78bc\uff0c\u4f7f\u5f97\u6e2c\u8a66\u904e\u7a0b\u66f4\u70ba\u7c21\u6f54\u9ad8\u6548\u3002</li> </ul>"},{"location":"change-log/#106","title":"1.0.6","text":"<ul> <li>fix(report): \u4fee\u6b63 importlib.resources \u5728 python&lt;=3.6, python==3.8,3.7, python &gt;=3.9 \u4e0d\u80fd\u7528\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#105","title":"1.0.5","text":"<ul> <li>fix(report): \u4fee\u6b63 importlib.resources \u5728 python&lt;=3.8 \u4e0d\u80fd\u7528\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#104","title":"1.0.4","text":"<ul> <li>feat(backtest): \u65b0\u589e\u56de\u6e2c\u8207\u6a19\u7684\u7684\u76f8\u95dc\u6e2c\u8a66\u529f\u80fd</li> <li>fix(backtest): \u4fee\u6b63 removing next_weight force to 1 \u7684\u554f\u984c</li> <li>fix(us_market): \u4fee\u6b63\u652f\u63f4 market_close_at_timestamp support None \u7684\u554f\u984c</li> <li>chore(pandas 3.0): \u652f\u63f4\u65b0\u7248\u7684 Pandas &gt;= 3.0.0 new resample string format</li> <li>feat(backtest): \u65b0\u589e sl_enter \u548c tp_enter\uff0c\u4f86\u4ee3\u8868\u7acb\u5373\u505c\u640d\u505c\u5229\uff0c\u76f4\u5230\u4e0b\u6b21\u63db\u80a1\u518d\u8cb7\u5165\u7684\u6a19\u793a</li> </ul>"},{"location":"change-log/#103","title":"1.0.3","text":""},{"location":"change-log/#fix_18","title":"Fix","text":"<ul> <li>\u4fee\u5fa9\u652f\u63f4\u7db2\u9801\u7aef\u57f7\u884c\u56de\u6e2c</li> <li>\u4fee\u6b63 <code>report.current_trades</code> \u5047\u5982\u6709\u91cd\u8907\u7684\u80a1\u7968\u540d\u7a31\uff0c\u4ee5\u6700\u65b0\u7684\u90e8\u4f4d\u70ba\u4e3b</li> <li>\u4fee\u6b63\u5100\u8868\u677f\u986f\u793a\u6bcf\u6708\u71df\u6536\u7684\u8a08\u7b97\u65b9\u5f0f\uff0c\u5f9e 1 \u865f\u5230 31 \u865f\uff0c\u8b8a\u6210\u8ddf\u4e4b\u524d\u4e00\u6a23\uff0c\u5f9e\u4e0a\u6708 31 \u865f\u5230\u6b64\u6708 31 \u865f</li> <li>\u4fee\u6b63 <code>trail_stop</code> \u5728\u8cb7\u540c\u4e00\u5f35\u80a1\u7968\u6642\uff0c\u63d0\u65e9\u51fa\u5834\u7684\u554f\u984c</li> <li>\u9694\u5929\u8981\u9032\u5834\uff0c\u540c\u6642\u53c8\u505c\u640d\u505c\u5229\uff0c\u91dd\u5c0d <code>stop_trading_next_period</code> \u5c0d\u65bc <code>report.action</code> \u4ee5\u53ca <code>report.next_weights</code> \u7684\u986f\u793a\u8cc7\u6599\u9032\u884c\u4fee\u6b63\uff0c\u4e26\u589e\u52a0\u55ae\u5143\u6e2c\u8a66\u3002</li> </ul>"},{"location":"change-log/#102","title":"1.0.2","text":""},{"location":"change-log/#refactor_7","title":"Refactor","text":"<ul> <li>\u79fb\u9664 tailwind default css\uff0c\u6539\u800c\u4f7f\u7528 vite \u8f38\u51fa\u7684 style.css</li> <li>\u79fb\u9664 web server \u6539\u800c\u4f7f\u7528 iframe docsrc \uff08\u7d93\u904e\u6e2c\u8a66\u652f\u63f4\u6240\u6709\u5e73\u53f0\uff09</li> </ul>"},{"location":"change-log/#fix_19","title":"Fix","text":"<ul> <li>\u986f\u793a\u5728 docker \u4e0a web server port \u7121\u6cd5\u4f7f\u7528\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#101","title":"1.0.1","text":""},{"location":"change-log/#features_13","title":"Features","text":"<ul> <li>\u986f\u793a\u79fb\u52d5\u505c\u640d</li> <li>\u5100\u8868\u677f\u53f3\u4e0a\u89d2\u63a7\u5236 light/dark \u6a21\u5f0f</li> <li>\u53e6\u5b58\u5100\u8868\u677f\u81f3\u6307\u5b9a\u7684\u8def\u5f91\u4e0b</li> </ul>"},{"location":"change-log/#fix_20","title":"Fix","text":"<ul> <li>\u4fee\u6b63 Windows \u4e0b report \u9810\u8a2d\u8b80\u5beb\u7de8\u78bc\u70ba cp950 \u9020\u6210\u7684\u554f\u984c\u3002</li> <li>\u4fee\u6b63\u505c\u640d\u7121\u6cd5\u986f\u793a</li> <li>Colab \u4e2d CSS \u5b57\u9ad4\u8207\u6392\u7248\u8abf\u6574</li> <li>light/dark \u6a21\u5f0f\u4e2d\uff0c\u5716\u8868\u5ea7\u6a19\u8ef8\u984f\u8272\u97ff\u61c9</li> <li>\u4fee\u6b63\u5716\u8868\u8a18\u61b6\u9ad4\u6c92\u6709\u91cb\u653e\uff0c\u5c0e\u81f4 tab \u5207\u63db\u5ef6\u9072\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#100","title":"1.0.0","text":""},{"location":"change-log/#features_14","title":"Features","text":"<ul> <li>\u65b0\u589e Position.from_report \u7684\u55ae\u5143\u6e2c\u8a66</li> <li>\u5728\u591a\u7a2e\u689d\u4ef6\u4e0b\u6e2c\u8a66 report.next_weights \u529f\u80fd</li> <li>\u63a8\u51fa\u5168\u65b0\u5100\u8868\u677f\u4ecb\u9762</li> <li>\u652f\u63f4 Python 3.12 \u7248\u672c</li> </ul>"},{"location":"change-log/#fix_21","title":"Fix","text":"<ul> <li>\u4fee\u6b63\u4e86\u5728\u555f\u7528\u6b62\u640d\u6216\u6b62\u76c8\u6642\uff0c\u5831\u544a\u4e2d report.next_weights \u7684\u6b63\u898f\u5316\u554f\u984c</li> <li>\u89e3\u6c7a\u4e86\u5728 Pandas \u7684 reindex \u51fd\u6578\u4e2d\uff0c\u5206\u985e\u578b\u6b04\u4f4d\u7121\u6cd5\u6b63\u78ba\u7d22\u5f15\u7684\u554f\u984c</li> <li>\u4fee\u6b63\u4e86\u5728\u6dfb\u52a0\u904b\u7b97\u5b50\u6642\uff0c\u5206\u985e\u578b\u6b04\u4f4d\u7e6a\u5716\u932f\u8aa4\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#0513","title":"0.5.13","text":""},{"location":"change-log/#features_15","title":"Features","text":"<ul> <li>\u6574\u5408 Pytest\uff08\u63d0\u4ea4 e7a487c\uff09\uff1a\u52a0\u5165\u4e86 Pytest\uff0c\u8b93\u6e2c\u8a66\u66f4\u9ad8\u6548\u3002</li> <li>finlab.ml \u65e5\u5167\u4ea4\u6613\u5831\u916c\u7387\u8a08\u7b97\uff08\u63d0\u4ea4 8804fb1\uff09\uff1a\u65b0\u589e\u4e86\u8a08\u7b97\u65e5\u5167\u4ea4\u6613\u7684 label</li> <li>finlab.ml.feature.ta \u7279\u5fb5\u8a08\u7b97\u652f\u6301\u591a\u9032\u7a0b\uff08\u63d0\u4ea4 1ab0463\uff09\uff1a\u5728\u7279\u5fb5\u8a08\u7b97\u6a21\u7d44\u4e2d\u5f15\u5165\u591a\u9032\u7a0b\u652f\u6301\uff0c\u63d0\u5347\u6027\u80fd\u3002</li> </ul>"},{"location":"change-log/#fix_22","title":"Fix","text":"<ul> <li>\u512a\u5316 'get_location' \u51fd\u6578\uff08\u63d0\u4ea4 253e98c\uff09\uff1a\u6539\u9032\u4e86 'data.py' \u4e2d\u7684 'get_location' \u51fd\u6578\uff0c\u4f7f\u5176\u66f4\u597d\u5730\u8655\u7406\u5931\u6557\u60c5\u6cc1\u3002</li> <li>\u5e02\u5834\u4fe1\u606f\u652f\u6301\u6642\u5340\uff08\u63d0\u4ea4 aa2756b &amp; 79b3671\uff09\uff1a\u5728 'market_info.py' \u4e2d\u52a0\u5165\u4e86\u6642\u5340\u4fe1\u606f\u7684\u8655\u7406\u3002</li> <li>\u79fb\u52d5\u505c\u640d\u4fee\u6b63\uff08\u63d0\u4ea4 6522bf7 &amp; e7fc1f3\uff09\uff1a\u8abf\u6574\u4e86 'backtest.py' \u4e2d\u7684\u4ea4\u6613\u8a08\u7b97\uff0c\u4fee\u6b63\u79fb\u52d5\u505c\u640d\u7684\u529f\u80fd\u3002</li> <li>Dataframe \u7684\u5c0e\u5165\u4fee\u6b63\uff08\u63d0\u4ea4 626ada1\uff09\uff1a\u4fee\u6b63\u4e86 'dataframe.py' \u4e2d\u7684\u5c0e\u5165\u554f\u984c\u3002</li> <li>\u7279\u5fb5\u521d\u59cb\u5316\u4fee\u6b63\uff08\u63d0\u4ea4 772d659\uff09\uff1a\u89e3\u6c7a\u4e86 'ml/feature.py' \u4e2d\u7684\u521d\u59cb\u5316\u554f\u984c\u3002</li> <li>\u5f37\u5236\u96f2\u7aef\u4e0b\u8f09\uff08\u63d0\u4ea4 7ec28a3\uff09\uff1a\u4fee\u5fa9\u4e86 'data.py' \u4e2d\u7684 'force_cloud_download' \u5be6\u73fe\u3002</li> </ul>"},{"location":"change-log/#other-updates","title":"Other updates","text":"<ul> <li>\u91cd\u69cb\uff08\u63d0\u4ea4 26d1518\uff09\uff1a\u5c0d 'online' \u6a21\u7d44\u9032\u884c\u4e86\u91cd\u69cb\uff0c\u4f7f\u4ee3\u78bc\u7d50\u69cb\u66f4\u597d\u3002</li> <li>\u6587\u6a94\u66f4\u65b0\uff08\u63d0\u4ea4 44a93d4, 9f5683f, cd4a894\uff09\uff1a\u66f4\u65b0\u4e86 'backtest.py'\u3001'data.py' \u548c 'ml/feature.py' \u7684\u6587\u6a94\u3002</li> <li>\u7248\u672c\u66f4\u65b0\uff08\u63d0\u4ea4 d361d7f\uff09\uff1a\u5c07\u7248\u672c\u5347\u7d1a\u5230\u4e86 0.5.13\u3002</li> <li>\u589e\u52a0\u6e2c\u8a66\u8986\u84cb\u7387\uff08\u63d0\u4ea4 350dfbc\uff09\uff1a\u5728 Docker \u914d\u7f6e\u4e2d\u589e\u52a0\u4e86\u6e2c\u8a66\u8986\u84cb\u7387\u3002</li> <li>\u6e2c\u8a66\u7cfb\u7d71\u7684\u7a69\u5065\u6027\uff08\u63d0\u4ea4 1647479\uff09\uff1a\u63d0\u5347\u4e86\u6e2c\u8a66\u7cfb\u7d71\u7684\u7a69\u5065\u6027\u3002</li> <li>\u5728\u7dda\u6e2c\u8a66 <code>Position.to_list</code>\uff08\u63d0\u4ea4 f3d086f\uff09\uff1a\u66f4\u65b0\u4e86 'online_test.py'\uff0c\u589e\u52a0\u4e86\u8f49\u63db\u70ba\u5217\u8868\u7684\u529f\u80fd\u3002</li> </ul>"},{"location":"change-log/#0512","title":"0.5.12","text":"<ul> <li>\u4fee\u6b63\u4e86 run_online_test.sh \u4e2d\u7684\u5728\u7dda\u6e2c\u8a66\u66f4\u65b0\u50f9\u683c\uff0c\u4ee5\u5305\u542b FUGLE \u914d\u7f6e\u7684\u74b0\u5883\u8b8a\u91cf\u3002</li> <li>\u8abf\u6574\u4e86 online_test.py \u4e2d\u7684 test_update_price\uff0c\u4ee5\u6b63\u78ba\u6bd4\u8f03\u6d6e\u9ede\u6578\u91cf\u3002</li> <li>\u4fee\u6539\u4e86 event_study.py\uff0c\u901a\u904e\u91cd\u65b0\u7d22\u5f15\u5de5\u4f5c\u65e5\u4f7f\u5176\u8207\u975e\u4ea4\u6613\u65e5\u517c\u5bb9\u3002</li> </ul>"},{"location":"change-log/#0511","title":"0.5.11","text":"<ul> <li>\u4fee\u5fa9 position \u70ba\u96f6\u6642\uff0c\u6703\u5831 error \u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#0510","title":"0.5.10","text":"<ul> <li>\u6c38\u8c50 API \u4e0b\u55ae\u5927\u65bc 1000 \u5143\u7121\u6cd5\u4e0b\u55ae\u7684\u554f\u984c</li> <li>\u4fee\u6b63 <code>FinlabDataframe</code> \u7684 memory leak error</li> <li>\u4fee\u6b63\u767b\u5165\u986f\u793a\u7684\u6a23\u5f0f\uff0c\u907f\u514d colab \u767b\u5165\u6642\u51fa\u73fe error</li> <li>\u4fee\u6b63 <code>data.search</code> \u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#059","title":"0.5.9","text":"<ul> <li>\u4fee\u6b63 dataframe operator \u904b\u7b97\u6642\u7684 reshape \u554f\u984c</li> <li>\u6539\u5584 <code>df[bool_selector]</code> \u7121\u6cd5\u4f7f\u7528\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#058","title":"0.5.8","text":"<ul> <li>\u6539\u5584 <code>data.get</code>\u901f\u5ea6</li> <li>\u66f4\u65b0\u6c38\u8c50 API \u4e0b\u55ae\u6548\u7387\uff08\u7136\u800c\u5f15\u51fa\u4e00\u4e9b\u554f\u984c\uff0c\u5df2\u7d93\u4fee\u5fa9\uff09</li> </ul>"},{"location":"change-log/#057-2023-11-4","title":"0.5.7 (2023-11-4)","text":""},{"location":"change-log/#fix_23","title":"Fix \ud83d\ude80","text":"<ul> <li><code>FinlabDataFrame</code>\uff1a\u82e5\u672a\u8a2d\u7f6e\u5247\u6b63\u78ba\u4f7f\u7528 UUID \u4fee\u6b63\u4e86<code>__hash__</code>\u65b9\u6cd5\u3002</li> <li><code>hold_until</code>\u65b9\u6cd5\uff1a\u4fee\u6b63\u4e86<code>self</code>\u3001<code>exit</code>\u548c<code>rank</code>\u7684<code>reindex</code>\u554f\u984c\u3002</li> <li><code>market_info.get_market_info</code>\uff1a\u66f4\u6b63\u4e86<code>reindex</code>\u908f\u8f2f\uff0c\u78ba\u4fdd\u4f7f\u7528\u66f4\u65b0\u5f8c\u7684\u7d22\u5f15\u3002</li> <li><code>fetch_data</code>\uff1a\u4fee\u6b63\u4e86\u5831\u544a\u90e8\u5206\u7684\u65e5\u5747\u8a08\u7b97\u932f\u8aa4\u3002</li> <li><code>data.py</code>\uff1a\u70ba HTTP \u8acb\u6c42\u6dfb\u52a0\u4e86<code>User-Agent</code>\u6a19\u982d\u4ee5\u9632\u6b62\u53d6\u5f97\u932f\u8aa4\u3002</li> <li><code>data.py</code>\uff1a\u4fee\u6b63\u4e86\u4fdd\u5b58\u7a7a<code>DataFrame</code>\u7684\u554f\u984c\u3002</li> <li><code>ffn_core.py</code>\uff1a\u4fee\u6b63\u4e86<code>calc_sharpe</code>\u65b9\u6cd5\u4e2d\u9664\u4ee5\u96f6\u7684\u932f\u8aa4\u3002</li> </ul>"},{"location":"change-log/#features_16","title":"Features \ud83d\ude80","text":"<ul> <li><code>tools</code>: \u65b0\u589e <code>finlab.tools.event_study</code> \u7814\u7a76\u4e8b\u4ef6\u4ea4\u6613\u7b49\u76f8\u95dc\u529f\u80fd\u3002</li> <li><code>backtest.py</code>\uff1a\u5f15\u5165\u4e86<code>fast_mode</code>\uff0c\u5728\u4e0d\u8003\u616e\u6b62\u640d\u6216\u6b62\u76c8\u7684\u60c5\u6cc1\u4e0b\u9032\u884c\u5feb\u901f\u56de\u6e2c\u3002</li> <li><code>dataframe.py</code>\uff1a\u5c07<code>index_str_to_date</code>\u65b9\u6cd5\u9032\u884c\u4e86\u7de9\u5b58\uff0c\u63d0\u9ad8\u6027\u80fd\u3002</li> <li><code>report.add_trade_info</code>\uff1a\u5c0e\u5165 Cython \u512a\u5316\u904b\u7b97\u901f\u5ea6\u3002</li> <li><code>setup.py</code>\uff1a\u7de8\u8b6f Cython \u64f4\u5c55\u6642\u555f\u7528 O3 \u512a\u5316\u3002</li> <li><code>backtest.py</code>\uff1a\u70ba<code>sim</code>\u51fd\u6578\u65b0\u589e\u6587\u6a94\uff0c\u8a73\u7d30\u8aaa\u660e\u65b0\u7279\u6027\u548c\u53c3\u6578\u3002</li> <li><code>dataframe.py</code>\uff1a\u5be6\u73fe\u4e86\u7d22\u5f15\u512a\u5316\uff0c\u5c07\u5b57\u7b26\u4e32\u7d22\u5f15\u8f49\u63db\u70ba\u65e5\u671f\u4e26\u9032\u884c\u7de9\u5b58\u3002</li> <li>\u8abf\u6574<code>setup.py</code>\uff0c\u5c07 Python \u7248\u672c\u8981\u6c42\u5f9e &gt;=3.7 \u6539\u70ba &gt;=3.6\u3002</li> <li>\u66f4\u65b0\u5b50\u6a21\u7d44\u81f3\u6700\u65b0\u63d0\u4ea4\u3002</li> </ul>"},{"location":"change-log/#tests","title":"Tests \ud83d\ude80","text":"<ul> <li>\u70ba<code>report_test.py</code>\u6a21\u584a\u65b0\u589e\u6e2c\u8a66\uff0c\u4ee5\u4fdd\u8b49\u67e5\u8a62\u529f\u80fd\u7684\u6b63\u78ba\u6027\u3002</li> <li>\u70ba<code>report_test.py</code>\u65b0\u589e\u591a\u500b\u91dd\u5c0d\u4e0d\u540c\u6578\u64da\u985e\u578b\u7684\u6e2c\u8a66\u6848\u4f8b\u3002</li> <li>\u66f4\u65b0<code>run_test_docker.sh</code>\u8173\u672c\uff0c\u5305\u542b\u65b0\u7684\u6e2c\u8a66\u6848\u4f8b\u3002</li> </ul>"},{"location":"change-log/#052-2023-09-28","title":"0.5.2 (2023-09-28)","text":""},{"location":"change-log/#fix_24","title":"Fix \ud83d\ude80","text":"<ul> <li>\u5728\u5c11\u90e8\u5206\u7684 OS \u4e0a\u51fa\u73fe recursive import \u7684\u554f\u984c</li> <li>\u4fee\u6b63 liquility analysis \u4e2d\u7522\u751f NaN \u6642\uff0c\u88ab Pandas \u6697\u81ea\u8f49\u63db\u6210 float \u9020\u6210\u7684\u554f\u984c</li> <li>trade_at_price \u4fee\u6b63</li> <li>\u4fee\u6b63\u5728\u5617\u8a66 merge \u904e\u7a0b\u4e2d\u6d88\u8017\u5927\u91cf\u8a18\u61b6\u9ad4\u7684\u554f\u984c</li> </ul>"},{"location":"change-log/#050-2023-09-14","title":"0.5.0 (2023-09-14)","text":""},{"location":"change-log/#features_17","title":"Features \ud83d\ude80","text":"<ul> <li>\u65b0\u589e\u79fb\u52d5\u505c\u640d\u529f\u80fd <code>sim(..., trail_stop=0.1)</code> \u4f86\u8a2d\u5b9a\u79fb\u52d5\u505c\u640d\u3002</li> <li><code>data.universe</code> \u652f\u63f4 <code>market='etf'</code> \u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u9078 ETF \u7684\u7a2e\u985e\u5982\uff1a<code>domestic_etf</code>, <code>foreign_etf</code>, <code>leveraged_etf</code>, <code>vanilla_futures_etf</code>, <code>leveraged_futures_etf</code></li> <li><code>data.get</code> \u652f\u63f4\u5f9e\u7f8e\u570b\u3001\u53f0\u7063\u5169\u5730\u66f4\u65b0\u8cc7\u6599\uff0c\u6703\u81ea\u52d5\u9078\u64c7\u6bd4\u8f03\u8fd1\u7684\u4f3a\u670d\u5668\u4f86\u7d22\u53d6\u8cc7\u6599\u3002</li> <li><code>data.get</code> \u81ea\u52d5\u5075\u6e2c\u4e26\u9023\u7d50 Google Drive \u4f86\u5b58\u653e\u4e0b\u8f09\u7684\u8cc7\u6599\u3002</li> <li><code>data.get</code> \u5c07\u5168\u9762\u652f\u63f4\u5728\u672c\u5730\u7aef\u66f4\u65b0\u8cc7\u6599\uff0c\u4ee5\u5f8c\u518d\u4e5f\u4e0d\u7528\u5168\u9762\u4e0b\u8f09\u6240\u6709\u8cc7\u6599\uff0c\u800c\u662f\u4e0b\u8f09 patch \u4e26\u85c9\u7531\u672c\u5730\u7aef\u7684\u7a0b\u5f0f\u4f86\u9032\u884c\u7dad\u8b77\uff0c\u53ea\u6709\u5728\u5fc5\u8981\u7684\u6642\u5019\u9032\u884c\u6574\u6279\u8cc7\u6599\u7684\u91cd\u7f6e\uff08\u9810\u8a2d\u958b\u555f\uff09</li> <li><code>sim(..., trade_at_price)</code> \u53ef\u9078\u64c7\u5176\u4ed6\u50f9\u683c\u4f86\u6a21\u64ec\u8cb7\u8ce3\uff0c\u53ef\u9078'close'\u3001'open'\u3001'open_close_avg'\u3001'high_low_avg'\u6216 'price_avg'\u3002</li> <li>\u65b0\u589e\u5e95\u5c64\u529f\u80fd\u4ee5\u78ba\u4fdd\u65b0\u7684\u7db2\u7ad9\u80fd\u5920\u517c\u5bb9</li> </ul>"},{"location":"change-log/#fixes_3","title":"Fixes","text":"<ul> <li>\u4fee\u6b63\u505a\u7a7a\u7684\u505c\u640d\u505c\u5229</li> <li>FinlabDataFrame.hold_until \u73fe\u5728\u8f38\u51fa\u70ba bool \uff08\u800c\u975e\u4ee5\u524d\u7684 int\uff09</li> <li>FinlabDataFrame \u66f4\u5ee3\u6cdb\u7684\u652f\u63f4\u81ea\u52d5 reshape \u8207\u586b\u503c\u7684\u904b\u7b97\uff0c\u4f8b\u5982\u300c&amp;=\u300d\u3001\u300c+=\u300d\u7b49\u76ee\u524d\u5df2\u652f\u63f4</li> <li>\u79fb\u9664\u4e86\u5f37\u5236\u8a2d\u7f6e\u7684 logger</li> <li>finlab.online \u4fee\u6b63\u4e86\u7372\u53d6\u7e3d\u9918\u984d\u6642\u7684\u6642\u5340\u554f\u984c\u3002</li> <li>data.FileStorage \u89e3\u6c7a\u4e86 Windows \u7cfb\u7d71\u4e0a\u7684\u6587\u4ef6\u8def\u5f91\u932f\u8aa4\u3002</li> <li>ffn \u79fb\u9664\u5373\u5c07\u4e0d\u652f\u63f4\u7684\u8a9e\u6cd5\uff0c\u66f4\u65b0\u4e86 pandas2.1 \u9593\u5bb9\u7684\u8a9e\u6cd5\u3002</li> <li>\u81ea\u52d5\u5075\u6e2c backtest(position) \u4e2d\u7684 position.index \u8f49\u63db\u70ba datetime</li> <li>\u89e3\u6c7a report.trades \u592a\u9577\u4e0a\u50b3\u7684\u554f\u984c</li> <li>\u89e3\u6c7a\u56de\u6e2c\u6642\u4e0a\u6b21\u51fa\u5834\u7684\u6a19\u7684\uff0c\u9019\u6b21\u4e0d\u9032\u5834\u7684\u932f\u8aa4</li> </ul>"},{"location":"change-log/#046-2023-08-11","title":"0.4.6 (2023-08-11)","text":""},{"location":"change-log/#fixes_4","title":"Fixes \ud83d\udd27","text":"<ul> <li>\u4fee\u6b63\u512a\u52e2\u50f9\u683c\u8cb7\u8ce3(extra_bid_pct)\u5728\u59d4\u8a17\u50f9\u683c\u8d85\u904e\u6f32\u8dcc\u505c\u50f9\u6642\u7684\u59d4\u8a17\u5931\u6557\u554f\u984c\uff0c\u59d4\u8a17\u50f9\u4ee5\u6f32\u8dcc\u505c\u70ba\u4e0a\u9650\u3002</li> <li>\u89e3\u6c7a\u4e86\u4e0b\u55ae API \u4e2d Position.from_report \u505c\u640d\u505c\u5229\u90e8\u4f4d\u5224\u65b7\u932f\u8aa4\u7684\u554f\u984c\u3002</li> <li>\u89e3\u6c7a\u4e86\u6c38\u8c50 API \u96f6\u80a1\u6539\u50f9\u5931\u6557\u554f\u984c\uff0c\u81ea\u52d5\u522a\u55ae\u518d\u91cd\u4e0b\u3002</li> <li>\u6708\u71df\u6536\u7d22\u5f15\u6539\u70ba datetime \u683c\u5f0f\uff0c\u89e3\u6c7a data.set_storage \u6a21\u5f0f\u4e0b\u5f37\u5236\u4e0b\u8f09\u6708\u71df\u6536\u8cc7\u6599\u7684\u554f\u984c\u3002</li> <li>\u907f\u514d finlab.dataframe.industry rank() \u51fa\u73fe nan \u6578\u503c\u3002</li> </ul>"},{"location":"change-log/#features_18","title":"Features \ud83d\ude80","text":"<ul> <li>\u52a0\u5165\u7b56\u7565\u5831\u7c4c\u7387\u7d71\u8a08\u5206\u6790\u5716\u8868\u529f\u80fd finlab.plot.StrategyReturnStats\u3002</li> <li>Fugle \u884c\u60c5 API v1.0 \u7248 \u76f8\u5bb9 finlab.online\uff0c\u4e0d\u76f8\u5bb9 v0.3\u3002 \u63d0\u9192\u7528\u6236\u8acb\u5c07\u884c\u60c5 API v0.3 \u7248\u672c\u5347\u7d1a\u81f3\u6700\u65b0\u7684 v1.0 \u7248\u672c\uff0c\u820a\u7248\u672c\u5c07\u88ab Fugle \u5b98\u65b9\u68c4\u7528\uff0c\u8981\u6ce8\u610f\u5728\u884c\u60c5 API v1.0 \u7248\u672c\u4e2d\uff0c\u63a1\u7528\u4e86\u4e0d\u540c\u7684\u8eab\u4efd\u9a57\u8b49\u65b9\u5f0f\uff0c\u56e0\u6b64 v0.3 \u7684 API \u91d1\u9470\u5c07\u7121\u6cd5\u9069\u7528\u65bc v1.0 \u7684 HTTP API \u548c WebSocket API\u3002\u60a8\u9700\u8981\u91cd\u65b0\u7533\u8acb API \u91d1\u9470\u4ee5\u4f7f\u7528\u6700\u65b0\u7248\u672c\u7684 API\u3002\u8acb\u524d\u5f80 \u91d1\u9470\u7533\u8acb\u9801\u9762 \u9032\u884c\u7533\u8acb https://developer.fugle.tw/docs/key/%E3%80%82</li> <li>\u65b0\u589e\u4e0b\u55ae API \u65bc\u300c\u66f4\u65b0\u59d4\u8a17\u55ae\u50f9\u683c\u300d\u6642\u652f\u63f4\u512a\u52e2\u50f9\u683c\u8cb7\u8ce3(extra_bid_pct)\u7684\u529f\u80fd\uff0c\u4ee5\u9ad8\u65bc\u6210\u4ea4\u50f9\u7684 x%\u8cb7\u5165\uff0c\u4f4e\u65bc\u6210\u4ea4\u50f9\u7684 x%\u8ce3\u51fa\u3002</li> </ul>"},{"location":"change-log/#045-2023-07-05","title":"0.4.5 (2023-07-05)","text":""},{"location":"change-log/#fixes_5","title":"Fixes \ud83d\udd27","text":"<ul> <li>\u89e3\u6c7a\u4e86\u5728 hold_until \u4e2d rank \u53c3\u6578 inf \u5c0e\u81f4\u7684\u6392\u540d\u529f\u80fd\u5931\u6548\u554f\u984c\u3002</li> <li>\u4fee\u6b63\u4e86 alphalens \u5728 pandas 2.0 \u7248\u672c\u4e0a\u7684\u4e0d\u76f8\u5bb9\u554f\u984c\u3002</li> <li>\u89e3\u6c7a\u4e86\u6c38\u8c50 API \u4e0b\u55ae\u6642\uff0c\u96f6\u80a1\u5e02\u50f9\u7121\u6cd5\u4e0b\u55ae\u7684\u554f\u984c\uff0c\u73fe\u5728\u6539\u6210\u6f32\u8dcc\u505c\u4e0b\u55ae\u3002</li> <li>\u91dd\u5c0d candle plot \u7684\u6a19\u984c\u986f\u793a\u4f4d\u79fb\u554f\u984c\u9032\u884c\u4e86\u4fee\u6b63\u3002</li> <li>\u4fee\u6b63\u4e86 report.position \u4e1f\u5165 sim \u5f8c\u5f97\u5230\u4e00\u81f4\u7d50\u679c\u7684\u554f\u984c\u3002</li> <li>\u89e3\u6c7a\u4e86 edge ratio \u6642\u9593\u5e8f\u5217\u6392\u5e8f\u554f\u984c\uff0c\u73fe\u5728\u53ef\u4ee5\u6309\u6642\u9593\u9806\u5e8f\u6392\u5e8f\u3002</li> </ul>"},{"location":"change-log/#features_19","title":"Features \ud83d\ude80","text":"<ul> <li>\u52a0\u5165 us_universe \u9078\u64c7\u7f8e\u80a1\u5b50\u7522\u696d\u7684\u529f\u80fd\u3002</li> <li>\u65b0\u589e\u4e0b\u55ae API \u652f\u63f4\u512a\u52e2\u50f9\u683c\u8cb7\u8ce3\u7684\u529f\u80fd\uff0c\u73fe\u5728\u53ef\u4ee5\u4ee5\u9ad8\u65bc\u6210\u4ea4\u50f9\u7684 x%\u8cb7\u5165\uff0c\u4f4e\u65bc\u6210\u4ea4\u50f9\u7684 x%\u8ce3\u51fa\u3002</li> </ul>"},{"location":"change-log/#doc","title":"Doc \ud83d\udcda","text":"<ul> <li>\u65b0\u589e\u7f8e\u80a1\u7b56\u7565\u7bc4\u4f8b\uff0c\u63d0\u4f9b\u7528\u6236\u53c3\u8003\u548c\u5b78\u7fd2\u3002</li> <li>\u65b0\u589e\u5728 data.indicator \u4e2d\u4f7f\u7528\u7f8e\u80a1\u6642\u7684 market \u53c3\u6578\u8aaa\u660e\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u66f4\u5bb9\u6613\u7406\u89e3\u5176\u4f7f\u7528\u65b9\u5f0f\u3002</li> </ul>"},{"location":"change-log/#043-2023-05-11","title":"0.4.3 (2023-05-11)","text":""},{"location":"change-log/#warnings-backtesting-result-and-performance-will-change","title":"Warnings: Backtesting result and performance will change.","text":""},{"location":"change-log/#features_20","title":"Features \ud83d\ude80","text":"<ul> <li>Improved RAM usage by removing sorting and swaplevel for machine learning features (e081c924).</li> <li>Optimized backtest report (8babbd7a).</li> <li>Implemented cross-validation for machine learning (e55828c0).</li> <li>support infomation for stop loss and take profit assets (5f9272f3).</li> <li>Hold_until functionality made available for US data (8437d62).</li> <li>Added indicators control in plot_stats (7364d58).</li> </ul>"},{"location":"change-log/#fixes_6","title":"Fixes \ud83d\udd27","text":"<ul> <li>Fixed deadline considering business date for DataFrame (312f2fe1).</li> <li>Fixed the issue where a float object had no attribute 'month' (d51a5901).</li> <li>Fixed run_all_test (6203f56f).</li> <li>Prevented deletion during map iteration in backtest_core (2d1d9b05).</li> <li>Fixed login info (d177ed47).</li> <li>Fixed alpha annualize estimation in analysis (26a8becf).</li> <li>Fixed issue with short selling in online module (919521b9).</li> <li>Synced win_ratio in maeMfeAnalysis (a9a31189).</li> <li>Added rotc deadline in DataFrame (ac10597).</li> </ul>"},{"location":"change-log/#refactoring","title":"Refactoring \ud83d\udca1","text":"<ul> <li>Refactored f_disclosure_date to_business_date, removed date too far, and improved speed (7dcb203b).</li> <li>Refactored market selection according to DataFrame columns (039cbc96).</li> <li>Fixed bugs and future warnings in the analysis module (ec93088f).</li> <li>Refactored environment name capitalization in login module (635caed4).</li> <li>Refactored login to use FINLAB_API_TOKEN (a5c9064d).</li> <li>Informed free users that data is limited (bbabad14).</li> </ul>"},{"location":"change-log/#tests_1","title":"Tests \ud83e\uddea","text":"<ul> <li>Added test_hold_until (ccc4ba89).</li> </ul>"},{"location":"change-log/#doc_1","title":"Doc \ud83d\uddc2\ufe0f","text":"<ul> <li>Updated daily_sortino documentation (b7d1d91d).</li> <li>Updated get_data documentation (276862c2).</li> </ul>"},{"location":"change-log/#042-2023-04-27","title":"0.4.2 (2023-04-27)","text":""},{"location":"change-log/#_2","title":"\u65b0\u589e\u529f\u80fd\uff1a","text":"<ul> <li>\u5728\u6a5f\u5668\u5b78\u7fd2\u4e2d\u52a0\u5165\u4e86\u6a19\u7c64\u4ea4\u6613\u50f9\u683c\u7684\u529f\u80fd</li> <li>\u5728\u5831\u544a\u4e2d\u65b0\u589e\u4e86 report.display() \u7684\u4f7f\u7528\u8aaa\u660e</li> <li>\u5728\u5e02\u5834\u8cc7\u8a0a\u4e2d\u65b0\u589e\u4e86\u7f8e\u570b\u5e02\u5834\u8cc7\u8a0a</li> </ul>"},{"location":"change-log/#_3","title":"\u4fee\u5fa9\u554f\u984c\uff1a","text":"<ul> <li>\u5728\u7dda\u4e0a\u7a0b\u5f0f\u4e2d\u4fee\u6b63\u4e86\u986f\u793a\u5b57\u4e32\u7684\u554f\u984c</li> <li>\u5c07\u56de\u6e2c\u529f\u80fd\u56de\u5fa9\u5230\u7a69\u5b9a\u7248\u672c</li> <li>\u8abf\u6574\u56de\u6e2c\u529f\u80fd\u4e2d\u6839\u64da\u9032\u51fa\u5834\u50f9\u683c\u8abf\u6574\u6301\u5009\u7684\u554f\u984c</li> <li>\u4fee\u6b63 qlib.init \u7684\u5075\u6e2c\u554f\u984c</li> <li>\u5728\u5831\u544a\u4e2d\u4fee\u6b63\u4e86\u57fa\u6e96\u6307\u6578\u6642\u5340\u7684\u554f\u984c</li> <li>\u8655\u7406\u4e86 pandas 2.0.0 \u7248\u672c\u517c\u5bb9\u6027\u554f\u984c</li> <li>\u8655\u7406\u4e86 talib \u4f9d\u8cf4\u6027\u554f\u984c</li> <li>\u4fee\u6b63\u4e86\u5728\u56de\u6e2c\u529f\u80fd\u4e2d\u9032\u51fa\u5834\u6bd4\u4f8b\u70ba nan \u7684\u554f\u984c</li> <li>\u5728\u6587\u6a94\u4e2d\u4fee\u6b63\u4e86 fugle Account numpy \u7684\u5f15\u7528\u554f\u984c</li> </ul>"},{"location":"change-log/#_4","title":"\u5176\u4ed6\uff1a","text":"<ul> <li>\u5728\u6a5f\u5668\u5b78\u7fd2\u4e2d\u65b0\u589e\u4e86\u76f8\u95dc\u6587\u4ef6</li> <li>\u5728\u5e02\u5834\u8cc7\u8a0a\u4e2d\u65b0\u589e\u4e86\u76f8\u95dc\u6587\u4ef6</li> </ul>"},{"location":"change-log/#041-2023-04-14","title":"0.4.1 (2023-04-14)","text":"<ul> <li>(fix): fugle np not found</li> </ul>"},{"location":"change-log/#0319-2023-04-04","title":"0.3.19 (2023-04-04)","text":"<ul> <li>(improve): memory usage in machine learning feature creation</li> <li>(improve): machine learning feature for different freqnecy index</li> <li>(fix): data.indicator support almost all talib functions</li> <li>(fix): 2023/4/10 monthly revenue reveal change to 2023/4/12</li> <li>(fix): sinopac calculate account balance</li> </ul>"},{"location":"change-log/#0318-2023-03-28","title":"0.3.18 (2023-03-28)","text":"<ul> <li>(Breaking): update shioaji &gt;= 1.0.0. Please refer to finlab.inline module</li> <li>(feat): finlab.ml (document are not ready yet)</li> <li>(feat): support qlib data</li> <li>(feat): report add yearly and monthly return table</li> <li>(fix): backtest entry exit signal both activate conflict</li> </ul>"},{"location":"change-log/#0312-2022-11-29","title":"0.3.12 (2022-11-29)","text":"<ul> <li>(Breaking): report.get_stats() has new format</li> <li>(feat): data.get now read expire date from server and update data dynamically</li> <li>(feat): add a bunch of analysis for backtesting report</li> <li>(feat): getpass password to hide api_token</li> <li>(fix): report.weight and report.next_weights remove considering of price changed</li> <li>(fix): backtest(..., resample_offset='10d') fix backtesting display date</li> <li>(fix): finlab.online.order_executor show_alerting_stocks fix price</li> <li>(fix): fugle order status not change even when it is filled</li> <li>(fix): support update price of fraction lot size</li> </ul>"},{"location":"change-log/#0311-2022-11-10","title":"0.3.11 (2022-11-10)","text":"<ul> <li>(Fix) finlab backtest asset shorting fee miner adjust</li> <li>(Fix) finlab.report.weights and finlab.report.next_weights not defined</li> <li>(Fix) fugle-trade remove flag accoding to 0.4.0</li> <li>(Fix) fugle-trade fetch other source when stock.close is nan</li> <li>(Fix) fugle-trade FugleAccount.get_position not latest position</li> <li>(Feat) finlab.data.universe('STOCK_FUTURE') subset of TWII stocks</li> <li>(Feat) add yearly return when upload report</li> <li>(Feat) add fugle_trade version not compatable warning</li> </ul>"},{"location":"change-log/#0310-2022-10-13","title":"0.3.10 (2022-10-13)","text":""},{"location":"change-log/#039-2022-10-13","title":"0.3.9 (2022-10-13)","text":"<ul> <li>(Fix) finlab.online.sinopac_account order_lot position zero</li> <li>(Fix) finlab.online.fugle_account order_lot position duplicated</li> <li>(Fix) finlab.backtest weight display remove normalized</li> <li>(Fix) finlab.data windows FileStorage fix</li> <li>(Fix) finlab.data indicator exception error</li> </ul>"},{"location":"change-log/#038-2022-9-27","title":"0.3.8 (2022-9-27)","text":"<ul> <li>(Fix) finlab.online.order_executor price +-10% limit order restricted</li> <li>(Fix) finlab.online.order_executor Position.from_report handle price=0, weight=0, and duplicated stock id</li> <li>(Fix) finlab.plot.StrategySunburst compatibility</li> <li>(Fix) finlab.report.display display multiple chart</li> </ul>"},{"location":"change-log/#038dev1-2022-9-27","title":"0.3.8.dev1 (2022-9-27)","text":"<ul> <li>(Fix) talib abstract module incompatible</li> <li>(Fix) backtest result: alpha and beta</li> <li>(Fix) finlab.online.panel</li> <li>(Fix) finlab.online.fugle_account stock not traded error</li> <li>(Fix) add cert custom password for sinopac</li> <li>(Fix) remove duplicated columns from unnumeric_dtype.</li> <li>(Fix) KY company disclosure deadline</li> <li>(Chore) Candlestick data format generalized</li> <li>(Chore) raise error when data.get not found</li> <li>(Chore) logger.info to logger.warning in finlab.data</li> <li>(Chore) fig return for report.display</li> <li>(Feat) add retain_cost_when_rebalance flag</li> </ul>"},{"location":"change-log/#037dev1-2022-8-8","title":"0.3.7.dev1 (2022-8-8)","text":"<ul> <li>\u91dd\u5c0d touched_exit \u505a\u66f4\u7d30\u90e8\u7684\u56de\u6e2c\uff1a</li> <li>\u539f\u672c\u89f8\u50f9\u53cd\u5f48\u5f8c\u4e0d\u6703\u88ab\u5217\u5165\u89f8\u50f9\u8ce3\u51fa\uff0c\u73fe\u5728\u6703\u6a21\u64ec\u89f8\u50f9\u8ce3\u51fa</li> <li>\u539f\u672c\u958b\u76e4\u8df3\u7a7a\uff0c\u6703\u6c92\u8fa6\u6cd5\u8ce3\u5728 0.07\uff0c\u73fe\u5728\u4e5f\u6703\u8ce3\u5728\u66f4\u4f4e\u7684\u4f4d\u7f6e</li> </ul>"},{"location":"change-log/#035dev-2022-7-18","title":"0.3.5.dev (2022-7-18)","text":"<ul> <li>\u65b0\u589e finlab.optimize \u679a\u8209\u689d\u4ef6\u7d44\u5408\u56de\u6e2c</li> <li>\u65b0\u589e mae_mfe \u5716\u8868</li> <li>mae_mfe \u505a\u7a7a\u5206\u6790</li> <li>report.get_trades()['position'] \u6539\u6210 weighting</li> <li>backtest touched_exit \u4fee\u6b63</li> <li>\u4fee\u5fa9 finlab.analysis bugs</li> </ul>"},{"location":"change-log/#033dev-2022-7-1","title":"0.3.3.dev (2022-7-1)","text":""},{"location":"change-log/#bugs","title":"Bugs \u4fee\u6b63","text":"<ul> <li>\u4fee\u6b63\u653e\u7a7a\u80a1\u7968\u7684 weight \u6b0a\u91cd\u986f\u793a\u554f\u984c</li> <li>TreeMap \u7e6a\u5716\u4fee\u6b63</li> <li>\u8ca1\u5831\u516c\u4f48\u6b77\u53f2\u6642\u9593\u4fee\u6b63</li> </ul>"},{"location":"change-log/#analysis","title":"Analysis \u5206\u6790\u56de\u6e2c\u7d50\u679c","text":"<p>\u65b0\u589e Analysis \u67b6\u69cb\uff0c\u53ef\u4ee5\u5c07\u56de\u6e2c\u7d50\u679c\u5b8c\u6574\u5206\u6790\u3002 \u4e4b\u5f8c\u7684\u5206\u6790\u90fd\u5c07\u7e7c\u627f Analysis \u4e26\u4e14\u986f\u793a\u5716\u8868\uff0c\u8b93 report \u4f7f\u7528\u8d77\u4f86\u66f4\u8c50\u5bcc\uff01</p>"},{"location":"change-log/#liquidityanalysis","title":"liquidityAnalysis \u6d41\u52d5\u6027\u6e2c\u8a66","text":"<p>\u7b56\u7565\u6703\u6a21\u64ec\u80a1\u7968\u5728\u6536\u76e4\u6216\u958b\u76e4\u50f9\u8cb7\u9032\u8ce3\u51fa\uff0c\u4f46\u5be6\u969b\u4e0a\uff0c\u80a1\u7968\u4e5f\u6709\u53ef\u80fd\u6c92\u8fa6\u6cd5\u9806\u5229\u4ea4\u6613\uff0c\u4f8b\u5982\u9047\u5230\u8655\u7f6e\u80a1\u3001\u5168\u984d\u4ea4\u5272\u80a1\uff0c\u6216\u662f\u9577\u8dcc\u505c\u677f\u3002 liquidityAnalysis \u6703\u6aa2\u6e2c\u56de\u6e2c\u6642\uff0c\u662f\u5426\u6709\u8cb7\u5230\u9019\u985e\u884c\u7684\u6a19\u7684\uff0c\u4e26\u4e14\u8a08\u7b97\u6bd4\u4f8b\uff0c\u5df2\u78ba\u4fdd\u7b56\u7565\u7684\u6d41\u52d5\u6027\u7b26\u5408\u60a8\u7684\u8cc7\u91d1\u9700\u6c42\u3002 \u67e5\u770b\u66f4\u8a73\u7d30\u7684\u6559\u5b78\u6587\u7ae0\u3002</p> <pre><code>report.run_analysis('LiquidityAnalysis')\n</code></pre>"},{"location":"change-log/#inequalityanalysis","title":"inequalityAnalysis \u4e0d\u7b49\u5f0f\u6e2c\u8a66","text":"<p>\u539f\u672c\u5df2\u7d93\u6709\u7b56\u7565\uff0c\u60f3\u8981\u984d\u5916\u52a0\u5165\u5176\u4ed6\u6280\u8853\u6307\u6a19\u3001\u7c4c\u78bc\u3001\u7372\u5229\u6307\u6a19\uff0c\u53ef\u4ee5\u900f\u904e inequalityAnalaysis \u4f86\u6aa2\u8996\u662f\u5426\u80fd\u5920\u63d0\u9ad8\u9078\u80a1\u7e3e\u6548\u3002 \u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u800c\u8a00\uff0c\u6211\u5011\u60f3\u89c0\u5bdf\u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u4f86\u9032\u4e00\u6b65\u7be9\u9078\u80a1\u7968\u7684\u7e3e\u6548\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u65b9\u5f0f\uff1a</p> <pre><code>report.run_analysis('InequalityAnalysis', name='price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\n</code></pre> <p>\u8981\u5982\u4f55\u770b\u7d50\u679c\uff0c\u53ef\u4ee5\u53c3\u8003\u66f4\u8a73\u7d30\u7684\u6559\u5b78\u6587\u7ae0\u3002</p>"},{"location":"change-log/#032dev-2022-6-23","title":"0.3.2.dev (2022-6-23)","text":""},{"location":"change-log/#sunburst","title":"SunBurst \u6aa2\u8996\u7b56\u7565\u90e8\u4f4d","text":"<p>\u53ef\u4ee5\u986f\u793a\u7576\u524d\u7684\u80a1\u7968\uff0c\u6709\u54ea\u4e9b\u7522\u696d\uff0c\u7522\u696d\u7684\u504f\u91cd\u662f\u54ea\u4e00\u584a\uff0c\u67e5\u770b\u8a73\u7d30\u5167\u5bb9\uff01</p>"},{"location":"change-log/#_5","title":"\u505a\u7a7a\u4ee5\u53ca\u500b\u80a1\u6b0a\u91cd","text":"<p>FinLab Package \u7d42\u65bc\u652f\u63f4\u505a\u7a7a\u4e86\uff0c\u5047\u5982\u4f60\u539f\u672c\u5c31\u6709\u4e00\u500b\u597d\u7b56\u7565\uff0c\u53ef\u4ee5\u505a\u7a7a 0050 \u8a66\u8a66\u770b\uff0c\u96d6\u7136\u5831\u916c\u7387\u53ef\u4ee5\u80fd\u6703\u4e0b\u964d\uff0c\u4f46\u662f\u98a8\u96aa\u4e5f\u6703\u5927\u5e45\u7e2e\u5c0f\uff01\u975e\u5e38\u9069\u5408\u6211\u5011\u505a\u591a\u6a94\u80a1\u7968\u8cc7\u7522\u914d\u7f6e\u4f7f\u7528\u3002</p> <p>\u53e6\u5916\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u65b0\u7684\u7248\u672c position \u9664\u4e86\u4ee5\u524d\u7684\u5e03\u6797\u8a0a\u865f (True/False) \u5916\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u6b0a\u91cd\uff01\u6240\u4ee5\u4e0b\u65b9\u7a0b\u5f0f\u78bc\uff0c\u5c31\u662f 50% \u6bd4\u91cd\u7d66 2330 \u505a\u591a\uff0c50% \u7d66 1101 \u505a\u7a7a\u3002</p> <p>\u9019\u6a23\u7684\u6b0a\u91cd\u5206\u914d\u65b9\u5f0f\uff0c\u5b8c\u5168\u517c\u5bb9\u4e4b\u524d\u7684\u7248\u672c\uff0c\u4e5f\u5c31\u662f position \u662f True / False \u7684\u72c0\u6cc1\uff0c\u56e0\u70ba True \u5728\u96fb\u8166\u904b\u7b97\u4e2d\uff0c\u672c\u4f86\u5c31\u4ee3\u8868 1 \uff0c\u800c False \u4ee3\u8868 0\u3002\u6b0a\u91cd\u90fd\u662f 1 \u7684\u60c5\u6cc1\u4e0b\uff0c\u7a0b\u5f0f\u5c31\u6703\u8ddf\u4ee5\u524d\u4e00\u6a23\u5e73\u5747\u5206\u914d\u8cc7\u7522\u5594\u3002</p> <pre><code>from finlab import data\nfrom finlab import backtest\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = close &lt; 0\nposition['2330'] = 0.5\nposition['1101'] = -0.5\nr = backtest.sim(position)\nr.display()\n</code></pre>"},{"location":"change-log/#pandas_ta","title":"\u652f\u63f4 Pandas_ta \u8a08\u7b97\u6280\u8853\u6307\u6a19","text":"<p>Pandas_ta \u6700\u8fd1\u4e00\u5169\u5e74\u7b97\u662f\u8a08\u7b97\u6280\u8853\u6307\u6a19\u7684\u5f8c\u8d77\u4e4b\u79c0\uff0c\u539f\u56e0\u5728\u65bc TaLib \u6709\u6642\u5019\u5be6\u592a\u96e3\u5b89\u88dd\u4e86\uff0c\u800c\u4e14\u6280\u8853\u6307\u6a19\u5c31\u53ea\u6709\u90a3 100 \u500b\uff0c\u90fd\u662f\u8001\u8abf\u91cd\u5f48\uff0c\u6c92\u6709\u66f4\u65b0\u3002\u6709\u9452\u65bc\u6b64\uff0cPandas_ta \u63a1\u7528\u7d14 Pandas \u8a08\u7b97\u6280\u8853\u6307\u6a19\uff0c\u8ddf\u4e0d\u540c\u7684\u4f5c\u696d\u7cfb\u7d71\u6709\u6bd4\u8f03\u597d\u7684\u76f8\u5bb9\u6027\u3002\u53e6\u5916\uff0cPandas_ta \u4e5f\u6709\u5f88\u591a\u6700\u65b0\u7684\u6280\u8853\u6307\u6a19\uff0c\u4f8b\u5982 supertrend indicator\u3002\u6709\u975e\u5e38\u591a\u6c92\u6709\u770b\u904e\u7684\u6307\u6a19\uff0c\u50cf\u662f\u300cEven Better Sinewave \u300d\uff0c\u807d\u8d77\u4f86\u5be6\u5728\u662f\u975e\u5e38\u6709\u8da3\u5440\uff01\u9019\u4e9b\u90fd\u53ef\u4ee5\u5728 Pandas_ta \u6587\u6a94\u4e2d\u627e\u5230\u3002</p> <pre><code>from finlab import data\nvalues = data.indicator('supertrend')\n</code></pre>"},{"location":"cli/","title":"FinLab \u7684\u6307\u4ee4\u5217\u4ecb\u9762\uff08CLI\uff09\u3002","text":"<p>\u6b64 CLI \u63d0\u4f9b\u591a\u7a2e\u547d\u4ee4\u4f86\u7ba1\u7406 FinLab \u74b0\u5883\uff0c\u5305\u62ec\u8eab\u4efd\u9a57\u8b49\u3001\u5238\u5546\u7ba1\u7406\u3001\u7b46\u8a18\u672c\u64cd\u4f5c\u3001\u6295\u8cc7\u7d44\u5408\u7ba1\u7406\u548c\u6392\u7a0b\u4efb\u52d9\u3002\u4e3b\u547d\u4ee4\u7fa4\u7d44 (cli) \u662f\u6240\u6709\u5b50\u547d\u4ee4\u548c\u5b50\u7fa4\u7d44\u7684\u9032\u5165\u9ede\u3002</p> <p>\u5c1a\u5728\u6e2c\u8a66</p> <p>\u76ee\u524d\u6b64\u529f\u80fd\u70ba Alpha \u968e\u6bb5\uff0c\u53ef\u80fd\u6703\u6709\u932f\u8aa4\u6216\u4e0d\u7a69\u5b9a\u7684\u60c5\u6cc1\u3002\u8acb\u5c0f\u5fc3\u4f7f\u7528\u3002 \u5982\u6709\u4efb\u4f55\u554f\u984c\uff0c\u8acb\u81f3 Discord \u4e0a\u63d0\u51fa\u554f\u984c\uff0c\u6211\u5011\u5c07\u76e1\u5feb\u4f86\u4fee\u6b63\u3002</p>"},{"location":"cli/#_1","title":"\u5feb\u901f\u8a2d\u5b9a","text":"<ol> <li> <p>\u5b89\u88dd FinLab CLI\uff1a</p> <pre><code>pip install \"finlab[cli]\"\n</code></pre> </li> <li> <p>\u521d\u59cb\u5316 FinLab \u74b0\u5883\uff1a</p> <pre><code>finlab init\n</code></pre> </li> </ol>"},{"location":"cli/#_2","title":"\u6307\u4ee4\u4ecb\u7d39","text":""},{"location":"cli/#finlab-init","title":"finlab init","text":"<p>\u521d\u59cb\u5316 FinLab \u74b0\u5883\u548c\u5de5\u4f5c\u5340\u3002</p> <p>\u6b64\u547d\u4ee4\u57f7\u884c\u521d\u59cb\u5316\u8a2d\u7f6e\uff0c\u4ee5\u4f7f FinLab \u74b0\u5883\u6b63\u5e38\u904b\u884c\u3002\u5305\u62ec\u4ee5\u4e0b\u6b65\u9a5f\uff1a</p> <ul> <li> <p>\u5275\u5efa\u5de5\u4f5c\u5340\u76ee\u9304\uff1a\u5efa\u7acb\u7528\u65bc\u5b58\u5132\u6240\u6709\u5fc5\u8981\u6587\u4ef6\u548c\u914d\u7f6e\u7684\u76ee\u9304\u7d50\u69cb\u3002</p> </li> <li> <p>\u5275\u5efa\u74b0\u5883\u914d\u7f6e\uff1a\u5f9e FinLab \u8cc7\u6e90\u8b80\u53d6\u74b0\u5883\u914d\u7f6e\uff08env.yml\uff09\u4e26\u5beb\u5165\u5de5\u4f5c\u5340\u76ee\u9304\u3002</p> </li> <li> <p>\u5275\u5efa\u4e26\u8a2d\u7f6e Conda \u74b0\u5883\uff1a\u522a\u9664\u4efb\u4f55\u73fe\u6709\u540d\u70ba 'finlab-env' \u7684 Conda \u74b0\u5883\uff0c\u4e26\u6839\u64da\u74b0\u5883\u914d\u7f6e\u6587\u4ef6\u5275\u5efa\u4e00\u500b\u65b0\u7684\u74b0\u5883\u3002</p> </li> <li> <p>\u5b89\u88dd Jupyter Lab\uff1a\u5728\u65b0\u5275\u5efa\u7684\u74b0\u5883\u4e2d\u5b89\u88dd Jupyter Lab\uff0c\u4ee5\u555f\u7528\u4e92\u52d5\u5f0f\u7b46\u8a18\u672c\u64cd\u4f5c\u3002</p> </li> </ul> <p>\u7528\u6cd5:</p> <pre><code>finlab init\n</code></pre>"},{"location":"cli/#finlab-auth","title":"finlab auth","text":"<p>FinLab \u7684\u8eab\u4efd\u9a57\u8b49\u64cd\u4f5c\u3002</p> <p>\u6b64\u547d\u4ee4\u7fa4\u7d44\u8655\u7406\u7528\u6236\u8eab\u4efd\u9a57\u8b49\u4efb\u52d9\uff0c\u5305\u62ec\u767b\u9304\u548c\u767b\u51fa\u64cd\u4f5c\u3002\u6b64\u7fa4\u7d44\u4e2d\u7684\u547d\u4ee4\u901a\u904e\u7ba1\u7406\u7528\u6236\u6191\u8b49\u548c\u6703\u8a71\u8cc7\u8a0a\u4f86\u78ba\u4fdd\u5c0d FinLab \u8cc7\u6e90\u7684\u5b89\u5168\u8a2a\u554f\u3002</p>"},{"location":"cli/#finlab-auth-login","title":"finlab auth login","text":"<p>\u767b\u9304 FinLab\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab auth login\n</code></pre>"},{"location":"cli/#finlab-auth-logout","title":"finlab auth logout","text":"<p>\u767b\u51fa FinLab\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab auth logout\n</code></pre>"},{"location":"cli/#finlab-broker","title":"finlab broker","text":"<p>\u7ba1\u7406 FinLab \u4e2d\u5238\u5546\u5e33\u6236\u7684\u64cd\u4f5c\u3002</p> <p>\u6b64\u547d\u4ee4\u7fa4\u7d44\u5305\u62ec\u6dfb\u52a0\u3001\u5217\u51fa\u3001\u6e2c\u8a66\u548c\u79fb\u9664\u5238\u5546\u5e33\u6236\u7684\u547d\u4ee4\u3002\u5b83\u5141\u8a31\u7528\u6236\u7ba1\u7406\u4ed6\u5011\u7684\u5238\u5546\u6574\u5408\uff0c\u4e26\u57f7\u884c\u5fc5\u8981\u7684\u64cd\u4f5c\uff0c\u4ee5\u78ba\u4fdd FinLab \u8207\u4ed6\u5011\u7684\u5238\u5546\u5e33\u6236\u4e4b\u9593\u7684\u7121\u7e2b\u901a\u4fe1\u3002</p>"},{"location":"cli/#finlab-broker-add","title":"finlab broker add","text":"<p>\u6dfb\u52a0\u5238\u5546\u5e33\u6236\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab broker add [\u9078\u9805] [\u81ea\u8a02\u540d\u7a31]\n</code></pre> <p>\u9078\u9805:</p> \u540d\u7a31 \u985e\u578b \u63cf\u8ff0 \u9810\u8a2d --broker text \u70ba <code>sinopac</code> \u6216 <code>fugle</code> None"},{"location":"cli/#finlab-broker-list","title":"finlab broker list","text":"<p>\u5217\u51fa\u6240\u6709\u5238\u5546\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab broker list\n</code></pre>"},{"location":"cli/#finlab-broker-remove","title":"finlab broker remove","text":"<p>\u79fb\u9664\u5238\u5546\u5e33\u6236\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab broker remove [\u540d\u7a31]\n</code></pre>"},{"location":"cli/#finlab-broker-test","title":"finlab broker test","text":"<p>\u6e2c\u8a66\u6240\u6709\u5238\u5546\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab broker test\n</code></pre>"},{"location":"cli/#finlab-nb","title":"finlab nb","text":"<p>FinLab \u7684\u7b46\u8a18\u672c\u64cd\u4f5c\u3002</p> <p>\u6b64\u547d\u4ee4\u7fa4\u7d44\u5305\u62ec\u7ba1\u7406 FinLab \u74b0\u5883\u4e2d Jupyter \u7b46\u8a18\u672c\u7684\u547d\u4ee4\u3002\u7528\u6236\u53ef\u4ee5\u5f9e\u96f2\u7aef\u62c9\u53d6\u7b46\u8a18\u672c\u3001\u5c07\u672c\u5730\u7b46\u8a18\u672c\u63a8\u9001\u5230\u96f2\u7aef\u3001\u5728 Jupyter Lab \u4e2d\u6253\u958b\u7b46\u8a18\u672c\u3001\u79fb\u9664\u7b46\u8a18\u672c\u548c\u57f7\u884c\u7b46\u8a18\u672c\u3002</p>"},{"location":"cli/#finlab-nb-jupyter","title":"finlab nb jupyter","text":"<p>\u4f7f\u7528\u6307\u5b9a\u7684\u7b46\u8a18\u672c\u6253\u958b Jupyter Lab\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab nb jupyter \u7b56\u7565\u540d\u7a31\n</code></pre>"},{"location":"cli/#finlab-nb-pull","title":"finlab nb pull","text":"<p>\u5f9e\u96f2\u7aef\u4e0b\u8f09\u7b46\u8a18\u672c</p> <p>\u7528\u6cd5:</p> <pre><code>finlab nb pull \u7b56\u7565\u540d\u7a31\n</code></pre>"},{"location":"cli/#finlab-nb-push","title":"finlab nb push","text":"<p>\u5c07\u7b46\u8a18\u672c\u4e0a\u50b3\u5230\u96f2\u7aef\u4e26\u8986\u84cb\u73fe\u6709\u7684\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab nb push \u7b56\u7565\u540d\u7a31\n</code></pre>"},{"location":"cli/#finlab-nb-remove","title":"finlab nb remove","text":"<p>\u79fb\u9664\u6307\u5b9a\u7684\u7b46\u8a18\u672c\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab nb remove \u7b56\u7565\u540d\u7a31\n</code></pre>"},{"location":"cli/#finlab-nb-run","title":"finlab nb run","text":"<p>\u57f7\u884c\u6307\u5b9a\u7684\u7b46\u8a18\u672c\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab nb run \u7b56\u7565\u540d\u7a31\n</code></pre>"},{"location":"cli/#finlab-pm","title":"finlab pm","text":"<p>FinLab \u7684\u6295\u8cc7\u7d44\u5408\u7ba1\u7406\u64cd\u4f5c\u3002</p> <p>\u6b64\u547d\u4ee4\u7fa4\u7d44\u5305\u62ec\u7ba1\u7406\u8207\u5238\u5546\u5e33\u6236\u540c\u6b65\u7684\u6295\u8cc7\u7d44\u5408\u7684\u547d\u4ee4\u3002\u7528\u6236\u53ef\u4ee5\u5275\u5efa\u65b0\u7684\u6295\u8cc7\u7d44\u5408\u3001\u66f4\u65b0\u73fe\u6709\u6295\u8cc7\u7d44\u5408\u3001\u6aa2\u67e5\u6295\u8cc7\u7d44\u5408\u7684\u72c0\u614b\u4ee5\u53ca\u5c07\u6295\u8cc7\u7d44\u5408\u8207\u4ed6\u5011\u7684\u5238\u5546\u5e33\u6236\u540c\u6b65\u3002</p>"},{"location":"cli/#finlab-pm-create","title":"finlab pm create","text":"<p>\u6839\u64da\u7d66\u5b9a\u7684\u7b56\u7565\u6b0a\u91cd\u5275\u5efa\u6295\u8cc7\u7d44\u5408\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab pm create [\u6295\u7d44\u540d\u7a31] [\u6b0a\u91cd]... [\u9078\u9805]\n</code></pre> <p>\u9078\u9805:</p> \u540d\u7a31 \u985e\u578b \u63cf\u8ff0 \u9810\u8a2d --name text \u6295\u8cc7\u7d44\u5408\u7ba1\u7406\u8005\u540d\u7a31 default --total_balance integer \u7e3d\u8cc7\u7522 0 --rebalance_safety_weight float \u91cd\u65b0\u5e73\u8861\u5b89\u5168\u6b0a\u91cd 0.2 --smooth_transition boolean \u5e73\u6ed1\u904e\u6e21 True --force_override_difference boolean \u5f37\u5236\u8986\u84cb\u5dee\u7570 False --margin_trading boolean \u4fdd\u8b49\u91d1\u4ea4\u6613 False <p>\u7bc4\u4f8b\uff1a</p> <pre><code>finlab pm create \u591a\u5143\u6295\u8cc7 \u50f9\u503c\u7b56\u7565 0.5 \u52d5\u91cf\u7b56\u7565 0.5 --total_balance 1000000 \n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u5c07\u5275\u5efa\u4e00\u500b\u540d\u70ba '\u591a\u5143\u6295\u8cc7' \u7684\u6295\u8cc7\u7d44\u5408\uff0c\u5176\u4e2d\u5305\u542b\u5169\u500b\u7b56\u7565\uff1a'\u50f9\u503c\u7b56\u7565' \u548c '\u52d5\u91cf\u7b56\u7565'\uff0c\u6b0a\u91cd\u5206\u5225\u70ba 0.5\u3002\u6b64\u5916\uff0c\u7e3d\u8cc7\u7522\u70ba 100 \u842c\u5143\u3002</p>"},{"location":"cli/#finlab-pm-status","title":"finlab pm status","text":"<p>\u986f\u793a\u6295\u8cc7\u7d44\u5408\u72c0\u614b\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab pm status [\u6295\u7d44\u540d\u7a31]\n</code></pre>"},{"location":"cli/#finlab-pm-sync","title":"finlab pm sync","text":"<p>\u5c07\u6295\u8cc7\u7d44\u5408\u8207\u5238\u5546\u5e33\u6236\u540c\u6b65\uff0c\u5728\u7b2c\u4e00\u6b21\u540c\u6b65\u6642\uff0c\u9700\u8981\u6307\u5b9a\u5238\u5546\u5e33\u865f\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab pm sync [\u9078\u9805] [\u6295\u7d44\u540d\u7a31]\n</code></pre> <p>\u9078\u9805:</p> \u540d\u7a31 \u985e\u578b \u63cf\u8ff0 \u9810\u8a2d --broker text \u8981\u540c\u6b65\u7684\u5238\u5546\u540d\u7a31 None"},{"location":"cli/#finlab-pm-update","title":"finlab pm update","text":"<p>\u66f4\u65b0\u6307\u5b9a\u540d\u7a31\u7684\u6295\u8cc7\u7d44\u5408\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab pm update [\u6295\u7d44\u540d\u7a31]\n</code></pre>"},{"location":"cli/#finlab-schedule","title":"finlab schedule","text":"<p>FinLab \u7684\u6392\u7a0b\u4efb\u52d9\u3002</p> <p>\u6b64\u547d\u4ee4\u7fa4\u7d44\u5305\u62ec\u70ba FinLab \u8a2d\u5b9a\u81ea\u52d5\u64cd\u4f5c\u7684\u547d\u4ee4\u3002\u7528\u6236\u53ef\u4ee5\u6392\u7a0b\u7b46\u8a18\u672c\u57f7\u884c\u548c\u6295\u8cc7\u7d44\u5408\u540c\u6b65\u3001\u5217\u51fa\u6240\u6709\u6392\u7a0b\u4efb\u52d9\uff0c\u4e26\u79fb\u9664\u7279\u5b9a\u6392\u7a0b\u4efb\u52d9\u3002</p>"},{"location":"cli/#finlab-schedule-list","title":"finlab schedule list","text":"<p>\u5217\u51fa\u6240\u6709\u6392\u7a0b\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab schedule list\n</code></pre>"},{"location":"cli/#finlab-schedule-nb","title":"finlab schedule nb","text":"<p>\u6392\u7a0b\u5728\u7279\u5b9a\u6642\u9593\u57f7\u884c\u7b46\u8a18\u672c\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab schedule nb [\u7b56\u7565\u540d\u7a31] [\u6642\u9593]...\n</code></pre> <p>\u4f8b\u5982\uff1a <pre><code>finlab schedule nb \u7b56\u7565\u540d\u7a31 08:00 20:00 00:00\n</code></pre></p> <p>\u4e0a\u8ff0\u547d\u4ee4\u5c07\u5728\u6bcf\u5929\u7684 8:00\u300120:00 \u548c 0:00 \u57f7\u884c\u540d\u70ba '\u7b56\u7565\u540d\u7a31' \u7684\u7b46\u8a18\u672c\u3002</p>"},{"location":"cli/#finlab-schedule-pm","title":"finlab schedule pm","text":"<p>\u6392\u7a0b\u5728\u7279\u5b9a\u6642\u9593\u540c\u6b65\u6295\u8cc7\u7d44\u5408\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab schedule pm [\u6295\u7d44\u540d\u7a31] [\u6642\u9593]...\n</code></pre> <p>\u4f8b\u5982\uff1a <pre><code>finlab schedule pm \u591a\u5143\u6295\u8cc7 08:00 20:00 00:00\n</code></pre></p> <p>\u4e0a\u8ff0\u547d\u4ee4\u5c07\u5728\u6bcf\u5929\u7684 8:00\u300120:00 \u548c 0:00 \u540c\u6b65\u540d\u70ba '\u591a\u5143\u6295\u8cc7' \u7684\u6295\u8cc7\u7d44\u5408\u3002</p>"},{"location":"cli/#finlab-schedule-remove","title":"finlab schedule remove","text":"<p>\u79fb\u9664\u6392\u7a0b\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab schedule remove {nb|pm} \u540d\u7a31\n</code></pre> <p>\u540d\u7a31\u53ef\u4ee5\u662f\u7b46\u8a18\u672c\u540d\u7a31\u6216\u6295\u8cc7\u7d44\u5408\u540d\u7a31\u3002</p>"},{"location":"cli/#finlab-schedule-run","title":"finlab schedule run","text":"<p>\u57f7\u884c\u6240\u6709\u6392\u7a0b\u3002</p> <p>\u7528\u6cd5:</p> <pre><code>finlab schedule run\n</code></pre>"},{"location":"faq/","title":"\u5e38\u898b\u554f\u984c","text":""},{"location":"faq/#_2","title":"\u767b\u5165\u9a57\u8b49\u76f8\u95dc","text":"\u627e\u4e0d\u5230<code>api_token</code>\u7684\u8f38\u5165\u6846\uff0c\u5c0e\u81f4\u7121\u6cd5\u6293\u53d6\u8cc7\u6599\u600e\u9ebc\u8fa6\u5462\uff1f <p>\u53ef\u80fd\u60a8\u662f\u4f7f\u7528VSCode\u3001\u6216\u5176\u4ed6IDE\uff0c\u5728\u7a0b\u5f0f\u6700\u524d\u9762\u52a0\u4e0a\u4ee5\u4e0b\u8a9e\u6cd5\uff0c\u4e5f\u80fd\u76f4\u63a5\u767b\u5165\u645f <pre><code>import finlab\nfinlab.login('\u60a8\u7684api_token')\n</code></pre></p>"},{"location":"faq/#_3","title":"\u8cc7\u6599\u4e0b\u8f09","text":"\u6293\u4e0d\u5230\u5b8c\u6574\u8cc7\u6599\uff1f\u70ba\u4ec0\u9ebc\u8cc7\u6599\u7bc4\u570d\u53ea\u52302020\u5e74\u5462\uff1f <p>\u56e0\u70ba\u60a8\u5c1a\u672a\u8a02\u95b1VIP\uff0c\u5c0d\u672a\u8a02\u95b1VIP\u6703\u54e1\u6211\u5011\u53ea\u958b\u653e\u81f32020\u5e74\u5e95\u7684\u8cc7\u6599\uff0c\u53ef\u4ee5\u8003\u616e\u8a02\u95b1\u8d77\u4f86\uff01 \u5373\u53ef\u4f7f\u7528\u622a\u6b62\u81f3\u6700\u65b0\u4ea4\u6613\u65e5\u7684\u6b77\u53f2\u8cc7\u6599\u3002</p> \u70ba\u4ec0\u9ebc\u8f09\u4e0b\u4f86\u7684\u8cc7\u6599\u4e2d\uff0c\u53ea\u6709index\u6709\u503c\uff0cvalue\u7686\u70ba\u7a7a\u503c\u5462\uff1f <p>\u60a8\u53ef\u80fd\u6709\u8a2d\u5b9a\u5230<code>set_universe</code>\uff0c\u57f7\u884c<code>data.universe_stocks = {}</code> \u6216\u662f\u6574\u500bkernal\u91cd\u555f\u5f8c\u518d\u57f7\u884c\u539f\u7a0b\u5f0f\u78bc\u5373\u53ef\u3002</p>"},{"location":"faq/#_4","title":"\u5e38\u7528\u7b56\u7565\u8a9e\u6cd5\u554f\u984c","text":"\u6bcf\u7a2e\u8ca1\u7d93\u8cc7\u6599\u7684 index \u6c92\u6709\u5c0d\u9f4a\uff0c\u8981\u7528 reindex \u53bb\u505a\u904b\u7b97\uff1f <p>\u4e0d\u9700\u8981\uff0c\u9019\u6a23\u6703\u82b1\u8cbb\u5927\u91cf\u6642\u9593\u5728\u505a\u8cc7\u6599\u7684\u8abf\u6574\uff0c\u5728 finlab package \u4e2d\uff0c\u6240\u6709\u4ee5 <code>data.get</code> \u6240\u62ff\u53d6\u7684\u8cc7\u6599\uff0c\u5728\u505a\u4e8c\u5143\u904b\u7b97\u6642\uff0c\u90fd\u6703\u5077\u5077\u5e6b\u4f60\u81ea\u52d5\u5c0d\u9f4a\uff0c\u60a8\u4e0d\u9700\u8981\u82b1\u8cbb\u4efb\u4f55\u6642\u9593\u4f86\u5c0d\u9f4a\u8cc7\u6599\uff0c\u4ee5\u4e0b\u70ba\u4f8b\u5b50\u3002 \u4f8b\u5982\u6211\u5011\u62ff\u53d6\u6b64\u8cc7\u6599\uff1a <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\n</code></pre> \u6b64\u6642 <code>close</code> \u4ee5\u53ca <code>roa</code> \u90fd\u662f <code>FinlabDataFrame</code>\uff0c\u6240\u4ee5\u8207\u5176\u9019\u6a23\u88fd\u4f5c\u689d\u4ef6</p> <pre><code>roa_daily = roa.reindex(close.index, method='ffill')\ncondition = (close &lt; 30) &amp; (roa_daily &gt; 0)\n</code></pre> <p>\u60a8\u53ef\u4ee5\u5316\u7c21\u5982\u4e0b</p> <pre><code>condition = (close &lt; 30) &amp; (roa &gt; 0)\n</code></pre> <p>\u5728\u505a\u9019\u4e9b\u56db\u5247\u904b\u7b97\u6216\u4e0d\u7b49\u5f0f\u904b\u7b97\u6642\uff0c\u6211\u5011\u6703\u5077\u5077\u5e6b\u4f60\u8a08\u7b97 <code>roa_daily</code>\uff0c\u6240\u4ee5\u60a8\u4e0d\u9700\u8981\u89aa\u81ea\u52d5\u624b\u5beb\u5594\uff01</p> \u60f3\u8981\u5728\u7279\u5b9a\u6708\u4efd\u505c\u6b62\u4ea4\u6613\uff0c\u8981\u600e\u9ebc\u5728\u56de\u6e2c\u4e2d\u6392\u9664\u7279\u5b9a\u6708\u4efd\u5462\uff1f <p>\u4ee57,8\u6708\u4e0d\u8981\u6709\u7b56\u7565\u8a0a\u865f\u70ba\u4f8b\uff0c\u5c07month_condition\u8207\u5176\u4ed6\u689d\u4ef6\u53d6\u4ea4\u96c6\u5373\u53ef\u3002 <pre><code>month_condition = close.index.to_series().apply(lambda x:x.month not in [7,8])\n</code></pre></p> \u8981\u5982\u4f55\u5c07\u8cc7\u6599\u5eab\u4e2d\u4f8b\u5982\u300c\u4f01\u696d\u57fa\u672c\u8cc7\u8a0a\u300d\u7684\u7279\u5b9a\u6b04\u4f4d\u6574\u7406\u6210\u50cf\u5176\u4ed6\u56de\u6e2c\u8cc7\u6599\u540c\u6a23\u7684\u683c\u5f0f\u5462\uff1f(index\u70badate\u3001columns\u70bastock_id)\" <p>\u4ee5\u6574\u7406\u300c\u5df2\u767c\u884c\u666e\u901a\u80a1\u6578\u6216TDR\u539f\u767c\u884c\u80a1\u6578\u300d\u6b04\u4f4d\u70ba\u4f8b\uff1a <pre><code>from finlab.dataframe import FinlabDataFrame\nfrom finlab import data\nbasic_info = data.get('company_basic_info')\nbasic_info.index = basic_info.stock_id\n\u71df\u696d\u6536\u5165 = data.get('financial_statement:\u71df\u696d\u6536\u5165\u6de8\u984d')\n\u6d41\u901a\u5728\u5916\u80a1\u6578 = basic_info['\u5df2\u767c\u884c\u666e\u901a\u80a1\u6578\u6216TDR\u539f\u767c\u884c\u80a1\u6578']\n\u6d41\u901a\u5728\u5916\u80a1\u6578 = FinlabDataFrame(pd.DataFrame([list(\u6d41\u901a\u5728\u5916\u80a1\u6578)], columns=basic_info.index, index=\u71df\u696d\u6536\u5165.index))\n</code></pre></p>"},{"location":"faq/#_5","title":"\u7b56\u7565\u56de\u6e2c","text":"\u70ba\u4f55\u6c92\u6709\u6b63\u78ba\u7684\u505c\u640d\u505c\u5229\uff1f <p>\u7576\u4f7f\u7528 <pre><code>report = sim(position, stop_loss=0.1)\n</code></pre> \u7684\u6642\u5019\uff0c\u5c31\u7b97\u662f stop_loss \u6709\u958b\u555f\uff0c\u7576\u5075\u6e2c\u5230 position \u7576\u5929\u6709\u90e8\u4f4d\u6642\uff0c\u9084\u662f\u512a\u5148\u4ee5 position \u70ba\u6e96\u3002\u9664\u975e\u60a8\u7684 position index \u662f\u7a00\u758f\u7684\u72c0\u6cc1\u4e0b\uff08\u4f8b\u5982 index \u53ea\u6709\u6bcf\u500b\u6708\uff09\uff0c\u7cfb\u7d71\u67e5\u627e\u4e0d\u5230\u7576\u5929\u9700\u8a2d\u5b9a\u7684\u90e8\u4f4d\u6642\uff0c\u624d\u6703\u4ee5 stop_loss \u4f86\u76e3\u6e2c\u662f\u5426\u8ce3\u51fa\u3002 </p> <p>\u4f60\u53ef\u80fd\u6703\u89ba\u5f97\u9019\u6a23\u4e0d\u592a\u76f4\u89ba\uff0c\u4f46\u662f\u8a2d\u60f3\u5047\u5982\u505c\u640d\u5f8c\uff0c\u9084\u662f\u7dad\u6301 position \u662f True\uff0c\u90a3\u660e\u5929\u7a76\u7adf\u662f\u5df2\u7d93\u505c\u640d\u9084\u662f\u61c9\u8a72\u91cd\u65b0\u8cb7\u5165\uff1f\u5c31\u6703\u8b8a\u6210\u5927\u54c9\u554f\u3002\u6240\u4ee5\u5047\u5982 position \u662f True\uff0c\u5c31\u4ee5 position \u70ba\u6e96\uff0c\u800c\u4e0d\u984d\u5916\u505c\u640d\uff0c\u662f\u6700\u55ae\u7d14\u7684\u65b9\u5f0f\u3002 </p> <p>\u5047\u5982\u60a8\u7684 position \u7684 index \u662f\u6bcf\u500b\u4ea4\u6613\u65e5\uff0c\u78ba\u5be6\u6703\u5c0e\u81f4 stop_loss \u6c92\u6709\u4f5c\u7528\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u89e3\u6c7a\u65b9\u6cd5\uff1a</p> <ol> <li>\u5047\u5982\u60a8\u525b\u597d\u6709\u4f7f\u7528 hold_until \u4f86\u88fd\u4f5c position \u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 <pre><code># \u539f\u672c\u7684\nposition = buy.hold_until(sell)\n# \u6709\u505c\u640d\u7684\nposition = buy.hold_until(sell, stop_loss=0.1)\n</code></pre></li> <li>\u5047\u5982\u60a8\u539f\u672c\u5c31\u6c92\u6709\u4f7f\u7528 hold_until\uff0c\u5247\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u4f86\u8a2d\u5b9a <pre><code>position.is_entry().hold_until(position.is_exit(), stop_loss=0.1) \n</code></pre> \u4f86\u8a2d\u5b9a\u505c\u640d\u505c\u5229</li> </ol> \u8a72\u5982\u4f55\u512a\u5316\u8207\u9a57\u8b49\u7b56\u7565\uff1f <p>\u8a73\u7d30\u6982\u5ff5\u53ef\u53c3\u8003\uff1a https://www.finlab.tw/phcebus-thinking-report-part2-backtest-sop/ \u4e26\u900f\u904eFinlab\u56de\u6e2c\u7cfb\u7d71\u9032\u884c\u5be6\u4f5c\u3002</p> \u5728local\u6216colab\u57f7\u884c\u56de\u6e2c\u6642\uff0c\u53ef\u4ee5\u4e0d\u8981\u5370\u51fa\u7db2\u9801\u5831\u8868\u55ce\uff1f <p>\u5728sim\u56de\u6e2c\u6a21\u7d44\u4e2d\u8a2d\u5b9a\u53c3\u6578upload=False\u5373\u53ef\u3002 <pre><code>report = sim(position, upload=False)\n</code></pre></p> \u70ba\u4ec0\u9ebc\u56de\u6e2c\u51fa\u4f86\u7684\u5831\u916c\u8ddf\u81ea\u5df1\u7b97\u51fa\u4f86\u7684\u90fd\u4e0d\u4e00\u6a23\u5462\uff1f <p>\u53ef\u4ee5\u5148\u6aa2\u67e5\u662f\u5426\u5df2\u7528\u9084\u539f\u80a1\u50f9\u8a08\u7b97\u3001\u78ba\u8a8d\u7b56\u7565\u9032\u51fa\u5834\u78ba\u5207\u6642\u9593\u9ede\u3001\u662f\u4f7f\u7528\u6293\u958b\u76e4\u6216\u6536\u76e4\u50f9\u3002\u82e5\u4f9d\u7136\u6709\u7591\u616e\u53ef\u81f3Discord\u8ad6\u58c7\u5340\u8a0e\u8ad6\u3002</p> report\u7684display_mae_mfe_analysis\uff0cEdge ratio\u70ba\u4ec0\u9ebc\u6c92\u6709\u986f\u793a\uff1f <p>\u9700\u5728<code>sim</code>\u56de\u6e2c\u6a21\u7d44\u4e2d\u8a2d\u5b9a\u53c3\u6578<code>mae_mfe_window</code>\uff0c\u53c3\u8003 https://doc.finlab.tw/reference/backtest/ \u3002</p> \u600e\u9ebc\u9032\u4e00\u6b65\u5ba2\u88fd\u5316\u63db\u80a1\u983b\u7387\u5462\uff1f(resample\u7684\u9032\u968e\u61c9\u7528\uff1f)\" <p>\u53ef\u53c3\u8003pandas\u6587\u4ef6\u8aaa\u660e https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.resample.html \uff0c\u76f4\u63a5\u4f7f\u7528\u65bc\u653e\u5165\u56de\u6e2c\u6a21\u7d44\u524d\u7684position\u3002</p> \u5728\u5e73\u53f0\u4e0a\u57f7\u884c\u9047\u5230MemoryError\u8981\u600e\u9ebc\u89e3\u6c7a\u5462\uff1f <p>\u8d85\u904e\u7db2\u9801\u8a18\u61b6\u9ad4\u9650\u5236\uff0c\u5efa\u8b70\u79fb\u81f3 Google Colab \u4f7f\u7528\u3002</p> \u7b56\u7565\u540d\u7a31\u65c1\u7684\u7da0\u9ede\u9ede\u662f\u4ec0\u9ebc\u610f\u601d\uff1f <p>\u8868\u793a\u8a72\u7b56\u7565\u70ba\u8a0a\u865f\u7570\u52d5\u65e5\u6216\u63db\u80a1\u65e5\u3002</p>"},{"location":"faq/#_6","title":"\u74b0\u5883\u76f8\u95dc","text":"Talib\u8981\u5982\u4f55\u5b89\u88dd\uff1f <ul> <li>\u5728 Google Colab: \u53ef\u4ee5\u4f7f\u7528\u8a9e\u6cd5<code>!pip install ta-lib-bin</code> \u4f86\u9032\u884c\u5b89\u88dd</li> <li>\u900f\u904e conda \u5b89\u88dd\uff1a\u5728\u5176\u4ed6 kernel: \u57f7\u884c <code>$ conda install -c conda-forge ta-lib</code> \u4f86\u9032\u884c\u5b89\u88dd</li> <li>MacOS \u5b89\u88dd\uff1a\u8acb\u5148\u5b89\u88dd Homebrew\uff0c\u4e26\u4e14\u4f7f\u7528 <code>brew install ta-lib</code> \u4f86\u9032\u884c\u5b89\u88dd\uff0c</li> <li>Windows \u5b89\u88dd\uff1a\u53ef\u4ee5\u81f3 https://www.lfd.uci.edu/~gohlke/pythonlibs/#ta-lib \u4e0b\u8f09\u76f8\u61c9\u7248\u672cwheel\uff0c\u4e26\u5728\u4e0b\u8f09\u8def\u5f91\u57f7\u884c <code>$ pip install \u6a94\u6848\u5168\u540d.whl</code></li> </ul> \u8981\u5982\u4f55\u5728colab\u5c07\u8cc7\u6599\u532f\u51fa\uff1f\u5982\u4f55\u532f\u5165\u8cc7\u6599\u4e26\u8a2d\u5b9a\u6b63\u78ba\u8def\u5f91\uff1f <p>\u9700\u639b\u63a5google \u96f2\u7aef\u786c\u789f\uff0c\u53ef\u5728\u9801\u9762\u5de6\u5074\u300c\u6a94\u6848\u300d\u9078\u55ae\u4e2d\u9ede\u9078\u300c\u639b\u63a5\u96f2\u7aef\u786c\u789f\u300d\uff0c\u6216\u76f4\u63a5\u8f38\u5165\u4e26\u57f7\u884c\uff1a <pre><code>from google.colab import drive\ndrive.mount('/content/drive')\n</code></pre> \u5176\u4e2d\u300c/drive/MyDrive\u300d\u5373\u70bagoogle\u96f2\u7aef\u786c\u789f\u6839\u76ee\u9304\u3002</p> \u5728\u672c\u6a5f\u6216colab\u8dd1\u7684\u56de\u6e2c\u7e3e\u6548\u8ddf\u5e73\u53f0\u4e0a\u8dd1\u51fa\u4f86\u7684\u4e0d\u4e00\u6a23\uff1f <p>\u4ee5\u5728\u672c\u6a5f\u6216colab\u4f7f\u7528\u6700\u65b0\u7248\u5957\u4ef6\u57f7\u884c\u7684\u7d50\u679c\u70ba\u6e96\u3002</p> \u624b\u6a5f\u9069\u5408\u64cd\u4f5c FinLab \u91cf\u5316\u5e73\u53f0\u55ce\uff1f <p>\u82e5\u662f\u67e5\u770b\u5404\u7b56\u7565\u7e3e\u6548\u3001\u5176\u4ed6\u500b\u80a1\u3001\u7522\u696d\u8cc7\u8a0a\u7b49\uff0c\u7528\u624b\u6a5f\u662f\u53ef\u884c\u7684\uff1b\u4e0d\u904e\u82e5\u6b32\u64b0\u5beb\u7b56\u7565\u4e26\u57f7\u884c\uff0c\u56e0\u8a18\u61b6\u9ad4\u9650\u5236\u8003\u91cf\uff0c\u5efa\u8b70\u4ee5\u96fb\u8166\u4f86\u4f7f\u7528\u70ba\u4e3b\u3002</p>"},{"location":"faq/#_7","title":"\u4e0b\u55ae\u9032\u51fa\u5834","text":"\u5728finlab\u5e73\u53f0\u7121\u6cd5\u76f4\u63a5\u57f7\u884c\u4e0b\u55ae\uff1f <p>\u662f\u7684\uff0c\u5982\u9700\u4e32\u63a5\u4e0b\u55aeAPI\uff0c\u9700\u4f7f\u7528\u5176\u4ed6\u74b0\u5883\u9032\u884c\u64cd\u4f5c\u3002</p> \u8981\u5982\u4f55\u4e32\u63a5\u5238\u5546API\u4e0b\u55ae\u5462\uff1f <p>Finlab\u6709\u8207\u6c38\u8c50\u8b49\u5238\u3001\u7389\u5c71Fugle\u5408\u4f5c\uff0c\u53ef\u5728\u958b\u7acb\u76f8\u95dc\u5e33\u6236\u5f8c\u67e5\u95b1\u6587\u4ef6\u958b\u59cb\u4e32\u63a5\uff0c\u5167\u6587\u4ea6\u9644\u6709\u6559\u5b78\u5f71\u7247\uff0c\u4f9d\u6b65\u9a5f\u57f7\u884c\u5373\u53ef\uff1a https://doc.finlab.tw/details/order_api/</p> \u4e0b\u55ae\u6642\u5982\u4f55\u907f\u514d\u51fa\u6389\u975e\u8a72\u7b56\u7565\u7684\u90e8\u4f4d\uff1f <p>\u5148\u5275\u5efaPosition\u7269\u4ef6\u4e26\u5b9a\u7fa9\u624b\u55ae\u90e8\u4f4d(\u975e\u8a72\u6b21\u7b56\u7565\u76f8\u95dc\u7684\u90e8\u4f4d)\uff0c\u5728OrderExecutor\u7684position\u653e\u5165\u8a72\u7b56\u7565\u90e8\u4f4d\u8207\u624b\u55ae\u90e8\u4f4d\u7684\u52a0\u7e3d\uff0c\u5373\u53ef\u76f4\u63a5\u4e0b\u55ae\u3002</p> \u932f\u904e\u7b56\u7565\u7684\u9032\u51fa\u5834\u65e5\u671f\uff0c\u8a72\u600e\u9ebc\u8fa6\uff1f <p>\u53ef\u85c9\u7531Edge Ratio\u5206\u6790\u4f86\u5224\u65b7\u662f\u5426\u9069\u5408\u4e2d\u9014\u9032\u5834\uff0c\u8a73\u7d30\u8aaa\u660e\u8acb\u898bBen\u5927\u6587\u7ae0\u89e3\u8aaa\uff1ahttps://www.finlab.tw/edge-ratio-follow-application/</p>"},{"location":"faq/#_8","title":"\u5e73\u53f0\u4f7f\u7528","text":"\u54ea\u88e1\u80fd\u8a2d\u5b9a\u7b56\u7565\u81ea\u52d5\u66f4\u65b0\uff0c\u4e0d\u60f3\u6bcf\u5929\u6309\uff1f <p>\u5728\u5e73\u53f0\u7b56\u7565\u9801\u9762\u4e0a\u65b9\uff0c\u6309\u4e0b\u300c\u81ea\u52d5\u66f4\u65b0\u300d\uff0c\u5373\u53ef\u9078\u64c7\u6b32\u66f4\u65b0\u4e4b\u7b56\u7565\u3001\u8a2d\u5b9a\u6642\u9593\u4f86\u9032\u884c\u6bcf\u65e5\u81ea\u52d5\u66f4\u65b0\u3002</p> \u7b56\u7565\u8a0a\u865f\u6709\u7570\u52d5\uff0c\u6703\u6709\u901a\u77e5\u529f\u80fd\u55ce\uff1f <p>\u5728\u5e73\u53f0\u4e0a\u6709\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u4e4b\u7b56\u7565\uff0c\u5c07\u5728\u8a0a\u865f\u51fa\u73fe\u7570\u52d5\u6642\uff0c\u5bc4\u51famail\u901a\u77e5(\u901a\u77e5\u5728\u5de5\u4f5c\u65e50600~0700\u4e4b\u9593\u5bc4\u51fa)\u3002</p> \u7b56\u7565\u6e05\u55ae\uff0c\u300c\u7576\u524d\u7d71\u8a08\u300d\u548c\u300c\u8fd1\u671f\u66f4\u52d5\u6e05\u55ae\u300d\u7684\u5dee\u7570\u5728\u54ea\uff1f <p>\u7576\u524d\u7d71\u8a08\u6e05\u55ae\u5305\u542b\u7b56\u7565\u76ee\u524d\u5be6\u969b\u6301\u80a1\uff0c\u8fd1\u671f\u66f4\u52d5\u6e05\u55ae\u9664\u4e86\u76ee\u524d\u5be6\u969b\u6301\u80a1\u3001\u4e5f\u5305\u542b\u8fd1\u671f\u5404\u500b\u80a1\u7684\u7570\u52d5\u3002</p> \u70ba\u4f55\u300c\u8fd1\u671f\u7570\u52d5\u6e05\u55ae\u300d\u6703\u6bcf\u5929\u8b8a\uff1f <p>\u96a8\u8457\u7b56\u7565\u4e2d\u4f7f\u7528\u5230\u7684\u6578\u64da\u6bcf\u65e5\u7570\u52d5\uff0c\u5c1a\u672a\u9032\u5834\u7684\u9078\u80a1\u5c07\u96a8\u4e4b\u8b8a\u5316\uff0c\u5be6\u969b\u61c9\u7528\u4e0a\uff0c\u65bc\u539f\u5148\u8a2d\u5b9a\u4e4b\u63db\u80a1\u5468\u671f\u9032\u884c\u63db\u80a1\u64cd\u4f5c\u5373\u53ef\u3002</p>"},{"location":"faq/#_9","title":"\u8a02\u95b1\u8207\u5176\u4ed6\u554f\u984c","text":"\u53ef\u4ee5\u66f4\u6539\u8a02\u95b1\u6642\u7d81\u5b9a\u7684\u4fe1\u7528\u5361\u55ce\uff1f <p>\u53ef\u4ee5\uff0c\u8acb\u9ede\u9078\u5e73\u53f0\u7684\u53f3\u4e0a\u89d2\u7684\u6703\u54e1\u9801\u9762\uff0c\u4e26\u4e14\u9ede\u9078\u300c\u4ed8\u6b3e\u8a2d\u5b9a\u8207\u7d00\u9304\u300d\u5206\u9801\uff0c\u4e26\u9ede\u9078\u300c\u66f4\u6539\u767c\u7968\u4ee5\u53ca\u4fe1\u7528\u5361\u300d\u5373\u53ef\u3002</p> \u8a3b\u518a\u932f\u5e33\u865f\u4e86\uff0c\u60f3\u66f4\u63db\u8a3b\u518a\u4f7f\u7528\u7684FinLab\u5e33\u865f\uff0c\u600e\u9ebc\u8fa6\uff1f <p>\u53ef\u76f4\u63a5\u4f7f\u7528\u65b0\u7684google\u5e33\u865f\u767b\u5165\u5f8c\uff0c\u7528\u820a\u7684\u5e33\u865f\u5c0d\u61c9\u5230\u7684 email \u5230 finlab.company@finlab.tw \u4f86\u66f4\u63db\u5373\u53ef</p> \u6211\u6709\u91cf\u5316\u5e73\u53f0\u4f7f\u7528\u4e0a\u7684\u554f\u984c\uff0c\u8acb\u554f\u52a9\u6559\u7cfb\u7d71\u5728\u54ea\u88e1\uff1f\u8a72\u5982\u4f55\u8a62\u554f\u554f\u984c\uff1f <p>Finlab\u6709\u5c08\u5c6cDiscord\u804a\u5929\u5ba4\uff0c\u53ef\u81f3Discord\u641c\u5c0b\u300cPython \u9078\u80a1\u5be6\u9a57\u5ba4\u300d\uff0c\u6216\u662f\u81f3Finlab\u7db2\u9801\u5de6\u5074\u300c\u793e\u7fa4&gt;Discord \u804a\u5929\u5ba4\u300d\u9032\u5165\u3002</p> <p>\u767c\u554f\u5167\u5bb9\u4ee5\u5e73\u53f0/\u5957\u4ef6\u4f7f\u7528\u76f8\u95dc\u7591\u96e3\u96dc\u75c7\u70ba\u4e3b\uff0c\u4e00\u822c\u7a0b\u5f0f\u8a9e\u6cd5\u6216\u5176\u4ed6\u8207Finlab\u7121\u95dc\u4e4b\u969c\u7919\u53ef\u5148\u591a\u5617\u8a66\u4f7f\u7528google\u6216ChatGPT\u5354\u52a9\u8655\u7406\u3002</p> <p>\u767c\u554f\u6642\uff0c\u9700\u5b8c\u6574\u63cf\u8ff0\u6240\u9047\u5230\u7684\u72c0\u6cc1\uff0c\u53ef\u80fd\u5305\u542b\u4f7f\u7528\u74b0\u5883\u3001\u5957\u4ef6\u7248\u672c\u3001\u4f7f\u7528\u6642\u9593\uff0c\u4e26\u9644\u4e0a\u5b8c\u6574\u7a0b\u5f0f\u78bc\u8207\u932f\u8aa4\u8a0a\u606f\uff0c\u7576\u63d0\u4f9b\u7684\u8cc7\u8a0a\u8d8a\u5b8c\u6574\uff0c\u52a9\u6559\u5c07\u80fd\u8d8a\u8fc5\u901f\u70ba\u60a8\u89e3\u6c7a\u3002\u800c\u82e5\u662f\u91dd\u5c0d\u7b56\u7565\u64b0\u5beb\u7684\u7591\u554f\uff0c\u76e1\u91cf\u4ee5\u5177\u6709\u908f\u8f2f\u7684\u65b9\u5f0f\u63cf\u8ff0\u5b8c\u6574\u6982\u5ff5\uff0c\u5c07\u80fd\u5f97\u5230\u66f4\u6709\u6548\u7387\u7684\u89e3\u6c7a\u65b9\u6848\u3002</p> <p>\u70ba\u5728\u8a0a\u606f\u91cf\u8f03\u5927\u6642\u907f\u514d\u88ab\u6d17\u6389\u3001\u4e14\u6709\u5ef6\u4f38\u8a0e\u8ad6\u6642\u80fd\u8f15\u6613\u8ffd\u8e64\uff0c\u53ef\u591a\u5584\u7528\u8ad6\u58c7\u5340\u9032\u884c\u4e3b\u984c\u5f0f\u8a0e\u8ad6\u3002</p> \u6709\u5efa\u8b70\u7684\u65b0\u529f\u80fd\uff0c\u8981\u5728\u54ea\u88e1\u8a31\u9858\uff1f <p>\u5448\u4e0a\uff0c\u53ef\u81f3Discord\u7684vip\u5c08\u5c6c\u8a31\u9858\u6c60\u7559\u4e0b\u60a8\u7684\u9858\u671b\uff0cVIP\u9650\u5b9a\uff01</p> \u52a9\u6559\u6703\u5728\u591a\u4e45\u5f8c\u56de\u8986\u6211\u7684\u554f\u984c\uff1f\u5ba2\u670d\u670d\u52d9\u6642\u9593\u662f\uff1f <p>\u5ba2\u670d\u6642\u9593\u70ba\u9031\u4e00\u81f3\u9031\u4e949:00~17:00\uff0c\u65bcDiscord\u7559\u4e0b\u7684\u554f\u984c\u5c07\u6703\u5728\u5169\u500b\u5de5\u4f5c\u5929\u5167\u76e1\u91cf\u5b8c\u6210\u56de\u8986\u3002</p> \u54ea\u88e1\u53ef\u4ee5\u5f97\u77e5\u65b0\u7684\u7814\u7a76\u6559\u5b78\u8a0a\u606f\uff1f <p>\u7814\u7a76\u6559\u5b78\u8cc7\u8a0a\u5c07\u5e03\u544a\u65bcDiscord\u7684\u6559\u5b78\u8cc7\u6e90\u983b\u9053\u8207FB\u7c89\u5c08\uff0c\u800c\u7814\u7a76\u6210\u679c\u591a\u4ee5\u90e8\u843d\u683c\u6587\u7ae0\u3001Youtube\u5f71\u97f3\u5f62\u5f0f\u70ba\u4e3b\uff0c\u5747\u53ef\u76f4\u63a5\u8ffd\u8e64\u6536\u85cf\u8d77\u4f86\uff01</p> <p>Finlab\u8ca1\u7d93\u5be6\u9a57\u5ba4Youtube\u983b\u9053\uff1a https://www.youtube.com/@FinlabPython Finlab\u90e8\u843d\u683c\uff1a https://www.finlab.tw/</p>"},{"location":"getting-started/","title":"\u5feb\u901f\u4e0a\u624b","text":""},{"location":"getting-started/#_2","title":"\u5b89\u88dd","text":"<p>\u5728\u4efb\u610f\u5e73\u53f0\u4e0a\uff0c\u7686\u53ef\u5b89\u88dd FinLab Package\uff0c\u6211\u5011\u652f\u63f4 Windows\u3001MacOS\u3001Linux\uff0c\u4e26\u4e14\u751a\u81f3\u662f Pyodide\uff01 \u4ee5\u65b0\u624b\u4f86\u8aaa\uff0c\u63a8\u85a6\u7684\u4f7f\u7528\u65b9\u5f0f\u662f\u76f4\u63a5\u5728 Google Colab\uff0c\u4f86\u4f7f\u7528\u3002 Google Colab \u53ef\u4ee5\u7dda\u4e0a\u7522\u751f\u4e00\u500b\u57f7\u884c Python \u7684\u74b0\u5883\uff0c\u4f7f\u7528\u8005\u4e0d\u9700\u984d\u5916\u5728\u672c\u6a5f\u5b89\u88dd\u4efb\u4f55\u7a0b\u5f0f\uff0c\u5373\u53ef\u958b\u59cb\u4f7f\u7528\u3002</p>  FinLab \u5be6\u9a57\u5ba4 Google Colab \u672c\u6a5f Python Docker \u5b89\u88dd <pre><code>\u6253\u958b\u9078\u80a1\u7b56\u7565\u9801\u9762\nhttps://ai.finlab.tw/strategies\n\u4e26\u9ede\u9078\u300c\u5efa\u7acb\u7b56\u7565\u300d\u5373\u53ef\u958b\u59cb\u4f7f\u7528\u3002\n</code></pre> <pre><code># \u6253\u958b Colab: https://colab.research.google.com/ \u65b0\u589e\u7b46\u8a18\u672c\n# \u5728 Colab \u4e2d\u4efb\u610f Cell \u4e2d\u57f7\u884c\n!pip install finlab &gt; log.txt\n# \u5373\u53ef\n</code></pre> <pre><code># \u5728 anacnoda prompt \u4e2d\u57f7\u884c\npip install finlab\n</code></pre> <p>\u53ef\u80fd\u5b58\u5728\u76f8\u5bb9\u6027\u554f\u984c</p> <p>\u7528\u300cpip install finlab\u300d\u65b9\u6cd5\u5b89\u88dd\uff0c\u53ef\u80fd\u6703\u9020\u6210 Package \u4e0d\u76f8\u5bb9\u7684\u554f\u984c\uff0c\u5047\u5982\u60a8\u5e0c\u671b\u5f97\u5230\u66f4\u7a69\u5b9a\u7684\u7248\u672c\uff0c\u8acb\u53c3\u8003\u300cDocker\u300d\u5b89\u88dd\u3002</p>"},{"location":"getting-started/#1-docker","title":"1. \u5b89\u88dd Docker","text":"<p>\u8acb\u6309\u7167\u4e0b\u5217\u6b65\u9a5f\u5b89\u88dd Docker\uff1a</p> <ul> <li>\u524d\u5f80 Docker \u5b98\u65b9\u7db2\u7ad9\uff1ahttps://www.docker.com/products/docker-desktop\u3002</li> <li>\u5728\u4e0b\u8f09\u9801\u9762\u4e2d\uff0c\u6309\u4e00\u4e0b\u300cDownload Docker Desktop\u300d\u6309\u9215\u3002</li> <li>\u5b8c\u6210\u4e0b\u8f09\u5f8c\uff0c\u57f7\u884c\u5b89\u88dd\u7a0b\u5f0f\u4e26\u6309\u7167\u63d0\u793a\u9032\u884c\u5b89\u88dd\u3002</li> </ul>"},{"location":"getting-started/#2-finlab-jupyter","title":"2. \u4e0b\u8f09 FinLab \u7684 Jupyter \u6620\u50cf\u6a94","text":"<p>\u5728\u5b89\u88dd Docker \u5b8c\u6210\u5f8c\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u5f9e Docker Hub \u4e0b\u8f09 FinLab \u7684 Jupyter \u6620\u50cf\u6a94\uff1a</p> <p>\u958b\u555f\u7d42\u7aef\u6a5f\u6216\u547d\u4ee4\u63d0\u793a\u5b57\u5143\u3002</p> <p>\u8f38\u5165\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u4e0b\u8f09 FinLab \u7684 Jupyter \u6620\u50cf\u6a94\uff1a</p> <p><pre><code>docker pull finlab/jupyter-finlab\n</code></pre> \u6b64\u547d\u4ee4\u5c07\u6703\u5f9e Docker Hub \u4e0b\u8f09\u6620\u50cf\u6a94\uff0c\u8acb\u8010\u5fc3\u7b49\u5f85\u4e0b\u8f09\u5b8c\u6210\u3002</p>"},{"location":"getting-started/#3-88888888-ip","title":"3. \u57f7\u884c\u6620\u50cf\u6a94\u4e26\u9023\u63a5\u5230 8888:8888 \u7684 IP \u4f4d\u5740","text":"<p>\u4e0b\u8f09\u5b8c\u6210\u5f8c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u57f7\u884c\u6620\u50cf\u6a94\uff1a</p> <p><pre><code>docker run -p 8888:8888 finlab/jupyter-finlab\n</code></pre> \u6b64\u547d\u4ee4\u5c07\u6703\u555f\u52d5\u4e00\u500b\u5bb9\u5668\u4e26\u5c07\u5bb9\u5668\u5167\u90e8\u7684 8888 \u57e0\u53e3\u6620\u5c04\u5230\u60a8\u7684\u672c\u6a5f 8888 \u57e0\u53e3\u3002\u8acb\u8010\u5fc3\u7b49\u5f85\u5bb9\u5668\u555f\u52d5\u5b8c\u6210\uff0c\u7d42\u7aef\u6a5f\u4e2d\u5c07\u6703\u986f\u793a\u4e00\u500b URL\uff0c\u4f8b\u5982\uff1a</p> <p><pre><code>http://127.0.0.1:8888/\n</code></pre> \u8acb\u8907\u88fd\u8a72 URL\uff0c\u7a0d\u5f8c\u60a8\u5c07\u4f7f\u7528\u5b83\u4f86\u9023\u63a5\u5230 JupyterLab\u3002</p>"},{"location":"getting-started/#4-jupyterlab-finlab","title":"4. \u4f7f\u7528 JupyterLab \u548c FinLab \u5957\u4ef6","text":"<p>\u73fe\u5728\u60a8\u5df2\u7d93\u6210\u529f\u555f\u52d5\u4e86 JupyterLab\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u9032\u4e00\u6b65\u4f7f\u7528 JupyterLab \u548c FinLab \u5957\u4ef6\uff1a</p> <p>\u5728\u700f\u89bd\u5668\u4e2d\u6253\u958b\u525b\u525b\u8907\u88fd\u7684 URL\u3002\u9019\u5c07\u6703\u986f\u793a JupyterLab \u7684\u4ecb\u9762\u3002 \u5728 JupyterLab \u7684\u4ecb\u9762\u4e2d\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa\u65b0\u7684 Jupyter Notebook \u3002 \u5728 Notebook \u4e2d\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 FinLab \u63d0\u4f9b\u7684\u529f\u80fd\u548c\u5957\u4ef6\u3002FinLab \u662f\u4e00\u500b\u91dd\u5c0d\u91d1\u878d\u6578\u64da\u5206\u6790\u548c\u7b56\u7565\u56de\u6e2c\u7684 Python \u5957\u4ef6\uff0c\u8a73\u7d30\u7684\u4f7f\u7528\u65b9\u6cd5\u8acb\u53c3\u8003 FinLab \u7684\u5b98\u65b9\u6587\u4ef6\u3002 </p>"},{"location":"getting-started/#_3","title":"\u4e0b\u8f09\u8cc7\u6599","text":"<p>\u8f38\u5165\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff0c\u5373\u53ef\u4e0b\u8f09\u8cc7\u6599\u3002\u53ef\u4ee5\u67e5\u8a62\u6709\u54ea\u4e9b\u6b77\u53f2\u8cc7\u6599\u53ef\u4ee5\u4e0b\u8f09\u3002</p> <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9')\n</code></pre> date 0015 0050 0051 0052 0053 2007-04-23 9.54 57.85 32.83 38.4 nan 2007-04-24 9.54 58.1 32.99 38.65 nan 2007-04-25 9.52 57.6 32.8 38.59 nan 2007-04-26 9.59 57.7 32.8 38.6 nan 2007-04-27 9.55 57.5 32.72 38.4 nan"},{"location":"getting-started/#_4","title":"\u64b0\u5beb\u7b56\u7565","text":"<p>\u53ef\u4ee5\u7528\u975e\u5e38\u7c21\u55ae\u7684 <code>Pandas</code> \u8a9e\u6cd5\u4f86\u64b0\u5beb\u7b56\u7565\u908f\u8f2f\uff0c\u4ee5\u5275\u65b0\u9ad8\u7684\u7b56\u7565\u4f86\u8aaa\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u5beb\u6cd5\uff1a</p> <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\n# \u5275\u4e09\u767e\u500b\u4ea4\u6613\u65e5\u65b0\u9ad8\nposition = close &gt;= close.rolling(300).max()\nposition\n</code></pre> date 0015 0050 0051 0052 0053 2007-04-23 00:00:00 False False False False False 2007-04-24 00:00:00 False False False False False 2007-04-25 00:00:00 False False False False False 2007-04-26 00:00:00 False False False True False 2007-04-27 00:00:00 False False False False False <p>\u9019\u908a\u7684 <code>position</code> \u662f\u4e00\u500b False/True \u7684\u67e5\u8a62\u8868\uff0c\u7576\u6578\u503c\u70ba True \uff0c\u4ee3\u8868\u8a72\u80a1\u7968\u5728\u7576\u5929\u6709\u5275\u65b0\u9ad8\uff0c\u800c\u6578\u5b57 False \u5247\u4ee3\u8868\u6c92\u6709\u5275\u65b0\u9ad8\u3002\u7531\u65bc\u5275\u65b0\u9ad8\u7684\u80a1\u7968\u5f88\u5c11\uff0c\u4e0a\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c\u53ea\u6709\u5c11\u6578\u80a1\u7968\u7684\u6578\u503c\u6703\u662f True\u3002</p> <p>\u5047\u8a2d\u6211\u5011\u5e0c\u671b\u6bcf\u500b\u6708\u5e95\uff0c\u641c\u5c0b\u4e0a\u8868\u4e2d\u6578\u503c\u70ba True \u7684\u80a1\u7968\u4e26\u4e14\u8cb7\u5165\u6301\u6709\u4e00\u500b\u6708\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u8a9e\u6cd5\uff1a</p>"},{"location":"getting-started/#_5","title":"\u56de\u6e2c\u7e3e\u6548","text":"<pre><code>from finlab import backtest\nreport = backtest.sim(position, resample='M')\nreport.display()\n</code></pre>"},{"location":"learning_ref/","title":"Learning ref","text":""},{"location":"learning_ref/#_1","title":"\u8cc7\u6599\u8655\u7406","text":"<ul> <li>10\u5206\u9418\u4e0a\u624bpandas</li> <li>pandas \u6578\u64da\u5206\u6790\u91cd\u91cf\u5305</li> <li>numpy \u77e9\u9663\u904b\u7b97</li> <li>scipy \u6578\u5b78\u904b\u7b97</li> </ul>"},{"location":"learning_ref/#_2","title":"\u91cf\u5316\u4ea4\u6613","text":"<ul> <li>finlab-python finlab\u5927\u672c\u71df</li> <li>ffn \u91cf\u5316\u8a08\u7b97\u51fd\u6578\u5eab</li> <li>ta-lib \u6280\u8853\u6307\u6a19\u51fd\u6578\u5eab</li> <li>pandas-ta \u6280\u8853\u6307\u6a19\u51fd\u6578\u5eab </li> <li>vectorbt \u91cf\u5316\u7b56\u7565\u5206\u6790</li> <li>Riskfolio-Lib \u8cc7\u7522\u914d\u7f6e\u6700\u4f73\u5316</li> <li>PyPortfolioOpt \u8cc7\u7522\u914d\u7f6e\u6700\u4f73\u5316</li> <li>Qlib \u5fae\u8edfAI\u91cf\u5316\u4ea4\u6613\u6846\u67b6</li> </ul>"},{"location":"learning_ref/#_3","title":"\u8cc7\u6599\u8996\u89ba\u5316","text":"<ul> <li>matplotlib \u975c\u614b\u5716\u8868</li> <li>pandas \u975c\u614b\u5716\u8868</li> <li>seaborn \u975c\u614b\u5716\u8868</li> <li>plotly \u52d5\u614b\u5716\u8868</li> </ul>"},{"location":"learning_ref/#_4","title":"\u6a5f\u5668\u5b78\u7fd2","text":"<ul> <li>scikit-learn \u6a5f\u5668\u5b78\u7fd2\u6846\u67b6</li> <li>keras \u6a5f\u5668\u5b78\u7fd2\u6846\u67b6</li> <li>tensorflow \u6a5f\u5668\u5b78\u7fd2\u6846\u67b6</li> <li>pytorch \u6a5f\u5668\u5b78\u7fd2\u6846\u67b6</li> <li>xgboost \u6a5f\u5668\u5b78\u7fd2\u6f14\u7b97\u6cd5</li> <li>tuneta \u53c3\u6578\u6700\u4f73\u5316</li> </ul>"},{"location":"roadmap/","title":"Roadmap","text":""},{"location":"roadmap/#2022-q3","title":"2022-Q3","text":"<ul> <li>\u7db2\u9801\u9078\u80a1\u6e05\u55ae\u652f\u63f4\u505a\u7a7a</li> <li>\u5238\u5546\u5206\u9ede\u8ab2\u7a0b\u88fd\u4f5c</li> <li>mae mfe analysis refactor</li> <li>report refactor</li> </ul>"},{"location":"roadmap/#2022-q4","title":"2022 Q4","text":"<ul> <li>\u6a5f\u5668\u5b78\u7fd2helpers</li> <li>\u76e4\u4e2d\u56de\u6e2c</li> </ul>"},{"location":"roadmap/#2023-q1","title":"2023 Q1","text":"<ul> <li>\u5168\u81ea\u52d5\u4e0b\u55ae\u6a5f</li> <li>\u652f\u63f4\u671f\u8ca8\u98a8\u96aa\u5c0d\u6c96</li> </ul>"},{"location":"details/backtest/","title":"\u6b77\u53f2\u56de\u6e2c","text":"<p>\u4e00\u884c\u57f7\u884c\u5f37\u5927\u7684\u56de\u6e2c\u7cfb\u7d71\uff0c\u7522\u751f <code>position</code> \u7684\u6bcf\u65e5\u8a0a\u865f\uff0c\u5e36\u5165 <code>finlab.backtest.sim</code> \u9032\u884c\u56de\u6e2c\uff0c\u5feb\u901f\u5f97\u5230\u98a8\u96aa\u5831\u916c\u5206\u6790\u3001\u9078\u80a1\u6e05\u55ae\uff01</p>"},{"location":"details/backtest/#_1","title":"\u56de\u6e2c\u901f\u901f\u4e0a\u624b","text":"<p>\u4f60\u76f8\u4fe1\u5e74\u5831\u916c +23% \u7684\u7b56\u7565\uff0c\u7a0b\u5f0f\u78bc\u4e09\u884c\u5c31\u641e\u5b9a\u55ce\uff1f\u8b93 FinLab \u6253\u958b\u4f60\u7684\u773c\u754c\uff0c\u63a5\u4e0b\u4f86\u6211\u5011\u53ef\u4ee5\u5efa\u69cb\u4e00\u500b\u7b56\u7565\uff0c\u7b56\u7565\u6bcf\u500b\u6708\u6703\u6aa2\u67e5\u80a1\u7968\u6e05\u55ae\uff0c\u6301\u6709\u50f9\u683c\u5c0f\u65bc 6 \u5143\u7684\u80a1\u7968\uff0c\u5254\u9664\u50f9\u683c\u5927\u65bc 6 \u5143\u7684\u80a1\u7968\uff0c\u6bcf\u500b\u6708\u5e95\u57f7\u884c\uff0c\u5468\u800c\u5fa9\u59cb\u3002\u4f86\u56de\u6e2c\u770b\u770b\u9019\u6a23\u7684\u7e3e\u6548\u5230\u5e95\u5982\u4f55\uff1a</p> <pre><code>from finlab import data\nfrom finlab import backtest\n# \u53ea\u8cb7\u5165\u50f9\u683c\u5c0f\u65bc 6 \u5143\u7684\u80a1\u7968\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = close &lt; 6\n# \u56de\u6e2c\uff0c\u6bcf\u6708\u5e95(M)\u91cd\u65b0\u8abf\u6574\u80a1\u7968\u6b0a\u91cd\nreport = backtest.sim(position, resample='M', name=\"\u50f9\u683c\u5c0f\u65bc6\u7684\u80a1\u7968\")\n</code></pre> <p></p> <p>\u4e0a\u50b3\u56de\u6e2c\u8cc7\u6599\u5230\u96f2\u7aef\u5e73\u53f0\u5f8c\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u9ede\u9078\u4e0b\u65b9\u7684\u300c\u9078\u80a1\u6e05\u55ae\u300d\u4f86\u67e5\u770b\u4eca\u5929\u7684\u6301\u80a1\u72c0\u6cc1\uff0c\u751a\u81f3\u662f\u624b\u52d5\u8ddf\u55ae\uff0c\u4f86\u5c07\u865b\u64ec\u7684\u7372\u5229\u8b8a\u6210\u73fe\u5be6\u3002</p> <p></p>"},{"location":"details/backtest/#_2","title":"\u986f\u793a\u7b56\u7565\u56de\u6e2c\u7d50\u679c","text":"<p><pre><code>report.display()\n</code></pre> </p>"},{"location":"details/backtest/#_3","title":"\u53d6\u5f97\u7b56\u7565\u4ea4\u6613\u7d00\u9304","text":""},{"location":"details/backtest/#trade_record","title":"trade_record \u8868\u683c\u91cd\u9ede\u6b04\u4f4d\u8aaa\u660e","text":"<p><pre><code>report.get_trades()\n</code></pre> * exit_sig_date:\u51fa\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002 * entry_sig_date:\u9032\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002 * entry_date:\u9032\u5834\u65e5\u3002 * exit_date:\u51fa\u5834\u65e5\u3002 * period:\u6301\u6709\u5929\u6578\u3002 * position: \u6301\u6709\u4f54\u6bd4\u3002 * return:\u5831\u916c\u7387\u3002 * mdd:\u6301\u6709\u671f\u9593\u6700\u5927\u56de\u64a4\u3002 * mae:\u6301\u6709\u671f\u9593\u6700\u5927\u4e0d\u5229\u5e45\u5ea6\u3002 * g_mfe:\u6301\u6709\u671f\u9593\u6700\u5927\u6709\u5229\u5e45\u5ea6\u3002 * b_mfe:mae\u767c\u751f\u524d\u7684\u6700\u5927\u6709\u5229\u5e45\u5ea6\u3002</p>"},{"location":"details/backtest/#_4","title":"\u986f\u793a\u6ce2\u52d5\u5206\u6790\u5716","text":"<p><pre><code>report.display_mae_mfe_analysis()\n</code></pre> </p>"},{"location":"details/backtest/#_5","title":"\u7b56\u7565\u6d41\u52d5\u6027\u98a8\u96aa\u6aa2\u6e2c","text":"<p><pre><code>from finlab.analysis.liquidityAnalysis import LiquidityAnalysis\n# \u4ea4\u6613\u7d00\u9304\u9032\u51fa\u5834\u6210\u4ea4\u5f35\u6578\u5927\u65bc1000\u5f35\u7684\u6bd4\u4f8b, \u6210\u4ea4\u91d1\u984d\u5927\u65bc1000000\u5143\u7684\u6bd4\u4f8b\uff0c\u6aa2\u6e2c\u8cc7\u91d1\u90e8\u4f4d\u80c3\u7d0d\u91cf\nreport.run_analysis(LiquidityAnalysis(required_volume=100000, required_turnover=1000000))\n</code></pre> </p>"},{"location":"details/backtest/#_6","title":"\u66f4\u591a\u56de\u6e2c\u7bc4\u4f8b","text":""},{"location":"details/backtest/#_7","title":"\u5275\u65b0\u9ad8\u7b56\u7565","text":"<p>\u80a1\u7968\u6700\u5fcc\u8af1\u5c31\u662f\u300c\u8cb7\u9ad8\u8ce3\u4f4e\u300d\uff0c\u6c72\u6c72\u71df\u71df\uff0c\u4f46\u662f\u4f60\u6709\u6c92\u6709\u60f3\u904e\uff0c\u5927\u5bb6\u90fd\u6015\u8cb7\u9ad8\uff0c\u53cd\u800c\u8981\u8cb7\u66f4\u9ad8\uff1f \u5275\u65b0\u9ad8\u7684\u80a1\u7968\uff0c\u7531\u65bc\u53d7\u5230\u5e02\u5834\u7684\u95dc\u6ce8\uff0c\u4e0a\u6f32\u52d5\u80fd\u975e\u5e38\u5f37\uff0c\u6240\u4ee5\u9078\u64c7\u9019\u4e9b\u80a1\u7968\uff0c\u5c31\u80fd\u5e36\u4f86\u4e0d\u932f\u7684\u5831\u916c\u7387\u3002 \u4e0b\u65b9\u7684\u689d\u4ef6\uff0c\u4f7f\u7528\u4e86 <code>pd.DataFrame</code> \u88e1\u7684\u529f\u80fd <code>rolling(250).max()</code>\uff0c\u4ee3\u8868 250 \u5929\u7684\u6700\u9ad8\u50f9\uff0c \u5047\u5982\u4eca\u5929\u7684\u6536\u76e4\uff0c\u7b49\u65bc 250 \u5929\u7684\u6700\u9ad8\u50f9\uff0c\u5c31\u4ee3\u8868\u5275\u65b0\u9ad8\u4e86\uff01</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u5275 250 \u5929\u65b0\u9ad8\u7684\u80a1\u7968\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = (close == close.rolling(250).max())\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\uff0c\u9078\u51fa\u7576\u5929\u5275\u65b0\u9ad8\u80a1\u7968\nsim(position, resample='M', name=\"\u5275\u5e74\u65b0\u9ad8\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/backtest/#rsi","title":"\u9ad8 RSI \u6280\u8853\u6307\u6a19\u7b56\u7565","text":"<p>\u4e0a\u8ff0\u7b56\u7565\u6703\u9078\u51fa\u5f88\u591a\u6a94\u6a19\u7684\uff0c\u8981\u662f\u6211\u5011\u53ea\u60f3\u8981\u9078\u51fa 20 \u6a94\u8981\u600e\u9ebc\u5beb\u5462\uff1f\u9019\u500b\u7b56\u7565\u6211\u5011\u53ef\u4ee5\u5c07 RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\u7d0d\u5165\u7d44\u5408\uff0c\u4e26\u4e14\u6301\u6709\u4e00\u9031\uff0c\u4f86\u8a66\u8a66\u770b\u6548\u679c\u5982\u4f55\u3002\u6211\u5011\u53ef\u4ee5\u7528 <code>data.indicator</code> \u4f86\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI\uff0c\u4e5f\u53ef\u4ee5\u7528 <code>rsi.is_largest</code> \u4f86\u8a08\u7b97\u6b64\u80a1\u7968\u7684 RSI \u662f\u5426\u662f\u6700\u5927\u7684 20 \u6a94\u3002</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\nrsi = data.indicator('RSI')\nposition = rsi.is_largest(20)\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/backtest/#_8","title":"\u4e56\u96e2\u7387\u548c\u8ca1\u5831\u6ffe\u7db2\u7b56\u7565","text":"<p>\u53ef\u4ee5\u4e00\u6b21\u4f7f\u7528\u5169\u7a2e\u4e0d\u540c\u7684\u6307\u6a19\u4f86\u9078\u80a1\u55ce\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u800c\u4e14\u9019\u5169\u500b\u6307\u6a19\uff0c\u9084\u53ef\u4ee5\u662f\u6bcf\u5b63\u7684\u8ca1\u5831\u8ddf\u6bcf\u5929\u7684\u50f9\u683c\uff0c\u6df7\u548c\u689d\u4ef6\u9078\u80a1\uff0c\u7531\u65bc\u4e0b\u65b9\u7684 <code>roe</code> \u548c <code>close</code> \u4e26\u4e0d\u662f <code>pd.DataFrame</code> \u800c\u662f <code>finlab.dataframe.FinlabDataFrame</code> \uff0c\u7576\u5728\u505a\u689d\u4ef6\u904b\u7b97\uff0c\u4f8b\u5982\u4ea4\u96c6\u3001\u806f\u96c6\uff08and or\uff09\u6642\uff0c\u4e0d\u540c\u983b\u7387\u7684 index \u6703\u88ab\u53d6\u9023\u96c6\u4e26\u4e14\u6574\u5408\uff0c\u6240\u4ee5\u4f7f\u7528\u8005\u4e0d\u9700\u8981\u601d\u8003\uff0c\u7a76\u7adf\u8cc7\u6599\u662f\u300c\u5b63\u300d\u9084\u662f\u300c\u6708\u300d\u9084\u662f\u300c\u65e5\u300d\uff0c\u53ef\u4ee5\u76f4\u63a5\u7576\u4f5c index \u548c columns \u662f\u5c0d\u9f4a\u7684\uff0c\u76f4\u63a5\u904b\u7b97\uff08\u7a0b\u5f0f\u6703\u81ea\u52d5\u60f3\u8fa6\u6cd5\uff09\u3002</p> <p>\u4e0b\u9762\u7684\u7b56\u7565\uff0c\u5229\u7528 <code>close / close.shift(60)</code> \u8a08\u7b97\u4e56\u96e2\u7387\uff0c\u4e26\u53d6 30 \u6a94\u80a1\u7968\u51fa\u4f86\uff0c\u518d\u7528 ROE \u7576\u6ffe\u7db2\uff0c\u9078\u64c7 ROE \u70ba\u6b63\u7684\u80a1\u7968\u3002</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\")\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = (\n(close / close.shift(60)).is_largest(30) # \u9078\u51fa\u4e56\u96e2\u7387\u524d 30 \u540d\u7684\u80a1\u7968\n&amp; (roe &gt; 0) # \u9078\u51fa ROE \u5927\u65bc 0 \u7684\u80a1\u7968\n)\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='M', name=\"\u4e56\u96e2\u7387\u548cROE\u6ffe\u7db2\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/backtest_decorator/","title":"\u8a08\u7b97\u9078\u80a1\u689d\u4ef6","text":"<p>\u7531\u65bc\u6211\u5011\u4e0b\u8f09\u7684\u8ca1\u7d93\u8cc7\u6599\uff0c\u591a\u534a\u662f\u7e31\u8ef8\u70ba\u65e5\u671f\uff0c\u6a6b\u8ef8\u70ba\u80a1\u7968\u7684\u8868\u683c\uff0c\u9019\u7a2e\u8868\u683c\u7684\u540d\u7a31\u662f <code>pd.DataFrame</code>\uff0c\u662f\u5728 Python \u505a\u904b\u7b97\u6642\u5e38\u6703\u7528\u5230\u7684\u5de5\u5177\u3002\u5047\u5982\u60a8\u6c92\u6709\u63a5\u89f8\u904e\uff0c\u5efa\u8b70\u60a8\u5148\u53c3\u800310\u5206\u9418\u5b78\u6703Pandas\u7684\u6559\u5b78\uff0c\u5148\u4f86\u5c0d\u8868\u683c\u64cd\u4f5c\u6709\u4e00\u5b9a\u7684\u77ad\u89e3\u3002</p> <p>\u77ad\u89e3\u4e86 Pandas \u7684\u57fa\u672c\u539f\u7406\uff0c\u6211\u5011\u5728\u539f\u672c\u7684 DataFrame \u4e4b\u4e0a\uff0c\u53c8\u505a\u4e86\u5f88\u591a\u9078\u80a1\u5c08\u7528\u7684\u529f\u80fd\uff0c\u8b93\u5927\u5bb6\u53ef\u4ee5\u7528\u7c21\u77ed\u7684\u7a0b\u5f0f\u78bc\uff0c\u6709\u5f37\u5927\u7684\u6548\u679c\uff0c\u9019\u500b\u589e\u5f37\u7248\u7684 DataFrame \u53eb\u505a FinlabDataFrame!</p>"},{"location":"details/backtest_decorator/#finlabdataframe","title":"\u70ba\u4ec0\u9ebc\u8981\u6709 FinlabDataFrame?","text":"<p>\u958b\u767c\u7b56\u7565\u6642\uff0c\u53ef\u4ee5\u7528 FinlabDataFrame \u7c21\u6613\u7684\u8a9e\u6cd5\u5b8c\u6210\u8907\u96dc\u7684\u9078\u80a1\u689d\u4ef6\uff0c\u8b93\u958b\u767c\u7b56\u7565\u66f4\u7c21\u6f54\uff01</p>"},{"location":"details/backtest_decorator/#dataframe","title":"\u8207\u4e00\u822c Dataframe \u4e0d\u540c\u4e4b\u8655\uff1a","text":"<p>\u904b\u7b97\u7686\u8ddf\u4e00\u822c\u7684 <code>pd.DataFrame</code> \u4e00\u6a21\u4e00\u6a23\uff0c\u9664\u4e86\u4ee5\u4e0b\u5169\u500b\u65b9\u9762</p> <ol> <li>\u591a\u4e86\u4e00\u4e9b\u984d\u5916\u7684\u51fd\u5f0f\uff0c\u5982 <code>df.is_largest()</code>, <code>df.sustain()</code> \u7b49\uff0c\u4e0b\u65b9\u6703\u6709\u66f4\u8a73\u7d30\u7684\u4ecb\u7d39\u3002</li> <li>\u5728\u505a\u56db\u5247\u904b\u7b97\u3001\u4e0d\u7b49\u5f0f\u904b\u7b97\u524d\uff0c\u6703\u81ea\u52d5\u5c07 df1\u3001df2 \u5c0d\u9f4a\u904b\u7b97\uff0c\u4e0b\u65b9\u6703\u6709\u66f4\u8a73\u7d30\u7684\u4ecb\u7d39\u3002</li> </ol>"},{"location":"details/backtest_decorator/#finlabdataframe_1","title":"\u5275\u5efa FinlabDataFrame","text":"<p>\u53ea\u8981\u4f7f\u7528 <code>finlab.data.get()</code> \u6240\u7372\u5f97\u7684\u8cc7\u6599\uff0c\u7686\u70ba <code>FinlabDataFrame</code> \u683c\u5f0f\u3002</p> <p>\u5047\u5982\u4f60\u6709\u73fe\u6210\u7684 Pandas DataFrame \uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u8a9e\u6cd5\uff0c\u5c07\u539f\u672c\u7684 <code>Dataframe</code> \u8f49\u63db\u6210 <code>FinlabDataFrame</code> <pre><code>import pandas as pd\nfrom finlab.dataframe import FinlabDataFrame\ndf = pd.DataFrame()\ndf_finlab = FinlabDataFrame(df)\n</code></pre></p> <p>\u63a5\u4e0b\u4f86\u6211\u5011\u5c31\u4f86\u770b\u770b\uff0c <code>FinlabDataFrame</code> \u6709\u54ea\u4e9b\u597d\u7528\u7684\u529f\u80fd\u5427\uff01</p>"},{"location":"details/backtest_decorator/#_2","title":"\u65e5\u6708\u5b63\u4e0d\u7b49\u5f0f\u3001\u56db\u5247\u904b\u7b97","text":"<p>\u8207\u4e00\u822c\u7684 <code>pd.DataFrame</code> \u975e\u5e38\u985e\u4f3c\uff0c\u4e5f\u5c31\u662f\u5c0d\u65bc\u6bcf\u500b\u76f8\u540c\u4f4d\u7f6e\u7684\u6578\u5b57\u53bb\u505a\u64cd\u4f5c\u3002 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u904b\u7b97\u7b26\u865f\u9032\u884c\u7b97\u8853\u904b\u7b97\u3001\u6bd4\u8f03\u904b\u7b97\u548c\u908f\u8f2f\u904b\u7b97\u3002</p> <ul> <li>\u7b97\u8853\u904b\u7b97\u7b26\u865f\uff1a+, -, *, /<ul> <li>\u4f7f\u7528 + \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c07\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u76f8\u52a0\u3002</li> <li>\u4f7f\u7528 - \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c07\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u76f8\u6e1b\u3002</li> <li>\u4f7f\u7528 * \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c07\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u76f8\u4e58\u3002</li> <li>\u4f7f\u7528 / \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c07\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u76f8\u9664\u3002</li> </ul> </li> <li>\u6bd4\u8f03\u904b\u7b97\u7b26\u865f\uff1a&gt;, &gt;=, ==, &lt;, &lt;=<ul> <li>\u4f7f\u7528 &gt; \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u6bd4\u8f03\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u662f\u5426\u5927\u65bc\u3002</li> <li>\u4f7f\u7528 &gt;= \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u6bd4\u8f03\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u662f\u5426\u5927\u65bc\u7b49\u65bc\u3002</li> <li>\u4f7f\u7528 == \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u6bd4\u8f03\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u662f\u5426\u76f8\u7b49\u3002</li> <li>\u4f7f\u7528 &lt; \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u6bd4\u8f03\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u662f\u5426\u5c0f\u65bc\u3002</li> <li>\u4f7f\u7528 &lt;= \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u6bd4\u8f03\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u662f\u5426\u5c0f\u65bc\u7b49\u65bc\u3002</li> </ul> </li> <li>\u908f\u8f2f\u904b\u7b97\u7b26\u865f\uff1a&amp;, |, ~<ul> <li>\u4f7f\u7528 &amp; \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c0d\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u9032\u884c\u300c\u4e14\u300d\u908f\u8f2f\u904b\u7b97\u3002</li> <li>\u4f7f\u7528 | \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c0d\u5169\u500b DataFrame \u4e2d\u5c0d\u61c9\u4f4d\u7f6e\u7684\u5143\u7d20\u9032\u884c\u300c\u6216\u300d\u908f\u8f2f\u904b\u7b97\u3002</li> <li>\u4f7f\u7528 ~ \u904b\u7b97\u7b26\u865f\u53ef\u4ee5\u5c0d\u4e00\u500b DataFrame \u4e2d\u7684\u5143\u7d20\u9032\u884c\u300c\u975e\u300d\u908f\u8f2f\u904b\u7b97\u3002</li> </ul> </li> </ul> <p>\u4ee5\u4e0b\u5c31\u662f\u4e00\u500b\u7c21\u55ae\u7684\u4f8b\u5b50\uff0c\u64b0\u5beb\u9078\u80a1\u689d\u4ef6\uff0c\u70ba\u6536\u76e4\u50f9\u4ecb\u65bc 10 ~ 100 \u7684\u80a1\u7968 <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\n# \u6536\u76e4\u50f9\u4f4d\u65bc 10 ~ 100 \u4e4b\u9593\nbetween_10_100 = (close &gt; 10) &amp; (close &lt; 100)\n</code></pre></p> <p>\u8cc7\u6599\u983b\u7387\u5c0d\u9f4a\uff0c\u8f15\u9b06\u89e3\u6c7a</p> <p>\u7576\u8cc7\u6599\u65e5\u671f\u6c92\u6709\u5c0d\u9f4a\uff08\u4f8b\u5982: \u8ca1\u5831 vs \u6536\u76e4\u50f9 vs \u6708\u5831\uff09\u6642\uff0c\u60a8\u4e0d\u9700\u8981\u4f7f\u7528<code>df1.reindex(df2)</code>\u5c07\u8cc7\u6599\u5c0d\u9f4a\uff0c\u56e0\u70ba <code>FinlabDataFrame</code> \u6703\u81ea\u52d5\u5e6b\u4f60\u8655\u7406\uff0c\u904b\u7b97\u5143\u7d20\u524d\uff0c\u6703\u5148\u9032\u884c\u5169\u6b65\u7a0b\u5e8f\uff1a</p> <ul> <li>\u5c07 index \u7684\u65e5\u671f\u53d6\u806f\u96c6\uff0c\u4e26\u5c07\u7f3a\u503c\u505a\u4ee5\u6700\u8fd1\u7684\u6578\u503c\u586b\u88dc (<code>forward fill</code>)\uff0c\u5f15\u542b\u7684\u610f\u601d\u662f\uff0c\u5047\u5982\u7576\u5929\u6c92\u6709\u8cc7\u6599\uff0c\u5247\u4f7f\u7528\u8fd1\u671f\u516c\u5e03\u7684\u6578\u64da\u3002</li> <li>\u5c07 column \u80a1\u7968\u4ee3\u865f\u53d6\u4ea4\u96c6\uff0c\u5f15\u542b\u7684\u610f\u601d\u662f\uff0c\u80a1\u7968\u5047\u5982\u6c92\u6709\u76f8\u5c0d\u61c9\u7684\u8ca1\u52d9\u8cc7\u6599\uff0c\u5c31\u6703\u88ab\u5254\u9664\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u7bc4\u4f8b\uff1a<code>cond1</code> \u8207 <code>cond2</code> \u5206\u5225\u70ba\u300c\u6bcf\u5929\u300d\uff0c\u548c\u300c\u6bcf\u5b63\u300d\u7684\u8cc7\u6599\uff0c\u5047\u5982\u8981\u53d6\u4ea4\u96c6\u7684\u6642\u9593\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8a9e\u6cd5\uff1a</p> <pre><code>from finlab import data\n# \u53d6\u5f97 FinlabDataFrame\nclose = data.get('price:\u6536\u76e4\u50f9')\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\n# \u904b\u7b97\u5169\u500b\u9078\u80a1\u689d\u4ef6\u4ea4\u96c6\ncond1 = close &gt; 37\ncond2 = roa &gt; 0\ncond_1_2 = cond1 &amp; cond2\n</code></pre> <p>\u64f7\u53d6 1101 \u53f0\u6ce5 \u7684\u8a0a\u865f\u5982\u4e0b\u5716\uff0c\u53ef\u4ee5\u770b\u5230 <code>cond1</code> \u8ddf <code>cond2</code> \u8a0a\u865f\u7684\u983b\u7387\u96d6\u7136\u4e0d\u76f8\u540c\uff0c\u4f46\u662f\u7531\u65bc <code>cond1</code> \u8ddf <code>cond2</code> \u662f <code>FinlabDataFrame</code>\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u53d6\u4ea4\u96c6\uff0c\u800c\u4e0d\u7528\u8655\u7406\u8cc7\u6599\u983b\u7387\u5c0d\u9f4a\u7684\u554f\u984c\u3002</p> <p></p> <p>\u70ba\u4f55\u4e0a\u9762\u7bc4\u4f8b\u7684 cond_1_2 \u7684 row \u6578\u91cf\u6bd4 cond1 \u5c11\uff1f\u4e0d\u662f\u53d6\u806f\u96c6\u55ce\uff1f</p> <p>\u4e0a\u8ff0 cond1 \u7684\u8cc7\u6599\u5f9e 2010 \u958b\u59cb\uff0c\u800c cond2 \u7684\u8cc7\u6599\u5f9e 2013 \u5e74\u958b\u59cb\uff0c\u6240\u4ee5\u7576\u5169\u500b dataframe \u5408\u4f75\u6642\uff0c\u65b0\u7684\u8cc7\u6599\u53ea\u6703\u64f7\u53d6\u4e0a\u8ff0\u5169\u7a2e\u8cc7\u6599\u7684\u91cd\u758a\u7684\u6642\u9593\uff0c\u6240\u4ee5\u65b0\u8cc7\u6599\u8d77\u4f7f\u65e5\u70ba 2013 \u5e74\u958b\u59cb\uff01\u800c\u975e2010 \u5e74\uff0c\u9020\u6210\u8cc7\u6599 row \u7684\u6578\u91cf\u6bd4 cond1 \u5c11\u5594\uff01</p>"},{"location":"details/backtest_decorator/#average","title":"\u5747\u7dda (average)","text":"<p>\u53d6 n \u7b46\u79fb\u52d5\u5e73\u5747\uff0c\u82e5\u80a1\u7968\u5728\u6642\u9593\u7a97\u683c\u5167\uff0c\u6709 N/2 \u7b46 NaN\uff0c\u5247\u6703\u7522\u751f NaN\u3002</p> <p>\u80a1\u50f9\u572810\u65e5\u5747\u7dda\u4e4b\u4e0a<pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nsma = close.average(10)\ncond = close &gt; sma\n</code></pre> \u53ea\u9700\u8981\u7c21\u55ae\u7684\u8a9e\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5c07\u5176\u4e2d\u4e00\u90e8\u5206\u7684\u8a0a\u865f\u7e6a\u88fd\u51fa\u4f86\u6aa2\u67e5\uff1a <pre><code>import matplotlib.pyplot as plt\nclose.loc['2021', '2330'].plot()\nsma.loc['2021', '2330'].plot()\ncond.loc['2021', '2330'].mul(20).add(500).plot()\nplt.legend(['close', 'sma', 'cond'])\n</code></pre> </p>"},{"location":"details/backtest_decorator/#n-is_largest","title":"\u6578\u503c\u6700\u5927\u7684 n \u6a94\u80a1\u7968(is_largest)","text":"<p><code>FinlabDataFrame.is_largest(n)</code> \u53d6\u6bcf\u5217\u524d n \u7b46\u5927\u7684\u6578\u503c\uff0c\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5927\u7684\u80a1\u7968</p> <p></p> \u9078\u80a1\u7bc4\u4f8b\uff1a\u6bcf\u5b63 ROA \u524d 10 \u540d\u7684\u80a1\u7968<pre><code>from finlab import data\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\ngood_stocks = roa.is_largest(1)\n</code></pre> date 000116 000538 000616 000700 000779 2013-Q1 False False True False False 2013-Q2 False False False False True 2013-Q3 False True False False False 2013-Q4 False False False True False 2014-Q1 True False False False False"},{"location":"details/backtest_decorator/#n-is_smallest","title":"\u6578\u503c\u6700\u5c0f\u7684 n \u6a94\u80a1\u7968(is_smallest)","text":"<p>\u53d6\u6bcf\u5217\u524d n \u7b46\u5c0f\u7684\u6578\u503c\uff0c\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5c0f\u7684\u80a1\u7968\u3002</p> \u7bc4\u4f8b\uff1a\u80a1\u50f9\u6de8\u503c\u6bd4\u6700\u5c0f\u7684 10 \u6a94\u80a1\u7968<pre><code>from finlab import data\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\ncheap_stocks = pb.is_smallest(10)\n</code></pre>"},{"location":"details/backtest_decorator/#hold_until","title":"\u8a0a\u865f\u9032\u51fa\u5834(hold_until)","text":"<p>\u9019\u662f\u6240\u6709\u7b56\u7565\u64b0\u5beb\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u8a9e\u6cd5\u7cd6\uff0c\u7528\u6cd5\u70ba\uff1a</p> <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nbuy = close &gt; close.averate(5)\nsell = close &lt; close.average(20)\nposition = buy.hold_until(sell)\n</code></pre> <p>\u4e0a\u8ff0\u8a9e\u6cd5\u4e2d <code>buy</code> \u70ba\u9032\u5834\u8a0a\u865f\uff0c\u800c <code>sell</code> \u662f\u51fa\u5834\u8a0a\u865f\u3002\u6240\u4ee5 <code>buy.hold_until(sell)</code> \uff0c\u5c31\u662f\u9032\u5834\u8a0a\u865f\u70ba <code>True</code> \u6642\uff0c\u8cb7\u5165\u4e26\u6301\u6709\u8a72\u6a94\u80a1\u7968\uff0c\u76f4\u5230\u51fa\u5834\u8a0a\u865f\u70ba <code>True</code> \u5247\u8ce3\u51fa\u3002</p> <p></p> <p>\u505c\u640d\u505c\u5229</p> <p>\u5229\u7528 <code>hold_until</code> \u9664\u4e86\u5ba2\u88fd\u5316\u51fa\u5834\u4ee5\u5916\uff0c\u9084\u53ef\u4ee5\u8a2d\u5b9a\u984d\u5916\u7684\u505c\u640d\u505c\u5229\uff0c\u4f7f\u7528\u65b9\u6cd5\u70ba\uff1a</p> <pre><code>buy.hold_until(sell, stop_loss=0.1, take_profit=0.2, trade_at_price='close')\n</code></pre> <p>\u4ee5\u6536\u76e4\u50f9\u7576\u6210\u4f9d\u64da\uff0c\u5047\u5982\u9032\u5834\u5f8c\uff0c\u89f8\u767c\u505c\u640d10%\uff0c\u7372\u91cb\u89f8\u767c\u505c\u522920%\uff0c\u5247\u5c31\u7b97\u6c92\u6709\u8ce3\u51fa\u8a0a\u865f\uff0c\u4e5f\u6703\u57f7\u884c\u8ce3\u51fa\u7684\u52d5\u4f5c\u3002</p> <p>\u985e\u80a1\u8f2a\u52d5</p> <p>\u53ef\u4ee5\u8b93\u4f60\u6700\u591a\u9078\u64c7 N \u6a94\u80a1\u7968\u505a\u8f2a\u52d5\uff0c\u7576\u6301\u6709\u80a1\u7968\u6578\u91cf\u7b49\u65bc N \u6642\uff0c\u5c07\u4e0d\u5728\u984d\u5916\u8cb7\u5165\u65b0\u7684\u6301\u80a1\uff0c\u800c\u662f\u4fdd\u6301\u7576\u524d\u90e8\u4f4d\uff0c\u76f4\u5230\u60a8\u7684\u90e8\u4f4d\u7576\u4e2d\u767c\u751f\u8ce3\u51fa\u8a0a\u865f\uff0c\u624d\u6703\u518d\u6839\u64da\u65b0\u7684\u8cb7\u5165\u8a0a\u865f\uff0c\u8490\u96c6\u65b0\u7684\u80a1\u7968\uff0c\u76f4\u5230\u6301\u6709\u80a1\u7968\u6578\u91cf\u7b49\u65bc N \u6642\u505c\u6b62\u3002 \u96d6\u7136\u6b64\u529f\u80fd\u4e4d\u770b\u4e4b\u4e0b\u5f88\u8907\u96dc\uff0c\u4f46\u5176\u5be6\u53ea\u8981\u8a2d\u5b9a\u4e00\u500b\u984d\u5916\u7684\u53c3\u6578 <code>nstocks_limit</code> \u5373\u53ef\u5b8c\u6210\uff1a</p> <pre><code>position = buy.hold_until(sell, nstocks_limit=5)\n</code></pre> <p>\u985e\u80a1\u8f2a\u52d5\u512a\u5148\u5ea6</p> <p>\u7576\u4f7f\u7528\u985e\u80a1\u8f2a\u52d5\u6642\uff0c\u5f80\u5f80\u6703\u9047\u5230\u7576\u5929\u6709\u6578\u6a94\u80a1\u7968\u90fd\u6709\u9032\u5834\u8a0a\u865f\uff0c\u6b64\u6642\u53ef\u4ee5\u8a2d\u5b9a\u512a\u5148\u7a0b\u5ea6\uff0c\u512a\u5148\u5ea6\u9ad8\u7684\u9032\u5834\u8a0a\u865f\uff0c\u6703\u63d0\u65e9\u88ab\u9078\u53d6\uff0c\u4f8b\u5982\u6211\u5011\u53ef\u4ee5\u9078\u64c7\u80a1\u50f9\u9ad8\u7684\u80a1\u7968\u512a\u5148\u9032\u5834\uff1a</p> <pre><code>position = buy.hold_until(sell, nstocks_limit=5, rank=close)\n</code></pre> <p>\u5047\u5982\u60f3\u9078\u64c7\u80a1\u50f9\u4f4e\u7684\u80a1\u7968\u512a\u5148\u9032\u5834\uff0c\u5247\u8a2d\u5b9a <code>rank=-close</code> \u5373\u53ef\u3002</p> <p>\u5b8c\u6574\u7b56\u7565\u7bc4\u4f8b</p> <p>\u50f9\u683c &gt; 20 \u65e5\u5747\u7dda\u5165\u5834, \u50f9\u683c &lt; 60 \u65e5\u5747\u7dda\u51fa\u5834\uff0c\u6700\u591a\u6301\u670910\u6a94\uff0c\u8d85\u904e 10 \u500b\u9032\u5834\u8a0a\u865f\uff0c\u5247\u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u5c0f\u7684\u80a1\u7968\u512a\u5148\u9078\u5165\u3002</p> \u9078\u80a1\u7b56\u7565<pre><code>from finlab import data\nfrom finlab.backtest import sim\nclose = data.get('price:\u6536\u76e4\u50f9')\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')  \nsma20 = close.average(20)\nsma60 = close.average(60)\nentries = close &gt; sma20\nexits = close &lt; sma60\nposition = entries.hold_until(exits, nstocks_limit=10, rank=-pb)\nsim(position)\n</code></pre>"},{"location":"details/backtest_decorator/#rise","title":"\u6578\u503c\u4e0a\u5347\u4e2d(rise)","text":"<p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u9ad8\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002 </p> \u6536\u76e4\u50f9\u662f\u5426\u9ad8\u65bc10\u65e5\u524d\u80a1\u50f9<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise(10)\n</code></pre>"},{"location":"details/backtest_decorator/#fall","title":"\u6578\u503c\u4e0b\u964d\u4e2d(fall)","text":"<p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u4f4e\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p> \u6536\u76e4\u50f9\u662f\u5426\u4f4e\u65bc10\u65e5\u524d\u80a1\u50f9<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').fall(10)\n</code></pre>"},{"location":"details/backtest_decorator/#n-sustain","title":"\u6301\u7e8c N \u5929\u6eff\u8db3\u689d\u4ef6(sustain)","text":"<p>\u53d6\u79fb\u52d5 nwindow \u7b46\u52a0\u7e3d\u5927\u65bc\u7b49\u65bcnsatisfy\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p> \u6536\u76e4\u50f9\u662f\u5426\u9023\u5169\u65e5\u4e0a\u6f32<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise().sustain(2)\n</code></pre> \u6536\u76e4\u50f9\u662f\u5426\u4e09\u5929\u4e2d\u6709\u5169\u5929\u4e0a\u6f32<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise().sustain(3, 2)\n</code></pre>"},{"location":"details/backtest_decorator/#quantile_row","title":"\u80a1\u7968\u7576\u5929\u6578\u503c\u5206\u4f4d\u6578(quantile_row)","text":"<p>\u53d6\u5f97\u6bcf\u5217n\u5b9a\u5206\u4f4d\u6578\u7684\u503c\u3002</p> \u53d6\u6bcf\u65e5\u80a1\u50f9\u524d90\uff05\u5206\u4f4d\u6578<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').quantile_row(0.9)\n</code></pre>"},{"location":"details/backtest_decorator/#index_str_to_date","title":"\u8ca1\u52d9\u6708\u5b63\u5831\u7d22\u5f15\u683c\u5f0f\u8f49\u63db(index_str_to_date)","text":"<p><code>FinlabDataFrame.index_str_to_date()</code></p> <p>\u5c07\u8cc7\u6599\u7684 index \u540d\u7a31\u5f9e\u539f\u672c\u7684\u5b57\u4e32:</p> <ul> <li>\u6708\u71df\u6536 (ex:2022-M1) </li> <li>\u8ca1\u52d9\u5b63\u5831 (ex:2022-Q1) </li> </ul> <p>\u8f49\u63db\u6210</p> <ul> <li>\u6708\u71df\u6536 (ex:2022-01-10) </li> <li>\u8ca1\u52d9\u5b63\u5831 (ex:2022-05-15) </li> </ul> <p>\u5f9e\u6587\u5b57\u683c\u5f0f\u8f49\u70ba\u516c\u544a\u622a\u6b62\u65e5\u7684 <code>datetime</code> \u683c\u5f0f\uff0c\u901a\u5e38\u4f7f\u7528\u60c5\u5883\u70ba\u5c0d\u4e0d\u540c\u9031\u671f\u7684 <code>dataframe</code>\u505a <code>reindex</code>\uff0c\u5e38\u7528\u65bc\u4ee5\u516c\u544a\u622a\u6b62\u65e5\u70ba\u8a0a\u865f\u7522\u751f\u65e5\u7684\u6642\u5019\u3002</p> <pre><code>from finlab import data\ndata.get('monthly_revenue:\u7576\u6708\u71df\u6536').index_str_to_date()\ndata.get('financial_statement:\u73fe\u91d1\u53ca\u7d04\u7576\u73fe\u91d1').index_str_to_date()\n</code></pre>"},{"location":"details/backtest_decorator/#groupby_category","title":"\u7522\u696d\u5206\u7fa4(groupby_category)","text":"<p>\u8cc7\u6599\u6309\u7522\u696d\u5206\u7fa4\uff0c\u985e\u4f3c <code>pd.DataFrame.groupby()</code>\u3002</p> <p>\u534a\u5c0e\u9ad4\u5e73\u5747\u80a1\u50f9\u6de8\u503c\u6bd4\u6642\u9593\u5e8f\u5217<pre><code>from finlab import data\npe = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\npe.groupby_category().mean()['\u534a\u5c0e\u9ad4'].plot()\n</code></pre> </p> <p>\u5168\u7403 2020 \u91cf\u5316\u5bec\u9b06\u52a0\u4e0a\u6676\u7247\u77ed\u7f3a\uff0c\u4f7f\u5f97\u534a\u5c0e\u9ad4\u80a1\u50f9\u6de8\u503c\u6bd4\u885d\u9ad8\u3002</p>"},{"location":"details/backtest_decorator/#is_entry","title":"\u9032\u5834\u9ede(is_entry)","text":"<p>\u53d6\u9032\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p> \u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u9032\u5834\u9ede<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_entry()\n</code></pre>"},{"location":"details/backtest_decorator/#is_exit","title":"\u51fa\u5834\u9ede(is_exit)","text":"<p>\u53d6\u51fa\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70ba True\uff0c\u53cd\u4e4b\u70ba False\u3002</p> \u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u51fa\u5834\u9ede\u3002<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_exit()\n</code></pre>"},{"location":"details/document/","title":"FinLab \u51fd\u5f0f\u5eab","text":""},{"location":"details/document/#_1","title":"\u5feb\u901f\u4e0a\u624b","text":"<p>FinLab \u81f4\u529b\u65bc\u63a8\u5ee3\u6211\u5011\u5728\u91cf\u5316\u6295\u8cc7\u4e0a\u7684\u77e5\u8b58\u8207 Python \u5be6\u4f5c\u7d93\u9a57\uff0c\u4e26\u4e14\u5206\u4eab\u5982\u4f55\u904b\u7528 Python \u5275\u9020\u5c6c\u65bc\u81ea\u5df1\u7684\u6295\u8cc7\u751f\u614b\u7cfb\uff0c\u9760\u81ea\u5df1\u7684\u80fd\u529b\u70ba\u81ea\u5df1\u5275\u9020\u6295\u8cc7\u6536\u5165\uff0c\u4e0d\u7528\u5728\u5916\u82b1\u9322\u807d\u4fe1\u7121\u6839\u64da\u7684\u660e\u724c\uff0c\u8b93\u5927\u5bb6\u7528\u5f88\u4f4e\u7684\u6210\u672c\u8907\u88fd\u6211\u5011\u5728\u8ca1\u7d93\u4e00\u8def\u4e0a\u7684\u6240\u5b78\u8207\u7d93\u9a57\u3002\u9664\u4e86\u904e\u53bb\u5728 Hahow \u958b\u8a2d\u8ab2\u7a0b\uff0c\u73fe\u5728\u70ba\u4e86\u6253\u9020\u66f4\u8c50\u5bcc\u7684 Python \u91cf\u5316\u6295\u8cc7\u751f\u614b\u7cfb\uff0c\u5efa\u7f6e\u4e86 SaaS \u8207\u5ef6\u4f38\u6559\u5b78\u5167\u5bb9\u5e73\u53f0\uff0c\u4e0d\u65b7\u7814\u767c\uff0c\u63d0\u4f9b\u7d66\u5927\u5bb6\u66f4\u591a\u6b66\u5668\u61c9\u5c0d\u8907\u96dc\u7684\u91d1\u878d\u5e02\u5834\u3002</p>"},{"location":"details/document/#_2","title":"\u6703\u54e1\u8a3b\u518a","text":"<p>\u9032\u5165\u9996\u9801\u5f8c\uff0c\u9ede\u9078\u53f3\u4e0a\u89d2\u767b\u5165\u6309\u9215\uff0c\u5373\u53ef\u4f7f\u7528 Google \u5e33\u865f\u767b\u9304 FinLab \u6703\u54e1\u3002\u82e5\u7121 Google \u5e33\u865f\uff0c\u8acb\u5148 \u8a3b\u518a Google \u5e33\u865f \u65b9\u53ef\u63a5\u7e8c\u9032\u884c\u3002</p>"},{"location":"details/document/#_3","title":"\u5feb\u901f\u5b89\u88dd","text":"<p>\u63d0\u4f9b3\u7a2e\u9078\u9805\uff0c\u6bcf\u500b\u4eba\u90fd\u53ef\u4ee5\u9078\u64c7\u9069\u5408\u81ea\u5df1\u7684\u74b0\u5883\uff1a 1. Python:     \u4f7f\u7528 <code>pip install finlab</code> \u4e26\u4e14\u5728\u4e00\u822c Python \u74b0\u5883\u4e0b\u57f7\u884c\u56de\u6e2c\u3002</p> <pre><code>\u6ce8\u610f:\u82e5\u5728finlab hahow\u8ab2\u7a0b\u8cc7\u6599\u593e\u5167\u64cd\u4f5c\uff0c\u53ef\u80fd\u8207\u672c\u5730finlab\u6a21\u7d44\u6709\u547d\u540d\u885d\u7a81\u554f\u984c\uff0c\u8acb\u91cd\u958b\u65b0\u7684python\u958b\u767c\u74b0\u5883\u6216\u5728colab\u64cd\u4f5c\u3002\n</code></pre> <ol> <li> <p>FinLab IDE:     \u514d\u5b89\u88dd\uff0c\u76f4\u63a5\u5728\u7db2\u9801\u4e0a\u57f7\u884c Python \u7a0b\u5f0f\u8a9e\u6cd5\uff0c\u4e26\u642d\u914d FinLab \u51fd\u5f0f\u5eab\u4f7f\u7528\u3002</p> <p>\u6ce8\u610f:\u514d\u8cbb\u6b0a\u9650\u6709\u6bcf\u65e5\u904b\u884c\u6642\u9593\u9650\u5236600\u79d2\uff0c\u5efa\u8b70\u5148\u5728\u4e00\u822c Python \u74b0\u5883\u4e0b\u57f7\u884c\u56de\u6e2c(\u7121\u9650\u5236\u6642\u9593)\uff0c\u78ba\u8a8d\u7b56\u7565\u904b\u4f5c\u6b63\u5e38\u5f8c\uff0c\u518d\u5c07\u7a0b\u5f0f\u78bc\u8cbc\u5230FinLab IDE\u57f7\u884c\u90e8\u5c6c\u3002</p> </li> <li> <p>FinLab GUI:     \u514d\u5b89\u88dd\uff0c\u76f4\u63a5\u5728\u7db2\u9801\u4e0a\u57f7\u884c\uff0c\u7528\u5716\u5f62\u5316\u4ecb\u9762\u7de8\u8f2f\u7b56\u7565\u3002</p> </li> </ol> Python  \u4e00\u822c Python \u74b0\u5883\u5b89\u88dd: <pre><code>pip install finlab\n</code></pre>  \u8a3b\uff1a\u5047\u5982\u662f\u5728 Colab\u6216Jupyter \u74b0\u5883\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 `!pip install finlab` \u4f86\u5b89\u88dd\u3002  Finlab IDE  #### Step1 \u5de6\u5074\u5c0e\u89bd\u5217\u9ede\u9078\u9078\u80a1\u7b56\u7565Icon\u3002  #### Step2 \u9ede\u9078\u201c\u5efa\u7acb\u65b0\u7b56\u7565\u201d\u3002    #### Step3 \u8f38\u5165\u7b56\u7565\u540d\u7a31\uff0c\u9ede\u9078\u201c\u78ba\u5b9a\u201d\u3002    #### Step4: \u9ede\u9078\u201c\u7a0b\u5f0f\u78bc\u7de8\u8f2f\u5668\u201d\uff0c\u9032\u5165IDE\u958b\u767c\u756b\u9762\u3002   Finlab GUI Step1: \u5de6\u5074\u5c0e\u89bd\u5217\u9ede\u9078\u9078\u80a1\u7b56\u7565Icon\u3002 Step2: \u9ede\u9078\u201c\u5efa\u7acb\u65b0\u7b56\u7565\u201d\u3002    Step3: \u8f38\u5165\u7b56\u7565\u540d\u7a31\uff0c\u9ede\u9078\u201c\u78ba\u5b9a\u201d\u3002    Step4: \u9ede\u9078\u201c\u5716\u5f62\u5316\u7de8\u8f2f\u5668\u201d\uff0c\u9032\u5165GUI\u958b\u767c\u756b\u9762\u3002"},{"location":"details/document/#_4","title":"\u7372\u53d6\u6b77\u53f2\u8cc7\u6599","text":"<p>\u4e00\u884c\u7a0b\u5f0f\u5feb\u901f\u6293\u53d6\u8c50\u5bcc\u7684\u80a1\u5e02\u8cc7\u6599\u5eab\uff01</p> Python Step1:  \u5229\u7528 finlab.data \u4f86\u5f97\u5230\u300c\u6240\u6709\u300d\u6b77\u53f2\u8cc7\u6599\u3002  \u81f3[\u8cc7\u6599\u5eab\u76ee\u9304](https://ai.finlab.tw/database)\u8907\u88fd\u60f3\u7372\u53d6\u7684\u8cc7\u6599\u7684\u4f7f\u7528\u65b9\u6cd5\u3002 \u8209\u4f8b\uff1a  <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nclose\n</code></pre> Step2: \u521d\u6b21\u4e0b\u8f09\u8cc7\u6599\u6703\u8df3\u51fa\u9a57\u8b49\u78bc\u8acb\u6c42\uff0c\u82e5\u6709\u6210\u529f\u8a3b\u518a\u6703\u54e1\uff0c\u756b\u9762\u6703\u986f\u793a\u9a57\u8b49\u78bc\uff0c\u518d\u5c07\u9a57\u8b49\u78bc\u8907\u88fd\u586b\u5165\u201c\u8f38\u5165\u9a57\u8b49\u78bc\u201d\u6b04\u4f4d\u5373\u53ef\u7372\u53d6\u8cc7\u6599\u3002    Finlab IDE \u65b9\u6cd51:  \u81f3[\u8cc7\u6599\u5eab\u76ee\u9304](https://ai.finlab.tw/database)\u8907\u88fd\u60f3\u7372\u53d6\u7684\u8cc7\u6599\u7684\u4f7f\u7528\u65b9\u6cd5\u8cbc\u5230IDE\u7de8\u5beb\u3002 \u8209\u4f8b\uff1a  <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nclose\n</code></pre> \u65b9\u6cd52:  \u81f3IDE\u53f3\u5074\u8ca1\u52d9\u6307\u6a19\u6216\u6280\u8853\u6307\u6a19\u9ede\u9078\uff0c\u5373\u53ef\u751f\u6210data.get(\u6240\u9078\u6307\u6a19)\u7684\u7a0b\u5f0f\u78bc\u65bcIDE\u3002 \u8209\u4f8b\uff1a   Finlab GUI Step1:  \u81f3IDE\u53f3\u5074\u8ca1\u52d9\u6307\u6a19\u6216\u6280\u8853\u6307\u6a19\u9ede\u9078\uff0c\u5373\u53ef\u751f\u6210\u6240\u9078\u7684\u6307\u6a19\u62fc\u5716\u65bcGUI\u3002 \u8209\u4f8b\uff1a"},{"location":"details/document/#_5","title":"\u7b56\u7565\u958b\u767c\u8207\u56de\u6e2c","text":"<p>\u7c21\u55ae\u958b\u767c\u7b56\u7565\uff0c\u57f7\u884c\u5f37\u5927\u7684\u56de\u6e2c\u7cfb\u7d71\uff01</p> Python Step1:  \u5229\u7528python pandas\u53cafinlab\u8a9e\u6cd5\u64b0\u5beb\u689d\u4ef6\u7a0b\u5f0f\u78bc\u3002 [Colab\u7bc4\u4f8b\u6a94\u9023\u7d50\u3002](https://colab.research.google.com/drive/1RVd2d6eW_A3yZGqLSl9PJ2LHGAoNIOOj?usp=sharing) \u7a0b\u5f0f\u7bc4\u4f8b\u5982\u4e0b:  <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u4e0b\u8f09\u8cc7\u6599\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\nclose = data.get('price:\u6536\u76e4\u50f9')\n# \u6536\u76e4\u50f9\u4f4d\u65bc20\u65e5\u5747\u7dda\u652f\u6490\u4e0a\ncond1=close &gt; close.rolling(20).mean()\n# \u4f7f\u7528indicator\u8a08\u7b97rsi\u6307\u6a19\nrsi=data.indicator('RSI', timeperiod=5)\n# rsi\u9ad8\u6a94\u920d\u5316\ncond2=(rsi&gt;80).rolling(3).sum()==3\n# \u6392\u9664\u80a1\u50f9\u904e\u9ad8\u8207\u904e\u4f4e\u7684\u80a1\u7968\ncond3=(close &gt; 5)&amp;(close &lt; 500)\n# \u9078\u51fa\u8cb7\u9032\u8a0a\u865f\u4e2d\u76ca\u672c\u6bd4\u524d10\u5927\u6a19\u5730\nind=(1/pe)*(cond1&amp;cond2&amp;cond3)\nposition=ind.is_largest(10)\nsim(position,resample='M',name=\"demo_strategy\")\n</code></pre> Step2: \u53d6\u5f97\u56de\u6e2c\u7d50\u679c    Finlab IDE Step1:  \u5229\u7528python pandas\u53cafinlab\u8a9e\u6cd5\u64b0\u5beb\u689d\u4ef6\u7a0b\u5f0f\u78bc\uff0c\u7bc4\u4f8b\u5982\u4e0b:  <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u4e0b\u8f09\u8cc7\u6599\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\nclose = data.get('price:\u6536\u76e4\u50f9')\n# \u6536\u76e4\u50f9\u4f4d\u65bc20\u65e5\u5747\u7dda\u652f\u6490\u4e0a\ncond1=close &gt; close.rolling(20).mean()\n# \u4f7f\u7528indicator\u8a08\u7b97rsi\u6307\u6a19\nrsi=data.indicator('RSI', timeperiod=5)\n# rsi\u9ad8\u6a94\u920d\u5316\ncond2=(rsi&gt;80).rolling(3).sum()==3\n# \u6392\u9664\u80a1\u50f9\u904e\u9ad8\u8207\u904e\u4f4e\u7684\u80a1\u7968\ncond3=(close &gt; 5)&amp;(close &lt; 500)\n# \u9078\u51fa\u8cb7\u9032\u8a0a\u865f\u4e2d\u76ca\u672c\u6bd4\u524d10\u5927\u6a19\u5730\nind=(1/pe)*(cond1&amp;cond2&amp;cond3)\nposition=ind.is_largest(10)\nsim(position,resample='M',name=\"demo_strategy\")\n</code></pre> Step2: \u57f7\u884c\u7a0b\u5f0f(\u7bc4\u4f8b\u5716\u7d05\u5708\u8655)\u3002    Step3: \u53d6\u5f97\u56de\u6e2c\u7d50\u679c\u3002    Finlab GUI Step1:  GUI\u64cd\u4f5c\u539f\u5247:  1. \u62fc\u5716\u984f\u8272\u7531\u5916\u800c\u5167\u914d\u7f6e\u9806\u5e8f\u70ba\uff1a\u7d05\u3001\u9ec3\u3001\u85cd\u3001\u7d2b\uff0c\u4e0d\u540c\u984f\u8272\u4ee3\u8868\u4e0d\u540c\u4e3b\u529f\u80fd\u3002 1. \u4f9d\u8cc7\u6599\u908f\u8f2f\u586b\u5165\u6578\u503c\uff0c\u82e5\u908f\u8f2f\u6b63\u78ba\uff0c\u62fc\u5716\u5373\u53ef\u62fc\u63a5\uff0c\u5426\u5247\u7121\u6cd5\u586b\u5165\u3002 1. \u62fc\u63a5\u5b8c\u6210\u5f8c\uff0c\u6309\u4e0b\u65b9\u57f7\u884c\u9215(\u7bc4\u4f8b\u5716\u7d05\u5708\u8655)\uff0c\u56de\u6e2c\u5373\u958b\u59cb\u57f7\u884c\u3002  \u9078\u80a1\u7bc4\u4f8b\u689d\u4ef6\u5982\u4e0b:  1. \u6536\u76e4\u50f9\u4f4d\u65bc20\u65e5\u5747\u7dda\u652f\u6490\u4e0a\u3002 1. rsi\u9ad8\u6a94\u920d\u5316\uff0c\u90233\u65e5\u5927\u65bc80\u3002 1. \u80a1\u50f9\u4ecb\u65bc5-500\u3002 1. \u6700\u5f8c\u9078\u51fa\u8cb7\u9032\u8a0a\u865f\u4e2d\u76ca\u672c\u6bd4\u524d10\u5927\u6a19\u5730\u3002  GUI\u64cd\u4f5c\u7bc4\u4f8b\u5982\u4e0b:   Step2: \u53d6\u5f97\u56de\u6e2c\u7d50\u679c\u3002"},{"location":"details/document/#_6","title":"\u6a21\u7d44\u529f\u80fd\u6307\u5357","text":"<p>\u4ee5\u4e0b\u70ba\u4f7f\u7528 <code>finlab</code> package \u66f4\u7d30\u90e8\u7684\u4ecb\u7d39\uff0c\u91dd\u5c0d\u6bcf\u4e00\u500b\u51fd\u5f0f\u64b0\u5beb\u7bc4\u4f8b\u3002</p>"},{"location":"details/document/#finlab_1","title":"Finlab\u6b0a\u9650\u767b\u5165","text":"<p><code>finlab.login(api_token:str)</code></p> <p>\u53ef\u4ee5\u81f3 </p> <p>api_token\u67e5\u8a62\u9801\u9762 \u7372\u53d6api_token\uff0c\u57f7\u884c<code>finlab.login(api_token)</code>\u767b\u5165\u4f86\u8a2d\u7f6e\u76f8\u95dc\u74b0\u5883\u8b8a\u6578\u3002</p> <p>\u82e5\u4e0d\u81ea\u884c\u8f38\u5165\uff0c\u5728\u4f7f\u7528Finlab\u6a21\u7d44\u57f7\u884c\u6703\u54e1\u529f\u80fd\u6642\uff0c\u7cfb\u7d71\u6703\u81ea\u52d5\u6703\u8df3\u51fa </p> <p>GUI\u9801\u9762 \u8acb\u6c42\u8f38\u5165api_token\uff0c\u9a57\u8b49\u5b8c\u65b9\u53ef\u4f7f\u7528\u5c0d\u61c9\u6b0a\u9650\u7684\u529f\u80fd\u3002</p> <p></p>"},{"location":"details/document/#_7","title":"\u7372\u53d6\u6b77\u53f2\u8cc7\u6599","text":"<p><code>finlab.data.get(dataset)</code></p> <p>\u5229\u7528 finlab.data \u4f86\u5f97\u5230\u300c\u6240\u6709\u300d\u6b77\u53f2\u8cc7\u6599\uff0c\u53ef\u4ee5\u81f3\u8cc7\u6599\u5eab\u76ee\u9304\u8907\u88fd\u8cc7\u6599\u7684\u4f7f\u7528\u65b9\u6cd5\u3002\u4e00\u884c\u7a0b\u5f0f\u5feb\u901f\u6293\u53d6\u8c50\u5bcc\u7684\u80a1\u5e02\u8cc7\u6599\u5eab\uff01 \u76ee\u524d\u91dd\u5c0d FREE \u8ddf VIP \u7528\u6236\uff0c\u6240\u5f97\u5230\u7684\u8cc7\u6599\u6642\u9593\u6bb5\u4e0d\u540c\uff1a * FREE \u7528\u6236\uff1a\u53bb\u9664\u6700\u8fd1\u5169\u500b\u6708\u4e4b\u6b77\u53f2\u8cc7\u6599 * VIP \u7528\u6236\uff1a\u5b8c\u6574\u6b77\u53f2\u548c\u7576\u5929\u8cc7\u6599</p> <p>\u8cc7\u6599\u683c\u5f0f\u70ba\u5206\u70ba\u5169\u7a2e\uff1a\u300c\u6642\u9593\u5e8f\u5217\u8cc7\u6599\u300d\u548c\u300c\u975e\u6642\u9593\u5e8f\u5217\u8cc7\u6599\u300d</p>"},{"location":"details/document/#1","title":"1. \u6642\u9593\u5e8f\u5217\u8cc7\u6599","text":"<p>\u8cc7\u6599\u7372\u53d6\u65b9\u6cd5\uff0c\u5c31\u662f\u4f7f\u7528  <code>data.get</code> \u51fd\u5f0f\uff0c\u50b3\u5165\uff1a<code>\u4e3b\u8cc7\u6599:\u5b50\u8cc7\u6599</code> \u7684\u683c\u5f0f\uff0c\u4f8b\u5982<code>price:\u6536\u76e4\u50f9</code>\u3002 \u7372\u5f97\u7684\u8cc7\u6599\uff0c\u5176\u7e31\u8ef8\u70ba\u65e5\u671f\uff0c\u6a6b\u8ef8\u70ba\u80a1\u7968\u4ee3\u865f\uff0c\u88fd\u4f5c\u9078\u80a1\u7b56\u7565\u975e\u5e38\u65b9\u4fbf\u3002</p> <p><pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9')\n</code></pre> </p>"},{"location":"details/document/#2-table","title":"2.  \u975e\u6642\u9593\u5e8f\u5217\u8cc7\u6599(table)","text":"<p>\u8cc7\u6599\u7372\u53d6\u65b9\u6cd5\uff0c\u5c31\u662f\u4f7f\u7528  <code>data.get</code> \u51fd\u5f0f\uff0c\u50b3\u5165\uff1a<code>\u4e3b\u8cc7\u6599</code> \u7684\u683c\u5f0f\uff0c\u4f8b\u5982 <code>company_main_business</code>\u3002\u53ef\u4ee5\u767c\u73fe\u62ff\u5230\u7684\u8cc7\u6599\uff0c\u4e0d\u662f\u6309\u7167\u6642\u9593\u5e8f\u5217\u6392\u5217\u3002</p> <p><pre><code>from finlab import data\ndata.get('company_main_business')\n</code></pre> </p>"},{"location":"details/document/#_8","title":"\u6280\u8853\u6307\u6a19\u8a08\u7b97","text":"<p><code>finlab.data.indicator(indname:str, adjust_price:bool=False, resample:str='D', **kwargs):</code></p> <p>\u652f\u63f4 Talib \u548c pandas_ta \u4e0a\u767e\u7a2e\u6280\u8853\u6307\u6a19\uff01\u53ea\u9700\u8981\u4e00\u884c\uff0c\u5e6b\u4f60\u7b97\u51fa2000\u6a94\u80a1\u7968\u300110\u5e74\u7684\u6240\u6709\u8cc7\u8a0a\uff01</p>"},{"location":"details/document/#_9","title":"\u4f7f\u7528\u8a2d\u5b9a","text":"<p>\u5728\u4f7f\u7528\u9019\u500b\u51fd\u5f0f\u524d\uff0c\u5fc5\u9700\u8981\u5148\u5b89\u88dd talib \u5957\u4ef6\uff0c\u53ef\u4ee5\u53c3\u8003 \u5b98\u65b9\u5b89\u88dd\u6559\u5b78 \u4f86\u5b89\u88dd\uff0c\u652f\u63f4 Windows\u3001MacOS\u3001Linux\u3002</p>"},{"location":"details/document/#_10","title":"\u53c3\u6578\u8aaa\u660e\uff1a","text":"<ul> <li><code>indname</code>: talib\u6307\u6a19\u540d\u7a31\uff0c\u4f8b\u5982 <code>SMA</code>, <code>STOCH</code>, <code>RSI</code> \u7b49\uff0c\u53ef\u4ee5\u53c3\u8003 talib \u6559\u5b78\u3002</li> <li><code>adjust_price</code>: \u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\u8a08\u7b97\u3002</li> <li><code>resample</code>: \u6280\u8853\u6307\u6a19\u50f9\u683c\u9031\u671f\uff0cex: <code>D</code> \u4ee3\u8868\u65e5\u7dda, <code>W</code> \u4ee3\u8868\u9031\u7dda, <code>M</code> \u4ee3\u8868\u6708\u7dda\u3002</li> <li><code>**kwargs</code>: \u6240\u9078talib\u6307\u6a19\u7684\u5176\u4ed6\u53c3\u6578\u8a2d\u5b9a\uff0c\u4ee5 <code>RSI</code> \u70ba\u4f8b\uff0c\u53c3\u8003 talib \u6587\u4ef6\u4e2d RSI \u7bc4\u4f8b\uff0c\u8abf\u6574\u9805\u70ba\u8a08\u7b97\u9031\u671f <code>timeperiod</code>\u3002</li> </ul> <p>\u5efa\u8b70\u4f7f\u7528\u8005\u53ef\u4ee5\u5148\u53c3\u8003\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u4e26\u4e14\u642d\u914d talib\u5b98\u65b9\u6587\u4ef6\uff0c\u5c31\u53ef\u4ee5\u638c\u63e1\u88fd\u4f5c\u6280\u8853\u6307\u6a19\u7684\u65b9\u6cd5\u4e86\u3002</p>"},{"location":"details/document/#_11","title":"\u7bc4\u4f8b\u4e00","text":"<p>\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI \u6578\u503c <pre><code>from finlab import data\ndata.indicator('RSI', timeperiod=14)\n</code></pre> </p> <p>\u4e0a\u5716\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u8cc7\u6599\u5305\u542b <code>NaN</code> \uff0c\u4ee3\u8868\u8cc7\u6599\u7b46\u6578\u4e0d\u8db3\uff0c\u7121\u6cd5\u8a08\u7b97\u51fa\u6578\u503c\uff0c\u6bcf\u4e00\u6a94\u80a1\u7968\u9664\u4e86\u525b\u958b\u59cb\u7684 14 \u5929\u5916\uff0c\u5e7e\u4e4e\u90fd\u6703\u6709\u6578\u503c\u3002</p>"},{"location":"details/document/#_12","title":"\u7bc4\u4f8b\u4e8c","text":"<p>\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 KD \u503c\uff0c\u7531\u65bc KD \u6578\u503c\u662f\u7531 K \u548c D \u6240\u7d44\u6210\uff0c\u6bcf\u4e00\u6a94\u80a1\u7968\u6bcf\u5929\u6703\u6709\u5169\u500b\u6578\u503c\uff0c\u6240\u4ee5 <code>data.indicator</code> \u6703\u81ea\u52d5\u56de\u50b3\u5169\u500b <code>pd.DataFrame</code>\uff0c\u53ef\u4ee5\u7528 <code>k, d = data.indicator('STOCH')</code> \u5c07 K \u8207 D \u6578\u503c\u7d00\u9304\uff0c\u4e4b\u5f8c\u7528\u65bc\u6bd4\u5927\u5c0f\uff0c\u4f8b\u5982 <code>k &gt; d</code>\u3002</p> <pre><code>from finlab import data\nk, d = data.indicator('STOCH')\nk\n</code></pre> <p></p>"},{"location":"details/document/#_13","title":"\u7bc4\u4f8b\u4e09 (\u7e8c) \u9078\u80a1","text":"<p>\u5ef6\u7e8c\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u4e8c\uff0c\u5047\u5982\u6211\u5011\u5e0c\u671b\u5c07\u6700\u8fd1\u4e00\u5929 K &gt; D \u503c\u7684\u80a1\u7968\u6e05\u55ae\u5217\u51fa\u4f86\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8a9e\u6cd5 <pre><code>(k &gt; d).iloc[-1]\n</code></pre> <pre><code>0015    False\n0050     True\n0051    False\n0052     True\n0053     True\n...  \n9951     True\n9955    False\n9958    False\n9960     True\n9962     True\nName: 2021-07-13 00:00:00, Length: 2269, dtype: bool\n</code></pre></p>"},{"location":"details/document/#-pandas_ta","title":"\u7bc4\u4f8b\u56db - Pandas_ta \u6280\u8853\u6307\u6a19","text":"<p>finlab 0.3.2 dev1 \u7248\u672c\u958b\u59cb\u652f\u63f4 Pandas_ta \u8a08\u7b97\u6280\u8853\u6307\u6a19\u3002 \u5957\u4ef6\u5b89\u88dd\u65b9\u6cd5\u53ca\u6307\u6a19\u9078\u9805\u8acb\u898b Pandas_ta\u5b98\u65b9\u6587\u4ef6</p> <p>\u6211\u5011\u5c07 Pandas_ta \u8207 Finlab \u6574\u5408\uff0c\u4f7f\u7528\u65b9\u5f0f\u975e\u5e38\u7684\u7c21\u55ae\uff0c\u5c31\u8ddf\u4ee5\u524d\u4e00\u6a21\u4e00\u6a23\uff0c\u7528\u4e00\u884c\u7c21\u77ed\u7684\u7a0b\u5f0f\uff0c\u5c31\u53ef\u4ee5\u8a08\u7b97\u5169\u5343\u6a94\u80a1\u7968\u7684\u6578\u503c\uff1a</p> <pre><code>from finlab import data\nvalues = data.indicator('supertrend')\n</code></pre> <p>\u6b64\u6642\uff0c\u7a0b\u5f0f\u6703\u512a\u5148\u641c\u5c0b TaLib \u4e2d\u662f\u5426\u6709\u5c0d\u61c9\u7684\u51fd\u5f0f\uff0c\u5047\u5982\u6c92\u6709\u7684\u8a71\uff0c\u5c31\u6703\u641c\u5c0b Pandas_ta\u3002\u53ef\u4ee5\u8b93\u4f60\u4e00\u6b21\u628a\u6240\u6709\u80a1\u7968\u7684\u6280\u8853\u6307\u6a19\u4e00\u6b21\u8a08\u7b97\u51fa\u4f86\u3002\u7f3a\u9ede\u662f Pandas_ta \u8a08\u7b97\u7684\u901f\u5ea6\u6bd4\u8f03\u6162\uff0c\u6240\u4ee5\u904b\u7b97\u6642\u8981\u7a0d\u5fae\u7b49\u5f85\u4e00\u4e0b\u3002</p>"},{"location":"details/document/#_14","title":"\u9650\u5b9a\u4e0a\u5e02\u6ac3\u3001\u985e\u80a1","text":"<p><code>finlab.data.set_universe(market='ALL', category='ALL')</code></p> <p>\u4f7f\u7528\u8005\u53ef\u4ee5\u4f7f\u7528\u6b64\u51fd\u5f0f\u8a2d\u5b9a\u5e02\u5834\u8207\u985e\u80a1\u7684\u56de\u6e2c\u6a19\u7684\u7bc4\u570d\u3002 \u8a2d\u5b9a\u5b8c\u7562\u5f8c\uff0c\u518d\u4f7f\u7528 <code>data.get</code> \u6216\u662f <code>data.indicator</code> \u6642\uff0c\u5c31\u53ea\u6703\u7372\u5f97\u6240\u9078\u7bc4\u570d\u4e4b\u6a19\u7684\uff0c\u6240\u5f97\u5230\u7684\u80a1\u7968\u6703\u88ab\u904e\u6ffe\u3002\u6ce8\u610f\u6b64\u8a2d\u5b9a\u5f71\u97ff\u70ba\u5168\u57df\uff0c\u82e5\u4e4b\u5f8c\u7684data\u4e0d\u60f3\u88ab\u5f71\u97ff\uff0c\u53ef\u4f7f\u7528\u4ee5\u4e0b\u7a0b\u5f0f\u3002 <pre><code>with data.universe(market='TSE_OTC'):\nprice=data.get('price:\u6536\u76e4\u50f9')\n</code></pre></p>"},{"location":"details/document/#_15","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>market (str)</code>: \u5e02\u5834\u540d\u7a31\u3002     \u7bc4\u4f8b\uff1a      <code>'ALL', 'TSE', 'OTC', 'TSE_OTC', 'ETF'</code></li> <li><code>category (str or list)</code>: \u985e\u80a1\u540d\u7a31\uff0c\u53ef\u4ee5\u4f7f\u7528\u6a21\u7cca\u6bd4\u5c0d\uff0c\u4f8b\u5982 <code>'\u96fb\u5b50'</code>\uff0c\u6703\u9078\u5230<code>'\u96fb\u5b50\u5de5\u696d'</code>, <code>'\u96fb\u5b50\u901a\u8def\u696d'</code>... \u7b49;\u4f8b\u5982 <code>['\u6c34\u6ce5','\u92fc\u9435']</code>\uff0c\u6703\u9078\u5230<code>'\u6c34\u6ce5\u5de5\u696d'</code>, <code>'\u92fc\u9435\u5de5\u696d'</code>\u3002 <pre><code>'\u5149\u96fb\u696d', '\u5176\u4ed6', '\u5176\u4ed6\u96fb\u5b50\u696d',\n'\u5316\u5b78\u5de5\u696d', '\u534a\u5c0e\u9ad4', '\u5851\u81a0\u5de5\u696d', '\u5b58\u8a17\u6191\u8b49', '\u5efa\u6750\u71df\u9020', '\u6587\u5316\u5275\u610f\u696d', '\u6a61\u81a0\u5de5\u696d', '\u6c34\u6ce5\u5de5\u696d',\n'\u6c7d\u8eca\u5de5\u696d', '\u6cb9\u96fb\u71c3\u6c23\u696d', '\u73bb\u7483\u9676\u74f7', '\u751f\u6280\u91ab\u7642', '\u751f\u6280\u91ab\u7642\u696d', '\u7d21\u7e54\u7e96\u7dad', '\u822a\u904b\u696d', '\u89c0\u5149\u4e8b\u696d', '\u8cbf\u6613\u767e\u8ca8',\n'\u8cc7\u8a0a\u670d\u52d9\u696d', '\u8fb2\u696d\u79d1\u6280', '\u901a\u4fe1\u7db2\u8def\u696d', '\u9020\u7d19\u5de5\u696d', '\u91d1\u878d', '\u92fc\u9435\u5de5\u696d', '\u96fb\u5668\u96fb\u7e9c', '\u96fb\u5b50\u5546\u52d9',\n'\u96fb\u5b50\u901a\u8def\u696d', '\u96fb\u5b50\u96f6\u7d44\u4ef6', '\u96fb\u6a5f\u6a5f\u68b0', '\u96fb\u8166\u53ca\u9031\u908a', '\u98df\u54c1\u5de5\u696d'\n</code></pre></li> </ul>"},{"location":"details/document/#_16","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u9650\u5b9a\u53ea\u6293\u53d6\u4e0a\u5e02\u6ac3\u666e\u901a\u80a1(\u6392\u9664ETF\u3001ETN\u3001\u7279\u5225\u80a1\u3001\u5b58\u8a17\u6191\u8b49) <pre><code>from finlab import data\ndata.set_universe(market='TSE_OTC', category='\u6c34\u6ce5') # \u6c34\u6ce5\u5de5\u696d\ndata.get('price:\u6536\u76e4\u50f9')\n</code></pre> </p>"},{"location":"details/document/#_17","title":"\u7372\u53d6\u5df2\u4e0a\u50b3\u7b56\u7565\u7684\u6578\u64da","text":"<p><code>finlab.data.get_strategies()</code> \uff0c\u53ef\u53d6\u5f97\u81ea\u5df1\u7b56\u7565\u5100\u8868\u677f\u4e0a\u7684\u6578\u64da\uff0c\u50cf\u662f\u6bcf\u500b\u7b56\u7565\u7684\u5831\u916c\u7387\u66f2\u7dda\u3001\u7b56\u7565\u5831\u916c\u7387\u7d71\u8a08\u3001\u8fd1\u671f\u90e8\u4f4d\u3001\u8fd1\u671f\u63db\u80a1\u65e5\u7b49\u7b49\uff0c\u9019\u4e9b\u6578\u64da\u53ef\u4ee5\u7528\u4f86\u9032\u884c\u591a\u7b56\u7565\u5f59\u6574\u7684\u61c9\u7528\u5594\uff01</p>"},{"location":"details/document/#_18","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>api_token (str)</code>:     \u9810\u8a2d\u70baNone\uff0c\u82e5\u672a\u8f38\u5165\u904efinlab\u6a21\u7d44\u7684api_token\uff0c\u6703\u81ea\u52d5\u8df3\u51fa\u767b\u5165\u9801\u9762\u3002\u5df2\u767b\u5165\u7684\u4f7f\u7528\u8005\u4e0d\u7528\u518d\u6b21\u8f38\u5165api_token\u53c3\u6578\u3002 </li> </ul>"},{"location":"details/document/#_19","title":"\u8fd4\u56de\u503c","text":"<ul> <li><code>{strategy1:{'positions':{},'returns':[],...},strategy2:{'positions':{},'returns':[],...},...}</code></li> </ul>"},{"location":"details/document/#_20","title":"\u56de\u6e2c\u6a21\u7d44","text":"<p><code>finlab.backtest.sim(position, resample=None, ...)</code></p> <p>\u4e00\u884c\u57f7\u884c\u5f37\u5927\u7684\u56de\u6e2c\u7cfb\u7d71\uff0c\u7522\u751f <code>position</code> \u7684\u6bcf\u65e5\u8a0a\u865f\uff0c\u5e36\u5165 <code>finlab.backtest.sim</code> \u9032\u884c\u56de\u6e2c\uff0c\u5feb\u901f\u5f97\u5230\u98a8\u96aa\u5831\u916c\u5206\u6790\u3001\u9078\u80a1\u6e05\u55ae\uff01</p>"},{"location":"details/document/#_21","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u4f60\u76f8\u4fe1\u5e74\u5831\u916c +27% \u7684\u7b56\u7565\uff0c\u7a0b\u5f0f\u78bc\u4e09\u884c\u5c31\u641e\u5b9a\u55ce\uff1f\u8b93 FinLab \u6253\u958b\u4f60\u7684\u773c\u754c\uff0c\u63a5\u4e0b\u4f86\u6211\u5011\u53ef\u4ee5\u5efa\u69cb\u4e00\u500b\u7b56\u7565\uff0c\u7b56\u7565\u6bcf\u500b\u6708\u6703\u6aa2\u67e5\u80a1\u7968\u6e05\u55ae\uff0c\u6301\u6709\u50f9\u683c\u5c0f\u65bc 6 \u5143\u7684\u80a1\u7968\uff0c\u5254\u9664\u50f9\u683c\u5927\u65bc 6 \u5143\u7684\u80a1\u7968\uff0c\u6bcf\u500b\u6708\u5e95\u57f7\u884c\uff0c\u5468\u800c\u5fa9\u59cb\u3002\u4f86\u56de\u6e2c\u770b\u770b\u9019\u6a23\u7684\u7e3e\u6548\u5230\u5e95\u5982\u4f55\uff1a</p> <pre><code>from finlab import data\nfrom finlab import backtest\n# \u53ea\u8cb7\u5165\u50f9\u683c\u5c0f\u65bc 6 \u5143\u7684\u80a1\u7968\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = close &lt; 6\n# \u56de\u6e2c\uff0c\u6bcf\u6708\u5e95(M)\u91cd\u65b0\u8abf\u6574\u80a1\u7968\u6b0a\u91cd\nbacktest.sim(position, resample='M', name=\"\u50f9\u683c\u5c0f\u65bc6\u7684\u80a1\u7968\")\n</code></pre>"},{"location":"details/document/#_22","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>position (pd.Dataframe)</code>:     \u8cb7\u8ce3\u8a0a\u865f\u7d00\u9304\u3002 True \u70ba\u6301\u6709\uff0c False \u70ba\u7a7a\u624b\u3002     \u82e5\u9078\u64c7\u505a\u7a7aposition\uff0c\u53ea\u8981\u5c07 sim(position) \u6539\u6210\u8ca0\u7684 <code>sim(-position.astype(float))</code>\u5373\u53ef\u505a\u7a7a\u3002     \u7cfb\u7d71\u9810\u8a2d\u4f7f\u7528\u8cc7\u6599\u70ba\u53f0\u80a1\u8207\u52a0\u5bc6\u8ca8\u5e63\uff0c\u82e5\u8981\u4f7f\u7528\u7f8e\u80a1\u6216\u5176\u4ed6\u5e02\u5834\uff0c\u5c07\u8cc7\u6599\u683c\u5f0f\u8a2d\u5b9a\u540c\u70ba\u53f0\u80a1\u7bc4\u4f8b\u5373\u53ef\uff0cindex\u70badatetime\u683c\u5f0f\uff0ccolumn\u70ba\u6587\u5b57\u683c\u5f0f\u7684\u6a19\u7684\u4ee3\u865f\uff0c\u6ce8\u610f\u6bcf\u65e5\u81ea\u52d5\u66f4\u65b0\u670d\u52d9\u4e0d\u9069\u7528\u53f0\u80a1\u8207\u52a0\u5bc6\u8ca8\u5e63\u7684\u8cc7\u6599\u3002     \u5fc5\u586b\u3002</li> <li><code>resample (str)</code>:     \u4ea4\u6613\u9031\u671f\u3002\u5c07 <code>position</code> \u7684\u8a0a\u865f\u4ee5\u9031\u671f\u6027\u7684\u65b9\u5f0f\u8ad6\u52d5\u80a1\u7968\uff0c\u9810\u8a2d\u70ba\u6bcf\u5929\u63db\u80a1\u3002\u5176\u4ed6\u5e38\u7528\u6578\u503c\u70ba <code>W</code>\u3001 <code>M</code> \u3001 <code>Q</code> \uff08\u6bcf\u9031\u3001\u6bcf\u6708\u3001\u6bcf\u5b63\u63db\u80a1\u4e00\u6b21\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>W-Fri</code> \u5728\u9031\u4e94\u7684\u6642\u5019\u7522\u751f\u65b0\u7684\u80a1\u7968\u6e05\u55ae\uff0c\u4e26\u4e14\u65bc\u4e0b\u9031\u4ea4\u6613\u65e5\u4e0b\u55ae\u3002\u66f4\u591afreq\u7684\u9078\u64c7\u8acb\u898bpandas\u6587\u4ef6\u3002</li> <li><code>trade_at_price (str)</code>:     \u9078\u64c7\u56de\u6e2c\u4e4b\u9084\u539f\u80a1\u50f9\u4ee5\u6536\u76e4\u50f9\u6216\u958b\u76e4\u50f9\u8a08\u7b97\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078'close'\u6216'open'\u3002</li> <li><code>fee_ratio (float)</code>:     \u4ea4\u6613\u624b\u7e8c\u8cbb\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u7121\u6253\u6298\u624b\u7e8c\u8cbb <code>0.001425</code>\u3002\u53ef\u8996\u500b\u4eba\u4f7f\u7528\u7684\u5238\u5546\u512a\u60e0\u8abf\u6574\u8cbb\u7387\u3002</li> <li><code>tax_ratio (float)</code>:     \u4ea4\u6613\u7a05\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u666e\u901a\u80a1\u4e00\u822c\u4ea4\u6613\u4ea4\u6613\u7a05\u7387 <code>0.003</code>\u3002\u82e5\u4ea4\u6613\u7b56\u7565\u7684\u6a19\u7684\u7686\u70baETF\uff0c\u8a18\u5f97\u8a2d\u6210 <code>0.001</code>\u3002</li> <li> <p><code>name (str)</code>:     \u7b56\u7565\u540d\u7a31\uff0c\u9810\u8a2d\u70ba <code>\u672a\u6307\u540d</code>\u3002\u7b56\u7565\u540d\u7a31\u3002\u76f8\u540c\u540d\u7a31\u4e4b\u7b56\u7565\u4e0a\u50b3\u6703\u8986\u5beb\u3002</p> <p>\u547d\u540d\u898f\u5247:\u5168\u82f1\u6587\u6216\u958b\u982d\u4e2d\u6587\uff0c\u4e0d\u63a5\u53d7\u958b\u982d\u82f1\u6587\u63a5\u4e2d\u6587\u3002 * <code>stop_loss (float)</code>: \u505c\u640d\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u640d\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u8667\u640d 10% \u6642\u51fa\u5834\u3002 * <code>take_profit (float)</code>: \u505c\u5229\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u5229\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u7372\u5229 10% \u6642\u51fa\u5834\u3002 * <code>position_limit(float)</code>: \u55ae\u6a94\u6a19\u7684\u6301\u80a1\u6bd4\u4f8b\u4e0a\u9650\uff0c\u63a7\u5236\u5009\u4f4d\u98a8\u96aa\u3002\u9810\u8a2d\u70baNone\u3002\u7bc4\u4f8b\uff1a0.2\uff0c\u4ee3\u8868\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u6709 20 % \u90e8\u4f4d\u3002 * <code>touched_exit(bool)</code>: \u89f8\u53ca\u5230\u8ce3\u51fa\u8a0a\u865f\u5373\u4ee5\u8a0a\u865f\u65e5\u7576\u4e0b\u51fa\u5834\u3002\u9810\u8a2d\u70baFalse\uff0c\u8a0a\u865f\u7522\u751f\u5f8c\u9694\u65e5\u51fa\u5834\u3002 * <code>mae_mfe_window(int)</code>: \u8a08\u7b97mae_mfe\u65bc\u9032\u5834\u5f8c\u65bc\u4e0d\u540c\u6301\u6709\u5929\u6578\u4e0b\u7684\u6578\u64da\u8b8a\u5316\uff0c\u4e3b\u8981\u61c9\u7528\u70baedge_ratio (\u512a\u52e2\u6bd4\u7387)\u8a08\u7b97\u3002\u9810\u8a2d\u70ba0\uff0c\u5247<code>Report.display_mae_mfe_analysis(...)</code>\u4e2d\u7684edge_ratio\u4e0d\u6703\u986f\u73fe\u3002 * <code>mae_mfe_window_step(int)</code>: \u8207mae_mfe_window\u53c3\u6578\u505a\u642d\u914d\uff0c\u70ba\u6642\u9593\u9593\u9694\u8a2d\u5b9a\uff0c\u9810\u8a2d\u70ba1\u3002\u82e5mae_mfe_window\u8a2d20\uff0cmae_mfe_window_step\u8a2d\u5b9a\u70ba2\uff0c\u76f8\u7576\u65bcpython\u7684range(0,20,2)\uff0c\u4ee52\u65e5\u70ba\u9593\u8ddd\u8a08\u7b97mae_mfe\u3002 * <code>upload(bool)</code>: \u4e0a\u50b3\u7b56\u7565\u81f3finlab\u7db2\u7ad9\uff0c\u9810\u8a2d\u70baTrue\uff0c\u4e0a\u50b3\u7b56\u7565\u3002\u7bc4\u4f8b\uff1a False\uff0c\u4e0d\u4e0a\u50b3\uff0c\u53ef\u7528 <code>finlab.backtest.sim(position, upload=False, ...).display()</code> \u5feb\u901f\u6aa2\u8996\u7b56\u7565\u7e3e\u6548\u3002</p> </li> </ul>"},{"location":"details/document/#_23","title":"\u8fd4\u56de\u503c","text":"<ul> <li><code>finlab.report.Report()</code></li> </ul> <p>\u6b64\u6642\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u9ede\u9078\u4e0b\u65b9\u7684\u300c\u9078\u80a1\u6e05\u55ae\u300d\u4f86\u67e5\u770b\u4eca\u5929\u7684\u6301\u80a1\u72c0\u6cc1\uff0c\u751a\u81f3\u662f\u624b\u52d5\u8ddf\u55ae\uff0c\u4f86\u5c07\u865b\u64ec\u7684\u7372\u5229\u8b8a\u6210\u73fe\u5be6\u3002</p> <p></p>"},{"location":"details/document/#_24","title":"\u591a\u7a7a\u4e26\u5b58\u56de\u6e2c","text":"<p>\u82e5\u7b56\u7565\u60f3\u540c\u6642\u505a\u591a\u548c\u505a\u7a7a\uff0c\u53ef\u53c3\u8003\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u7bc4\u4f8b\u662f\u505a\u591a 2330 \u4e00\u534a\u7684\u90e8\u4f4d\uff0c\u505a\u7a7a 1101 \u4e00\u534a\u7684\u90e8\u4f4d\u3002</p> <pre><code>from finlab import data\nfrom finlab import backtest\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = close &lt; 0\nposition['2330'] = 0.5\nposition['1101'] = -0.5\nr = backtest.sim(position)\nr.display()\n</code></pre>"},{"location":"details/document/#report","title":"Report\u7269\u4ef6","text":"<p><code>class finlab.report.Report()</code></p> <p>\u7522\u751f\u7b56\u7565\u5206\u6790\u5831\u544a\u3002</p>"},{"location":"details/document/#_25","title":"\u5c6c\u6027:","text":"<p><code>Report.position</code>: \u5f97\u5230\u6bcf\u65e5\u6b77\u53f2\u90e8\u4f4d\u660e\u7d30 (pd.Dataframe)\u3002</p> <p><code>Report.creturn</code>: \u5f97\u5230\u7b56\u7565\u5831\u916c\u7387\u8b8a\u5316 (pd.Series)\u3002</p> <p><code>Report.benchmark</code>: \u8a2d\u5b9a\u5c0d\u6a19\u6a19\u6e96 (pd.Series)\u3002\u9810\u8a2d\u70baNone\uff0c\u53f0\u80a1\u5c0d\u6a19\u53f0\u80a1\u52a0\u6b0a\u5831\u916c\u6307\u6578\uff0c\u52a0\u5bc6\u8ca8\u5e63\u5c0d\u6a19BTC/USD\u8d70\u52e2\u3002\u82e5\u8981\u6539\u70ba\u5c0d\u6a190050\u6216\u5176\u4ed6\u6a19\u7684\uff0c\u7bc4\u4f8b\u5982\u4e0b\u3002</p> <pre><code>from finlab import data,backtest\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition=(1/(pb * close) * (close &gt; close.average(60)) * (close &gt; 5)).is_largest(20)\nrr=backtest.sim(position=-position.astype(float),resample='Q',upload=False)\nrr.benchmark = close['0050']\nrr.display()\n</code></pre>"},{"location":"details/document/#_26","title":"\u65b9\u6cd5:","text":"<p><code>Report.display()</code>: \u986f\u793a\u7b56\u7565\u7e3e\u6548\u5716\u3002 </p> <p><code>Report.get_stats()</code>: \u53d6\u5f97\u7b56\u7565\u7d71\u8a08\u6578\u64da\uff0c\u5982\u590f\u666e\u7387\u3001\u7d22\u63d0\u8afe\u6bd4\u7387\u3001\u6700\u5927\u56de\u6a94\u3001\u8fd1\u671f\u5831\u916c\u7387\u7d71\u8a08\u3002</p> <p><code>Report.get_trades()</code>: \u53d6\u5f97\u7b56\u7565\u6bcf\u7b46\u4ea4\u6613\u7d00\u9304\u8cc7\u6599\u3002</p> <p><code>Report.display_mae_mfe_analysis(...)</code>: \u986f\u793a\u6ce2\u52d5\u5206\u6790\u5716\u7d44\u3002 \u5206\u6790\u4f7f\u7528\u8aaa\u660e\u3002</p>"},{"location":"details/document/#_27","title":"\u8fd4\u56de\u503c","text":"<ul> <li><code>trade_record</code>: pd.Dataframe     ##### trade_record \u91cd\u9ede\u6b04\u4f4d\u8aaa\u660e<ul> <li>exit_sig_date:\u9032\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>entry_sig_date:\u51fa\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>entry_date:\u9032\u5834\u65e5\u3002</li> <li>exit_date:\u51fa\u5834\u65e5\u3002</li> <li>return:\u5831\u916c\u7387\u3002</li> <li>mdd:\u6301\u6709\u671f\u9593\u6700\u5927\u56de\u64a4\u3002</li> <li>mae:\u6301\u6709\u671f\u9593\u6700\u5927\u4e0d\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>gmfe:\u6301\u6709\u671f\u9593\u6700\u5927\u6709\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>bmfe:mae\u767c\u751f\u524d\u7684\u6700\u5927\u6709\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>position: \u6301\u6709\u4f54\u6bd4\u3002</li> <li>period:\u6301\u6709\u5929\u6578\u3002</li> <li>pdays:\u8655\u65bc\u7372\u5229\u6642\u7684\u5929\u6578\u3002</li> </ul> </li> </ul>"},{"location":"details/document/#_28","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>atr_freq(int)</code>: edge_ratio\u4f7f\u7528\u7684 ATR \u6642\u6bb5\u9031\u671f\u53c3\u6578\u3002\u9810\u8a2d\u70ba10\u3002</li> <li><code>violinmode(str)</code>: violin\u578b\u614b\u7d71\u8a08\u5716\u6a23\u5f0f\uff0c\u6a21\u5f0f\u5206\u70ba'group'\u8207'overlay'\u3002\u9810\u8a2d\u70ba'group'\uff0c'group'\u6a21\u5f0f\u70ba\u5c07\u4ea4\u6613\u52dd\u6557\u624b\u5206\u7fa4\u7d71\u8a08\u5448\u73fe'\uff0c'overlay'\u63a1\u53d6\u5168\u6578\u7d71\u8a08\u3002</li> </ul>"},{"location":"details/document/#_29","title":"\u8fd4\u56de\u503c","text":"<ul> <li><code>figure(obj)</code></li> </ul>"},{"location":"details/document/#_30","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<pre><code>from finlab import data\nfrom finlab.backtest import sim\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = (1/(pb * close) * (close &gt; close.average(60)) * (close &gt; 5)).is_largest(20)\nreport = sim(position, resample='Q',mae_mfe_window=30,mae_mfe_window_step=2)\nreport.position\nreport.creturn\nreport.benchmark = data.get('benchmark_return:\u767c\u884c\u91cf\u52a0\u6b0a\u80a1\u50f9\u5831\u916c\u6307\u6578').squeeze()\nreport.display()\nreport.get_trades()\n#report.display_mae_mfe_analysis()\n</code></pre>"},{"location":"details/document/#_31","title":"\u56de\u6e2c\u8a9e\u6cd5\u7cd6","text":"<p><code>class finlab.dataframe.FinlabDataFrame()</code></p> <p>\u9664\u4e86\u4f7f\u7528\u719f\u6089\u7684 Pandas \u8a9e\u6cd5\u5916\uff0c\u6211\u5011\u4e5f\u63d0\u4f9b\u5f88\u591a\u8a9e\u6cd5\u7cd6\uff0c\u8b93\u5927\u5bb6\u958b\u767c\u7a0b\u5f0f\u6642\uff0c\u53ef\u4ee5\u7528\u7c21\u6613\u7684\u8a9e\u6cd5\u5b8c\u6210\u8907\u96dc\u7684\u529f\u80fd\uff0c\u8b93\u958b\u767c\u7b56\u7565\u66f4\u7c21\u6f54\uff01\u6211\u5011\u5c07\u6240\u6709\u7684\u8a9e\u6cd5\u7cd6\u5305\u88f9\u5728 <code>FinlabDataFrame</code> \u4e2d\uff0c\u7528\u8d77\u4f86\u8ddf <code>pd.DataFrame</code> \u4e00\u6a23\uff0c\u4f46\u662f\u591a\u4e86\u5f88\u591a\u529f\u80fd\uff01\u53ea\u8981\u4f7f\u7528 <code>finlab.data.get()</code> \u6240\u7372\u5f97\u7684\u8cc7\u6599\uff0c\u7686\u70ba <code>FinlabDataFrame</code> \u683c\u5f0f\uff0c\u63a5\u4e0b\u4f86\u6211\u5011\u5c31\u4f86\u770b\u770b\uff0c <code>FinlabDataFrame</code> \u6709\u54ea\u4e9b\u597d\u7528\u7684\u8a9e\u6cd5\u7cd6\u5427\uff01</p>"},{"location":"details/document/#_32","title":"\u65e5\u6708\u5b63\u4e0d\u7b49\u5f0f\u3001\u56db\u5247\u904b\u7b97","text":"<p>\u7576\u8cc7\u6599\u65e5\u671f\u6c92\u6709\u5c0d\u9f4a\uff08\u4f8b\u5982: \u8ca1\u5831 vs \u6536\u76e4\u50f9 vs \u6708\u5831\uff09\u6642\uff0c\u5728\u4f7f\u7528\u4ee5\u4e0b\u904b\u7b97\u7b26\u865f\uff1a<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&amp;</code>, <code>|</code>, <code>~</code>\uff0c\u4e0d\u9700\u8981\u5148\u5c07\u8cc7\u6599\u5c0d\u9f4a\uff0c\u56e0\u70ba <code>FinlabDataFrame</code> \u6703\u81ea\u52d5\u5e6b\u4f60\u8655\u7406\uff0c\u4ee5\u4e0b\u662f\u793a\u610f\u5716\u3002</p> <p></p> <p>\u4ee5\u4e0b\u662f\u7bc4\u4f8b\uff1a<code>cond1</code> \u8207 <code>cond2</code> \u5206\u5225\u70ba\u300c\u6bcf\u5929\u300d\uff0c\u548c\u300c\u6bcf\u5b63\u300d\u7684\u8cc7\u6599\uff0c\u5047\u5982\u8981\u53d6\u4ea4\u96c6\u7684\u6642\u9593\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8a9e\u6cd5\uff1a</p> <pre><code>from finlab import data\n\b# \u53d6\u5f97 FinlabDataFrame\nclose = data.get('price:\u6536\u76e4\u50f9')\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\n# \u904b\u7b97\u5169\u500b\u9078\u80a1\u689d\u4ef6\u4ea4\u96c6\ncond1 = close &gt; 37\ncond2 = roa &gt; 0\ncond_1_2 = cond1 &amp; cond2\n</code></pre> <p>\u64f7\u53d6 1101 \u53f0\u6ce5 \u7684\u8a0a\u865f\u5982\u4e0b\u5716\uff0c\u53ef\u4ee5\u770b\u5230 <code>cond1</code> \u8ddf <code>cond2</code> \u8a0a\u865f\u7684\u983b\u7387\u96d6\u7136\u4e0d\u76f8\u540c\uff0c\u4f46\u662f\u7531\u65bc <code>cond1</code> \u8ddf <code>cond2</code> \u662f <code>FinlabDataFrame</code>\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u53d6\u4ea4\u96c6\uff0c\u800c\u4e0d\u7528\u8655\u7406\u8cc7\u6599\u983b\u7387\u5c0d\u9f4a\u7684\u554f\u984c\u3002</p> <p></p>"},{"location":"details/document/#_33","title":"\u5747\u7dda","text":"<p><code>FinlabDataFrame.average(n)</code></p> <p>\u53d6 n \u7b46\u79fb\u52d5\u5e73\u5747\uff0c\u82e5\u80a1\u7968\u5728\u6642\u9593\u7a97\u683c\u5167\uff0c\u6709 N/2 \u7b46 NaN\uff0c\u5247\u6703\u7522\u751f NaN\u3002</p>"},{"location":"details/document/#_34","title":"\u7bc4\u4f8b\uff1a\u80a1\u50f9\u5728\u5747\u7dda\u4e4b\u4e0a","text":"<p><pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nsma = close.average(10)\ncond = close &gt; sma\n</code></pre> \u53ea\u9700\u8981\u7c21\u55ae\u7684\u8a9e\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5c07\u5176\u4e2d\u4e00\u90e8\u5206\u7684\u8a0a\u865f\u7e6a\u88fd\u51fa\u4f86\u6aa2\u67e5\uff1a <pre><code>import matplotlib.pyplot as plt\nclose.loc['2021', '2330'].plot()\nsma.loc['2021', '2330'].plot()\ncond.loc['2021', '2330'].mul(20).add(500).plot()\nplt.legend(['close', 'sma', 'cond'])\n</code></pre> </p>"},{"location":"details/document/#n","title":"\u6bcf\u5217\u6578\u503c\u6700\u5927\u7684 n \u6a94\u80a1\u7968","text":"<p><code>FinlabDataFrame.is_largest(n)</code></p> <p>\u53d6\u6bcf\u5217\u524d n \u7b46\u5927\u7684\u6578\u503c\uff0c\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5927\u7684\u80a1\u7968</p> <p></p>"},{"location":"details/document/#roa-10","title":"\u9078\u80a1\u7bc4\u4f8b\uff1a\u6bcf\u5b63 ROA \u524d 10 \u540d\u7684\u80a1\u7968","text":"<pre><code>from finlab import data\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\ngood_stocks = roa.is_largest(10)\n</code></pre>"},{"location":"details/document/#n_1","title":"\u6bcf\u5217\u6578\u503c\u6700\u5c0f\u7684 n \u6a94\u80a1\u7968","text":"<p><code>FinlabDataFrame.is_smallest(n)</code></p> <p>\u53d6\u6bcf\u5217\u524d n \u7b46\u5c0f\u7684\u6578\u503c\uff0c\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5c0f\u7684\u80a1\u7968</p>"},{"location":"details/document/#10","title":"\u7bc4\u4f8b\uff1a\u80a1\u50f9\u6de8\u503c\u6bd4\u6700\u5c0f\u7684 10 \u6a94\u80a1\u7968","text":"<pre><code>from finlab import data\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\ncheap_stocks = pb.is_smallest(10)\n</code></pre>"},{"location":"details/document/#_35","title":"\u8a0a\u865f\u9032\u51fa\u5834","text":"<p><code>entries.hold_until(exits, ...)</code></p> <p>\u9019\u5927\u6982\u662f\u6240\u6709\u7b56\u7565\u64b0\u5beb\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u8a9e\u6cd5\u7cd6\uff0c\u4e0a\u8ff0\u8a9e\u6cd5\u4e2d <code>entries</code> \u70ba\u9032\u5834\u8a0a\u865f\uff0c\u800c <code>exits</code> \u662f\u51fa\u5834\u8a0a\u865f\u3002\u6240\u4ee5 <code>entries.hold_until(exits)</code> \uff0c\u5c31\u662f\u9032\u5834\u8a0a\u865f\u70ba <code>True</code> \u6642\uff0c\u8cb7\u5165\u4e26\u6301\u6709\u8a72\u6a94\u80a1\u7968\uff0c\u76f4\u5230\u51fa\u5834\u8a0a\u865f\u70ba <code>True</code> \u5247\u8ce3\u51fa\u3002</p> <p></p> <p>\u6b64\u51fd\u5f0f\u6709\u5f88\u591a\u7d30\u90e8\u8a2d\u5b9a\uff0c\u53ef\u4ee5\u8b93\u4f60\u6700\u591a\u9078\u64c7 N \u6a94\u80a1\u7968\u505a\u8f2a\u52d5\u3002\u53e6\u5916\uff0c\u7576\u8d85\u904e N \u6a94\u9032\u5834\u8a0a\u865f\u767c\u751f\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u5ba2\u5236\u5316\u7684\u6392\u5e8f\uff0c\u9078\u64c7\u512a\u5148\u9078\u5165\u7684\u80a1\u7968\u3002\u6700\u5f8c\uff0c\u53ef\u4ee5\u6301\u5916\u8a2d\u5b9a\u505c\u640d\u505c\u5229\uff0c\u4f86\u589e\u52a0\u51fa\u5834\u7684\u6642\u6a5f\u9ede\u3002\u4ee5\u4e0b\u662f <code>hold_until</code> \u7684\u53c3\u6578\u8aaa\u660e\uff1a</p> <ul> <li><code>exit (pd.Dataframe)</code>: \u51fa\u5834\u8a0a\u865f\u3002</li> <li><code>nstocks_limit (int)</code>: \u8f2a\u52d5\u6a94\u6578\u4e0a\u9650\uff0c\u9810\u8a2d\u70baNone\u3002</li> <li><code>stop_loss (float)</code>: \u505c\u640d\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u640d\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0b\u8dcc 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</li> <li><code>take_profit (float)</code>: \u505c\u5229\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u5229\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0a\u6f32 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</li> <li><code>trade_at (str)</code>: \u505c\u640d\u505c\u5229\u53c3\u8003\u50f9\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078 <code>close</code> \u6216 <code>open</code>\u3002</li> <li><code>rank (pd.Dataframe)</code>: \u7576\u5929\u9032\u5834\u8a0a\u865f\u6578\u91cf\u8d85\u904e nstocks_limit \u6642\uff0c\u4ee5 rank \u6578\u503c\u8d8a\u5927\u7684\u80a1\u7968\u512a\u5148\u9032\u5834\u3002</li> </ul> <p>Note</p> <p>\u82e5\u8981\u4f7f\u7528 hold_until \u8207\u505c\u640d\u505c\u5229\uff0c\u5c07\u505c\u640d\u505c\u5229\u8a2d\u7f6e\u5728 hold_until \u5167\u5373\u53ef\uff0c\u4e0d\u53ef\u5c07\u505c\u640d\u505c\u5229\u8a2d\u7f6e\u5728<code>finlab.backtest.sim</code>\uff0c\u4ee5\u907f\u514d\u885d\u7a81\u3002</p>"},{"location":"details/document/#_36","title":"\u7b56\u7565\u7bc4\u4f8b","text":"<p>\u50f9\u683c &gt; 20 \u65e5\u5747\u7dda\u5165\u5834, \u50f9\u683c &lt; 60 \u65e5\u5747\u7dda\u51fa\u5834\uff0c\u6700\u591a\u6301\u670910\u6a94\uff0c\u8d85\u904e 10 \u500b\u9032\u5834\u8a0a\u865f\uff0c\u5247\u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u5c0f\u7684\u80a1\u7968\u512a\u5148\u9078\u5165\u3002</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\nclose = data.get('price:\u6536\u76e4\u50f9')\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')  \nsma20 = close.average(20)\nsma60 = close.average(60)\nentries = close &gt; sma20\nexits = close &lt; sma60\n\uff03pb\u524d10\u5c0f\u7684\u6a19\u7684\u505a\u8f2a\u52d5\nposition = entries.hold_until(exits, nstocks_limit=10, rank=-pb)\nsim(position)\n</code></pre>"},{"location":"details/document/#_37","title":"\u6578\u503c\u4e0a\u5347\u4e2d","text":"<p><code>rise(n=1)</code></p> <p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u9ad8\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002 </p>"},{"location":"details/document/#10_1","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u6536\u76e4\u50f9\u662f\u5426\u9ad8\u65bc10\u65e5\u524d\u80a1\u50f9","text":"<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise(10)\n</code></pre>"},{"location":"details/document/#_38","title":"\u6578\u503c\u4e0b\u964d\u4e2d","text":"<p><code>fall(n=1)</code></p> <p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u4f4e\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p>"},{"location":"details/document/#10_2","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u6536\u76e4\u50f9\u662f\u5426\u4f4e\u65bc10\u65e5\u524d\u80a1\u50f9","text":"<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').fall(10)\n</code></pre>"},{"location":"details/document/#n_2","title":"\u6301\u7e8c N \u5929\u6eff\u8db3\u689d\u4ef6","text":"<p><code>FinlabDataFrame.sustain(nwindow, nsatisfy=None)</code></p> <p>\u53d6\u79fb\u52d5 nwindow \u7b46\u52a0\u7e3d\u5927\u65bc\u7b49\u65bcnsatisfy\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p>"},{"location":"details/document/#_39","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u6536\u76e4\u50f9\u662f\u5426\u9023\u5169\u65e5\u4e0a\u6f32","text":"<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise().sustain(2)\n</code></pre>"},{"location":"details/document/#_40","title":"\u80a1\u7968\u7576\u5929\u6578\u503c\u5206\u4f4d\u6578","text":"<p><code>FinlabDataFrame.quantile_row(n=1)</code></p> <p>\u53d6\u5f97\u6bcf\u5217n\u5b9a\u5206\u4f4d\u6578\u7684\u503c\u3002</p>"},{"location":"details/document/#90","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u53d6\u6bcf\u65e5\u80a1\u50f9\u524d90\uff05\u5206\u4f4d\u6578","text":"<pre><code>from finlab import data\n# \ndata.get('price:\u6536\u76e4\u50f9').quantile_row(0.9)\n</code></pre>"},{"location":"details/document/#_41","title":"\u8ca1\u52d9\u6708\u5b63\u5831\u7d22\u5f15\u683c\u5f0f\u8f49\u63db","text":"<p><code>FinlabDataFrame.index_str_to_date()</code></p> <p>\u5c07\u4ee5\u4e0b\u8cc7\u6599\u7684\u7d22\u5f15:\u6708\u71df\u6536 (ex:2022M01) \uff0c\u8ca1\u52d9\u5b63\u5831 (ex:2022Q1) \u5f9e\u6587\u5b57\u683c\u5f0f\u8f49\u70ba\u516c\u544a\u622a\u6b62\u65e5\u7684datetime\u683c\u5f0f\uff0c\u901a\u5e38\u4f7f\u7528\u60c5\u5883\u70ba\u5c0d\u4e0d\u540c\u9031\u671f\u7684dataframe\u505areindex\uff0c\u5e38\u7528\u65bc\u4ee5\u516c\u544a\u622a\u6b62\u65e5\u70ba\u8a0a\u865f\u7522\u751f\u65e5\u7684\u6642\u5019\u3002</p>"},{"location":"details/document/#_42","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a","text":"<pre><code>from finlab import data\ndata.get('monthly_revenue:\u7576\u6708\u71df\u6536').index_str_to_date()\ndata.get('financial_statement:\u73fe\u91d1\u53ca\u7d04\u7576\u73fe\u91d1').index_str_to_date()\n</code></pre>"},{"location":"details/document/#_43","title":"\u7522\u696d\u5206\u7fa4","text":"<p><code>FinlabDataFrame.groupby_category()</code></p> <p>\u8cc7\u6599\u6309\u7522\u696d\u5206\u7fa4\uff0c\u985e\u4f3c <code>pd.DataFrame.groupby()</code>\u3002</p>"},{"location":"details/document/#_44","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u534a\u5c0e\u9ad4\u5e73\u5747\u80a1\u50f9\u6de8\u503c\u6bd4\u6642\u9593\u5e8f\u5217","text":"<p><pre><code>from finlab import data\npe = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\npe.groupby_category().mean()['\u534a\u5c0e\u9ad4'].plot()\n</code></pre> </p> <p>\u5168\u7403 2020 \u91cf\u5316\u5bec\u9b06\u52a0\u4e0a\u6676\u7247\u77ed\u7f3a\uff0c\u4f7f\u5f97\u534a\u5c0e\u9ad4\u80a1\u50f9\u6de8\u503c\u6bd4\u885d\u9ad8\u3002</p>"},{"location":"details/document/#_45","title":"\u9032\u5834\u9ede","text":"<p><code>FinlabDataFrame.is_entry()</code></p> <p>\u53d6\u9032\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p>"},{"location":"details/document/#10_3","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u9032\u5834\u9ede\u3002","text":"<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_entry()\n</code></pre>"},{"location":"details/document/#_46","title":"\u51fa\u5834\u9ede","text":"<p><code>FinlabDataFrame.is_exit()</code></p> <p>\u53d6\u51fa\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70ba True\uff0c\u53cd\u4e4b\u70ba False\u3002</p>"},{"location":"details/document/#10_4","title":"\u7a0b\u5f0f\u7bc4\u4f8b\uff1a\u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u51fa\u5834\u9ede\u3002","text":"<pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_entry()\n</code></pre>"},{"location":"details/document/#_47","title":"\u56de\u6e2c\u689d\u4ef6\u7bc4\u4f8b","text":""},{"location":"details/document/#_48","title":"\u5275\u65b0\u9ad8\u7b56\u7565","text":"<p>\u80a1\u7968\u6700\u5fcc\u8af1\u5c31\u662f\u300c\u8cb7\u9ad8\u8ce3\u4f4e\u300d\uff0c\u6c72\u6c72\u71df\u71df\uff0c\u4f46\u662f\u4f60\u6709\u6c92\u6709\u60f3\u904e\uff0c\u5927\u5bb6\u90fd\u6015\u8cb7\u9ad8\uff0c\u53cd\u800c\u8981\u8cb7\u66f4\u9ad8\uff1f \u5275\u65b0\u9ad8\u7684\u80a1\u7968\uff0c\u7531\u65bc\u53d7\u5230\u5e02\u5834\u7684\u95dc\u6ce8\uff0c\u4e0a\u6f32\u52d5\u80fd\u975e\u5e38\u5f37\uff0c\u6240\u4ee5\u9078\u64c7\u9019\u4e9b\u80a1\u7968\uff0c\u5c31\u80fd\u5e36\u4f86\u4e0d\u932f\u7684\u5831\u916c\u7387\u3002 \u4e0b\u65b9\u7684\u689d\u4ef6\uff0c\u4f7f\u7528\u4e86 <code>pd.DataFrame</code> \u88e1\u7684\u529f\u80fd <code>rolling(250).max()</code>\uff0c\u4ee3\u8868 250 \u5929\u7684\u6700\u9ad8\u50f9\uff0c \u5047\u5982\u4eca\u5929\u7684\u6536\u76e4\uff0c\u7b49\u65bc 250 \u5929\u7684\u6700\u9ad8\u50f9\uff0c\u5c31\u4ee3\u8868\u5275\u65b0\u9ad8\u4e86\uff01</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u5275 250 \u5929\u65b0\u9ad8\u7684\u80a1\u7968\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = (close == close.rolling(250).max())\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\uff0c\u9078\u51fa\u7576\u5929\u5275\u65b0\u9ad8\u80a1\u7968\nsim(position, resample='M', name=\"\u5275\u5e74\u65b0\u9ad8\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/document/#rsi","title":"\u9ad8 RSI \u6280\u8853\u6307\u6a19\u7b56\u7565","text":"<p>\u4e0a\u8ff0\u7b56\u7565\u6703\u9078\u51fa\u5f88\u591a\u6a94\u6a19\u7684\uff0c\u8981\u662f\u6211\u5011\u53ea\u60f3\u8981\u9078\u51fa 20 \u6a94\u8981\u600e\u9ebc\u5beb\u5462\uff1f\u9019\u500b\u7b56\u7565\u6211\u5011\u53ef\u4ee5\u5c07 RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\u7d0d\u5165\u7d44\u5408\uff0c\u4e26\u4e14\u6301\u6709\u4e00\u9031\uff0c\u4f86\u8a66\u8a66\u770b\u6548\u679c\u5982\u4f55\u3002\u6211\u5011\u53ef\u4ee5\u7528 <code>data.indicator</code> \u4f86\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI\uff0c\u4e5f\u53ef\u4ee5\u7528 <code>rsi.is_largest</code> \u4f86\u8a08\u7b97\u6b64\u80a1\u7968\u7684 RSI \u662f\u5426\u662f\u6700\u5927\u7684 20 \u6a94\u3002</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\nrsi = data.indicator('RSI')\nposition = rsi.is_largest(20)\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/document/#_49","title":"\u4e56\u96e2\u7387\u548c\u8ca1\u5831\u6ffe\u7db2\u7b56\u7565","text":"<p>\u53ef\u4ee5\u4e00\u6b21\u4f7f\u7528\u5169\u7a2e\u4e0d\u540c\u7684\u6307\u6a19\u4f86\u9078\u80a1\u55ce\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u800c\u4e14\u9019\u5169\u500b\u6307\u6a19\uff0c\u9084\u53ef\u4ee5\u662f\u6bcf\u5b63\u7684\u8ca1\u5831\u8ddf\u6bcf\u5929\u7684\u50f9\u683c\uff0c\u6df7\u548c\u689d\u4ef6\u9078\u80a1\uff0c\u7531\u65bc\u4e0b\u65b9\u7684 <code>roe</code> \u548c <code>close</code> \u4e26\u4e0d\u662f <code>pd.DataFrame</code> \u800c\u662f <code>finlab.dataframe.FinlabDataFrame</code> \uff0c\u7576\u5728\u505a\u689d\u4ef6\u904b\u7b97\uff0c\u4f8b\u5982\u4ea4\u96c6\u3001\u806f\u96c6\uff08and or\uff09\u6642\uff0c\u4e0d\u540c\u983b\u7387\u7684 index \u6703\u88ab\u53d6\u9023\u96c6\u4e26\u4e14\u6574\u5408\uff0c\u6240\u4ee5\u4f7f\u7528\u8005\u4e0d\u9700\u8981\u601d\u8003\uff0c\u7a76\u7adf\u8cc7\u6599\u662f\u300c\u5b63\u300d\u9084\u662f\u300c\u6708\u300d\u9084\u662f\u300c\u65e5\u300d\uff0c\u53ef\u4ee5\u76f4\u63a5\u7576\u4f5c index \u548c columns \u662f\u5c0d\u9f4a\u7684\uff0c\u76f4\u63a5\u904b\u7b97\uff08\u7a0b\u5f0f\u6703\u81ea\u52d5\u60f3\u8fa6\u6cd5\uff09\u3002</p> <p>\u4e0b\u9762\u7684\u7b56\u7565\uff0c\u5229\u7528 <code>close / close.shift(60)</code> \u8a08\u7b97\u4e56\u96e2\u7387\uff0c\u4e26\u53d6 30 \u6a94\u80a1\u7968\u51fa\u4f86\uff0c\u518d\u7528 ROE \u7576\u6ffe\u7db2\uff0c\u9078\u64c7 ROE \u70ba\u6b63\u7684\u80a1\u7968\u3002</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\n# \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\")\nclose = data.get('price:\u6536\u76e4\u50f9')\nposition = (\n(close / close.shift(60)).is_largest(30) # \u9078\u51fa\u4e56\u96e2\u7387\u524d 30 \u540d\u7684\u80a1\u7968\n&amp; (roe &gt; 0) # \u9078\u51fa ROE \u5927\u65bc 0 \u7684\u80a1\u7968\n)\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='M', name=\"\u4e56\u96e2\u7387\u548cROE\u6ffe\u7db2\u7b56\u7565\")\n</code></pre> <p></p>"},{"location":"details/document/#_50","title":"\u4e0b\u55ae\u4e32\u63a5","text":""},{"location":"details/document/#_51","title":"\u57f7\u884c\u4ea4\u6613\u7b56\u7565","text":"<p>\u76ee\u524d\u4ea4\u6613\u7cfb\u7d71\u50c5\u652f\u63f4 <code>finlab&gt;=0.3.0.dev1</code> \u7248\u672c\u3002\u5728\u4e0b\u55ae\u524d\uff0c\u8acb\u5148\u78ba\u8a8d\u5b89\u88dd\u4e86\u65b0\u7248\u7684 Package \u5594\uff01 \u9996\u5148\uff0c\u5728\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u958b\u76e4\u524d\uff0c\u57f7\u884c\u7b56\u7565\uff1a <pre><code>from finlab import backtest\n# write your own strategy\nreport = backtest.sim(...)\n</code></pre></p>"},{"location":"details/document/#_52","title":"\u8a08\u7b97\u80a1\u7968\u5f35\u6578","text":"<p>\u63a5\u4e0b\u4f86\uff0c\u986f\u793a\u6700\u8fd1\u7684\u90e8\u4f4d</p> <pre><code>print(report.current_trades)\n</code></pre> entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return entry_price exit_price mae gmfe bmfe mdd pdays weight next_weights stock_id 1416 \u5ee3\u8c50 2021-10-01 NaT 2021-09-30 2022-06-30 0.510197 159.0 3566.0 -1.0 -3.539823e-02 10.60 NaN -0.053097 0.070796 0.070796 -0.115702 37.0 0.060665 0.00 1453 \u5927\u5c07 2021-10-01 NaT 2021-09-30 2022-06-30 0.510197 159.0 3566.0 -1.0 2.348165e+00 8.43 NaN -0.086763 2.403782 0.245829 -0.624585 60.0 0.171264 0.00 1524 \u803f\u9f0e 2022-04-01 NaT 2022-03-31 2022-06-30 0.611632 39.0 3686.0 -1.0 -3.330669e-16 10.60 NaN -0.476658 0.015152 0.000000 -0.476658 2.0 0.122168 0.00 2543 \u7687\u660c 2021-10-01 NaT 2021-09-30 NaT 0.510197 159.0 3566.0 -1.0 1.073232e-01 7.46 NaN -0.063131 0.363636 0.008838 -0.268519 44.0 0.070298 0.05 2701 \u842c\u4f01 2022-04-01 NaT 2022-03-31 2022-06-30 0.611632 39.0 3686.0 -1.0 -3.330669e-16 12.05 NaN -0.025105 0.029289 0.029289 -0.052846 18.0 0.063107 0.00 <p>\u5047\u5982\u78ba\u8a8d\u6c92\u554f\u984c\uff0c\u53ef\u4ee5\u8a08\u7b97\u6bcf\u6a94\u80a1\u7968\u6295\u8cc7\u7684\u5f35\u6578\uff1a</p> <pre><code>from finlab.online.order_executor import Position\n# total fund\nfund = 1000000\nposition = Position.from_report(report, fund)\nprint(position)\n</code></pre> <p>[{'stock_id': '2330', 'quantity': 1, 'order_condition': }] <p>\u4e0a\u8ff0 <code>Position</code> \u4ee3\u8868\u60a8\u7684\u5e33\u6236\u4e2d\uff0c\u53ea\u5e0c\u671b\u6709\u4e00\u5f35 <code>2330</code> \u53f0\u7a4d\u96fb\u80a1\u7968\uff0c\u4e26\u4e14\u662f\u73fe\u8ca8\u3002</p>"},{"location":"details/document/#_53","title":"\u90e8\u4f4d\u589e\u6e1b\u8abf\u6574","text":"<p>\u6211\u5011\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8abf\u6574\u90e8\u4f4d\u5927\u5c0f</p> <pre><code># \u6e1b\u4e00\u5f35 2330 \u80a1\u7968\nnew_position = position - Position({'2330': 1})\n# \u589e\u52a0\u4e00\u5f35 1101 \u80a1\u7968\nnew_position = position + Position({'1101': 1})\n</code></pre>"},{"location":"details/document/#_54","title":"\u591a\u7b56\u7565\u6b0a\u91cd\u52a0\u7e3d","text":"<p>\u5047\u5982\u6211\u5011\u6709\u591a\u500b position\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u52a0\u7e3d\uff1a <pre><code>from finlab import backtest\nfrom finlab.online.order_executor import Position\nreport1 = backtest.sim(...)\nreport2 = backtest.sim(...)\nposition1 = Position.from_report(report1, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\nposition2 = Position.from_report(report2, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\ntotal_position = position1 + position2\n</code></pre></p>"},{"location":"details/document/#_55","title":"\u5be6\u969b\u4e0b\u55ae","text":""},{"location":"details/document/#1-api","title":"1 \u5b89\u88dd\u5238\u5546 API","text":"<p>\u76ee\u524d\u652f\u63f4 <code>\u7389\u5c71 Fugle</code> \u548c <code>\u6c38\u8c50</code> \u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71\uff0c\u5247\u4e00\u4f7f\u7528\u5373\u53ef\u3002 <pre><code># \u7389\u5c71 Fugle\npip install fugle-trade\n\n# \u6c38\u8c50\npip install shioaji\n</code></pre></p>"},{"location":"details/document/#2","title":"2 \u9023\u63a5\u8b49\u5238\u5e33\u6236","text":"<p>\u76ee\u524d\u652f\u63f4 <code>Fugle</code> \u548c <code>\u6c38\u8c50</code> \u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71\uff0c\u53ef\u4ee5\u5148\u5c07\u5e33\u865f\u5bc6\u78bc\u8a2d\u5b9a\u6210\u74b0\u5883\u8b8a\u6578\uff0c\u53ea\u8981\u91dd\u5c0d\u60a8\u9700\u8981\u7684\u5238\u5546\u4f86\u8a2d\u5b9a\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5169\u500b\u5238\u5546\u540c\u6642\u4e32\u63a5\u3002</p>"},{"location":"details/document/#21","title":"2.1 \u7389\u5c71\u5bcc\u679c \u5e33\u6236\u4e32\u63a5","text":"<p>\u8acb\u5148\u6309\u7167config \u6559\u5b78\u7372\u53d6 config \u8a2d\u5b9a\u6a94\u3002 \u4e26\u5230\u767b\u5165\u5bcc\u679cAPI\uff0c\u7372\u5f97\u5e02\u5834\u884c\u60c5 Token\u3002</p> <pre><code>from finlab.online.fugle_account import FugleAccount\nimport os\nos.environ['FUGLE_CONFIG_PATH'] = '\u7389\u5c71\u5bcc\u679c\u4ea4\u6613\u8a2d\u5b9a\u6a94(config.ini.example)\u8def\u5f91'\nos.environ['FUGLE_MARKET_API_KEY'] = '\u7389\u5c71\u5bcc\u679c\u7684\u884c\u60c5API Token'\nacc = FugleAccount()\n</code></pre>"},{"location":"details/document/#22","title":"2.2 \u6c38\u8c50\u5e33\u6236\u4e32\u63a5","text":"<p>\u8acb\u5148\u7372\u53d6\u6191\u8b49</p> <p>Windows \u6191\u8b49\u4e0b\u8f09\u65b9\u5f0f</p> <p>MacOS \u6191\u8b49\u4e0b\u8f09</p> <pre><code>import os\nfrom finlab.online.sinopac_account import SinopacAccount\nos.environ['SHIOAJI_ACCOUNT']= '\u6c38\u8c50\u8b49\u5238\u5e33\u865f'\nos.environ['SHIOAJI_PASSWORD']= '\u6c38\u8c50\u8b49\u5238\u5bc6\u78bc'\nos.environ['SHIOAJI_CERT_PATH']= '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nacc = SinopacAccount()\n</code></pre>"},{"location":"details/document/#3","title":"3 \u6279\u6b21\u4e0b\u55ae","text":"<p>\u6700\u5f8c\u5229\u7528 <code>OrderExecuter</code> \u5c07\u7576\u8b49\u5238\u5e33\u6236\u7684\u90e8\u4f4d\uff0c\u6309\u7167 <code>position</code> \u7684\u90e8\u4f4d\u9032\u884c\u8abf\u6574\u3002</p> <pre><code>from finlab.online.order_executor import OrderExecutor\n# Order Executer\norder_executer = OrderExecutor(position , account=acc)\n# \u4e0b\u55ae\u6aa2\u67e5\uff08\u700f\u89bd\u6a21\u5f0f\uff0c\u4e0d\u6703\u771f\u7684\u4e0b\u55ae\uff09\norder_executer.create_orders(view_only=True)\n# \u57f7\u884c\u4e0b\u55ae\uff08\u6703\u771f\u7684\u4e0b\u55ae\uff0c\u521d\u6b21\u4f7f\u7528\u5efa\u8b70\u6536\u5e02\u6642\u6e2c\u8a66\uff09\n# \u9810\u8a2d\u4f7f\u7528\u6700\u8fd1\u4e00\u7b46\u6210\u4ea4\u50f9\u7576\u6210\u9650\u50f9\norder_executer.create_orders()\n# \u66f4\u65b0\u9650\u50f9\uff08\u5c07\u6700\u5f8c\u4e00\u7b46\u6210\u4ea4\u50f9\u7576\u6210\u65b0\u7684\u9650\u50f9\uff09\norder_executer.update_order_price()\n# \u522a\u9664\u6240\u6709\u59d4\u8a17\u55ae\norder_executer.cancel_orders()\n</code></pre> <p> </p>"},{"location":"details/document/#_56","title":"\u7b56\u7565\u7ba1\u7406\u4ecb\u9762","text":""},{"location":"details/document/#_57","title":"\u522a\u9664\u7b56\u7565","text":"<p>\u9ede\u9078\u7b56\u7565\u53f3\u5074\u9f52\u8f2a\u7b26\u865f(\u4e0b\u5716\u7d05\u5708\u8655)\u522a\u9664\u7b56\u7565\u3002</p> <p></p>"},{"location":"details/document/#_58","title":"\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u7b56\u7565","text":"<p>\u9ede\u9078\u53f3\u4e0a\u201c\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u7b56\u7565\u201d\u6309\u9215\uff0c\u8a2d\u5b9a\u9700\u8981\u6bcf\u65e5\u81ea\u52d5\u66f4\u65b0\u6e05\u55ae\u8207\u56de\u6e2c\u7684\u7b56\u7565\uff0c\u9078\u53d6\u7b56\u7565\u540d\u7a31\u8207\u66f4\u65b0\u6642\u9593\uff0c\u76ee\u524d\u6bcf\u500b\u5e33\u865f\u9650\u5b9a3\u9805\u7b56\u7565\u53ef\u81ea\u52d5\u66f4\u65b0\u3002</p> <p>Note:\u9650\u5b9a\u4f7f\u7528Finlab IDE\u4ecb\u9762\u4e0a\u50b3\u7a0b\u5f0f\u5f8c\uff0c\u65b9\u53ef\u8a2d\u5b9a\u201c\u81ea\u52d5\u66f4\u65b0\u7b56\u7565\u201d\u3002\u4f7f\u7528colab\u6216\u5176\u4ed6\u7de8\u8f2f\u5668\u8005\uff0c\u53ef\u5728\u64b0\u5beb\u5b8c\u7b56\u7565\u5f8c\uff0c\u5c07\u7a0b\u5f0f\u8cbc\u65bcFinlab IDE\u4ecb\u9762\u57f7\u884c\u3002</p> <p></p>"},{"location":"details/document/#_59","title":"\u5206\u4eab\u7b56\u7565","text":"<p>Step1: \u9ede\u9078\u7b56\u7565\u540d\u7a31\u9032\u5165\u7b56\u7565\uff0c\u4e4b\u5f8c\u9ede\u9078\u5728\u7b56\u7565\u540d\u7a31\u65c1\u7684\u9f52\u8f2a\u7b26\u865f\u3002</p> <p></p> <p>Step2: \u9032\u5165\u201c\u7b56\u7565\u7db2\u5740\u7684\u5206\u4eab\u6b0a\u9650\u8a2d\u5b9a\uff0c\u672a\u8a2d\u5b9a\u516c\u958b\u524d\uff0c\u53ea\u6709\u5e33\u6236\u672c\u4eba\u624d\u80fd\u770b\u5230\u81ea\u5df1\u7684\u7b56\u7565\u3002\u82e5\u60f3\u5206\u4eab\u7b56\u7565\u6e05\u55ae\u8207\u76f8\u95dc\u7a0b\u5f0f\uff0c\u6b0a\u9650\u53ef\u4ee5\u9078\u64c7\u201c\u96b1\u85cf\u201d\u4e4b\u5916\u7684\u9078\u9805\u3002</p> <p></p> <p>Step3: \u78ba\u8a8d\u8a2d\u5b9a\u5f8c\uff0c\u5373\u53ef\u5206\u4eab\u7b56\u7565\u7684\u7db2\u5740\u7d66\u5176\u4ed6\u4eba\u53c3\u8003\u3002</p> <p></p>"},{"location":"details/document/#_60","title":"\u8996\u89ba\u5316\u5b50\u6a21\u7d44\uff08\u66ab\u4e0d\u652f\u63f4\u7db2\u9801\uff09","text":""},{"location":"details/document/#k","title":"K\u7dda\u5716\u7d44","text":"<p><code>finlab.plot.plot_tw_stock_candles(stock_id, recent_days=400, ...)</code></p> <p>\u7e6a\u88fdK\u7dda\u5716\uff0c\u53ef\u4ee5\u5404\u7a2e\u6280\u8853\u6307\u6a19\u8ddf K \u7dda\u5716\u4e00\u8d77\u7e6a\u88fd\u3002</p>"},{"location":"details/document/#_61","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>stock_id (str)</code>: \u5fc5\u586b\uff0c\u6a19\u5730\u4ee3\u78bc ex:2330\u3002</li> <li><code>recent_days (int)</code>: \u53d6\u8fd1n\u65e5\u5167\u7684\u8cc7\u6599\uff0c\u9810\u8a2d\u70ba400\u3002</li> <li><code>adjust_price (bool)</code>: \u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\uff0c\u9810\u8a2d\u70baFalse\u3002</li> <li><code>resample (str)</code>: \u6280\u8853\u6307\u6a19\u50f9\u683c\u9031\u671f\uff0c\u9810\u8a2d\u70ba'D'\uff0c\u7bc4\u4f8b\uff1a<code>D</code> \u4ee3\u8868\u65e5\u7dda, <code>W</code>\u4ee3\u8868\u9031\u7dda, <code>M</code> \u4ee3\u8868\u6708\u7dda\u3002</li> <li><code>overlay_func (dict)</code>: \u4e3b\u5716\u8f14\u52a9\u7dda\uff0c\u9810\u8a2d\u70baNone\uff0c\u986f\u793a\u5e03\u6797\u901a\u9053\u3002\u7bc4\u4f8b\u53ef\u4ee5\u53c3\u8003\u4e0b\u65b9\u6559\u5b78     \u81ea\u5b9a\u7fa9\u683c\u5f0f\u5beb\u6cd5\u5982\u4e0b:     <pre><code>{\n'ema_5':lambda df:abstract.EMA(df['close'],timeperiod=5),\n'ema_10':lambda df:abstract.EMA(df['close'],timeperiod=10),\n'ema_20':lambda df:abstract.EMA(df['close'],timeperiod=20),\n'ema_60':lambda df:abstract.EMA(df['close'],timeperiod=60),\n}\n</code></pre></li> <li><code>technical_func(dict or dict in list)</code>: \u6280\u8853\u6307\u6a19\u5b50\u5716\uff0c\u9810\u8a2d\u70baNone\uff0c\u986f\u793aKD\u6307\u6a19\u3002     \u81ea\u5b9a\u7fa9\u683c\u5f0f\u5beb\u6cd5\u5982\u4e0b:     <pre><code>from talib import abstract\n{\n'rsi_10':lambda df:abstract.RSI(df['close'],timeperiod=10),\n'rsi_20':lambda df:abstract.RSI(df['close'],timeperiod=20),\n}\n</code></pre>     technical_func \u70badict in list\u683c\u5f0f\uff0c\u53ef\u4efb\u610f\u8a2d\u5b9a\u6280\u8853\u6307\u6a19\u7d44\u6578\uff0c\u50cf\u662f\u7bc4\u4f8b\u6703\u7522\u751f\u5169\u7d44\u6280\u8853\u6307\u6a19\u5716\uff1a     <pre><code>from talib import abstract\ntechnical_func = [\n{\n'rsi_10': lambda df: abstract.RSI(df['close'], timeperiod=10),\n'rsi_20': lambda df: abstract.RSI(df['close'], timeperiod=20),\n},\n{\n'K': lambda df: abstract.STOCH(df['high'],df['low'],df['close'])[0],\n'D': lambda df: abstract.STOCH(df['high'],df['low'],df['close'])[1],\n}\n]\n</code></pre></li> </ul>"},{"location":"details/document/#_62","title":"\u5716\u4f8b","text":""},{"location":"details/document/#_63","title":"\u7bc4\u4f8b\u4e00\uff1a\u55ae\u4e00\u80a1\u7968\u7e6a\u5716","text":"<p>\u6700\u7c21\u55ae\u7684\u7bc4\u4f8b\u5982\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u547c\u53eb\u4e26\u4e14\u7e6a\u88fd <code>2330</code> \u53f0\u7a4d\u96fb\u7684\u80a1\u50f9 <pre><code>from finlab.plot import plot_tw_stock_candles\nplot_tw_stock_candles(\"2330\")\n</code></pre></p>"},{"location":"details/document/#_64","title":"\u7bc4\u4f8b\u4e8c\uff1a\u65e5\u3001\u6708\u7dda\u7e6a\u5716","text":"<pre><code>from finlab.plot import plot_tw_stock_candles\nplot_tw_stock_candles(\"2330\", resample=\"M\")\n</code></pre>"},{"location":"details/document/#_65","title":"\u7bc4\u4f8b\u4e09\uff1a\u5ba2\u5236\u5316\u6280\u8853\u6307\u6a19\u7e6a\u5716","text":"<p>\u6211\u5011\u53ef\u4ee5\u984d\u5916\u4f7f\u7528 <code>talib</code> \u4f86\u7e6a\u88fd\u60f3\u8981\u770b\u7684\u6280\u8853\u6307\u6a19\uff0c\u4f8b\u5982 5\u65e5\u300110\u65e5\u300120\u65e5\u7684\u79fb\u52d5\u5e7e\u4f55\u5e73\u5747\uff0c\u7531\u65bc\u9019\u4e9b\u6280\u8853\u6307\u6a19\uff0c\u662f\u8ddf\u80a1\u50f9\u7e6a\u88fd\u5728\u4e00\u8d77\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 <code>overlay_function</code> \u9019\u500b\u53c3\u6578\u3002</p> <pre><code>from finlab.plot import plot_tw_stock_candles\nfrom talib import abstract\noverlay_func = {\n'ema_05': lambda df: abstract.EMA(df.close, timeperiod=5),\n'ema_10': lambda df: abstract.EMA(df.close, timeperiod=10),\n'ema_20': lambda df: abstract.EMA(df.close, timeperiod=20),\n}\nplot_tw_stock_candles(\"2330\", overlay_func=overlay_func)\n</code></pre>"},{"location":"details/document/#_66","title":"\u7bc4\u4f8b\u56db\uff1a\u5ba2\u5236\u5316\u6280\u8853\u6307\u6a19\u7e6a\u5716","text":"<p>\u8207\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u4e0d\u540c\uff0c\u6280\u8853\u6307\u6a19\u5982 KD\u3001RSI\uff0c\u4e0d\u80fd\u8ddf\u80a1\u50f9\u7e6a\u88fd\u5728\u540c\u4e00\u5f35\u5716\u8868\uff0c\u9700\u8981\u984d\u5916\u5728\u4e0d\u540c\u7684\u5716\u8868\u4e0a\u7e6a\u88fd\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>technical_func</code> \u4f86\u7e6a\u88fd\uff0c<code>technical_func</code> \u70badict in list\u683c\u5f0f\uff0c\u53ef\u4efb\u610f\u8a2d\u5b9a\u6280\u8853\u6307\u6a19\u7d44\u6578\uff0c\u50cf\u662f\u7bc4\u4f8b\u6703\u7522\u751f\u5169\u7d44\u6280\u8853\u6307\u6a19\u5716\uff1a</p> <pre><code>from finlab.plot import plot_tw_stock_candles\nfrom talib import abstract\ntechnical_func = [\n{\n'rsi_10': lambda df: abstract.RSI(df['close'], timeperiod=10),\n'rsi_20': lambda df: abstract.RSI(df['close'], timeperiod=20),\n},\n{\n'K': lambda df: abstract.STOCH(df['high'],df['low'],df['close'])[0],\n'D': lambda df: abstract.STOCH(df['high'],df['low'],df['close'])[1],\n}\n]\nplot_tw_stock_candles(\"2330\", technical_func=technical_func)\n</code></pre>"},{"location":"details/document/#_67","title":"\u6a39\u72c0\u677f\u584a\u5730\u5716","text":"<p><code>finlab.plot.plot_tw_stock_treemap(start, end, ...)</code></p> <p>\u677f\u584a\u5730\u5716\uff0c\u53ef\u4ee5\u7528\u4f86\u77ad\u89e3\u80a1\u7968\u7684\u6210\u4ea4\u91cf\u5206\u4f48\uff0c\u4ee5\u53ca\u73fe\u91d1\u6d41\u7684\u8f49\u63db\u3002</p>"},{"location":"details/document/#_68","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>start (str)</code>: \u5fc5\u586b\uff0c\u8cc7\u6599\u8d77\u59cb\u65e5\uff0cex:2021-01-02\u3002</li> <li><code>end (str)</code>: \u5fc5\u586b\uff0c \u8cc7\u6599\u7d50\u675f\u65e5\uff0cex:2021-01-05\u3002</li> <li><code>adjust_price (bool)</code>: \u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\uff0c\u9810\u8a2d\u70baFalse\u3002</li> <li><code>area_ind (str)</code>: \u6c7a\u5b9a\u677f\u584a\u9762\u7a4d\u5927\u5c0f\u7684\u53c3\u6578\uff0c\u9810\u8a2d\u70ba'market_value'\uff0c\u53ef\u9078\u7bc4\u570d\u70ba<code>[\"market_value\", \"turnover\", \"turnover_ratio\"]</code>(\u5206\u5225\u70ba\uff1a\u5e02\u503c\u3001\u4ea4\u6613\u529b\u91cf\u3001\u4ea4\u6613\u4f54\u6bd4)\u3002</li> <li><code>item (str)</code>: \u6c7a\u5b9a\u677f\u584a\u9762\u7a4d\u5927\u5c0f\u7684\u53c3\u6578\uff0c\u9810\u8a2d\u70ba'return_ratio'\uff0c\u9810\u8a2d\u53ef\u9078\u7bc4\u570d\u70ba<code>[\"return_ratio\", \"turnover_ratio\"]</code>\u6216\u662f\u5e36\u5165finlab database\u7684\u4f7f\u7528\u65b9\u6cd5\uff0cex:<code>'price_earning_ratio:\u672c\u76ca\u6bd4'</code>\u3002</li> <li> <p><code>color_scales (str)</code>: \u8272\u6eab\u689d\u6a23\u5f0f\uff0c\u9810\u8a2d\u70ba'Temps'\u3002     \u6a23\u5f0f\u9078\u64c7\u8a73\u7d30\u8cc7\u8a0a\u3002</p> </li> <li> <p><code>clip (tuple)</code>: \u6578\u503c\u9650\u5b9a\u7bc4\u570d\uff0c\u9810\u8a2d\u70baNone\u3002\u907f\u514d\u6578\u503c\u7bc4\u570d\u904e\u5927\u8b93\u8272\u6eab\u986f\u793a\u904e\u6de1\uff0cex:(0,100)\u3002</p> </li> </ul>"},{"location":"details/document/#_69","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u7bc4\u4f8b\u70ba\u4f7f\u7528\u6b64\u51fd\u5f0f\uff0c\u7e6a\u88fd\u51fa <code>2021-7-1</code> ~ <code>2021-7-2</code> \u7684\u6210\u4ea4\u91cf\u7684\u6bd4\u4f8b\u3002\u5176\u9762\u7a4d\u662f\u6210\u4ea4\u91cf\u7684\u5927\u5c0f\uff0c\u800c\u984f\u8272\u5247\u662f\u4e0a\u6f32\u6216\u4e0b\u8dcc\u7684\u5e45\u5ea6\u3002 <pre><code>from finlab.plot import plot_tw_stock_treemap\nplot_tw_stock_treemap(\nstart='2021-7-1',\nend='2021-7-2',\narea_ind='turnover_ratio',\nitem='turnover_ratio')\n</code></pre> </p>"},{"location":"details/document/#pepb","title":"PE\u3001PB \u6cb3\u6d41\u5716","text":"<p><code>finlab.plot.plot_tw_stock_river(start=None, end=None, stock_id='2330', mode='pe', split_range=8)</code></p> <p>\u6cb3\u6d41\u5716\uff0c\u53ef\u4ee5\u7528\u4f86\u77ad\u89e3\u80a1\u7968\u6307\u6a19\u7684\u6b77\u53f2\u4f4d\u968e\u3002</p>"},{"location":"details/document/#_70","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>start (str)</code>: \u8cc7\u6599\u8d77\u59cb\u65e5\uff0c\u9810\u8a2d\u70baNone\uff0c\u5e36\u5165\u5168\u90e8\u8cc7\u6599\u3002ex:'2021-01-02'\u3002</li> <li><code>end (str)</code>: \u8cc7\u6599\u7d50\u675f\u65e5\uff0c\u9810\u8a2d\u70baNone\uff0c\u5e36\u5165\u5168\u90e8\u8cc7\u6599\u3002ex:'2021-01-05'\u3002</li> <li><code>stock_id (str)</code>: \u80a1\u865f\uff0c\u9810\u8a2d\u70ba'2330'\uff0cex:'2330'\u3002</li> <li><code>mode (str)</code>: \u8cc7\u6599\u6a21\u5f0f\uff0c\u9810\u8a2d\u70ba'pe'\uff0c\u53ef\u9078\u7bc4\u570d\u70ba<code>[\"pe\", \"pb\"]</code>\uff0c\u5206\u5225\u70ba\u672c\u76ca\u6bd4\u3001\u80a1\u50f9\u6de8\u503c\u6bd4\u3002</li> <li><code>split_range (int)</code>: \u6cb3\u6d41\u968e\u5c64\u6578\uff0c\u9810\u8a2d\u70ba8\u5c64\u3002</li> </ul>"},{"location":"details/document/#_71","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u7bc4\u4f8b\u70ba\u4f7f\u7528\u6b64\u51fd\u5f0f\u7e6a\u88fd\u51fa\u53f0\u7a4d\u96fb\u7684\u6b77\u53f2\u672c\u76ca\u6bd4\u6cb3\u6d41\u5716\u3002 <pre><code>from finlab.plot import plot_tw_stock_river\nplot_tw_stock_river(stock_id='2330',mode='pb',split_range=8)\n</code></pre> </p>"},{"location":"details/document/#_72","title":"\u8ca1\u52d9\u6307\u6a19\u5206\u7d1a\u96f7\u9054\u5716","text":"<p><code>finlab.plot.plot_tw_stock_radar(df=None, feats=None, ...)</code></p>"},{"location":"details/document/#_73","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li> <p><code>df(dataframe)</code>: \u5ba2\u88fd\u5316\u6307\u6a19dataframe\uff0c\u6578\u503c\u4f7f\u7528pandas\u7684rank\u8207cut\u505a\u7fa4\u7d44\u5206\u7d1a\u3002\u5982\u679c\u4e0d\u586b\uff0c\u5247\u4f7f\u7528\u4e0b\u4e00\u500bfeats\u53c3\u6578\u5e36\u5165\u73fe\u6709\u8cc7\u6599\u5eab\u6307\u6a19     \u683c\u5f0f\u7bc4\u4f8b:     <pre><code>            \u71df\u696d\u6bdb\u5229\u7387   \u71df\u696d\u5229\u76ca\u7387   \u7a05\u5f8c\u6de8\u5229\u7387\nstock_id\n1101              6         9         9\n1102              6         9         9\n1103              1         1         1\n1104              4         7         8\n1108              3         6         5\n</code></pre></p> </li> <li> <p><code>feats (list)</code>: \u6307\u6a19\u6e05\u55ae\uff0c\u586b\u5165\u8cc7\u6599\u5eab\u4f7f\u7528\u65b9\u6cd5\u81f3list\u3002\u9810\u8a2d\u70ba20\u9805\u5e38\u7528\u8ca1\u52d9\u6307\u6a19\u3002     \u683c\u5f0f\u7bc4\u4f8b:     <pre><code>['fundamental_features:\u71df\u696d\u6bdb\u5229\u7387','fundamental_features:\u71df\u696d\u5229\u76ca\u7387']\n</code></pre></p> </li> <li><code>select_targets(list)</code>: \u5fc5\u586b\uff0c\u53f0\u80a1\u6a19\u7684\u6e05\u55ae\u3002     \u683c\u5f0f\u7bc4\u4f8b:<code>['1101','1102']</code></li> <li><code>mode(str)</code>: \u96f7\u9054\u5716\u6a21\u5f0f\u9078\u64c7\uff0c\u9810\u8a2d\u70ba'line_polar'\uff0c\u53ef\u7528\u6a21\u5f0f\u70ba<code>'line_polar','bar_polar','scatter_polar'</code>\uff0c     \u8a73\u7d30\u8cc7\u8a0a\u3002</li> <li><code>line_polar_fill(str)</code>: line_polar\u6a21\u5f0f\u4e0b\u7684\u5716\u578b\u586b\u6eff\u9078\u64c7\uff0c\u9810\u8a2d\u70ba'None'\uff0c\u53ef\u7528\u6a21\u5f0f\u70ba:<code>None,'toself','tonext'</code>\uff0c     \u8a73\u7d30\u8cc7\u8a0a\u3002</li> <li><code>cut_bins(int)</code>: \u8a2d\u5b9a\u6307\u6a19\u5206\u7d1a\u7d1a\u8ddd\uff0c\u9810\u8a2d\u70ba10\u3002</li> <li><code>title(str)</code>: \u8a2d\u5b9a\u5716\u8868\u6a19\u984c\uff0c\u9810\u8a2d\u70baNone\u3002</li> </ul>"},{"location":"details/document/#polar-bar","title":"\u7bc4\u4f8b\u4e00 Polar Bar","text":"<p>\u9069\u5408\u5448\u73fe\u6574\u9ad4\u6295\u8cc7\u7d44\u5408\u6307\u6a19\u7d2f\u7a4d\u8a55\u5206\u7d50\u679c\u3002</p> <pre><code>from finlab.plot import plot_tw_stock_radar\nplot_tw_stock_radar(\nselect_targets=[\"1101\", \"2330\", \"8942\", \"6263\"],\nmode=\"bar_polar\" ,\nline_polar_fill=line_polar_fill)\n</code></pre> <p></p>"},{"location":"details/document/#polar-line","title":"\u7bc4\u4f8b\u4e8c Polar Line","text":"<p>line_polar \u9069\u5408\u6bd4\u8f03\u55ae\u4e00\u6a19\u5730\u6307\u6a19\u8a55\u5206\u3002 <pre><code>from finlab.plot import plot_tw_stock_radar\nplot_tw_stock_radar(\nselect_targets=[\"1101\", \"2330\", \"8942\", \"6263\"],\nmode=\"bar_polar\" ,\nline_polar_fill=None)\n</code></pre></p> <p></p>"},{"location":"details/document/#_74","title":"\u591a\u7b56\u7565\u8cc7\u7522\u914d\u7f6e\u65ed\u65e5\u5716","text":"<p><code>finlab.plot.StrategySunburst().plot(select_strategy=None, path=None, color_continuous_scale='RdBu_r')</code></p> <p>\u591a\u7b56\u7565\u65ed\u65e5\u5716 (sunburst)\uff0c\u53ef\u4ee5\u7528\u4f86\u77ad\u89e3\u5df2\u90e8\u7f72\u7684\u7b56\u7565\uff0c\u6aa2\u8996\u7576\u524d\u7684\u6301\u80a1\u90e8\u4f4d\u8207\u914d\u7f6e\u8cc7\u8a0a\u3002</p>"},{"location":"details/document/#_75","title":"\u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>select_strategy (dict)</code>: \u8a2d\u5b9a\u9078\u53d6\u7684\u7b56\u7565\u8207\u7b56\u7565\u5c0d\u61c9\u7684\u6301\u80a1\u73fe\u503c\u6b0a\u91cd\uff0c\u9810\u8a2d\u662f\u7b56\u7565\u5168\u9078\uff0c\u6b0a\u91cd\u70ba\u7b56\u7565\u6578\u7684\u5e73\u5747\u503c\u3002\u4e5f\u53ef\u4ee5\u81ea\u8a02\u5321\u9078\u7684\u7b56\u7565\uff0c\u50cf\u662f\u53ea\u60f3\u770b\u5169\u500b\u5be6\u6230\u7684\u7b56\u7565\uff0c\u4e26\u5206\u5225\u8a2d\u5b9a6\u6210\u82074\u6210\u6301\u80a1\u73fe\u503c\u6bd4\u91cd\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u6210 {'\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4':0.6,'\u7814\u767c\u9b54\u4eba':0.4} \u3002\u82e5\u6709\u73fe\u91d1\u7684\u7a7a\u90e8\u4f4d\u60f3\u52a0\u5165\u8cc7\u7522\u914d\u7f6e\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u6210 {'\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4':0.5,'\u7814\u767c\u9b54\u4eba':0.2, '\u73fe\u91d1':0.2} \uff0c\u7b56\u7565\u540d\u7a31\u70ba\u73fe\u91d1\uff0c\u5373\u53ef\u5275\u9020\u73fe\u91d1\u90e8\u4f4d\u3002</li> <li><code>path (list)</code>: sunburst \u5206\u5c64\u8def\u5f91\uff0c\u9810\u8a2d\u7531\u88e1\u5230\u5916\u7684\u5206\u5c64\u662f ['s_name', 'market', 'category', 'stock_id'] \uff0c\u53ef\u4ee5\u89c0\u5bdf\u7b56\u7565\u6301\u6709\u54ea\u4e9b\u985e\u80a1\u70ba\u4e3b\u3002\u4f60\u53ef\u4ee5\u81ea\u52d5\u8a2d\u5b9a\u5206\u5c64\uff0c\u6703\u6709\u4e0d\u540c\u7684\u6548\u679c\uff0c\u50cf\u662f\u4e5f\u53ef\u4ee5\u8a2d\u6210 ['category','stock_id','s_name']  \u8b8a\u6210\u53ef\u4ee5\u770b\u6a19\u7684\u88ab\u54ea\u4e9b\u7b56\u7565\u540c\u6642\u9078\u5230\u3002</li> <li><code>color_continuous_scale (str)</code>: color_continuous_scale (str)\uff1a\u9810\u8a2d\u70ba'RdBu_r'\uff0c\u53ef\u4ee5\u81ea\u9078\u5176\u4ed6\u6a23\u5f0f\u3002</li> </ul>"},{"location":"details/document/#_76","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u8a73\u7d30\u4f7f\u7528\u8aaa\u660e(\u5167\u542b colab \u7bc4\u4f8b\u6a94)</p> <pre><code>from finlab.plot import StrategySunburst\n# \u5be6\u4f8b\u5316\u7269\u4ef6\nstrategies = StrategySunburst()\ns_data = strategies.s_data\nprint(f'\u5df2\u4e0a\u50b3\u7684\u7b56\u7565\u540d\u7a31:{s_data.keys()}')\n# \u7bc4\u4f8b1\nstrategies.plot().show()\n# \u7bc4\u4f8b2\nstrategies.plot(select_strategy={'\u9ad8\u6b96\u5229\u7387\u70cf\u9f9c':0.5,'\u71df\u6536\u5f37\u52e2\u52d5\u80fd\u760b\u72d7':0.3,'\u73fe\u91d1\u6d41\u50f9\u503c\u6210\u9577':0.2}).show()\n# \u7bc4\u4f8b3\nstrategies.plot(select_strategy={'\u9ad8\u6b96\u5229\u7387\u70cf\u9f9c':0.4,'\u71df\u6536\u5f37\u52e2\u52d5\u80fd\u760b\u72d7':0.25,'\u73fe\u91d1\u6d41\u50f9\u503c\u6210\u9577':0.2,'\u73fe\u91d1':0.15},path =  ['market', 'category','stock_id','s_name']).show()\n</code></pre> <p></p>"},{"location":"details/document/#pandas","title":"Pandas \u5e38\u7528\u8a9e\u6cd5","text":"<p>FinLab \u7b56\u7565\u7a0b\u5f0f\u7684\u958b\u767c\u5efa\u7acb\u5728 Pandas \u7684\u57fa\u790e\uff0c\u85c9\u7531 Pandas \u5f37\u5927\u7684\u8cc7\u6599\u8655\u7406\u529f\u80fd\uff0c\u6211\u5011\u53ef\u4ee5\u7701\u4e0b\u8a31\u591a\u5b78\u7fd2\u6210\u672c\uff0c\u66f4\u65b9\u4fbf\u5730\u64cd\u63a7\u8cc7\u6599\u3002\u4ee5\u4e0b\u6574\u7406\u51fa\u7d93\u5e38\u4f7f\u7528\u5728\u7b56\u7565\u64b0\u5beb\u51fd\u6578\uff0c\u4e26\u4ee5 Finlab \u8ca1\u7d93\u8cc7\u6599\u70ba\u7bc4\u4f8b\uff0c\u793a\u7bc4\u7b56\u7565\u8f49\u5beb\u3002\u82e5\u4f60\u5df2\u7d93\u6709 Python \u57fa\u790e\uff0c\u6b64\u4efd\u8cc7\u6599\u65b9\u4fbf\u4f60\u5728\u8655\u7406\u8cc7\u6599\u9047\u5230\u56f0\u96e3\u6642\u5f97\u4ee5\u6aa2\u7d22\u3001\u8907\u7fd2\u3001\u5957\u7528\uff0c\u7121\u8ad6\u5728\u4f7f\u7528 Finlab \u6a21\u7d44\u529f\u80fd\u6216\u958b\u767c\u5176\u4ed6\u5ef6\u4f38\u61c9\u7528\uff0c\u90fd\u80fd\u5f97\u5fc3\u61c9\u624b\u3002\u82e5\u4f60\u60f3\u64cd\u8003\u66f4\u591a\u8a9e\u6cd5\u529f\u80fd\u7d30\u7bc0\uff0c\u8acb\u53c3\u8003\u6587\u7ae0\u5e95\u8655\u7684\u53c3\u8003\u8cc7\u6e90\u9023\u7d50\u3002</p> <p>colab \u7bc4\u4f8b\u9023\u7d50</p>"},{"location":"details/document/#_77","title":"\u8b80\u53d6\u51fd\u5f0f\u5eab","text":"<pre><code>import pandas as pd\nimport numpy as np\nfrom finlab import data\n</code></pre>"},{"location":"details/document/#_78","title":"\u6e96\u5099\u6b77\u53f2\u8cc7\u6599","text":"<p><code>pd.Dataframe</code> \u5efa\u7acb\u4e8c\u7dad\u8cc7\u6599\u8868\uff0c\u6709\u7d22\u5f15\u8207\u6b04\u4f4d\u3002\u53ef\u60f3\u6210\u662f\u591a\u6b04\u8cc7\u6599\uff0c\u7531\u591a\u500bSeries\u7d44\u6210\u3002</p> <p>\u8cc7\u6599\u683c\u5f0f\u7bc4\u4f8b\uff0c\u6211\u5011\u9019\u500b\u7ae0\u7bc0\uff0c\u5c07\u5206\u6790\u4e09\u6a94\u80a1\u7968 * \u9d3b\u6d77 <code>2317</code> * \u53f0\u7a4d\u96fb <code>2330</code> * \u5927\u7acb\u5149 <code>3008</code> \u5229\u7528\u8a9e\u6cd5\u5c07 <code>2018</code> \u5e74\u7684\u80a1\u7968\u8cc7\u6599\u53d6\u51fa\uff0c\u63a5\u4e0b\u4f86\u7684\u8cc7\u6599\u5206\u6790\uff0c\u5c31\u6703\u8457\u91cd\u5728\u9019\u4e09\u6a94\u80a1\u7968\u3002</p> <p><pre><code>df = data.get('price:\u6536\u76e4\u50f9')\ndf = df.loc['2018', ['2317', '2330', '3008']]\ndf\n</code></pre> <pre><code>            2317   2330    3008\ndate                           \n2018-01-02  95.0  232.5  4255.0\n2018-01-03  94.0  237.0  4145.0\n2018-01-04  92.6  239.5  4135.0\n2018-01-05  93.0  240.0  4100.0\n2018-01-08  91.8  242.0  3930.0\n...          ...    ...     ...\n2018-12-24  71.4  220.0  3270.0\n2018-12-25  70.7  217.5  3165.0\n2018-12-26  70.2  216.5  3125.0\n2018-12-27  70.8  223.0  3135.0\n2018-12-28  70.8  225.5  3215.0\n</code></pre></p>"},{"location":"details/document/#_79","title":"\u8cc7\u6599\u6aa2\u7d22","text":"<p>\u53ef\u4ee5\u5c07\u4e0a\u8ff0\u7684 <code>df</code> \u4e2d\uff0c\u7528\u6642\u9593\u548c\u80a1\u7968\u4f86\u9078\u53d6\u5176\u4e2d\u7684\u4e00\u5c0f\u90e8\u5206\uff0c\u4ee5\u4e0b\u662f\u5404\u7a2e\u7684\u7528\u6cd5:</p> <ul> <li> <p>values:\u53d6\u503c\u3002     <code>python=     demo_values=df.values     <pre><code>\n</code></pre>     array([[  9.54,  57.85,  32.83, ...,    nan,  46.  ,  49.6 ],         [  9.54,  58.1 ,  32.99, ...,    nan,  45.9 ,  50.4 ],         [  9.52,  57.6 ,  32.8 , ...,    nan,  49.1 ,  49.1 ],         ...,         [   nan, 137.6 ,  57.8 , ..., 131.5 ,  27.2 ,  14.6 ],         [   nan, 138.95,  58.2 , ..., 134.  ,  27.35,  16.05],         [   nan, 138.3 ,  57.9 , ..., 129.5 ,  27.25,  17.65]])</code></p> </li> <li> <p>boolean indexing:</p> <p>\u7d22\u5f15\u5e03\u6797\u908f\u8f2f\u7be9\u9078\u3002</p> <p>ex:\u53d6\u5f97\u7d22\u5f15\u5927\u65bc2020\u5e74\u4efd\u7684\u8cc7\u6599\u3002 <code>python= demo_boolean_indexing=df[df.index&gt;'2020'] <pre><code>\n</code></pre>     0015    0050    0051    0052    0053 date                     2020-01-02  NaN 97.65   35.45   73.30   42.70 2020-01-03  NaN 97.65   35.30   72.85   42.58 2020-01-06  NaN 96.40   35.10   72.05   42.04 2020-01-07  NaN 96.10   34.72   71.80   41.70 2020-01-08  NaN 95.65   34.69   71.25   41.61 ... ... ... ... ... ... 2021-06-25  NaN 136.95  57.85   124.30  66.30 2021-06-28  NaN 137.20  57.90   124.20  66.15 2021-06-29  NaN 137.60  57.80   124.65  66.45 2021-06-30  NaN 138.95  58.20   125.00  66.80 2021-07-01  NaN 138.30  57.90   124.35  66.20</code> 5. loc:\u4f7f\u7528\u6a19\u7c64\u7be9\u9078\u6b04\u5217\u3002</p> <p>ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d\u6240\u6709\u6a19\u5730\u7684\u80a1\u50f9\u3002 ```python= demo_loc1=df.loc['2020-01-03':'2020-01-08'] <pre><code>\n</code></pre>     0015    0050    0051    0052    0053 date                   2020-01-03  NaN 97.65   35.30   72.85   42.58 2020-01-06  NaN 96.40   35.10   72.05   42.04 2020-01-07  NaN 96.10   34.72   71.80   41.70 2020-01-08  NaN 95.65   34.69   71.25   41.61 <pre><code>ex:\u9078\u64c70050&amp;1101&amp;2330\u7684\u80a1\u50f9\uff0c\u4ee5\u4e0b\u5169\u7a2e\u65b9\u6cd5\u7b49\u50f9\u3002\n```python=\ndemo_loc2=df.loc[:,['0050','1101','2330']]\ndemo_column_select=df[['0050','1101','2330']]\n</code></pre> <pre><code>    0050    1101    2330\ndate            \n2007-04-23  57.85   29.60   68.6\n2007-04-24  58.10   30.25   69.8\n2007-04-25  57.60   29.65   69.3\n2007-04-26  57.70   29.65   69.9\n2007-04-27  57.50   30.35   69.0\n... ... ... ...\n2021-06-25  136.95  51.00   591.0\n2021-06-28  137.20  51.10   590.0\n2021-06-29  137.60  51.20   595.0\n2021-06-30  138.95  51.00   595.0\n2021-07-01  138.30  50.60   593.0\n</code></pre></p> <p>ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d0050&amp;1101&amp;2330\u7684\u80a1\u50f9\u3002 <pre><code>demo_loc3=df.loc['2020-01-03':'2020-01-08',['0050','1101','2330']]\n</code></pre></p> <p><pre><code>0050    1101    2330\ndate            \n2020-01-03  97.65   43.95   339.5\n2020-01-06  96.40   43.45   332.0\n2020-01-07  96.10   43.60   329.5\n2020-01-08  95.65   43.40   329.5\n</code></pre> 6. iloc:\u4f7f\u7528\u6a19\u7c64\u4f4d\u7f6e\u7be9\u9078\u6b04\u5217\u3002</p> <p>ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599\u3002</p> <p><code>python= demo_iloc1=df.iloc[5:10] <pre><code>\n</code></pre> 0015    0050    0051    0052    0053 date                     2007-04-30  9.37    56.90   32.07   38.10   NaN 2007-05-02  9.50    57.55   32.02   38.49   NaN 2007-05-03  9.41    58.20   31.75   38.80   NaN 2007-05-04  9.59    59.20   32.41   39.23   NaN 2007-05-07  9.60    59.55   32.60   39.44   NaN <pre><code>ex:\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599\u3002\n\n```python=\ndemo_iloc2=df.iloc[:,5:10]\n</code></pre> <pre><code>    0054    0055    0056    0057    0058\ndate                    \n2007-04-23  NaN NaN NaN NaN NaN\n2007-04-24  NaN NaN NaN NaN NaN\n2007-04-25  NaN NaN NaN NaN NaN\n2007-04-26  NaN NaN NaN NaN NaN\n2007-04-27  NaN NaN NaN NaN NaN\n... ... ... ... ... ...\n2021-06-25  31.84   21.25   34.74   94.05   NaN\n2021-06-28  31.84   21.29   35.10   94.05   NaN\n2021-06-29  31.80   21.20   34.80   94.70   NaN\n2021-06-30  31.90   21.26   35.00   95.45   NaN\n2021-07-01  31.56   21.24   35.00   94.95   NaN\n</code></pre> ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599&amp;\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599\u3002</code>python= demo_iloc3=df.iloc[5:10,5:10] <pre><code>\n</code></pre>     0054    0055    0056    0057    0058 date                   2007-04-30  NaN NaN NaN NaN NaN 2007-05-02  NaN NaN NaN NaN NaN 2007-05-03  NaN NaN NaN NaN NaN 2007-05-04  NaN NaN NaN NaN NaN 2007-05-07  NaN NaN NaN NaN NaN <code>7. [**nlargest &amp; nsmallest**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.nlargest.html): 1. nlargest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u9ad8\u7684\u6a19\u5730\u3002</code>python= demo_nlargest=df.iloc[-1].nlargest(10) <pre><code>\n</code></pre> 6415    3710.0 3008    3105.0 5274    2115.0 8454    1900.0 4966    1380.0 5269    1375.0 6409    1340.0 3529    1310.0 1590    1100.0 6669     976.0 Name: 2021-07-01 00:00:00, dtype: float64 ```</p> </li> <li> <p>nsmallest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u4f4e\u7684\u6a19\u5730\u3002     <code>python=     demo_nsmallest=df.iloc[-1].nsmallest(10)     <pre><code>\n</code></pre>     8101      2.61     5701      2.85     02001R    2.88     3095      2.96     2443      2.99     6289      2.99     9188      3.09     9110      3.12     2364      3.22     6225      3.40     Name: 2021-07-01 00:00:00, dtype: float64</code></p> </li> </ul>"},{"location":"details/document/#_80","title":"\u9078\u53d6\u300c\u5217\u300d","text":"<p>\u6211\u5011\u53ef\u4ee5\u9078\u53d6\u6b77\u53f2\u8cc7\u6599\u4e2d\u7684\u4e00\u689d\u6642\u9593\u5e8f\u5217\uff0c\u4f8b\u5982\u6211\u5011\u5e0c\u671b\u5c07 <code>2330</code> \u53f0\u7a4d\u96fb\u5f9e\u4e0a\u8ff0 <code>df</code> \u4e2d\u53d6\u51fa\u4f86\uff1a <pre><code>df['2330']\n</code></pre> <pre><code>date\n2018-01-02    232.5\n2018-01-03    237.0\n2018-01-04    239.5\n2018-01-05    240.0\n2018-01-08    242.0\n            ...  \n2018-12-24    220.0\n2018-12-25    217.5\n2018-12-26    216.5\n2018-12-27    223.0\n2018-12-28    225.5\nName: 2330, Length: 247, dtype: float64\n</code></pre></p>"},{"location":"details/document/#_81","title":"\u9078\u53d6\u982d\u8ddf\u5c3e","text":"<p>head &amp; tail \u6703\u9078\u53d6\u524d n \u7b46\uff0c\u548c\u5f8c n \u7b46\u8cc7\u6599\uff0c\u9810\u8a2d <code>n = 5</code></p> <p><pre><code>df.head()\n</code></pre> <pre><code>            2317   2330    3008\ndate                           \n2018-01-02  95.0  232.5  4255.0\n2018-01-03  94.0  237.0  4145.0\n2018-01-04  92.6  239.5  4135.0\n2018-01-05  93.0  240.0  4100.0\n2018-01-08  91.8  242.0  3930.0\n</code></pre></p> <p><pre><code>df.tail(3)\n</code></pre> <pre><code>            2317   2330    3008\ndate                           \n2018-12-26  70.2  216.5  3125.0\n2018-12-27  70.8  223.0  3135.0\n2018-12-28  70.8  225.5  3215.0\n</code></pre></p>"},{"location":"details/document/#index-columns","title":"\u9078\u53d6 index \u8ddf columns","text":"<p><pre><code>df.index\n</code></pre> <pre><code>DatetimeIndex(['2018-01-02', '2018-01-03', '2018-01-04', '2018-01-05',\n            '2018-01-08', '2018-01-09', '2018-01-10', '2018-01-11',\n            '2018-01-12', '2018-01-15',\n            ...\n            '2018-12-18', '2018-12-19', '2018-12-20', '2018-12-21',\n            '2018-12-22', '2018-12-24', '2018-12-25', '2018-12-26',\n            '2018-12-27', '2018-12-28'],\n            dtype='datetime64[ns]', name='date', length=247, freq=None)\n</code></pre></p> <p><pre><code>df.columns\n</code></pre> <pre><code>Index(['2317', '2330', '3008'], dtype='object')\n</code></pre></p>"},{"location":"details/document/#_82","title":"\u986f\u793a\u63a7\u5236","text":"<p>pandas\u9810\u9632\u8cc7\u6e90\u6d88\u8017\uff0c\u9810\u8a2d\u986f\u793a\u5217\u6578\u70ba10(\u982d\u5c3e\u5404\u4e94\u5217)\uff0c\u4e2d\u9593\u8cc7\u6599\u4ee5\u2018...\u2019\u5e36\u904e\uff0c\u82e5\u60f3\u8981\u8abf\u6574\u986f\u793a\u6578\u91cf\u4f86\u6aa2\u8996\u8cc7\u6599\uff0c\u53ef\u4f5c\u4ee5\u4e0b\u63a7\u5236\u3002</p> <p>Hint: \u8981\u6ce8\u610f\u7684\u662f\u6b64\u5f71\u97ff\u70ba\u5168\u57df\uff0c\u63a5\u4e0b\u4f86\u7684\u986f\u793a\u6578\u90fd\u6703\u88ab\u5f71\u97ff\u3002</p> <p>set_option:</p> <ol> <li> <p>\u5217\u6578\u5168\u5c55\u958b:     <code>python=     pd.set_option(\"display.max_rows\", None)</code></p> </li> <li> <p>\u6b04\u6578\u5168\u5c55\u958b:     <code>python=     pd.set_option(\"display.max_columns\", None)</code></p> </li> <li> <p>\u6700\u591a\u986f\u793a20\u5217:     <code>python=     pd.set_option(\"display.max_rows\", 20)</code></p> </li> <li> <p>\u6700\u591a\u986f\u793a20\u6b04:     <code>python=     pd.set_option(\"display.max_columns\", 20)</code></p> </li> <li> <p>\u9084\u539f\u986f\u793a\u6578\u9810\u8a2d\u521d\u59cb\u503c:     <code>python=     pd.reset_option(\"^display\")</code></p> </li> </ol>"},{"location":"details/document/#_83","title":"\u8cc7\u6599\u904b\u7b97","text":"<p>sum:</p> <p>\u52a0\u7e3d\uff0caxis=0\u70ba\u6574\u6b04\u52a0\u7e3d\uff0caxis=1\u70ba\u6574\u5217\u52a0\u7e3d\u3002</p> <p>ex:\u8a08\u7b97\u6bcf\u65e5\u80a1\u50f9\u5927\u65bc100\u7684\u6a19\u5730\u6578\u91cf <code>python= \u7522\u751f\u80a1\u50f9\u5927\u65bc100\u5143\u7684\u5e03\u6797dataframe\uff0c\u82e5\u5927\u65bc100\u5247\u986f\u793aTrue(\u8a08\u7b97\u6642\u8996\u70ba1)\uff0c\u82e5\u4e0d\u5927\u65bc100\u5247\u986f\u793aFalse(\u8a08\u7b97\u6642\u8996\u70ba0) price_up_10=df&gt;100 demo_sum=price_up_10.sum(axis=1) <pre><code>\n</code></pre> date 2007-04-23     70 2007-04-24     72 2007-04-25     70 2007-04-26     71 2007-04-27     71              ...  2021-06-25    282 2021-06-28    285 2021-06-29    283 2021-06-30    283 2021-07-01    280 Length: 3503, dtype: int64 <pre><code>[**mean &amp; median &amp; std**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mean.html):\n\nmean:\u5e73\u5747\u6578\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u5747\u7dda\u3002\n</code></pre> demo_mean=df.mean() <pre><code>\n</code></pre> 0015     7.697360 0050    67.783269 0051    29.989126 0052    45.283546 0053    29.846568           ...     9951    84.396078 9955    30.770911 9958    29.483578 9960    24.562452 9962    12.956349 Length: 2269, dtype: float64 <pre><code>median:\u4e2d\u4f4d\u6578\u3002\n```python=\ndemo_median=df.median()\n</code></pre> <pre><code>0015     7.49\n0050    62.90\n0051    29.44\n0052    38.77\n0053    27.10\n        ...  \n9951    79.00\n9955    20.90\n9958    11.50\n9960    22.30\n9962    11.50\nLength: 2269, dtype: float64\n</code></pre> std:\u6a19\u6e96\u5dee\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u4e56\u96e2\u7387\u3002</code>python= demo_std=df.std() <pre><code>\n</code></pre> 0015     1.482317 0050    19.781026 0051     6.076147 0052    20.926838 0053     9.881821           ...   9951    54.171955 9955    21.267716 9958    33.751259 9960     8.755944 9962     6.390186 Length: 2269, dtype: float64 <pre><code>[**max &amp; min**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.max.html):\n\nmax:\u6700\u5927\u503c\u3002\n```python=\ndemo_max=df.max()\n</code></pre> <pre><code>0015     12.40\n0050    143.00\n0051     58.20\n0052    136.45\n0053     68.80\n         ...  \n9951    220.00\n9955    140.50\n9958    141.50\n9960     61.10\n9962     50.40\nLength: 2269, dtype: float64\n</code></pre> min:\u6700\u5c0f\u503c\u3002 ```python= demo_min=df.min() <pre><code>\n</code></pre> 0015     4.15 0050    29.50 0051    13.40 0052    17.02 0053    11.85         ... 9951     0.00 9955    10.90 9958     5.10 9960     0.00 9962     4.95 Length: 2269, dtype: float64 <pre><code>[**cumsum &amp; cumprod**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.cumsum.html):\n\ncumsum:\u7d2f\u52a0\u3002\n\nex:\u7d2f\u7a4d\u6f32\u591a\u5c11\u5143\u3002\n```python=\ndemo_diff=df.diff()\ndemo_cumsum=demo_diff.cumsum()\n</code></pre> <pre><code>    0015    0050    0051    0052    0053\ndate                    \n2007-04-23  NaN NaN NaN NaN NaN\n2007-04-24  0.00    0.25    0.16    0.25    NaN\n2007-04-25  -0.02   -0.25   -0.03   0.19    NaN\n2007-04-26  0.05    -0.15   -0.03   0.20    NaN\n2007-04-27  0.01    -0.35   -0.11   0.00    NaN\n... ... ... ... ... ...\n2021-06-25  NaN 79.10   25.57   86.56   37.18\n2021-06-28  NaN 79.35   25.62   86.46   37.03\n2021-06-29  NaN 79.75   25.52   86.91   37.33\n2021-06-30  NaN 81.10   25.92   87.26   37.68\n2021-07-01  NaN 80.45   25.62   86.61   37.08\n</code></pre> cumprod:\u7d2f\u4e58\u3002</p> <p>ex:\u5e38\u7528\u65bc\u8a08\u7b97\u7d2f\u7a4d\u5831\u916c\u7387\u3002 <code>python= demo_pct_change=df.pct_change()+1 demo_cumprod=demo_pct_change.cumprod() <pre><code>\n</code></pre>     0015    0050    0051    0052    0053 date                     2007-04-23  NaN NaN NaN NaN NaN 2007-04-24  1.000000    1.004322    1.004874    1.006510    NaN 2007-04-25  0.997904    0.995678    0.999086    1.004948    NaN 2007-04-26  1.005241    0.997407    0.999086    1.005208    NaN 2007-04-27  1.001048    0.993950    0.996649    1.000000    NaN ... ... ... ... ... ... 2021-06-25  0.966457    2.367329    1.762108    3.236979    2.207057 2021-06-28  0.966457    2.371651    1.763631    3.234375    2.202064 2021-06-29  0.966457    2.378565    1.760585    3.246094    2.212051 2021-06-30  0.966457    2.401901    1.772769    3.255208    2.223702 2021-07-01  0.966457    2.390666    1.763631    3.238281    2.203728 <pre><code>[**cummax &amp; cummin**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.cummax.html):\n\ncummax:\u7d2f\u7a4d\u6700\u5927\u503c\uff0c\u5e38\u7528\u65bc\u8a08\u7b97drawdown\u3001\u5275\u65b0\u9ad8\u3002\n```python=\ndemo_cummax=df.cummax()\n</code></pre> <pre><code>    0015    0050    0051    0052    0053\ndate                    \n2007-04-23  9.54    57.85   32.83   38.40   NaN\n2007-04-24  9.54    58.10   32.99   38.65   NaN\n2007-04-25  9.54    58.10   32.99   38.65   NaN\n2007-04-26  9.59    58.10   32.99   38.65   NaN\n2007-04-27  9.59    58.10   32.99   38.65   NaN\n... ... ... ... ... ...\n2021-06-25  NaN 143.00  57.85   136.45  68.8\n2021-06-28  NaN 143.00  57.90   136.45  68.8\n2021-06-29  NaN 143.00  57.90   136.45  68.8\n2021-06-30  NaN 143.00  58.20   136.45  68.8\n2021-07-01  NaN 143.00  58.20   136.45  68.8\n</code></pre> cummin:\u7d2f\u7a4d\u6700\u5c0f\u503c\uff0c\u5e38\u7528\u65bc\u8a08\u7b97drawdown\u3001\u5275\u65b0\u4f4e\u3002</code>python= demo_cummin=df.cummin() <pre><code>\n</code></pre></p> <p>0015    0050    0051    0052    0053 date                   2007-04-23  9.54    57.85   32.83   38.40   NaN 2007-04-24  9.54    57.85   32.83   38.40   NaN 2007-04-25  9.52    57.60   32.80   38.40   NaN 2007-04-26  9.52    57.60   32.80   38.40   NaN 2007-04-27  9.52    57.50   32.72   38.40   NaN ... ... ... ... ... ... 2021-06-25  NaN 29.50   13.40   17.02   11.85 2021-06-28  NaN 29.50   13.40   17.02   11.85 2021-06-29  NaN 29.50   13.40   17.02   11.85 2021-06-30  NaN 29.50   13.40   17.02   11.85 2021-07-01  NaN 29.50   13.40   17.02   11.85 <pre><code>[**quantile**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.quantile.html):\n\n\u8a08\u7b97\u7b2cc\u767e\u5206\u4f4d\u6578\u6578\u503c\uff0c\u5e38\u7528\u65bc\u53d6\u6a19\u7684\u6578\u524dc%\u5f37\u6a19\u5730\u3002\n```python=\ndemo_quantile=df.iloc[-1].quantile(0.9)\n</code></pre> <pre><code>126.0\n</code></pre></p> <p>corr: \u8a08\u7b97\u76f8\u95dc\u6027\u3002 ```python= demo_corr=df.iloc[:,:5].corr() <pre><code>\n</code></pre></p> <p>0015    0050    0051    0052    0053 0015    1.000000    0.892513    0.922749    0.926133    0.823550 0050    0.892513    1.000000    0.852582    0.968580    0.989484 0051    0.922749    0.852582    1.000000    0.851140    0.870181 0052    0.926133    0.968580    0.851140    1.000000    0.983993 0053    0.823550    0.989484    0.870181    0.983993    1.000000 <pre><code>[**describe**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html):\n\u8a08\u7b97\u7d71\u8a08\u8cc7\u6599\u3002\n```python=\ndemo_describe=df.describe()\n</code></pre> <pre><code>    0015    0050    0051    0052    0053\ncount   1640.000000 3503.000000 3500.000000 3395.000000 3435.000000\nmean    7.697360    67.783269   29.989126   45.283546   29.846568\nstd 1.482317    19.781026   6.076147    20.926838   9.881821\nmin 4.150000    29.500000   13.400000   17.020000   11.850000\n25% 7.090000    54.850000   26.497500   33.440000   23.880000\n50% 7.490000    62.900000   29.440000   38.770000   27.100000\n75% 8.300000    78.250000   32.252500   50.100000   33.825000\nmax 12.400000   143.000000  58.200000   136.450000  68.800000\n</code></pre></p>"},{"location":"details/document/#_84","title":"\u79fb\u52d5\u7a97\u683c\u4f5c\u696d","text":"<p>shift: \u8cc7\u6599\u79fb\u52d5\uff0c\u5e38\u7528\u65bc\u524d\u5f8c\u671f\u6578\u503c\u589e\u6e1b\u6bd4\u8f03\u3001\u5e74\u589e\u7387\u8a08\u7b97\u3002</p> <p>ex:\u6536\u76e4\u50f9\u5411\u4e0b\u5e73\u79fb\u4e00\u5217\uff0c\u7b2c\u4e00\u5217\u6703\u8b8aNaN\u3002 ```python= demo_shift1=df.shift()      0015    0050    0051    0052    0053 date                   2007-04-23  NaN NaN NaN NaN NaN 2007-04-24  9.54    57.85   32.83   38.40   NaN 2007-04-25  9.54    58.10   32.99   38.65   NaN 2007-04-26  9.52    57.60   32.80   38.59   NaN 2007-04-27  9.59    57.70   32.80   38.60   NaN ... ... ... ... ... ... 2021-06-25  NaN 136.70  57.60   124.70  65.75 2021-06-28  NaN 136.95  57.85   124.30  66.30 2021-06-29  NaN 137.20  57.90   124.20  66.15 2021-06-30  NaN 137.60  57.80   124.65  66.45 2021-07-01  NaN 138.95  58.20   125.00  66.80 <pre><code>ex:\u6536\u76e4\u50f9\u5411\u4e0a\u5e73\u79fb\u4e00\u5217\uff0c\u6700\u5f8c\u4e00\u5217\u6703\u8b8aNaN\u3002\n```python=\ndemo_shift2=df.shift(-1)\n</code></pre> <pre><code>    0015    0050    0051    0052    0053\ndate                    \n2007-04-23  9.54    58.10   32.99   38.65   NaN\n2007-04-24  9.52    57.60   32.80   38.59   NaN\n2007-04-25  9.59    57.70   32.80   38.60   NaN\n2007-04-26  9.55    57.50   32.72   38.40   NaN\n2007-04-27  9.37    56.90   32.07   38.10   NaN\n... ... ... ... ... ...\n2021-06-25  NaN 137.20  57.90   124.20  66.15\n2021-06-28  NaN 137.60  57.80   124.65  66.45\n2021-06-29  NaN 138.95  58.20   125.00  66.80\n2021-06-30  NaN 138.30  57.90   124.35  66.20\n2021-07-01  NaN NaN NaN NaN NaN\n</code></pre> rolling: \u79fb\u52d5\u7a97\u683c\u4f5c\u696d\uff0c\u5e38\u7d50\u5408\u8cc7\u6599\u904b\u7b97\u516c\u5f0f\u505a\u6efe\u52d5\u5f0f\u8a08\u7b97\u3002</p> <p>ex:\u8a08\u7b9720\u65e5\u79fb\u52d5\u5e73\u5747\u7dda(\u524dn\u7b46\u6578\u8cc7\u6599\u672a\u6eff10\u65e5\u53d6na\uff0c\u672a\u6eff20\u65e5\u4ee5n\u65e5\u8a08\u7b97)\u3002 ```python= demo_rolling=df.rolling(20,min_periods=10).mean() <pre><code>\n</code></pre></p> <p>0015    0050    0051    0052    0053 date                   2007-04-23  NaN NaN NaN NaN NaN 2007-04-24  NaN NaN NaN NaN NaN 2007-04-25  NaN NaN NaN NaN NaN 2007-04-26  NaN NaN NaN NaN NaN 2007-04-27  NaN NaN NaN NaN NaN ... ... ... ... ... ... 2021-06-25  NaN 137.0975    55.6150 124.5325    65.8150 2021-06-28  NaN 137.1675    55.8250 124.5675    65.8725 2021-06-29  NaN 137.1925    56.0050 124.5475    65.8950 2021-06-30  NaN 137.2550    56.1575 124.5425    65.9225 2021-07-01  NaN 137.2850    56.2975 124.5550    65.9500 <pre><code>[**diff**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.diff.html):\n\u5217\u6578\u76f8\u6e1b\u3002\n\nex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u50f9\u3002\n```python=\ndemo_diff=df.diff()\n</code></pre> <pre><code>    0015    0050    0051    0052    0053\ndate                    \n2007-04-23  NaN NaN NaN NaN NaN\n2007-04-24  0.00    0.25    0.16    0.25    NaN\n2007-04-25  -0.02   -0.50   -0.19   -0.06   NaN\n2007-04-26  0.07    0.10    0.00    0.01    NaN\n2007-04-27  -0.04   -0.20   -0.08   -0.20   NaN\n... ... ... ... ... ...\n2021-06-25  NaN 0.25    0.25    -0.40   0.55\n2021-06-28  NaN 0.25    0.05    -0.10   -0.15\n2021-06-29  NaN 0.40    -0.10   0.45    0.30\n2021-06-30  NaN 1.35    0.40    0.35    0.35\n2021-07-01  NaN -0.65   -0.30   -0.65   -0.60\n</code></pre></p> <p>pct_change: \u5217\u6578\u76f8\u9664\u3002</p> <p>ex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u5e45\u3002 ```python= demo_pct_change=df.pct_change() <pre><code>\n</code></pre>     0015    0050    0051    0052    0053 date                   2007-04-23  NaN NaN NaN NaN NaN 2007-04-24  0.000000    0.004322    0.004874    0.006510    NaN 2007-04-25  -0.002096   -0.008606   -0.005759   -0.001552   NaN 2007-04-26  0.007353    0.001736    0.000000    0.000259    NaN 2007-04-27  -0.004171   -0.003466   -0.002439   -0.005181   NaN ... ... ... ... ... ... 2021-06-25  0.000000    0.001829    0.004340    -0.003208   0.008365 2021-06-28  0.000000    0.001825    0.000864    -0.000805   -0.002262 2021-06-29  0.000000    0.002915    -0.001727   0.003623    0.004535 2021-06-30  0.000000    0.009811    0.006920    0.002808    0.005267 2021-07-01  0.000000    -0.004678   -0.005155   -0.005200   -0.008982 <pre><code>### [\u8996\u89ba\u5316](https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html)\n\u4e56\u96e2\u7387\u7dda\u5716:\n```python=\ndf=data.get('price:\u6536\u76e4\u50f9').iloc[-400:]['2330']\nmean_20=df.rolling(20).mean()\nstd_value=df.rolling(20).std()\n\nup=mean_20+std_value*2\ndown=mean_20-std_value*2\nup.plot(label='up',legend=True)\ndown.plot(label='down',legend=True)\nmean_20.plot(label='ma_20',legend=True)\ndf.plot(title='bias plot',label='close',legend=True,grid=True,figsize=(20, 8))\n</code></pre> </p> <p>\u76f8\u95dc\u6027\u71b1\u529b\u5716: ```python= df=data.get('price:\u6536\u76e4\u50f9') check_list=['1101','1102','2330','2454','6263','9939'] demo_corr=df.iloc-600:.corr()</p> <p>demo_corr.style.background_gradient(cmap ='viridis')\\         .set_properties(**{'font-size': '20px'}) <pre><code>![](https://i.imgur.com/LnI8tK1.png)\n\n### \u5be6\u6230\u61c9\u7528\n\u4e86\u89e3pandas\u8a9e\u6cd5\u5f8c\uff0c\u5c31\u53ef\u4ee5\u8457\u624b\u5be6\u6230\u61c9\u7528\u65bc\u958b\u767c\u7b56\u7565\u3002\n\n\u5747\u7dda\u591a\u982d\n</code></pre> from finlab import data df = data.get('price:\u6536\u76e4\u50f9')</p>"},{"location":"details/document/#_85","title":"\u9650\u5b9a\u7bc4\u570d","text":"<p>df = df[(df.index &gt; '2015') &amp; (df.index &lt; '2019')]</p> <p>cond1 = df &gt; df.rolling(5).mean() cond2 = df &gt; df.rolling(10,min_periods=5).mean() cond3 = df &gt; df.rolling(20,min_periods=10).mean() cond4 = df &gt; df.rolling(60,min_periods=40).mean()</p> <p>position = (df * (cond1 &amp; cond2 &amp; cond3 &amp; cond4)) position = position[position &gt; 0] position = position.is_largest(10) <pre><code>\u7a81\u7834\u5e03\u6797\u901a\u9053\u4e0a\u7de3\n</code></pre> from finlab import data df = data.get('price:\u6536\u76e4\u50f9') mean_20 = df.rolling(20).mean() std_value = df.rolling(20).std()</p> <p>up = mean_20 + std_value*2</p>"},{"location":"details/document/#_86","title":"\u6536\u76e4\u50f9\u525b\u7ad9\u4e0a\u5e03\u6797\u901a\u9053\u4e0a\u7de3","text":"<p>cond1 = (df &gt; up) &amp; (df.shift() &lt; up) cond2 = (df &gt; 5) &amp; (df &lt; 200) position = (cond1 &amp; cond2) position = position[position &gt; 0] position = position.is_smallest(20) ```</p>"},{"location":"details/document/#_87","title":"\u53c3\u8003\u8cc7\u6e90","text":"<p>10\u5206\u9418\u4e0a\u624bPandas Pandas\u5b98\u65b9\u7db2\u7ad9</p>"},{"location":"details/factor_analysis/","title":"\u5206\u6790\u7b56\u7565\u56e0\u5b50","text":"<p>\u7814\u7a76\u56e0\u5b50\u5206\u6790\uff0c\u589e\u6e1b\u4fee\u6539\u56e0\u5b50\uff0c\u4e0d\u518d\u9760\u611f\u89ba\uff0c\u77ad\u89e3\u56e0\u5b50\u8207\u7b56\u7565\u5831\u916c\u7684\u95dc\u4fc2\u3002</p>"},{"location":"details/factor_analysis/#finlab-package","title":"FinLab Package \u63d0\u4f9b\u7684\u56e0\u5b50\u5206\u6790\u6d41\u7a0b\uff1a","text":"<pre><code>\u7bc4\u4f8b\u7b56\u7565\n    \u2502\n    \u251c\u2500\u2500\u2500 \u7279\u5fb5\u5de5\u7a0b \u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u7279\u5fb5 (Features)\n    \u2502\n    \u2514\u2500\u2500\u2500 \u6a19\u7c64\u5de5\u7a0b \u2500\u2500\u2500\u2500\u2192 \u8d85\u984d\u5831\u916c (Labels)\n                \u2502\n                \u251c\u2500\u2500\u2500 calc_factor_return() \u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u5831\u916c\n                \u2502      \u2502\n                |      \u2514\u2500\u2500 calc_centrality() \u2500\u2192 \u56e0\u5b50\u96c6\u4e2d\u5ea6\n                \u2502\n                \u251c\u2500\u2500\u2500 calc_shapley_values() \u2500\u2500\u2500\u2192 \u56e0\u5b50\u8ca2\u737b\u5ea6\n                \u2502\n                \u2514\u2500\u2500\u2500 calc_ic() \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u76f8\u95dc\u6027(IC)\n</code></pre> <p>\u6211\u5011\u5c07\u793a\u7bc4\u5c07</p> <ol> <li>\u300c\u7bc4\u4f8b\u7b56\u7565\u300d\u8f49\u63db\u6210\u300c\u7279\u5fb5\u300d\u8207\u300c\u6a19\u7c64\u300d</li> <li>\u7528\u4e0a\u8ff0\u8cc7\u6599\u5206\u6790\u56e0\u5b50\u7684\u6548\u80fd</li> </ol>"},{"location":"details/factor_analysis/#_2","title":"\u7bc4\u4f8b\u7b56\u7565","text":"<p>\u6b64\u7b56\u7565\u662f\u7531\u975e\u5e38\u57fa\u672c\u7684\u4e09\u500b\u56e0\u5b50\u7d44\u6210: 1. \u5e02\u503c 2. \u71df\u6536 3. \u52d5\u80fd</p> <pre><code>from finlab import data\nfrom finlab.backtest import sim\nmarketcap = data.get('etl:market_value')\nrevenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\nprice = data.get('etl:adj_close')\ncond1 = marketcap.rank(pct=True, axis=1) &lt; 0.3\ncond2 = (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &gt; 0.7\ncond3 = (price / price.shift(20)).rank(pct=True, axis=1) &gt; 0.7\npos = cond1 &amp; cond2 &amp; cond3\nreport = sim(pos, resample='ME', upload=False)\nreport.creturn.plot()\n</code></pre>"},{"location":"details/factor_analysis/#_3","title":"\u88fd\u4f5c\u7279\u5fb5\u8207\u6a19\u7c64","text":"<pre><code>from finlab import data\nimport finlab.ml.feature as feature\nimport finlab.ml.label as label\nfeatures =  feature.combine({\n'marketcap': cond1,\n'revenue': cond2,\n'momentum': cond3\n}, resample='ME')\n# \u8a08\u7b97\u672a\u4f86 1M \u7684\u6a19\u7c64\nlabels = label.excess_over_mean(index=features.index, resample='ME')\nfeatures.dropna().head()\n</code></pre> datetime instrument marketcap revenue momentum 2013-04-30 1101 False True True 2013-04-30 1102 False True True 2013-04-30 1103 False True False 2013-04-30 1104 False True False 2013-04-30 1108 False True False <pre><code>labels.dropna().head()\n</code></pre> <pre><code>datetime    instrument\n2007-04-30  1101          0.042548\n            1102          0.081764\n            1103         -0.016863\n            1104         -0.047492\n            1108         -0.002247\ndtype: float64\n</code></pre>"},{"location":"details/factor_analysis/#factor-return","title":"\u56e0\u5b50\u5831\u916c (Factor Return)","text":"<p>\u56e0\u5b50\u5831\u916c\uff08Factor Return\uff09\u662f\u8861\u91cf\u67d0\u56e0\u5b50\u5728\u4e00\u6bb5\u6642\u9593\u5167\u6240\u5e36\u4f86\u8d85\u984d\u5831\u916c\u7684\u6307\u6a19\uff0c\u5e38\u7528\u65bc\u8a55\u4f30\u56e0\u5b50\u7684\u6709\u6548\u6027\u8207\u6295\u8cc7\u50f9\u503c\u3002</p> <p>\u5728\u672c\u5206\u6790\u6d41\u7a0b\u4e2d\uff0c\u6703\u5148\u6839\u64da\u4e0d\u540c\u7684\u56e0\u5b50\uff08\u5982\u5e02\u503c\u3001\u71df\u6536\u6210\u9577\u3001\u52d5\u80fd\u7b49\uff09\u5efa\u7acb\u7279\u5fb5\uff0c\u4e26\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7684\u56e0\u5b50\u5831\u916c\u3002\u900f\u904e\u7d2f\u7a4d\u56e0\u5b50\u5831\u916c\u7684\u8d70\u52e2\uff0c\u53ef\u4ee5\u89c0\u5bdf\u8a72\u56e0\u5b50\u7684\u9577\u671f\u8868\u73fe\u8207\u7a69\u5b9a\u6027\uff0c\u9032\u4e00\u6b65\u4f5c\u70ba\u56e0\u5b50\u7be9\u9078\u8207\u7d44\u5408\u7684\u91cd\u8981\u4f9d\u64da\u3002</p> <p>\u4e0b\u65b9\u5c07\u4ee5\u5716\u8868\u65b9\u5f0f\u5c55\u793a\u5404\u56e0\u5b50\u7684\u7d2f\u7a4d\u5831\u916c\u8868\u73fe\u3002</p> <pre><code>from finlab.tools.factor_analysis import calc_factor_return\nfrom finlab.plot import plot_line\nplot_line(calc_factor_return(features, labels).cumsum(), unit='.0%', title='Factor Cumulative Return')\n</code></pre> <p></p> <p>\u5716\u4e2d\uff0c\u53ef\u4ee5\u89c0\u5bdf\u6708\u71df\u6536\u56e0\u5b50\u6548\u679c\u986f\u8457\u6bd4\u8f03\u597d\uff0c\u4f46\u5e02\u503c\u56e0\u5b50\u6548\u679c\u8f03\u5dee\u3002</p>"},{"location":"details/factor_analysis/#factor-centrality","title":"\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Factor Centrality\uff09","text":"<p>\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Factor Centrality\uff09\uff0c\u662f\u7528\u4f86\u91cf\u5316\u300c\u5171\u540c\u6027\u300d\u7684\u6307\u6a19\u3002</p> <p>\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Centrality\uff09\u5b9a\u7fa9\u5982\u4e0b\uff1a</p> \\[ \\text{Centrality}_i = \\frac{\\lambda_i}{ \\sum_{j=1}^{k}\\lambda_j} \\] <p>\u5176\u4e2d\uff0c\\(\\lambda_j\\) \u70ba\u56e0\u5b50\u5c0d\u65bc\u7b2c\u4e00\u4e3b\u6210\u5206\u7684\u4f54\u6bd4\uff0c\\(k\\) \u70ba\u56e0\u5b50\u7e3d\u6578\u3002</p> <p>\u6b64\u6307\u6a19\u53cd\u6620\u4e86\u56e0\u5b50\u5831\u916c\u7684\u5171\u540c\u6027\uff0c</p> <ul> <li>\u6578\u503c\u8d8a\u5927\u8868\u793a<ul> <li>\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\uff0c\u5728\u8fd1\u671f\u7e3e\u6548\u6bd4\u8f03\u597d\u3002</li> <li>\u96c6\u4e2d\u5ea6\u8d8a\u9ad8\uff0c\u8fd1\u800c\u589e\u52a0\u672a\u4f86\u56de\u6a94\u7684\u98a8\u96aa\uff0c\u9700\u5bc6\u5207\u89c0\u5bdf\u3002</li> </ul> </li> <li>\u6578\u503c\u8d8a\u5c0f\u8868\u793a<ul> <li>\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\uff0c\u5728\u8fd1\u671f\u7e3e\u6548\u8f03\u5dee\u3002</li> <li>\u96c6\u4e2d\u5ea6\u8d8a\u4f4e\uff0c\u672a\u4f86\u56de\u6a94\u7684\u98a8\u96aa\u8f03\u4f4e\u3002</li> <li>\u53ef\u4ee5\u5728\u56e0\u5b50\u64c1\u64e0\u5ea6\u8f03\u4f4e\u7684\u6642\u5019\uff0c\u5bc6\u5207\u89c0\u5bdf\uff0c\u7b49\u64c1\u64e0\u5ea6\u4e0a\u5347\u521d\u671f\uff0c\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\u3002</li> </ul> </li> </ul> <pre><code>from finlab.tools.factor_analysis import calc_centrality\nplot_line(calc_centrality(calc_factor_return(features, labels), 12), title='Centrality')\n</code></pre> <p></p> <p>\u4e0a\u5716\u4e2d\uff0c\u7576\u5e02\u503c\u56e0\u5b50\u76ee\u524d\u64c1\u64e0\u5ea6\u8f03\u4f4e\uff0c\u53ef\u4ee5\u63db\u4e00\u500b\u56e0\u5b50\uff0c\u8b93\u7b56\u7565\u66f4\u7a69\u5b9a\u3002</p> <p>\u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u5bc6\u5207\u89c0\u5bdf\u5e02\u503c\u56e0\u5b50\uff0c\u7b49\u64c1\u64e0\u5ea6\u4e0a\u5347\u521d\u671f\uff0c\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\uff08\u56e0\u5b50\u56de\u6b78\u6548\u61c9\uff09\u3002</p>"},{"location":"details/factor_analysis/#shapley-values","title":"\u56e0\u5b50\u8ca2\u737b\u5ea6\uff08Shapley Values\uff09","text":"<p>Shapley Values \u662f\u4e00\u7a2e\u7528\u65bc\u91cf\u5316\u5404\u500b\u56e0\u5b50\u5c0d\u6295\u8cc7\u7d44\u5408\u5831\u916c\u7684\u8ca2\u737b\u5ea6\uff0c\u662f\u4e00\u7a2e\u516c\u5e73\u5206\u914d\u7684\u6578\u5b78\u65b9\u6cd5\u3002</p> <p>\u6211\u5011\u679a\u8209\u6240\u6709\u53ef\u80fd\u7684\u56e0\u5b50\u7d44\u5408\uff0c\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7d44\u5408\u7684\u5831\u916c\uff0c\u4e26\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u5c0d\u5831\u916c\u7684\u8ca2\u737b\u5ea6\u3002</p> <p>\u6211\u5011\u751a\u81f3\u53ef\u4ee5\u8a08\u7b97\u51fa\uff0c\u6bcf\u500b\u56e0\u5b50\u3001\u6bcf\u500b\u6642\u9593\u9ede\uff0c\u5c0d\u5831\u916c\u7684\u8ca2\u737b\u5ea6\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0cShapley Values \u7684\u8a08\u7b97\u6642\u9593\u8907\u96dc\u5ea6\u70ba \\(O(2^n)\\)\uff0c\u5176\u4e2d \\(n\\) \u70ba\u56e0\u5b50\u500b\u6578\uff0c\u56e0\u6b64\u8a08\u7b97\u6642\u9593\u8f03\u9577\uff0c\u5728\u56e0\u5b50\u500b\u6578\u8f03\u591a\u6642\uff0c\u5efa\u8b70\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u3002</p> <pre><code>from finlab.tools.factor_analysis import calc_shapley_values\nplot_line(calc_shapley_values(features, labels))\n</code></pre> <p></p>"},{"location":"details/factor_analysis/#information-coefficient","title":"\u56e0\u5b50\u76f8\u95dc\u6027\uff08Information Coefficient\uff09","text":"<p>\u56e0\u5b50 IC\uff08Information Coefficient\uff09\u662f\u8861\u91cf\u56e0\u5b50\u9810\u6e2c\u80fd\u529b\u7684\u91cd\u8981\u6307\u6a19\uff0c\u5e38\u7528\u65bc\u8a55\u4f30\u56e0\u5b50\u8207\u672a\u4f86\u5831\u916c\u4e4b\u9593\u7684\u76f8\u95dc\u6027\u3002</p> <p>IC \u7684\u8a08\u7b97\u516c\u5f0f\u5982\u4e0b\uff1a</p> \\[ IC = \\text{corr}(\\text{Factor Score}, \\text{Future Return}) \\] <p>\u5176\u4e2d\uff0c\\(\\text{corr}\\) \u8868\u793a\u76f8\u95dc\u4fc2\u6578\uff08\u901a\u5e38\u70ba\u76ae\u723e\u68ee\u76f8\u95dc\uff09\uff0c\\(\\text{Factor Score}\\) \u70ba\u56e0\u5b50\u5206\u6578\uff0c\\(\\text{Future Return}\\) \u70ba\u672a\u4f86\u4e00\u6bb5\u671f\u9593\u7684\u8cc7\u7522\u5831\u916c\u3002</p> <p>IC \u6578\u503c\u7bc4\u570d\u901a\u5e38\u5728 -1 \u5230 1 \u4e4b\u9593\uff1a</p> <ul> <li>IC \u8d8a\u63a5\u8fd1 1\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u6709\u5f88\u5f37\u7684\u6b63\u5411\u9810\u6e2c\u80fd\u529b\u3002</li> <li>IC \u8d8a\u63a5\u8fd1 -1\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u6709\u5f88\u5f37\u7684\u53cd\u5411\u9810\u6e2c\u80fd\u529b\u3002</li> <li>IC \u63a5\u8fd1 0\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u5e7e\u4e4e\u6c92\u6709\u9810\u6e2c\u80fd\u529b\u3002</li> </ul> <p>\u5728\u91cf\u5316\u9078\u80a1\u4e2d\uff0cIC \u662f\u5224\u65b7\u56e0\u5b50\u6709\u6548\u6027\u7684\u91cd\u8981\u4f9d\u64da\uff0cIC \u8d8a\u9ad8\u7684\u56e0\u5b50\u901a\u5e38\u66f4\u503c\u5f97\u7d0d\u5165\u6295\u8cc7\u7d44\u5408\u3002</p> <pre><code>from finlab.tools.factor_analysis import calc_ic\nfeatures =  feature.combine({\n'marketcap': -marketcap, # \u5c0f\u5e02\u503c\n'revenue': revenue.average(3) / revenue.average(12),\n'momentum': price / price.shift(20)\n}, resample='ME')\nplot_line(calc_ic(features, labels, rank=True))\n</code></pre> <p></p>"},{"location":"details/factor_analysis/#_4","title":"\u56e0\u5b50\u8da8\u52e2\u5206\u6790","text":""},{"location":"details/factor_analysis/#_5","title":"\u6982\u8ff0","text":"<p>\u4e0a\u8ff0\u300c\u96c6\u4e2d\u5ea6\u300d\u300c\u8ca2\u737b\u5ea6\u300d\u300c\u76f8\u95dc\u6027\u300d\u96a8\u6642\u9593\u8b8a\u5316\u6578\u503c\uff0c\u53ef\u4ee5\u5229\u7528 <code>calc_regression_stats</code> \u4f86\u8a08\u7b97\u8da8\u52e2\uff1a</p> <pre><code>from finlab.tools.factor_analysis import calc_regression_stats\ncentrality_df = calc_centrality(features, labels)\ncentrality_trend = calc_regression_stats(centrality_df)\n</code></pre> slope p_value r_squared tail_estimate trend marketcap -0.000111 3.102740e-17 0.404468 0.0123 down revenue 0.000018 4.861743e-03 0.056041 0.0087 flat momentum 0.000093 1.146515e-17 0.412914 0.0215 up"},{"location":"details/factor_analysis/#_6","title":"\u6838\u5fc3\u6b04\u4f4d","text":"\u6b04\u4f4d \u8aaa\u660e \u6578\u503c\u7bc4\u570d \u542b\u7fa9 slope \u7dda\u6027\u56de\u6b78\u659c\u7387 (-\u221e, +\u221e) \u8da8\u52e2\u65b9\u5411\u548c\u5f37\u5ea6 p_value \u7d71\u8a08\u986f\u8457\u6027 [0, 1] \u8da8\u52e2\u7684\u53ef\u4fe1\u5ea6 r_squared \u6c7a\u5b9a\u4fc2\u6578 [0, 1] \u7dda\u6027\u6a21\u578b\u7684\u89e3\u91cb\u529b tail_estimate \u5c3e\u90e8\u4f30\u8a08\u503c (-\u221e, +\u221e) \u6642\u9593\u5e8f\u5217\u672b\u7aef\u7684\u9810\u6e2c\u503c trend \u8da8\u52e2\u5206\u985e \"up\"/\"down\"/\"flat\" \u7c21\u5316\u7684\u8da8\u52e2\u5224\u65b7"},{"location":"details/factor_analysis/#_7","title":"\u6578\u503c\u7bc4\u570d\u8207\u542b\u7fa9","text":""},{"location":"details/factor_analysis/#slope","title":"slope (\u659c\u7387)","text":"<ul> <li>\u6b63\u503c: \u4e0a\u5347\u8da8\u52e2\uff0c\u64c1\u64e0\u5ea6\u589e\u52a0</li> <li>\u8ca0\u503c: \u4e0b\u964d\u8da8\u52e2\uff0c\u64c1\u64e0\u5ea6\u6e1b\u5c11</li> <li>\u7d55\u5c0d\u503c\u5927\u5c0f: \u8da8\u52e2\u5f37\u5ea6\uff08\u8d8a\u5927\u8d8a\u5f37\uff09</li> </ul>"},{"location":"details/factor_analysis/#p_value","title":"p_value (\u7d71\u8a08\u986f\u8457\u6027)","text":"<ul> <li>[0, 0.01]: \u6975\u5ea6\u986f\u8457 (***)</li> <li>[0.01, 0.05]: \u9ad8\u5ea6\u986f\u8457 (**)</li> <li>[0.05, 0.1]: \u908a\u969b\u986f\u8457 (*)</li> <li>[0.1, 1]: \u4e0d\u986f\u8457</li> </ul>"},{"location":"details/factor_analysis/#r_squared","title":"r_squared (\u6c7a\u5b9a\u4fc2\u6578)","text":"<ul> <li>[0.8, 1.0]: \u6975\u5f37\u89e3\u91cb\u529b</li> <li>[0.6, 0.8): \u5f37\u89e3\u91cb\u529b</li> <li>[0.4, 0.6): \u4e2d\u7b49\u89e3\u91cb\u529b</li> <li>[0.2, 0.4): \u5f31\u89e3\u91cb\u529b</li> <li>[0, 0.2): \u5f88\u5f31\u89e3\u91cb\u529b</li> </ul>"},{"location":"details/factor_analysis/#_8","title":"\u8da8\u52e2\u7d44\u5408\u5206\u6790","text":"p_value r_squared slope trend \u542b\u7fa9 \u5c0f \u9ad8 \u6b63 up \u5f37\u70c8\u4e14\u7a69\u5b9a\u7684\u4e0a\u5347\u8da8\u52e2 \u5c0f \u9ad8 \u8ca0 down \u5f37\u70c8\u4e14\u7a69\u5b9a\u7684\u4e0b\u964d\u8da8\u52e2 \u5c0f \u4f4e \u4efb\u610f flat \u8da8\u52e2\u5b58\u5728\u4f46\u6548\u679c\u5c0f/\u96dc\u8a0a\u5927 \u5927 \u9ad8 \u4efb\u610f flat \u6a23\u672c\u5c11\uff0c\u96dc\u8a0a\u9ad8\uff0c\u7121\u6cd5\u5224\u65b7 \u5927 \u4f4e \u4efb\u610f flat \u57fa\u672c\u7121\u8da8\u52e2\u4e14\u6a21\u578b\u7121\u89e3\u91cb\u529b"},{"location":"details/factor_analysis/#_9","title":"\u5be6\u4f8b\u5206\u6790","text":""},{"location":"details/factor_analysis/#marketcap","title":"Marketcap (\u5e02\u503c\u56e0\u5b50)","text":"<pre><code>slope: -0.000111 (\u8ca0\u503c)\np_value: 3.10e-17 (\u6975\u5ea6\u986f\u8457)\nr_squared: 0.40 (\u4e2d\u7b49\u504f\u5f37\u89e3\u91cb\u529b)\ntrend: down\n</code></pre> <p>\u89e3\u8b80: \u5e02\u503c\u56e0\u5b50\u7684\u96c6\u4e2d\u5ea6\u5448\u73fe\u975e\u5e38\u5f37\u70c8\u4e14\u7d71\u8a08\u4e0a\u6975\u5ea6\u986f\u8457\u7684\u4e0b\u964d\u8da8\u52e2\u3002</p>"},{"location":"details/factor_analysis/#revenue","title":"Revenue (\u71df\u6536\u56e0\u5b50)","text":"<pre><code>slope: 0.000018 (\u6b63\u503c)\np_value: 0.0048 (\u986f\u8457)\nr_squared: 0.056 (\u89e3\u91cb\u529b\u8f03\u5f31)\ntrend: flat (\u56e0 r_squared &lt; 0.1)\n</code></pre> <p>\u89e3\u8b80: \u71df\u6536\u56e0\u5b50\u6709\u7d71\u8a08\u4e0a\u986f\u8457\u7684\u4e0a\u5347\u8da8\u52e2\uff0c\u4f46\u7531\u65bc\u89e3\u91cb\u529b\u4e0d\u8db3 (r_squared &lt; 0.1)\uff0c\u88ab\u6b78\u985e\u70ba flat\u3002</p>"},{"location":"details/factor_analysis/#momentum","title":"Momentum (\u52d5\u80fd\u56e0\u5b50)","text":"<pre><code>slope: 0.000093 (\u986f\u8457\u6b63\u503c)\np_value: 1.14e-17 (\u6975\u5ea6\u986f\u8457)\nr_squared: 0.41 (\u4e2d\u7b49\u504f\u5f37\u89e3\u91cb\u529b)\ntrend: up\n</code></pre> <p>\u89e3\u8b80: \u52d5\u80fd\u56e0\u5b50\u7684\u96c6\u4e2d\u5ea6\u5448\u73fe\u975e\u5e38\u5f37\u70c8\u4e14\u7d71\u8a08\u4e0a\u6975\u5ea6\u986f\u8457\u7684\u4e0a\u5347\u8da8\u52e2\u3002\u9019\u662f\u4e00\u500b\u660e\u78ba\u7684\u4fe1\u865f\uff0c\u8868\u660e\u52d5\u80fd\u56e0\u5b50\u975e\u5e38\u300c\u71b1\u9580\u300d\uff0c\u5927\u91cf\u8cc7\u91d1\u6b63\u5728\u8ffd\u9010\u9019\u500b\u7b56\u7565\u3002</p>"},{"location":"details/finlab_plot/","title":"\u8cc7\u6599\u8996\u89ba\u5316","text":"<p>FinLab \u63d0\u4f9b\u4e00\u7cfb\u5217\u5716\u8868\u5de5\u5177\uff0c\u8b93\u4f60\u66f4\u65b9\u4fbf\u6d1e\u5bdf\u5e02\u5834\u6578\u64da\uff01</p> <p>colab \u7bc4\u4f8b\u6a94\u6848\u9023\u7d50</p> In\u00a0[1]: Copied! <pre>%%capture\n!pip install finlab &gt; log.txt\n!pip install talib-binary &gt; log.txt\n</pre> %%capture !pip install finlab &gt; log.txt !pip install talib-binary &gt; log.txt In\u00a0[5]: Copied! <pre>from finlab.plot import plot_tw_stock_candles\nfrom talib import abstract\nfrom finlab.data import indicator\n\nstock_id = '2330'  # @param {type:\"string\"}\nrecent_days = 1000  # @param {type:\"slider\", min:200, max:6000, step:1}\nadjust_price=False #@param [\"False\", \"True\"] {type:\"raw\"}\nresample=\"D\"#@param [\"D\", \"W\",\"M\"] {allow-input: true}\n\noverlay_func={\n              'ema_5':indicator('EMA',timeperiod=5),\n              'ema_10':indicator('EMA',timeperiod=10),\n              'ema_20':indicator('EMA',timeperiod=20),\n              'ema_60':indicator('EMA',timeperiod=60),\n              }\nk,d = indicator('STOCH')\nrsi = indicator('RSI')\ntechnical_func = [{'K':k,'D':d},{'RSI':rsi}]\nplot_tw_stock_candles(stock_id,recent_days,adjust_price,resample,overlay_func=overlay_func,technical_func=technical_func)\n</pre> from finlab.plot import plot_tw_stock_candles from talib import abstract from finlab.data import indicator  stock_id = '2330'  # @param {type:\"string\"} recent_days = 1000  # @param {type:\"slider\", min:200, max:6000, step:1} adjust_price=False #@param [\"False\", \"True\"] {type:\"raw\"} resample=\"D\"#@param [\"D\", \"W\",\"M\"] {allow-input: true}  overlay_func={               'ema_5':indicator('EMA',timeperiod=5),               'ema_10':indicator('EMA',timeperiod=10),               'ema_20':indicator('EMA',timeperiod=20),               'ema_60':indicator('EMA',timeperiod=60),               } k,d = indicator('STOCH') rsi = indicator('RSI') technical_func = [{'K':k,'D':d},{'RSI':rsi}] plot_tw_stock_candles(stock_id,recent_days,adjust_price,resample,overlay_func=overlay_func,technical_func=technical_func) In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import plot_tw_stock_treemap\n\nstart= '2021-07-01' #@param {type:\"date\"}\nend = '2021-07-02' #@param {type:\"date\"}\narea_ind=\"turnover\" #@param [\"market_value\",\"turnover\"] {allow-input: true}\nitem=\"return_ratio\" #@param [\"return_ratio\", \"turnover_ratio\"] {allow-input: true}\nplot_tw_stock_treemap(start,end,area_ind,item)\n</pre> from finlab.plot import plot_tw_stock_treemap  start= '2021-07-01' #@param {type:\"date\"} end = '2021-07-02' #@param {type:\"date\"} area_ind=\"turnover\" #@param [\"market_value\",\"turnover\"] {allow-input: true} item=\"return_ratio\" #@param [\"return_ratio\", \"turnover_ratio\"] {allow-input: true} plot_tw_stock_treemap(start,end,area_ind,item) <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 113.8 / 5000 MB\nWARNING:finlab.data:company_basic_info -- Daily data usage: 114.7 / 5000 MB\nWARNING:finlab.data:price:\u6210\u4ea4\u91d1\u984d -- Daily data usage: 149.3 / 5000 MB\n</pre> In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import plot_tw_stock_treemap\n\nplot_tw_stock_treemap(start='2021-07-01',end='2021-07-02',area_ind=\"market_value\",item=\"price_earning_ratio:\u672c\u76ca\u6bd4\",clip=(0,50), color_continuous_scale='RdBu_r')\n</pre> from finlab.plot import plot_tw_stock_treemap  plot_tw_stock_treemap(start='2021-07-01',end='2021-07-02',area_ind=\"market_value\",item=\"price_earning_ratio:\u672c\u76ca\u6bd4\",clip=(0,50), color_continuous_scale='RdBu_r') <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 1092.5 / 5000 MB\nWARNING:finlab.data:company_basic_info -- Daily data usage: 1093.4 / 5000 MB\nWARNING:finlab.data:price:\u6210\u4ea4\u91d1\u984d -- Daily data usage: 1128.0 / 5000 MB\nWARNING:finlab.data:price_earning_ratio:\u672c\u76ca\u6bd4 -- Daily data usage: 1142.3 / 5000 MB\n</pre> In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import plot_tw_stock_radar\n\nportfolio = \"1101,2330,8942,6263\" #@param {type:\"string\"}\nportfolio = portfolio.split(',')\nmode = \"bar_polar\" #@param ['line_polar','bar_polar','scatter_polar'] {allow-input: true}\nline_polar_fill='None' #@param ['toself','tonext','None'] {allow-input: true}\nif line_polar_fill is \"None\":\n    line_polar_fill=None\nplot_tw_stock_radar(portfolio=portfolio,mode=mode,line_polar_fill=line_polar_fill)\n</pre> from finlab.plot import plot_tw_stock_radar  portfolio = \"1101,2330,8942,6263\" #@param {type:\"string\"} portfolio = portfolio.split(',') mode = \"bar_polar\" #@param ['line_polar','bar_polar','scatter_polar'] {allow-input: true} line_polar_fill='None' #@param ['toself','tonext','None'] {allow-input: true} if line_polar_fill is \"None\":     line_polar_fill=None plot_tw_stock_radar(portfolio=portfolio,mode=mode,line_polar_fill=line_polar_fill) In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import plot_tw_stock_radar\nfeats = ['fundamental_features:\u71df\u696d\u6bdb\u5229\u7387', 'fundamental_features:\u71df\u696d\u5229\u76ca\u7387', 'fundamental_features:\u7a05\u5f8c\u6de8\u5229\u7387',\n          'fundamental_features:\u73fe\u91d1\u6d41\u91cf\u6bd4\u7387', 'fundamental_features:\u8ca0\u50b5\u6bd4\u7387']\nplot_tw_stock_radar(portfolio=[\"9939\"], feats=feats, mode=\"line_polar\", cut_bins=8)\n</pre> from finlab.plot import plot_tw_stock_radar feats = ['fundamental_features:\u71df\u696d\u6bdb\u5229\u7387', 'fundamental_features:\u71df\u696d\u5229\u76ca\u7387', 'fundamental_features:\u7a05\u5f8c\u6de8\u5229\u7387',           'fundamental_features:\u73fe\u91d1\u6d41\u91cf\u6bd4\u7387', 'fundamental_features:\u8ca0\u50b5\u6bd4\u7387'] plot_tw_stock_radar(portfolio=[\"9939\"], feats=feats, mode=\"line_polar\", cut_bins=8) In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import plot_tw_stock_river\nplot_tw_stock_river(stock_id='2330', start='2015-1-1', end='2022-7-1', mode='pe', split_range=10)\n</pre> from finlab.plot import plot_tw_stock_river plot_tw_stock_river(stock_id='2330', start='2015-1-1', end='2022-7-1', mode='pe', split_range=10) In\u00a0[\u00a0]: Copied! <pre>from finlab.plot import StrategySunburst\n\n# \u5be6\u4f8b\u5316\u7269\u4ef6\nstrategies = StrategySunburst()\nstrategies.plot().show()\n</pre> from finlab.plot import StrategySunburst  # \u5be6\u4f8b\u5316\u7269\u4ef6 strategies = StrategySunburst() strategies.plot().show()"},{"location":"details/finlab_plot/","title":"\u6280\u8853\u6307\u6a19\u5716\u7d44\u00b6","text":""},{"location":"details/finlab_plot/","title":"\u6f32\u8dcc\u5e45\u8207\u6210\u4ea4\u91d1\u984d\u677f\u584a\u5716\u00b6","text":"<p>\u5de2\u72c0\u6a39\u72c0\u5716\u53ef\u4ee5\u986f\u793a\u591a\u7dad\u5ea6\u8cc7\u6599\uff0c\u4e26\u8207\u5716\u8868\u505a\u4e92\u52d5\uff0c\u5c07\u4f9d\u7167\u7522\u696d\u5206\u985e\u7684\u53f0\u80a1\u8cc7\u6599\u7d62\u9e97\u986f\u793a\u3002</p>"},{"location":"details/finlab_plot/","title":"\u672c\u76ca\u6bd4\u8207\u5e02\u503c\u677f\u584a\u5716\u00b6","text":""},{"location":"details/finlab_plot/","title":"\u8ca1\u52d9\u6307\u6a19\u96f7\u9054\u5716\u00b6","text":"<p>\u6bd4\u8f03\u6301\u80a1\u7d44\u5408\u7684\u6307\u6a19\u5206\u7d1a\u7279\u6027\u3002</p>"},{"location":"details/finlab_plot/","title":"\u672c\u76ca\u6bd4\u6cb3\u6d41\u5716\u00b6","text":"<p>\u4f7f\u7528 PE or PB \u7684\u6700\u9ad8\u8207\u6700\u4f4e\u503c\u7e6a\u88fd\u6cb3\u6d41\u5716\uff0c\u5224\u65b7\u6307\u6a19\u6240\u8655\u4f4d\u968e\u3002</p>"},{"location":"details/finlab_plot/","title":"\u7b56\u7565\u90e8\u4f4d\u65ed\u65e5\u5716\u00b6","text":"<p>\u76e3\u63a7\u591a\u7b56\u7565\u3002</p>"},{"location":"details/get_data/","title":"\u6578\u64da","text":"<p>\u4e00\u884c\u7a0b\u5f0f\u5feb\u901f\u6293\u53d6\u8c50\u5bcc\u7684\u80a1\u5e02\u8cc7\u6599\u5eab\uff01\u53f0\u80a1\u5e02\u5834\u4f60\u60f3\u7684\u5230\uff0c\u60f3\u4e0d\u5230\u7684\u8cc7\u6599\uff0c\u6211\u5011\u5e7e\u4e4e\u90fd\u6709\u63d0\u4f9b\u5594\uff01</p>"},{"location":"details/get_data/#_1","title":"\u4e0b\u8f09\u8cc7\u6599","text":"<p>\u8cc7\u6599\u7372\u53d6\u65b9\u6cd5\uff0c\u5c31\u662f\u4f7f\u7528 <code>data.get</code> \u51fd\u5f0f\uff0c\u4e00\u6b21\u641e\u5b9a\u4e0b\u8f09 2000 \u6a94\u80a1\u7968 10 \u5e74\u4ee5\u4e0a\u7684\u6b77\u53f2\u7d00\u9304\uff1a</p> <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\n</code></pre> date 1001 ... 2330 2007-04-23 39.65 ... 38.3 ... ... ... ... 2023-05-02 39.85 ... 38.85 <p>\u7372\u5f97\u7684\u8cc7\u6599\uff0c\u70ba <code>FinlabDataFrame</code>\uff0c\u529f\u80fd\u985e\u4f3c\u65bc Pandas DataFrame\uff0c\u719f\u6089 Pandas \u7684\u7528\u6236\u99ac\u4e0a\u5c31\u53ef\u4ee5\u5c07\u8cc7\u6599\u505a\u8655\u7406\uff0c\u5047\u5982\u60a8\u4e0d\u719f\u6089 Pandas\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u95b1\u8b80 Pandas 10\u5206\u9418\u4e0a\u624b\u3002</p> <ul> <li>\u7e31\u8ef8(row): \u662f\u5e02\u5834\u6709\u4ea4\u6613\u7684\u65e5\u671f\u7684\u6536\u76e4\u50f9\u3002</li> <li>\u6a6b\u8ef8(column): \u70ba\u80a1\u7968\u4ee3\u865f\uff0c\u88fd\u4f5c\u9078\u80a1\u7b56\u7565\u975e\u5e38\u65b9\u4fbf\u3002</li> </ul> <p>\u5982\u4f55\u8df3\u904e\u8981\u6c42\u767b\u5165?</p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4e0b\u65b9\u7684\u81ea\u52d5\u767b\u5165\u8a9e\u6cd5\uff0c\u8df3\u904e\u4eba\u5de5\u767b\u5165\u7684\u904e\u7a0b\uff0c\u8b93\u60a8\u81ea\u52d5\u767b\u5165\uff01</p> <p>\u9084\u6709\u63d0\u4f9b\u54ea\u4e9b\u8cc7\u6599\u5462\uff1f</p> <p>\u60a8\u53ef\u4ee5\u5230\u8cc7\u6599\u5eab\u76ee\u9304\u8907\u88fd\u60f3\u7372\u53d6\u7684\u8cc7\u6599\u7684\u4f7f\u7528\u65b9\u6cd5\u3002</p> <p>\u514d\u8cbb\u8cc7\u6599\u6bd4\u8f03\u77ed\u4e00\u9ede\u5594</p> <p>\u5047\u5982\u4f7f\u7528\u8005\u70ba\u514d\u8cbb\u8a66\u7528\u4e4b\u6703\u54e1\uff0c\u9084\u662f\u53ef\u4ee5\u4e0b\u8f09\u5230\u5927\u90e8\u5206\u7684\u8cc7\u6599\uff0c\u4f9b\u60a8\u56de\u6e2c\u4f7f\u7528\uff0c\u4f46\u4e26\u4e0d\u6703\u63d0\u4f9b\u8fd1\u5e74\u7684\u8cc7\u6599\uff0c\u6240\u4ee5\u5047\u5982\u6e2c\u8a66\u5b8c\u7562\uff0c\u89ba\u5f97\u672c\u529f\u80fd\u5408\u9069\uff0c\u6b61\u8fce\u53c3\u8003VIP\u5b8c\u6574\u529f\u80fd</p>"},{"location":"details/get_data/#_2","title":"\u81ea\u52d5\u767b\u5165\u53d6\u5f97\u6b77\u53f2\u8cc7\u6599","text":"<p>\u5728\u4e0b\u8f09\u8cc7\u6599\u524d\uff0c\u4f60\u9700\u8981\u5148\u767b\u5165 FinLab\uff0c\u624d\u80fd\u7372\u53d6\u8cc7\u6599\u3002\u5982\u679c\u4f60\u4f7f\u7528 Jupyter \u6216 Google Colab\uff0c\u53ef\u4ee5\u900f\u904e GUI \u4ecb\u9762\u4f86\u767b\u5165\uff0c\u7cfb\u7d71\u901a\u5e38\u6703\u81ea\u5df1\u8df3\u51fa\u4f86\u8acb\u4f60\u767b\u5165\u3002\u4f46\u5176\u4ed6\u72c0\u6cc1\uff0c\u4f8b\u5982\u60a8\u4e26\u975e\u4f7f\u7528 Jupyter \u6216 Colab \uff0c\u800c\u662f\u7528 VSCode \u6216\u57f7\u884c\u7d14 Python \u8173\u672c\uff0c\u5247\u53ef\u4ee5\u900f\u904e\u4ee5\u4e0b\u6b65\u9a5f\u4f86\u767b\u5165\uff1a</p> <p>\u9996\u5148\uff0c\u4f60\u9700\u8981\u53d6\u5f97\u4f60\u7684 API token\uff0c\u53ef\u4ee5\u5728 \u6703\u54e1\u5c08\u5340 \u4e2d\u627e\u5230\u3002</p> <p>\u8907\u88fd\u4f60\u7684 API token\uff0c\u4ee5\u767b\u5165 FinLab\uff1a</p> <pre><code>import finlab\nfinlab.login('YOUR_API_TOKEN')\n</code></pre> <p>\u66f4\u5b89\u5168\u7684\u5beb\u6cd5</p> <p>\u53ef\u4ee5\u5229\u7528\u74b0\u5883\u8b8a\u6578\u8a2d\u5b9a\uff0c\u907f\u514d\u60a8\u7684 API_TOKEN \u5916\u6d41\uff0c\u4ee5\u4e0b\u8a2d\u5b9a\u65b9\u5f0f\u9700\u8981\u6bcf\u6b21\u958b\u555f Terminal \u91cd\u65b0\u8a2d\u5b9a\uff0c\u5047\u5982\u60a8\u4e26\u975e\u8edf\u9ad4\u5de5\u7a0b\u80cc\u666f\uff0c\u53ef\u8df3\u904e\u6b64\u6b65\u9a5f\u3002</p> WindowsMacOS / Linux <p>\u6253\u958b\u547d\u4ee4\u63d0\u793a\u8996\u7a97\uff0c\u4e26\u8f38\u5165 <pre><code>set FINLAB_API_TOKEN=&lt;YOUR_API_TOKEN&gt;\n</code></pre></p> <p>\u6253\u958b terminal <pre><code>export FINLAB_API_TOKEN=&lt;YOUR_API_TOKEN&gt;\n</code></pre></p>"},{"location":"details/get_data/#_3","title":"\u5e02\u5834\u8207\u985e\u80a1\u7bc4\u570d","text":"<p>\u5728\u53f0\u7063\u80a1\u5e02\uff0c\u5e02\u5834\u7bc4\u570d (market) \u53ef\u4ee5\u9078\u64c7\u4ee5\u4e0b\u4e94\u500b\uff1a</p> <ul> <li><code>ALL</code>\uff1a\u4ee3\u8868\u5168\u5e02\u5834\uff0c\u5305\u62ec\u4e0a\u5e02\u3001\u4e0a\u6ac3\u3001\u8208\u6ac3\u3001\u516c\u958b\u767c\u884c\u7b49\u6240\u6709\u80a1\u7968\u3002</li> <li><code>TSE</code>\uff1a\u4ee3\u8868\u4e0a\u5e02\uff0c\u5373\u5728\u53f0\u7063\u8b49\u5238\u4ea4\u6613\u6240\u4e0a\u5e02\u7684\u516c\u53f8\u80a1\u7968\u3002</li> <li><code>OTC</code>\uff1a\u4ee3\u8868\u4e0a\u6ac3\uff0c\u5373\u5728\u53f0\u7063\u8b49\u5238\u6ac3\u6aaf\u8cb7\u8ce3\u4e2d\u5fc3\u4e0a\u5e02\u7684\u516c\u53f8\u80a1\u7968\u3002</li> <li><code>TSE_OTC</code>\uff1a\u4ee3\u8868\u4e0a\u5e02\u6ac3\uff0c\u5305\u62ec\u5728\u53f0\u7063\u8b49\u5238\u4ea4\u6613\u6240\u53ca\u6ac3\u6aaf\u8cb7\u8ce3\u4e2d\u5fc3\u4e0a\u5e02\u7684\u516c\u53f8\u80a1\u7968\u3002</li> <li><code>ETF</code>\uff1a\u4ee3\u8868\u4ea4\u6613\u578b\u57fa\u91d1\uff0c\u662f\u4e00\u7a2e\u53ef\u4ee5\u50cf\u80a1\u7968\u4e00\u6a23\u4ea4\u6613\u7684\u57fa\u91d1\u3002</li> </ul> <p>\u800c\u985e\u80a1\u7bc4\u570d (category) \u5247\u662f\u6309\u7167\u884c\u696d\u5206\u985e\uff0c\u53ef\u4ee5\u9078\u64c7\u4ee5\u4e0b 30 \u500b\u7522\u696d\uff1a</p> <p><code>\u5149\u96fb\u696d</code> <code>\u5176\u4ed6\u96fb\u5b50\u696d</code> <code>\u5316\u5b78\u5de5\u696d</code> <code>\u534a\u5c0e\u9ad4</code> <code>\u5851\u81a0\u5de5\u696d</code> <code>\u5b58\u8a17\u6191\u8b49</code> <code>\u5efa\u6750\u71df\u9020</code> <code>\u6587\u5316\u5275\u610f\u696d</code> <code>\u6a61\u81a0\u5de5\u696d</code> <code>\u6c34\u6ce5\u5de5\u696d</code> <code>\u6c7d\u8eca\u5de5\u696d</code> <code>\u6cb9\u96fb\u71c3\u6c23\u696d</code> <code>\u73bb\u7483\u9676\u74f7</code> <code>\u751f\u6280\u91ab\u7642</code> <code>\u751f\u6280\u91ab\u7642\u696d</code> <code>\u7d21\u7e54\u7e96\u7dad</code> <code>\u822a\u904b\u696d</code> <code>\u89c0\u5149\u4e8b\u696d</code> <code>\u8cbf\u6613\u767e\u8ca8</code> <code>\u8cc7\u8a0a\u670d\u52d9\u696d</code> <code>\u8fb2\u696d\u79d1\u6280</code> <code>\u901a\u4fe1\u7db2\u8def\u696d</code> <code>\u9020\u7d19\u5de5\u696d</code> <code>\u91d1\u878d</code> <code>\u92fc\u9435\u5de5\u696d</code> <code>\u96fb\u5668\u96fb\u7e9c</code> <code>\u96fb\u5b50\u5546\u52d9</code> <code>\u96fb\u5b50\u901a\u8def\u696d</code> <code>\u96fb\u5b50\u96f6\u7d44\u4ef6</code> <code>\u96fb\u6a5f\u6a5f\u68b0</code> <code>\u96fb\u8166\u53ca\u9031\u908a</code> <code>\u98df\u54c1\u5de5\u696d</code></p> <p>ETF \u76f8\u95dc\u985e\u80a1\uff0c\u53ef\u4ee5\u4f7f\u7528</p> <ul> <li><code>domestic_etf</code>:\u4ee5\u53f0\u80a1\u70ba\u6210\u5206\u80a1\u4e4b ETF</li> <li><code>foreign_etf</code>: \u4ee5\u570b\u5916\u5546\u54c1\u70ba\u6210\u5206\u80a1\u4e4b ETF</li> <li><code>leveraged_etf</code>: \u69d3\u687f\u578b ETF</li> <li><code>vanilla_futures_etf</code>: \u7121\u69d3\u687f\u671f\u8ca8 ETF</li> <li><code>leveraged_futures_etf</code>: \u69d3\u687f\u578b\u671f\u8ca8 ETF</li> </ul> <p>\u5982\u679c\u60f3\u8981\u9650\u5b9a\u7bc4\u570d\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>data.universe</code> \u51fd\u5f0f\u4f86\u8a2d\u5b9a\u7be9\u9078\u689d\u4ef6\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u6293\u53d6\u5728\u4e0a\u5e02\u6ac3\u4e2d\u7684\u6c34\u6ce5\u7522\u696d\u80a1\u7968\u6536\u76e4\u50f9\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff1a</p> <pre><code>from finlab import data\nwith data.universe(market='TSE_OTC', category=['\u6c34\u6ce5\u5de5\u696d']):\nprice = data.get('price:\u6536\u76e4\u50f9')\n</code></pre> <p>\u9019\u6a23\u5c31\u6703\u53d6\u5f97\u5728\u4e0a\u5e02\u6ac3\u4e2d\u7684\u6c34\u6ce5\u7522\u696d\u80a1\u7968\u6536\u76e4\u50f9\u7684\u8cc7\u6599:</p> <p></p> <p>\u53d6\u6d88\u6a21\u7cca\u6bd4\u5c0d</p> <p>\u4f7f\u7528\u6b63\u898f\u8868\u9054\u5f0f\u9078\u53d6\uff1a\u7531\u65bc\u7a0b\u5f0f\u662f\u4f7f\u7528 regex \u4f86\u9032\u884c\u6bd4\u5c0d\uff0c\u6240\u4ee5\u6703\u8b8a\u6210\u6a21\u7cca\u6bd4\u5c0d\uff0c\u7576 categories \u662f\u300c\u5176\u4ed6\u300d\uff0c\u5247\u6703\u9078\u51fa\u6240\u6709\u7684\u300c\u5176\u4ed6\u300d\u985e\u80a1\uff0c\u5305\u542b\u300c\u5176\u4ed6\u8b49\u5238\u300d\u3002\u5982\u679c\u4f7f\u7528\u8005\u5982\u679c\u5e0c\u671b\u9078\u51fa\u300c\u5176\u4ed6\u300d\u4f46\u4e0d\u60f3\u8981\u9078\u51fa\u300c\u5176\u4ed6\u8b49\u5238\u300d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\uff1a</p> <pre><code>with universe('TSE_OTC', ['^\u5176\u4ed6$']):\nclose_subset = data.get('price:\u6536\u76e4\u50f9')\nprint(close_subset)\n</code></pre> <p>\u9019\u6a23\u5c31\u6703\u660e\u78ba\u6307\u660e\u958b\u982d\u8ddf\u7d50\u5c3e\u4e2d\u9593\uff0c\u53ea\u6709\u300c\u5176\u4ed6\u300d\u7684\u985e\u80a1\u6703\u88ab\u9078\u51fa\u4f86\u3002</p>"},{"location":"details/limit_market/","title":"Limit market","text":"<p>\u8a2d\u5b9a\u6578\u64da\u7684\u5e02\u5834\u8207\u985e\u80a1\u7bc4\u570d\u3002</p>"},{"location":"details/limit_market/#_1","title":"\u7a0b\u5f0f\u7bc4\u4f8b","text":"<p>\u9650\u5b9a\u53ea\u6293\u53d6\u4e0a\u5e02\u6ac3\u666e\u901a\u80a1 (\u6392\u9664ETF\u3001ETN\u3001\u7279\u5225\u80a1\u3001\u5b58\u8a17\u6191\u8b49) \u7684\u80a1\u50f9\u3002</p> <pre><code>from finlab import data\nwith data.universe(market='TSE_OTC', category=['\u6c34\u6ce5']):\nprice=data.get('price:\u6536\u76e4\u50f9')\n</code></pre> <p></p>"},{"location":"details/limit_market/#datauniverse","title":"data.universe() \u53c3\u6578\u8aaa\u660e","text":"<ul> <li><code>market (str)</code>: \u5e02\u5834\u540d\u7a31\u3002     \u7bc4\u4f8b\uff1a <code>'ALL', 'TSE', 'OTC', 'TSE_OTC', 'ETF'</code></li> <li> <p><code>category (str or list)</code>: \u985e\u80a1\u540d\u7a31\uff0c\u53ef\u4ee5\u4f7f\u7528\u6a21\u7cca\u6bd4\u5c0d\uff0c\u4f8b\u5982 <code>'\u96fb\u5b50'</code>\uff0c\u6703\u9078\u5230<code>'\u96fb\u5b50\u5de5\u696d'</code>, <code>'\u96fb\u5b50\u901a\u8def\u696d'</code>... \u7b49;     \u4f8b\u5982 <code>['\u6c34\u6ce5','\u92fc\u9435']</code>\uff0c\u6703\u9078\u5230<code>'\u6c34\u6ce5\u5de5\u696d'</code>, <code>'\u92fc\u9435\u5de5\u696d'</code>\u3002</p> <p>\u53ef\u9078\u7522\u696d\u7bc4\u570d\u5982\u4e0b</p> <pre><code>'\u5149\u96fb\u696d', '\u5176\u4ed6', '\u5176\u4ed6\u96fb\u5b50\u696d',\n'\u5316\u5b78\u5de5\u696d', '\u534a\u5c0e\u9ad4', '\u5851\u81a0\u5de5\u696d', '\u5b58\u8a17\u6191\u8b49', '\u5efa\u6750\u71df\u9020', '\u6587\u5316\u5275\u610f\u696d', '\u6a61\u81a0\u5de5\u696d', '\u6c34\u6ce5\u5de5\u696d',\n'\u6c7d\u8eca\u5de5\u696d', '\u6cb9\u96fb\u71c3\u6c23\u696d', '\u73bb\u7483\u9676\u74f7', '\u751f\u6280\u91ab\u7642', '\u751f\u6280\u91ab\u7642\u696d', '\u7d21\u7e54\u7e96\u7dad', '\u822a\u904b\u696d', '\u89c0\u5149\u4e8b\u696d', '\u8cbf\u6613\u767e\u8ca8',\n'\u8cc7\u8a0a\u670d\u52d9\u696d', '\u8fb2\u696d\u79d1\u6280', '\u901a\u4fe1\u7db2\u8def\u696d', '\u9020\u7d19\u5de5\u696d', '\u91d1\u878d', '\u92fc\u9435\u5de5\u696d', '\u96fb\u5668\u96fb\u7e9c', '\u96fb\u5b50\u5546\u52d9',\n'\u96fb\u5b50\u901a\u8def\u696d', '\u96fb\u5b50\u96f6\u7d44\u4ef6', '\u96fb\u6a5f\u6a5f\u68b0', '\u96fb\u8166\u53ca\u9031\u908a', '\u98df\u54c1\u5de5\u696d'\n</code></pre> </li> </ul>"},{"location":"details/machine_learning/","title":"\u6a5f\u5668\u5b78\u7fd2","text":""},{"location":"details/machine_learning/#_1","title":"\u76f8\u95dc\u51fd\u5f0f\u5eab\u5b89\u88dd","text":""},{"location":"details/machine_learning/#_2","title":"\u5fc5\u8981\u5b89\u88dd","text":"<p>\u70ba\u4e86\u8b93\u60a8\u9806\u5229\u904b\u884c\u4e0a\u8ff0\u7684\u91cf\u5316\u6295\u8cc7\u6a21\u578b\u548c\u51fd\u6578\uff0c\u60a8\u9700\u8981\u5148\u5b89\u88dd\u4e00\u4e9b\u5fc5\u8981\u7684 Python \u5957\u4ef6\u3002\u5225\u64d4\u5fc3\uff0c\u9019\u500b\u904e\u7a0b\u975e\u5e38\u7c21\u55ae\uff01\u4ee5\u4e0b\u662f\u60a8\u9700\u8981\u6dfb\u52a0\u5230\u60a8\u7684\u74b0\u5883\u4e2d\u7684\u5957\u4ef6\u5b89\u88dd\u6307\u4ee4\uff1a </p> <ol> <li>\u5b89\u88dd <code>finlab</code> \u5957\u4ef6\uff0c\u5b83\u63d0\u4f9b\u4e86\u8a31\u591a\u65b9\u4fbf\u7684\u5de5\u5177\u548c\u51fd\u6578\u4f86\u9032\u884c\u91cf\u5316\u6295\u8cc7\u5206\u6790\u3002</li> <li>\u5b89\u88dd <code>ta-lib-bin</code> \u5957\u4ef6\uff0c\u9019\u662f\u4e00\u500b\u5f37\u5927\u7684\u6280\u8853\u5206\u6790\u5eab\uff0c\u5ee3\u6cdb\u61c9\u7528\u65bc\u91d1\u878d\u5e02\u5834\u5206\u6790\u4e2d\u3002</li> <li>\u5b89\u88dd <code>Qlib</code>\uff0c\u9019\u662f\u7531\u5fae\u8edf\u958b\u6e90\u7684\u4e00\u500b\u91cf\u5316\u6295\u8cc7\u7814\u7a76\u5e73\u53f0\uff0c\u652f\u6301\u5168\u6d41\u7a0b\u7684\u7b56\u7565\u958b\u767c\u3002</li> </ol> <pre><code>pip install finlab\npip install ta-lib-bin\npip install git+https://github.com/microsoft/qlib.git\n</code></pre> <p>\u5982\u679c\u4f7f\u7528 Colab\uff0c\u6703\u5f97\u5230 Packaging version \u91cd\u65b0\u5b89\u88dd\u7684\u76f8\u95dc\u63d0\u793a\uff0c\u8acb\u6309\u78ba\u8a8d\u5c07 kernel \u91cd\u65b0\u555f\u52d5(\u6216 Session)\uff0c\u5c31\u80fd\u6b63\u5e38\u4f7f\u7528\u3002\u901a\u904e\u57f7\u884c\u4e0a\u8ff0\u6307\u4ee4\uff0c\u60a8\u5c07\u6703\u7372\u5f97\u57f7\u884c\u91cf\u5316\u5206\u6790\u6240\u9700\u7684\u57fa\u790e\u8a2d\u65bd\u3002</p> <p>LegacyVersion \u932f\u8aa4\u8655\u7406</p> <p>\u5047\u5982\u60a8\u662f\u4f7f\u7528 Colab\uff0c\u8acb\u76f4\u63a5\u91cd\u65b0\u555f\u52d5\uff0c\u65b9\u6cd5\u70ba\u300c\u57f7\u884c\u968e\u6bb5\u300d-&gt;\u300c\u91cd\u65b0\u555f\u52d5\u57f7\u884c\u968e\u6bb5\u300d</p>"},{"location":"details/machine_learning/#_3","title":"\u6a21\u578b\u51fd\u793a\u5eab\uff08\u975e\u5fc5\u9808\uff09","text":"<p>\u7531\u65bc Qlib \u7576\u4e2d\u5f15\u7528\u8af8\u591a\u6a21\u578b\uff0c\u5982 LightGBM\u3001XGBoost\u3001CatBoost\u3001\u7dda\u6027\u6a21\u578b\u3001Pytorch\u3001Tensorflow \u548c\u6df1\u5ea6\u795e\u7d93\u7db2\u7d61\u7b49\uff0c \u5047\u5982\u9700\u8981\u7528\u5230\u9019\u4e9b\u6a21\u578b\uff0c\u8acb\u53c3\u8003\u8a72\u6a21\u578b\u7684\u5b98\u65b9\u6587\u4ef6\uff0c\u5b89\u88dd\u76f8\u5c0d\u61c9\u7684\u51fd\u5f0f\u5eab\u3002\u5047\u5982\u60a8\u4f7f\u7528 Colab\uff0c\u9019\u4e9b\u51fd\u5f0f\u5eab\u5df2\u7d93\u9810\u5148\u5b89\u88dd\u597d\u4e86\uff0c\u4e0d\u9700\u8981\u518d\u6b21\u5b89\u88dd\u3002</p> <ol> <li>\u5b89\u88dd LightGBM</li> <li>\u5b89\u88dd XGBoost</li> <li>\u5b89\u88dd CatBoost</li> <li>\u5b89\u88dd Pytorch</li> <li>\u5b89\u88dd Tensorflow</li> </ol>"},{"location":"details/machine_learning/#_4","title":"\u7279\u5fb5\u8655\u7406","text":""},{"location":"details/machine_learning/#combine","title":"\u4f7f\u7528 Combine \u51fd\u6578\u5408\u4f75\u7279\u5fb5","text":"<p>\u5728\u91d1\u878d\u5206\u6790\u548c\u91cf\u5316\u6295\u8cc7\u9818\u57df\u4e2d\uff0c\u300c\u7279\u5fb5\u300d\u662f\u5c0d\u65bc\u9810\u6e2c\u6a21\u578b\u4f86\u8aaa\u81f3\u95dc\u91cd\u8981\u7684\u6578\u64da\u3002<code>combine</code> \u51fd\u6578\u662f <code>finlab.ml.feature</code> \u6a21\u7d44\u4e2d\u7684\u4e00\u500b\u5f37\u5927\u5de5\u5177\uff0c\u5b83\u5141\u8a31\u60a8\u5c07\u591a\u500b\u4e0d\u540c\u4f86\u6e90\u7684\u7279\u5fb5\u5408\u4f75\u6210\u4e00\u500b\u7d71\u4e00\u7684 DataFrame\uff0c\u9019\u5c0d\u65bc\u69cb\u5efa\u548c\u8a13\u7df4\u9810\u6e2c\u6a21\u578b\u975e\u5e38\u6709\u5e6b\u52a9\u3002</p> <p>\u9019\u500b\u51fd\u6578\u7684\u512a\u9ede\u5728\u65bc\uff0c\u5b83\u53ef\u4ee5\u8655\u7406\u4f86\u81ea\u4e0d\u540c\u6578\u64da\u6e90\u7684\u7279\u5fb5\uff0c\u7121\u8ad6\u662f\u6280\u8853\u6307\u6a19\u3001\u57fa\u672c\u9762\u5206\u6790\u6307\u6a19\uff0c\u9084\u662f\u81ea\u5b9a\u7fa9\u7684\u6578\u64da\u96c6\uff0c\u90fd\u53ef\u4ee5\u901a\u904e <code>combine</code> \u51fd\u6578\u7d44\u5408\u8d77\u4f86\u3002\u6b64\u5916\uff0c\u5b83\u9084\u652f\u6301\u6578\u64da\u7684\u91cd\u65b0\u53d6\u6a23\uff0c\u9019\u5c0d\u65bc\u6642\u9593\u5e8f\u5217\u6578\u64da\u4f86\u8aaa\u5c24\u70ba\u91cd\u8981\u3002</p> <p>\u4ee5\u4e0b\u662f\u5169\u500b\u4f7f\u7528 <code>combine</code> \u51fd\u6578\u7684\u7bc4\u4f8b\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u5c07\u4e0d\u540c\u7684\u6578\u64da\u6e90\u5408\u4f75\u70ba\u4e00\u500b\u7279\u5fb5\u96c6\uff1a </p> <ol> <li>\u5408\u4f75\u80a1\u50f9\u6de8\u503c\u6bd4\u548c\u672c\u76ca\u6bd4\u70ba\u4e00\u500b\u7279\u5fb5\u96c6 \uff1a</li> </ol> <pre><code>from finlab import data\nfrom finlab.ml import feature as mlf\nfeatures = mlf.combine({\n'pb': data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4'),\n'pe': data.get('price_earning_ratio:\u672c\u76ca\u6bd4')  \n}, resample='W')\nfeatures.head()\n</code></pre> pb pe (Timestamp('2010-01-04 00:00:00'), '1101') 1.47 18.85 (Timestamp('2010-01-04 00:00:00'), '1102') 1.44 14.58 (Timestamp('2010-01-04 00:00:00'), '1103') 0.79 40.89 (Timestamp('2010-01-04 00:00:00'), '1104') 0.92 73.6 <p>\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c<code>combine</code> \u51fd\u6578\u5c07\u80a1\u50f9\u6de8\u503c\u6bd4\uff08pb\uff09\u548c\u672c\u76ca\u6bd4\uff08pe\uff09\u9019\u5169\u500b\u4f86\u81ea <code>data.get</code> \u51fd\u6578\u7684\u7279\u5fb5\u5408\u4f75\u6210\u4e00\u500b DataFrame\u3002\u9019\u53ef\u4ee5\u5e6b\u52a9\u5206\u6790\u5e2b\u5feb\u901f\u5730\u69cb\u5efa\u51fa\u5305\u542b\u9019\u5169\u7a2e\u57fa\u672c\u9762\u6307\u6a19\u7684\u6578\u64da\u96c6\uff0c\u7528\u65bc\u9032\u884c\u5f8c\u7e8c\u7684\u5206\u6790\u548c\u6a21\u578b\u8a13\u7df4\u3002 </p> <ol> <li>\u5408\u4f75\u6280\u8853\u6307\u6a19\u70ba\u4e00\u500b\u7279\u5fb5\u96c6 \uff1a</li> </ol> <pre><code>from finlab.ml import feature as mlf\nmlf.combine({\n'talib': mlf.ta(mlf.ta_names(n=1))\n})\n</code></pre> talib.HT_DCPERIOD__real__ talib.HT_DCPHASE__real__ talib.HT_PHASOR__quadrature__ (Timestamp('2024-04-01 00:00:00'), '9951') 23.4372 122.135 -0.0107087 (Timestamp('2024-04-01 00:00:00'), '9955') 18.4416 68.0654 -0.0168584 (Timestamp('2024-04-01 00:00:00'), '9958') 30.1035 -10.7866 0.159777 (Timestamp('2024-04-01 00:00:00'), '9960') 17.5025 94.0009 0.00310615 (Timestamp('2024-04-01 00:00:00'), '9962') 23.2931 90.0781 -0.0145453 <p>\u5728\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u4f7f\u7528 <code>mlf.ta</code> \u51fd\u6578\u548c <code>mlf.ta_names</code> \u51fd\u6578\u4f86\u751f\u6210\u4e00\u7d44\u6280\u8853\u6307\u6a19\u7279\u5fb5\u3002\u9019\u500b\u904e\u7a0b\u9996\u5148\u901a\u904e <code>mlf.ta_names(n=1)</code> \u751f\u6210\u96a8\u6a5f\u7684\u6280\u8853\u6307\u6a19\uff0c\u7136\u5f8c <code>mlf.ta</code> \u51fd\u6578\u6839\u64da\u9019\u500b\u5217\u8868\u8a08\u7b97\u51fa\u76f8\u61c9\u7684\u6307\u6a19\u503c\u3002\u6700\u5f8c\uff0c<code>combine</code> \u51fd\u6578\u5c07\u9019\u4e9b\u6280\u8853\u6307\u6a19\u5408\u4f75\u6210\u4e00\u500b DataFrame\uff0c\u70ba\u91cf\u5316\u7b56\u7565\u7684\u958b\u767c\u63d0\u4f9b\u4e86\u4e00\u7d44\u8c50\u5bcc\u7684\u7279\u5fb5\u3002</p> <p>\u9019\u5169\u500b\u7bc4\u4f8b\u5c55\u793a\u4e86 <code>combine</code> \u51fd\u6578\u7684\u591a\u6a23\u6027\u548c\u9748\u6d3b\u6027\uff0c\u7121\u8ad6\u662f\u5c0d\u65bc\u57fa\u672c\u9762\u5206\u6790\u9084\u662f\u6280\u8853\u5206\u6790\uff0c\u5b83\u90fd\u80fd\u63d0\u4f9b\u5f37\u5927\u7684\u6578\u64da\u652f\u6301\uff0c\u5e6b\u52a9\u6295\u8cc7\u8005\u548c\u5206\u6790\u5e2b\u5728\u8907\u96dc\u7684\u91d1\u878d\u5e02\u5834\u4e2d\u505a\u51fa\u66f4\u52a0\u7cbe\u6e96\u7684\u6c7a\u7b56\u3002</p>"},{"location":"details/machine_learning/#talib","title":"\u4f7f\u7528 Talib \u7522\u751f\u6280\u8853\u6307\u6a19","text":"<ul> <li>\u7576\u6211\u5011\u5728\u4f7f\u7528 <code>finlab</code> \u51fd\u5f0f\u5eab\u4f86\u958b\u767c\u91cf\u5316\u4ea4\u6613\u7b56\u7565\u6642\uff0c\u6280\u8853\u6307\u6a19\u626e\u6f14\u8457\u6975\u5176\u91cd\u8981\u7684\u89d2\u8272\u3002<code>finlab</code> \u63d0\u4f9b\u4e86\u4e00\u5957\u529f\u80fd\u5f37\u5927\u7684\u5de5\u5177\u4f86\u5e6b\u52a9\u6211\u5011\u751f\u6210\u548c\u5229\u7528\u9019\u4e9b\u6280\u8853\u6307\u6a19\u3002\u5176\u4e2d\uff0c<code>ta</code> \u548c <code>ta_names</code> \u5169\u500b\u51fd\u6578\u662f\u751f\u6210\u6280\u8853\u6307\u6a19\u7279\u5fb5\u7684\u95dc\u9375\u3002</li> </ul>"},{"location":"details/machine_learning/#ta_names","title":"ta_names \u51fd\u6578","text":"<p><code>ta_names</code> \u51fd\u6578\u7684\u4f5c\u7528\u662f\u751f\u6210\u4e00\u7cfb\u5217 TALIB \u6280\u8853\u6307\u6a19\u7684\u540d\u7a31\u3002\u9019\u4e9b\u540d\u7a31\u53cd\u6620\u4e86\u6307\u6a19\u7684\u8a08\u7b97\u65b9\u6cd5\u53ca\u5176\u53c3\u6578\u3002\u9019\u500b\u51fd\u6578\u975e\u5e38\u6709\u7528\uff0c\u56e0\u70ba\u5b83\u5141\u8a31\u6211\u5011\u63a2\u7d22\u548c\u5be6\u9a57\u4e0d\u540c\u7684\u6307\u6a19\u914d\u7f6e\uff0c\u4ee5\u5c0b\u627e\u6700\u4f73\u7684\u7279\u5fb5\u7d44\u5408\u3002 </p> <ul> <li>n \u53c3\u6578 \uff1a\u5728 <code>ta_names</code> \u4e2d\uff0c<code>n</code> \u53c3\u6578\u6307\u5b9a\u4e86\u6bcf\u500b\u6307\u6a19\u96a8\u6a5f\u751f\u6210\u7684\u53c3\u6578\u8a2d\u7f6e\u6578\u91cf\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5982\u679c <code>n=10</code>\uff0c\u90a3\u9ebc\u5c0d\u65bc TALIB \u4e2d\u7684\u6bcf\u4e00\u500b\u6307\u6a19\uff0c<code>ta_names</code> \u5c07\u6703\u751f\u6210 10 \u7a2e\u4e0d\u540c\u53c3\u6578\u914d\u7f6e\u7684\u6307\u6a19\u540d\u7a31\u3002\u9019\u5141\u8a31\u6211\u5011\u5f9e\u591a\u7a2e\u4e0d\u540c\u7684\u53c3\u6578\u8a2d\u7f6e\u4e2d\u9078\u64c7\uff0c\u4ee5\u4fbf\u66f4\u6df1\u5165\u5730\u63a2\u7d22\u6578\u64da\u548c\u7b56\u7565\u6027\u80fd\u4e4b\u9593\u7684\u95dc\u4fc2\u3002</li> </ul> <p><pre><code>from finlab.ml import feature as mlf\nmlf.ta_names(n=1)\n</code></pre> <pre><code>['talib.HT_DCPERIOD__real__',\n 'talib.HT_DCPHASE__real__',\n 'talib.HT_PHASOR__quadrature__',\n 'talib.HT_PHASOR__inphase__',\n 'talib.HT_SINE__sine__',\n 'talib.HT_SINE__leadsine__'\n ...\n ]\n</code></pre></p>"},{"location":"details/machine_learning/#ta","title":"ta \u51fd\u6578","text":"<p>\u4e00\u65e6\u6211\u5011\u6709\u4e86\u6307\u6a19\u540d\u7a31\u5217\u8868\uff08\u53ef\u4ee5\u901a\u904e <code>ta_names</code> \u51fd\u6578\u7372\u5f97\uff09\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 <code>ta</code> \u51fd\u6578\u4f86\u8a08\u7b97\u9019\u4e9b\u6307\u6a19\u7684\u5be6\u969b\u503c\u3002<code>ta</code> \u51fd\u6578\u662f\u4e00\u500b\u5f37\u5927\u7684\u5de5\u5177\uff0c\u5b83\u6839\u64da\u6307\u5b9a\u7684\u6280\u8853\u6307\u6a19\u540d\u7a31\u548c\u53c3\u6578\u8a2d\u7f6e\u4f86\u8a08\u7b97\u9019\u4e9b\u6307\u6a19\u7684\u503c\u3002 </p> <ul> <li> <p>\u529f\u80fd \uff1a<code>ta</code> \u51fd\u6578\u63a5\u53d7\u4e00\u500b\u6216\u591a\u500b\u7531 <code>ta_names</code> \u751f\u6210\u7684\u6307\u6a19\u540d\u7a31\uff0c\u7136\u5f8c\u8a08\u7b97\u9019\u4e9b\u6307\u6a19\u7684\u503c\u3002\u9019\u5c0d\u65bc\u7279\u5fb5\u5de5\u7a0b\u4f86\u8aaa\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u70ba\u5b83\u8b93\u6211\u5011\u53ef\u4ee5\u6839\u64da\u6307\u6a19\u7684\u8a08\u7b97\u7d50\u679c\u4f86\u69cb\u5efa\u9810\u6e2c\u6a21\u578b\u3002 </p> </li> <li> <p>\u9748\u6d3b\u6027 \uff1a\u9019\u5169\u500b\u51fd\u6578\u7684\u7d50\u5408\u4f7f\u7528\u63d0\u4f9b\u4e86\u6975\u5927\u7684\u9748\u6d3b\u6027\uff0c\u5141\u8a31\u91cf\u5316\u5206\u6790\u5e2b\u548c\u4ea4\u6613\u8005\u5728\u4e0d\u540c\u7684\u6642\u9593\u7bc4\u570d\u3001\u4e0d\u540c\u7684\u5e02\u5834\u689d\u4ef6\u4e0b\u6e2c\u8a66\u548c\u512a\u5316\u4ed6\u5011\u7684\u7b56\u7565\u3002</p> </li> <li> <p>resample \u53c3\u6578 : <code>ta</code> \u51fd\u6578\u9084\u652f\u6301 <code>resample</code> \u53c3\u6578\uff0c\u9019\u500b\u53c3\u6578\u53ef\u4ee5\u5c07\u8a08\u7b97\u51fa\u4f86\u7684\u6307\u6a19\u503c\u91cd\u65b0\u53d6\u6a23\u5230\u6307\u5b9a\u7684\u6642\u9593\u7bc4\u570d\u3002\u9019\u5c0d\u65bc\u6642\u9593\u5e8f\u5217\u6578\u64da\u7684\u8655\u7406\u975e\u5e38\u6709\u7528\uff0c\u53ef\u4ee5\u5e6b\u52a9\u6211\u5011\u66f4\u597d\u5730\u7406\u89e3\u548c\u5206\u6790\u6578\u64da\u3002</p> </li> </ul> <pre><code>from finlab.ml import feature as mlf\nmlf.ta(['talib.HT_DCPERIOD__real__',\n'talib.HT_DCPHASE__real__',\n'talib.HT_PHASOR__quadrature__'], resample='W')\n</code></pre> talib.HT_DCPERIOD__real__ talib.HT_DCPHASE__real__ (Timestamp('2024-04-07 00:00:00'), '9951') 23.4372 122.135 (Timestamp('2024-04-07 00:00:00'), '9955') 18.4416 68.0654 (Timestamp('2024-04-07 00:00:00'), '9958') 30.1035 -10.7866 (Timestamp('2024-04-07 00:00:00'), '9960') 17.5025 94.0009 (Timestamp('2024-04-07 00:00:00'), '9962') 23.2931 90.0781 <p>\u7e3d\u7d50\u4f86\u8aaa\uff0c<code>ta_names</code> \u548c <code>ta</code> \u51fd\u6578\u662f <code>finlab</code> \u51fd\u5f0f\u5eab\u4e2d\u7528\u65bc\u751f\u6210\u548c\u8a08\u7b97\u6280\u8853\u6307\u6a19\u7279\u5fb5\u7684\u5169\u500b\u6838\u5fc3\u5de5\u5177\u3002\u901a\u904e\u5be6\u9a57\u4e0d\u540c\u7684\u53c3\u6578\u8a2d\u7f6e\uff08\u4f7f\u7528 <code>ta_names</code> \u4e2d\u7684 <code>n</code> \u53c3\u6578\uff09\u548c\u8a08\u7b97\u9019\u4e9b\u8a2d\u7f6e\u4e0b\u7684\u6307\u6a19\u503c\uff08\u4f7f\u7528 <code>ta</code> \u51fd\u6578\uff09\uff0c\u91cf\u5316\u7b56\u7565\u958b\u767c\u8005\u53ef\u4ee5\u6df1\u5165\u6316\u6398\u6578\u64da\uff0c\u627e\u5230\u6700\u4f73\u7684\u6307\u6a19\u7d44\u5408\u4f86\u6307\u5c0e\u4ed6\u5011\u7684\u4ea4\u6613\u6c7a\u7b56\u3002\u9019\u7a2e\u65b9\u6cd5\u70ba\u91cf\u5316\u6295\u8cc7\u63d0\u4f9b\u4e86\u4e00\u500b\u5805\u5be6\u7684\u57fa\u790e\uff0c\u5e6b\u52a9\u6295\u8cc7\u8005\u5728\u8907\u96dc\u591a\u8b8a\u7684\u91d1\u878d\u5e02\u5834\u4e2d\u4fdd\u6301\u7af6\u722d\u529b\u3002</p>"},{"location":"details/machine_learning/#_5","title":"\u6a19\u7c64\u751f\u6210","text":""},{"location":"details/machine_learning/#label","title":"\u4f7f\u7528 Label \u51fd\u6578\u751f\u6210\u6a19\u7c64","text":"<p>\u5728\u91d1\u878d\u9818\u57df\u4e2d\uff0c\u6a19\u7c64\u751f\u6210\u662f\u4e00\u500b\u975e\u5e38\u91cd\u8981\u7684\u4efb\u52d9\u3002\u6a19\u7c64\u662f\u6307\u5c0d\u65bc\u67d0\u500b\u4e8b\u4ef6\u6216\u72c0\u614b\u7684\u6a19\u8a18\uff0c\u901a\u5e38\u7528\u65bc\u8a13\u7df4\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u6216\u5236\u5b9a\u4ea4\u6613\u7b56\u7565\u3002<code>finlab</code> \u51fd\u5f0f\u5eab\u63d0\u4f9b\u4e86\u4e00\u500b\u540d\u70ba <code>label</code> \u7684\u51fd\u6578\uff0c\u53ef\u4ee5\u5e6b\u52a9\u6211\u5011\u751f\u6210\u5404\u7a2e\u4e0d\u540c\u985e\u578b\u7684\u6a19\u7c64\uff0c\u5f9e\u800c\u66f4\u597d\u5730\u7406\u89e3\u548c\u5206\u6790\u91d1\u878d\u6578\u64da\u3002</p> <p>\u9019\u4e9b\u51fd\u6578\u90fd\u662f\u7528\u65bc\u8a08\u7b97\u5e02\u5834\u50f9\u683c\u5728\u7d66\u5b9a\u671f\u9593\u5167\u7684\u5404\u7a2e\u8b8a\u5316\u7387\uff0c\u5b83\u5011\u53ef\u4ee5\u7528\u65bc\u91cf\u5316\u7b56\u7565\u4e2d\uff0c\u5e6b\u52a9\u5206\u6790\u548c\u9810\u6e2c\u50f9\u683c\u8d70\u52e2\u3002\u4e0b\u9762\u6211\u5c07\u5206\u5225\u4ecb\u7d39\u6bcf\u500b\u51fd\u6578\u53ca\u5176\u4f7f\u7528\u7bc4\u4f8b\uff1a</p>"},{"location":"details/machine_learning/#daytrading_percentage","title":"\u9810\u6e2c daytrading_percentage","text":"<p>\u6b64\u51fd\u6578\u8a08\u7b97\u7d66\u5b9a\u5468\u671f\u5167\u5e02\u5834\u50f9\u683c\u7684\u767e\u5206\u6bd4\u8b8a\u5316\uff0c\u7279\u5225\u662f\u5f9e\u958b\u76e4\u50f9\u5230\u6536\u76e4\u50f9\u7684\u8b8a\u5316\u3002</p> <ul> <li> <p>resample \u53c3\u6578 : <code>daytrading_percentage</code> \u51fd\u6578\u652f\u6301 <code>resample</code> \u53c3\u6578\uff0c\u9019\u500b\u53c3\u6578\u5fc5\u9808\u8a2d\u5b9a\u8207 <code>combine</code> \u51fd\u6578\u4e2d\u7684 <code>resample</code> \u53c3\u6578\u76f8\u540c\u3002\u9019\u6a23\u53ef\u4ee5\u78ba\u4fdd\u6a19\u7c64\u548c\u7279\u5fb5\u4e4b\u9593\u7684\u6642\u9593\u5c0d\u9f4a\u3002</p> </li> <li> <p>period \u53c3\u6578 : <code>period</code> \u53c3\u6578\u6307\u5b9a\u4e86\u8a08\u7b97\u767e\u5206\u6bd4\u8b8a\u5316\u7684\u6642\u9593\u7bc4\u570d\uff0c\u4f8b\u5982 <code>period=1</code> \u8868\u793a\u8a08\u7b97\u672a\u4f86\u4e00\u500b\u55ae\u4f4d\u7684\u8b8a\u5316\uff0c\u55ae\u4f4d\u6839\u64da <code>resample</code> \u53c3\u6578\u4f86\u78ba\u5b9a\u3002</p> </li> </ul> <pre><code>from finlab.ml import feature as mlf\nfrom finlab.ml import label as mll\nfeature = mlf.combine(...)\nlabel = mll.daytrading_percentage(feature.index)\n</code></pre> <pre><code>datetime    instrument\n2007-04-23  0015          0.000000\n            0050          0.003454\n            0051          0.004874\n            0052          0.006510\n            01001T        0.001509\ndtype: float64\n</code></pre>"},{"location":"details/machine_learning/#n","title":"\u9810\u6e2cN\u5929\u5f8c\u7684\u5831\u916c\u7387","text":"<p>\u9019\u500b\u51fd\u6578\u8a08\u7b97\u4e86\u7d66\u5b9a\u5468\u671f\u5167\u5e02\u5834\u50f9\u683c\u7684\u767e\u5206\u6bd4\u8b8a\u5316\u3002\u5b83\u53ef\u4ee5\u7528\u65bc\u5206\u6790\u80a1\u7968\u7684\u9577\u671f\u8868\u73fe\u3002</p> <pre><code>label = mll.return_percentage(feature.index, resample='W', period=1)\n</code></pre>"},{"location":"details/machine_learning/#maximum-adverse-excursion","title":"Maximum Adverse Excursion","text":"<p>MAE \u8a08\u7b97\u5728\u6301\u6709\u671f\u5167\u53ef\u80fd\u906d\u53d7\u7684\u6700\u5927\u4e0d\u5229\u50f9\u683c\u8b8a\u52d5\u3002\u9019\u662f\u8861\u91cf\u4ea4\u6613\u98a8\u96aa\u7684\u4e00\u500b\u91cd\u8981\u6307\u6a19\u3002 \u76ee\u524d\u6b64\u51fd\u6578\u4e26\u4e0d\u652f\u63f4 resample\uff0c\u9810\u8a2d\u70ba\u300c\u672a\u4f86 period \u5929\u7684\u6700\u5927\u4e0d\u5229\u8b8a\u52d5\u300d\u3002</p> <pre><code>label = mll.maximum_adverse_excursion(feature.index, period=1)\n</code></pre>"},{"location":"details/machine_learning/#maximum-favorable-excursion","title":"Maximum Favorable Excursion","text":"<p>MFE \u8a08\u7b97\u5728\u6301\u6709\u671f\u5167\u53ef\u80fd\u5be6\u73fe\u7684\u6700\u5927\u6709\u5229\u50f9\u683c\u8b8a\u52d5\u3002\u9019\u53ef\u4ee5\u5e6b\u52a9\u4ea4\u6613\u8005\u8a55\u4f30\u6f5b\u5728\u7684\u7372\u5229\u80fd\u529b\u3002 \u76ee\u76ee\u524d\u6b64\u51fd\u6578\u4e26\u4e0d\u652f\u63f4 resample\uff0c\u9810\u8a2d\u70ba\u300c\u672a\u4f86 period \u5929\u7684\u6700\u5927\u6709\u5229\u8b8a\u52d5\u300d\u3002</p> <pre><code>label = mll.maximum_favorable_excursion(feature.index, period=1)\n</code></pre>"},{"location":"details/machine_learning/#excess-over-median","title":"Excess Over Median","text":"<p>\u9019\u500b\u51fd\u6578\u8a08\u7b97\u7684\u662f\u76f8\u5c0d\u65bc\u540c\u671f\u6240\u6709\u80a1\u7968\u6536\u76ca\u4e2d\u4f4d\u6578\u7684\u8d85\u984d\u6536\u76ca\u3002\u9019\u53ef\u4ee5\u7528\u4f86\u8b58\u5225\u76f8\u5c0d\u65bc\u5e02\u5834\u8868\u73fe\u8f03\u597d\u6216\u8f03\u5dee\u7684\u80a1\u7968\u3002</p> <pre><code>label = mll.excess_over_median(feature.index, resample='M', period=1)\n</code></pre>"},{"location":"details/machine_learning/#excess-over-mean","title":"Excess Over Mean","text":"<p>\u9019\u500b\u51fd\u6578\u8a08\u7b97\u7684\u662f\u76f8\u5c0d\u65bc\u540c\u671f\u6240\u6709\u80a1\u7968\u6536\u76ca\u5747\u503c\u7684\u8d85\u984d\u6536\u76ca\u3002\u9019\u4e5f\u662f\u4e00\u7a2e\u8a55\u4f30\u80a1\u7968\u76f8\u5c0d\u8868\u73fe\u7684\u65b9\u6cd5\u3002</p> <pre><code>label = mll.excess_over_mean(feature.index, resample='M', period=1)\n</code></pre> <p>\u5728\u4f7f\u7528\u9019\u4e9b\u51fd\u6578\u6642\uff0c\u91cd\u8981\u7684\u662f\u8981\u78ba\u4fdd <code>index</code> \u53c3\u6578\u6b63\u78ba\u53cd\u6620\u4e86\u4f60\u60f3\u8981\u5206\u6790\u7684\u65e5\u671f\u548c\u6a19\u7684\uff0c\u4e26\u4e14 <code>ml.get_market()</code> \u80fd\u5920\u6b63\u78ba\u7372\u53d6\u5230\u76f8\u95dc\u7684\u5e02\u5834\u6578\u64da\u3002\u9019\u4e9b\u51fd\u6578\u7684\u7d50\u679c\u53ef\u4ee5\u7528\u4f86\u69cb\u5efa\u7279\u5fb5\uff0c\u9032\u4e00\u6b65\u7528\u65bc\u5efa\u7acb\u9810\u6e2c\u6a21\u578b\u6216\u9032\u884c\u5e02\u5834\u5206\u6790\u3002</p>"},{"location":"details/machine_learning/#qlib","title":"\u4f7f\u7528 Qlib \u5957\u4ef6\u6a21\u578b\u8a13\u7df4","text":"<ul> <li>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u793a\u7bc4\u4e86\u5982\u4f55\u5728 Qlib \u6846\u67b6\u4e2d\u4f7f\u7528\u5404\u7a2e\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u9032\u884c\u91cf\u5316\u6295\u8cc7\u7b56\u7565\u7684\u958b\u767c\u3002<code>WrapperModel</code> \u662f\u4e00\u500b\u5c01\u88dd\u985e\u5225\uff0c\u7528\u65bc\u521d\u59cb\u5316\u548c\u9069\u914d\u4e0d\u540c\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u65bc LightGBM\u3001XGBoost\u3001CatBoost\u3001\u7dda\u6027\u6a21\u578b\u3001Tabnet \u548c\u6df1\u5ea6\u795e\u7d93\u7db2\u7d61\u7b49\u3002\u9019\u500b\u5c01\u88dd\u4f7f\u5f97\u5728 Qlib \u4e2d\u4f7f\u7528\u9019\u4e9b\u6a21\u578b\u8b8a\u5f97\u66f4\u52a0\u7c21\u55ae\u548c\u7d71\u4e00\u3002</li> </ul> <p>\u4ee5\u4e0b\u662f\u6bcf\u500b\u6a21\u578b\u5c01\u88dd\u985e\u5225\u7684\u7c21\u55ae\u4ecb\u7d39\u548c\u7bc4\u4f8b\u7528\u6cd5\uff1a</p>"},{"location":"details/machine_learning/#lgbmodel","title":"LGBModel","text":"<p>\u5c01\u88dd LightGBM \u6a21\u578b\uff0c\u9069\u7528\u65bc\u8fc5\u901f\u5efa\u7acb\u9ad8\u6548\u7684\u6a39\u6a21\u578b\u3002</p> <pre><code>import finlab.ml.qlib as q\n# \u69cb\u5efa X_train, y_train, X_test\nmodel = q.LGBModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre> <p>\u5982\u4f55\u5efa\u69cb X_train, y_train, X_test?</p> <p>\u5728\u4f7f\u7528 <code>LGBModel</code> \u4e4b\u524d\uff0c\u60a8\u9700\u8981\u5148\u6e96\u5099\u597d\u8a13\u7df4\u6578\u64da <code>X_train</code> \u548c <code>y_train</code>\uff0c\u4ee5\u53ca\u6e2c\u8a66\u6578\u64da <code>X_test</code>\u3002\u9019\u4e9b\u6578\u64da\u61c9\u8a72\u662f Numpy \u6578\u7d44\u6216 Pandas DataFrame \u7684\u5f62\u5f0f\uff0c\u4e26\u4e14\u7b26\u5408\u6a21\u578b\u7684\u8f38\u5165\u8981\u6c42\u3002\u5047\u8a2d features \u662f\u7279\u5fb5\u6578\u64da\uff0clabels \u662f\u6a19\u7c64\u6578\u64da\uff0c\u4e26\u4e14\u5e0c\u671b\u4ee5 2020 \u5e74\u4ee5\u524d\u7684\u8cc7\u6599\u9032\u884c\u8a13\u7df4\uff0c\u60a8\u53ef\u4ee5\u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u69cb\u5efa\u8a13\u7df4\u6578\u64da\u548c\u6e2c\u8a66\u6578\u64da\uff1a</p> <pre><code>is_train = features.index.get_level_values('datetime') &lt; '2020-01-01'\nX_train = features[is_train]\ny_train = labels[is_train]\nX_test = features[~is_train]\n</code></pre>"},{"location":"details/machine_learning/#xgbmodel","title":"XGBModel","text":"<p>\u5c01\u88dd XGBoost \u6a21\u578b\uff0c\u662f\u4e00\u500b\u5f37\u5927\u7684\u5206\u985e\u548c\u56de\u6b78\u6a39\u6a21\u578b\u3002</p> <pre><code>model = q.XGBModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre>"},{"location":"details/machine_learning/#densmblemodel","title":"DEnsmbleModel","text":"<p>\u5c01\u88dd\u96d9\u91cd\u96c6\u6210\u6a21\u578b\uff0c\u901a\u904e\u7d50\u5408\u591a\u500b\u57fa\u6a21\u578b\u63d0\u9ad8\u9810\u6e2c\u6e96\u78ba\u7387\u3002</p> <pre><code>model = q.DEnsmbleModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre>"},{"location":"details/machine_learning/#catboostmodel","title":"CatBoostModel","text":"<p>\u5c01\u88dd CatBoost \u6a21\u578b\uff0c\u4e00\u500b\u8655\u7406\u985e\u5225\u7279\u5fb5\u975e\u5e38\u6709\u6548\u7684\u68af\u5ea6\u63d0\u5347\u6c7a\u7b56\u6a39\u6a21\u578b\u3002</p> <pre><code>model = q.CatBoostModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre>"},{"location":"details/machine_learning/#linearmodel","title":"LinearModel","text":"<p>\u5c01\u88dd\u7dda\u6027\u6a21\u578b\uff0c\u9069\u7528\u65bc\u7dda\u6027\u76f8\u95dc\u6027\u5f37\u7684\u6578\u64da\u96c6\u3002</p> <pre><code>model = q.LinearModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre>"},{"location":"details/machine_learning/#tabnetmodel","title":"TabnetModel","text":"<p>\u5c01\u88dd Tabnet \u6a21\u578b\uff0c\u4e00\u7a2e\u57fa\u65bc\u795e\u7d93\u7db2\u7d61\u7684\u8868\u683c\u6578\u64da\u5b78\u7fd2\u6a21\u578b\u3002</p> <pre><code>model = q.TabnetModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre>"},{"location":"details/machine_learning/#dnnmodel","title":"DNNModel","text":"<p>\u5c01\u88dd\u6df1\u5ea6\u795e\u7d93\u7db2\u7d61\u6a21\u578b\uff0c\u9069\u7528\u65bc\u8907\u96dc\u7684\u975e\u7dda\u6027\u6578\u64da\u96c6\u3002</p> <pre><code>model = q.DNNModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre> <p>\u9019\u4e9b\u5c01\u88dd\u985e\u5225\u70ba\u91cf\u5316\u7b56\u7565\u958b\u767c\u63d0\u4f9b\u4e86\u4e00\u7a2e\u5feb\u901f\u3001\u9ad8\u6548\u7684\u65b9\u5f0f\uff0c\u4f7f\u5f97\u7814\u7a76\u4eba\u54e1\u53ef\u4ee5\u5c08\u6ce8\u65bc\u7279\u5fb5\u5de5\u7a0b\u548c\u7b56\u7565\u512a\u5316\uff0c\u800c\u4e0d\u9700\u8981\u6df1\u5165\u4e86\u89e3\u6bcf\u500b\u6a21\u578b\u7684\u7d30\u7bc0\u3002\u901a\u904e\u9019\u4e9b\u5c01\u88dd\uff0cQlib \u65e8\u5728\u7c21\u5316\u91cf\u5316\u6295\u8cc7\u7b56\u7565\u958b\u767c\u7684\u8907\u96dc\u6027\uff0c\u52a0\u901f\u5f9e\u6578\u64da\u5230\u7b56\u7565\u7684\u7814\u767c\u904e\u7a0b\u3002</p>"},{"location":"details/machine_learning/#get_models","title":"get_models","text":"<ul> <li><code>get_models</code> \u51fd\u6578\u63d0\u4f9b\u4e86\u4e00\u500b\u5feb\u6377\u65b9\u5f0f\uff0c\u8b93\u60a8\u80fd\u5920\u8a2a\u554f\u4e26\u521d\u59cb\u5316\u4e00\u7cfb\u5217\u9810\u5b9a\u7fa9\u7684\u91cf\u5316\u6295\u8cc7\u6a21\u578b\u3002\u9019\u4e9b\u6a21\u578b\u5305\u62ec\u4e86\u591a\u7a2e\u6a5f\u5668\u5b78\u7fd2\u7b97\u6cd5\uff0c\u5982 LightGBM\u3001XGBoost\u3001CatBoost\u3001\u7dda\u6027\u56de\u6b78\u6a21\u578b\u3001Tabnet \u548c\u6df1\u5ea6\u795e\u7d93\u7db2\u7d61\u7b49\uff0c\u6db5\u84cb\u4e86\u5f9e\u7d93\u5178\u7b97\u6cd5\u5230\u6700\u65b0\u7814\u7a76\u6210\u679c\u7684\u5ee3\u6cdb\u7bc4\u570d\u3002</li> </ul> <p>\u4f7f\u7528 <code>get_models</code> \u51fd\u6578\uff0c\u60a8\u53ef\u4ee5\u8f15\u9b06\u5730\u7372\u53d6\u5230\u6240\u6709\u53ef\u7528\u6a21\u578b\u7684\u5be6\u4f8b\uff0c\u800c\u4e0d\u9700\u8981\u624b\u52d5\u521d\u59cb\u5316\u6bcf\u4e00\u500b\u6a21\u578b\u3002\u9019\u5728\u60a8\u9700\u8981\u8a66\u9a57\u591a\u7a2e\u6a21\u578b\u4ee5\u627e\u51fa\u6700\u9069\u5408\u60a8\u6578\u64da\u7684\u7b97\u6cd5\u6642\u7279\u5225\u6709\u7528\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u500b\u5982\u4f55\u4f7f\u7528 <code>get_models</code> \u51fd\u6578\u4f86\u7372\u53d6\u6a21\u578b\u5217\u8868\u548c\u521d\u59cb\u5316\u7279\u5b9a\u6a21\u578b\u7684\u793a\u4f8b\uff1a</p> <pre><code>import finlab.ml.qlib as q\n# \u7372\u53d6\u6240\u6709\u53ef\u7528\u7684\u6a21\u578b\nmodels = q.get_models()\n# \u5217\u5370\u51fa\u6240\u6709\u6a21\u578b\u7684\u540d\u7a31\nprint(list(models.keys()))\n# \u9078\u64c7\u4e00\u500b\u6a21\u578b\u9032\u884c\u5be6\u4f8b\u5316\uff0c\u4f8b\u5982 LightGBM\nmodel = models['LGBModel']()\n# \u5047\u8a2d\u5df2\u7d93\u6e96\u5099\u597d\u4e86\u8a13\u7df4\u6578\u64da\u548c\u6e2c\u8a66\u6578\u64da X_train, y_train, X_test\n# model\nmodel.fit(X_train, y_train)\n# \u4f7f\u7528\u8a13\u7df4\u597d\u7684\u6a21\u578b\u9032\u884c\u9810\u6e2c\ny_pred = model.predict(X_test)\n</code></pre> <p>\u9019\u6bb5\u4ee3\u78bc\u9996\u5148\u5f9e <code>get_models</code> \u51fd\u6578\u7372\u53d6\u6240\u6709\u53ef\u7528\u7684\u6a21\u578b\uff0c\u7136\u5f8c\u5217\u5370\u51fa\u9019\u4e9b\u6a21\u578b\u7684\u540d\u7a31\u3002\u63a5\u8457\uff0c\u9078\u64c7\u5176\u4e2d\u4e00\u500b\u6a21\u578b\uff08\u4f8b\u5982 <code>LGBModel</code>\uff09\u9032\u884c\u5be6\u4f8b\u5316\uff0c\u4e26\u4f7f\u7528\u6e96\u5099\u597d\u7684\u8a13\u7df4\u6578\u64da\u9032\u884c\u8a13\u7df4\u3002\u6700\u5f8c\uff0c\u4f7f\u7528\u8a13\u7df4\u597d\u7684\u6a21\u578b\u5c0d\u6e2c\u8a66\u6578\u64da\u9032\u884c\u9810\u6e2c\u3002</p> <p><code>get_models</code> \u51fd\u6578\u7c21\u5316\u4e86\u6a21\u578b\u9078\u64c7\u548c\u521d\u59cb\u5316\u7684\u904e\u7a0b\uff0c\u8b93\u60a8\u80fd\u5920\u66f4\u52a0\u5c08\u6ce8\u65bc\u6a21\u578b\u7684\u8a13\u7df4\u548c\u8a55\u4f30\uff0c\u52a0\u5feb\u91cf\u5316\u7b56\u7565\u7684\u7814\u767c\u5468\u671f\u3002</p>"},{"location":"details/machine_learning/#_6","title":"\u9032\u884c\u56de\u6e2c","text":"<ul> <li>\u56de\u6e2c\u662f\u91cf\u5316\u6295\u8cc7\u7b56\u7565\u958b\u767c\u904e\u7a0b\u4e2d\u7684\u4e00\u500b\u91cd\u8981\u6b65\u9a5f\uff0c\u5b83\u901a\u904e\u6b77\u53f2\u6578\u64da\u6a21\u64ec\u4ea4\u6613\u7b56\u7565\u7684\u8868\u73fe\uff0c\u5e6b\u52a9\u7814\u7a76\u4eba\u54e1\u8a55\u4f30\u7b56\u7565\u7684\u6709\u6548\u6027\u548c\u98a8\u96aa\u3002<code>finlab</code> \u51fd\u5f0f\u5eab\u63d0\u4f9b\u4e86\u4e00\u500b\u540d\u70ba <code>sim</code> \u7684\u51fd\u6578\uff0c\u53ef\u4ee5\u5e6b\u52a9\u60a8\u9032\u884c\u56de\u6e2c\uff0c\u4e26\u8a08\u7b97\u7b56\u7565\u7684\u6536\u76ca\u7387\u548c\u98a8\u96aa\u6307\u6a19\u3002</li> </ul> <pre><code>from finlab.backtest import sim\nposition = y_pred.is_largest(50)\nsim(position, resample='4W')\n</code></pre> <p>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u9996\u5148\u6839\u64da\u6a21\u578b\u9810\u6e2c\u7684\u7d50\u679c\u751f\u6210\u4ea4\u6613\u4fe1\u865f <code>position</code>\uff0c\u7136\u5f8c\u4f7f\u7528 <code>sim</code> \u51fd\u6578\u9032\u884c\u56de\u6e2c\u3002<code>resample</code> \u53c3\u6578\u6307\u5b9a\u4e86\u56de\u6e2c\u7684\u6642\u9593\u7bc4\u570d\uff0c\u9019\u5c0d\u65bc\u8a08\u7b97\u6536\u76ca\u7387\u548c\u98a8\u96aa\u6307\u6a19\u975e\u5e38\u91cd\u8981\u3002<code>sim</code> \u51fd\u6578\u5c07\u8fd4\u56de\u4e00\u500b\u5305\u542b\u56de\u6e2c\u7d50\u679c\u7684 DataFrame\uff0c\u5305\u62ec\u6bcf\u500b\u4ea4\u6613\u5468\u671f\u7684\u6536\u76ca\u7387\u3001\u6700\u5927\u56de\u64a4\u3001\u590f\u666e\u6bd4\u7387\u7b49\u6307\u6a19\u3002\u900f\u904e\u56de\u6e2c\uff0c\u60a8\u53ef\u4ee5\u8a55\u4f30\u60a8\u7684\u91cf\u5316\u6295\u8cc7\u7b56\u7565\u5728\u6b77\u53f2\u6578\u64da\u4e0a\u7684\u8868\u73fe\uff0c\u4e26\u6839\u64da\u56de\u6e2c\u7d50\u679c\u9032\u884c\u7b56\u7565\u7684\u512a\u5316\u548c\u8abf\u6574\u3002\u9019\u6709\u52a9\u65bc\u63d0\u9ad8\u7b56\u7565\u7684\u7a69\u5b9a\u6027\u548c\u6536\u76ca\u7387\uff0c\u4e26\u5e6b\u52a9\u60a8\u5728\u771f\u5be6\u5e02\u5834\u4e2d\u53d6\u5f97\u66f4\u597d\u7684\u6295\u8cc7\u8868\u73fe\u3002</p>"},{"location":"details/order_api/","title":"\u4e0b\u55ae(\u55ae\u7b56\u7565)","text":""},{"location":"details/order_api/#_1","title":"\u57f7\u884c\u4ea4\u6613\u7b56\u7565","text":"<p>\u76ee\u524d\u4ea4\u6613\u7cfb\u7d71\u50c5\u652f\u63f4 <code>finlab&gt;=0.3.0.dev1</code> \u7248\u672c\u3002\u5728\u4e0b\u55ae\u524d\uff0c\u8acb\u5148\u78ba\u8a8d\u5b89\u88dd\u4e86\u65b0\u7248\u7684 Package \u5594\uff01 \u9996\u5148\uff0c\u5728\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u958b\u76e4\u524d\uff0c\u57f7\u884c\u7b56\u7565\uff1a <pre><code>from finlab import backtest\n# write your own strategy\nreport = backtest.sim(...)\n</code></pre></p>"},{"location":"details/order_api/#_2","title":"\u8a08\u7b97\u80a1\u7968\u5f35\u6578","text":"<p>\u63a5\u4e0b\u4f86\uff0c\u986f\u793a\u6700\u8fd1\u7684\u90e8\u4f4d</p> <pre><code>print(report.current_trades)\n</code></pre> stock_id entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return entry_price exit_price mae gmfe bmfe mdd pdays next_weights 1416 \u5ee3\u8c50 2021-10-01 NaT 2021-09-30 2022-06-30 0.510197 159.0 3566.0 -1.0 -3.539823e-02 10.60 NaN -0.053097 0.070796 0.070796 -0.115702 37.0 0.060665 1453 \u5927\u5c07 2021-10-01 NaT 2021-09-30 2022-06-30 0.510197 159.0 3566.0 -1.0 2.348165e+00 8.43 NaN -0.086763 2.403782 0.245829 -0.624585 60.0 0.171264 1524 \u803f\u9f0e 2022-04-01 NaT 2022-03-31 2022-06-30 0.611632 39.0 3686.0 -1.0 -3.330669e-16 10.60 NaN -0.476658 0.015152 0.000000 -0.476658 2.0 0.122168 2543 \u7687\u660c 2021-10-01 NaT 2021-09-30 NaT 0.510197 159.0 3566.0 -1.0 1.073232e-01 7.46 NaN -0.063131 0.363636 0.008838 -0.268519 44.0 0.070298 2701 \u842c\u4f01 2022-04-01 NaT 2022-03-31 2022-06-30 0.611632 39.0 3686.0 -1.0 -3.330669e-16 12.05 NaN -0.025105 0.029289 0.029289 -0.052846 18.0 0.063107 <p>\u5047\u5982\u78ba\u8a8d\u6c92\u554f\u984c\uff0c\u53ef\u4ee5\u8a08\u7b97\u6bcf\u6a94\u80a1\u7968\u6295\u8cc7\u7684\u5f35\u6578\uff1a</p> <p><pre><code>from finlab.online.order_executor import Position\n# total fund\nfund = 1000000\nposition = Position.from_report(report, fund)\nprint(position)\n</code></pre> \u53ef\u4ee5\u7522\u751f\u51fa\u4ee5\u4e0b\u7d50\u679c <pre><code>[{'stock_id': '2330', 'quantity': 1, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}]\n</code></pre></p> <p>\u4e0a\u8ff0 <code>Position</code> \u4ee3\u8868\u60a8\u7684\u5e33\u6236\u4e2d\uff0c\u53ea\u5e0c\u671b\u6709\u4e00\u5f35 <code>2330</code> \u53f0\u7a4d\u96fb\u80a1\u7968\uff0c\u4e26\u4e14\u662f\u73fe\u8ca8\u3002</p>"},{"location":"details/order_api/#_3","title":"\u9032\u968e\u90e8\u4f4d\u8abf\u6574","text":""},{"location":"details/order_api/#_4","title":"\u96f6\u80a1\u4ea4\u6613","text":"<p>\u6b32\u4f7f\u7528\u96f6\u80a1\u90e8\u4f4d\uff0c\u53ea\u8981\u5c07\u4e0a\u8ff0\u7a0b\u5f0f\u78bc\u505a\u4ee5\u4e0b\u4fee\u6539\u5373\u53ef\uff1a</p> <pre><code># \u6574\u80a1\nposition = Position.from_report(report, fund)\n# \u96f6\u80a1\nposition = Position.from_report(report, fund, odd_lot=True)\n</code></pre>"},{"location":"details/order_api/#_5","title":"\u5ba2\u88fd\u5316\u90e8\u4f4d\u5f35\u6578","text":"<p>\u4e0a\u8ff0\u65b9\u6cd5\u4f7f\u7528 <code>Position.from_report</code> \u4f86\u5efa\u69cb\u90e8\u4f4d\uff0c\u5176\u5be6\u6211\u5011\u4e5f\u53ef\u4ee5\u55ae\u7d14\u7528\u5f88\u76f4\u89ba\u7684\u65b9\u5f0f\u5efa\u69cb\u60f3\u8981\u518d\u5e73\u8861\u7684\u90e8\u4f4d\uff1a</p> <p><pre><code>position = Position({'2330': 1, '1101': 1.001})\n</code></pre> \u53ef\u4ee5\u7522\u751f\u51fa\u4ee5\u4e0b\u7d50\u679c <pre><code>[{'stock_id': '2330', 'quantity': 1, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}\n {'stock_id': '1101', 'quantity': 1.001, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}]\n</code></pre></p>"},{"location":"details/order_api/#_6","title":"\u90e8\u4f4d\u589e\u6e1b\u8abf\u6574","text":"<p><code>Position</code> \u662f\u53ef\u4ee5\u76f8\u52a0\u6e1b\u7684\uff0c\u6211\u5011\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8abf\u6574\u90e8\u4f4d\u5927\u5c0f</p> <pre><code># \u6e1b\u4e00\u5f35 2330 \u80a1\u7968\nnew_position = position - Position({'2330': 1})\n# \u589e\u52a0\u4e00\u5f35 1101 \u80a1\u7968\nnew_position = position + Position({'1101': 1})\n</code></pre>"},{"location":"details/order_api/#_7","title":"\u591a\u7b56\u7565\u6b0a\u91cd\u52a0\u7e3d","text":"<p>\u5047\u5982\u6211\u5011\u6709\u591a\u500b position\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u52a0\u7e3d\uff1a <pre><code>from finlab import backtest\nfrom finlab.online.order_executor import Position\nreport1 = backtest.sim(...)\nreport2 = backtest.sim(...)\nposition1 = Position.from_report(report1, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\nposition2 = Position.from_report(report2, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\ntotal_position = position1 + position2\n</code></pre></p>"},{"location":"details/order_api/#_8","title":"\u5be6\u969b\u4e0b\u55ae","text":""},{"location":"details/order_api/#1-api","title":"1. \u5b89\u88dd\u5238\u5546 API","text":"<p>\u76ee\u524d\u652f\u63f4 <code>\u7389\u5c71 Fugle</code> \u548c <code>\u6c38\u8c50</code> \u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71\uff0c\u5247\u4e00\u4f7f\u7528\u5373\u53ef\u3002 <pre><code># \u7389\u5c71 Fugle\npip install fugle-trade\n\n# \u6c38\u8c50\npip install shioaji\n</code></pre></p>"},{"location":"details/order_api/#2","title":"2. \u9023\u63a5\u8b49\u5238\u5e33\u6236","text":"<p>\u76ee\u524d\u652f\u63f4 <code>Fugle</code> \u548c <code>\u6c38\u8c50</code> \u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71\uff0c\u53ef\u4ee5\u5148\u5c07\u5e33\u865f\u5bc6\u78bc\u8a2d\u5b9a\u6210\u74b0\u5883\u8b8a\u6578\uff0c\u53ea\u8981\u91dd\u5c0d\u60a8\u9700\u8981\u7684\u5238\u5546\u4f86\u8a2d\u5b9a\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5169\u500b\u5238\u5546\u540c\u6642\u4e32\u63a5\u3002</p> <p>\u9078\u64c7\u60a8\u7684\u5238\u5546</p> \u7389\u5c71\u5bcc\u679c\u6c38\u8c50\u8b49\u5238\u5143\u5bcc\u8b49\u5238\u5bcc\u90a6\u8b49\u5238 <p></p> <ul> <li>\u8acb\u5148\u6309\u7167config \u6559\u5b78\u7372\u53d6 config \u8a2d\u5b9a\u6a94\u3002</li> <li>\u4e26\u5230\u767b\u5165\u5bcc\u679cAPI\uff0c\u7372\u5f97\u5e02\u5834\u884c\u60c5 Token\u3002</li> </ul> <pre><code>from finlab.online.fugle_account import FugleAccount\nimport os\nos.environ['FUGLE_CONFIG_PATH'] = '\u7389\u5c71\u5bcc\u679c\u4ea4\u6613\u8a2d\u5b9a\u6a94(config.ini.example)\u8def\u5f91'\nos.environ['FUGLE_MARKET_API_KEY'] = '\u7389\u5c71\u5bcc\u679c\u7684\u884c\u60c5API Token'\nos.environ['FUGGLE_ACCOUNT_PASSWORD'] = '\u7389\u5c71\u5bcc\u679c\u7684\u5e33\u865f\u5bc6\u78bc'\nos.environ['FUGLE_CERT_PASSWORD'] = '\u7389\u5c71\u5bcc\u679c\u7684\u6191\u8b49\u5bc6\u78bc'\nacc = FugleAccount()\n</code></pre> <p>\u5047\u5982\u4f7f\u7528\u4e2d\u4e0b\u55ae\u51fa\u73fe\u932f\u8aa4\u4ee3\u78bc\uff0c\u53ef\u4ee5\u5230\u5bcc\u679c\u6587\u4ef6 \u4f86\u67e5\u627e\u539f\u56e0\u3002\u5047\u5982\u5c0d\u65bc Finlab Package \u4e0b\u55ae\u4e0d\u719f\u7fd2\uff0c\u5efa\u8b70\u4e5f\u53ef\u4ee5\u5148\u6309\u7167\u5238\u5546\u7684\u6559\u5b78\u4f86\u7df4\u7fd2\uff0c\u5047\u5982\u4e32\u63a5\u6210\u529f\uff0c\u5247 FinLab Package \u7684\u4e32\u63a5\u4e5f\u5c31\u662f\u5982\u6cd5\u70ae\u88fd\u7684\u8a2d\u5b9a\u56c9\uff01</p> <p></p> <ul> <li> <p>\u8acb\u5148\u7372\u53d6\u6191\u8b49</p> <ul> <li>Windows \u6191\u8b49\u4e0b\u8f09\u65b9\u5f0f</li> <li>MacOS \u6191\u8b49\u4e0b\u8f09\uff1a\u76ee\u524d\u6c38\u8c50\u96d6\u652f\u63f4 MacOS \u4e0b\u55ae\uff0c\u4f46\u4e26\u4e0d\u652f\u63f4\u7528 MacOS \u7372\u53d6\u6191\u8b49\uff0c\u53ef\u4ee5\u5148\u627e\u4e00\u53f0 Windows \u4f5c\u696d\u7cfb\u7d71\uff0c\u4e26\u4e14\u4f7f\u7528\u4e0a\u8ff0\u65b9\u6cd5\u7372\u53d6\u6191\u8b49\u5f8c\uff0c\u518d\u5c07\u6191\u8b49\u65bc MacOS \u4f86\u4f7f\u7528\u3002</li> </ul> </li> </ul> <p><pre><code>import os\nfrom finlab.online.sinopac_account import SinopacAccount\nos.environ['SHIOAJI_API_KEY'] = '\u6c38\u8c50\u8b49\u5238API_KEY'\nos.environ['SHIOAJI_SECRET_KEY'] = '\u6c38\u8c50\u8b49\u5238SECRET_KEY'\nos.environ['SHIOAJI_CERT_PERSON_ID']= '\u8eab\u4efd\u8b49\u5b57\u865f'\nos.environ['SHIOAJI_CERT_PATH']= '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nos.environ['SHIOAJI_CERT_PASSWORD'] = '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u5bc6\u78bc' # \u9810\u8a2d\u8207\u8eab\u4efd\u8b49\u5b57\u865f\nacc = SinopacAccount()\n</code></pre> \u5047\u5982\u5c0d\u65bc Finlab Package \u4e0b\u55ae\u4e0d\u719f\u7fd2\uff0c\u5efa\u8b70\u4e5f\u53ef\u4ee5\u5148\u6309\u7167 \u5238\u5546\u7684\u6559\u5b78 \u4f86\u7df4\u7fd2\uff0c\u5047\u5982\u4e32\u63a5\u6210\u529f\uff0c\u5247 FinLab Package \u7684\u4e32\u63a5\u5c31\u6703\u975e\u5e38\u7c21\u55ae\u56c9\uff01</p> <p>\u8acb\u53c3\u8003\u5143\u5bcc\u8b49\u5238\u7684\u6559\u5b78 \u4f86\u7372\u53d6\u6191\u8b49\uff0c\u4e26\u4e14\u5c07\u6191\u8b49\u653e\u5728\u76f8\u5c0d\u61c9\u7684\u8def\u5f91\u4e4b\u4e2d\uff0c\u4e26\u4e14\u5b89\u88dd\u76f8\u5c0d\u61c9\u7684\u5957\u4ef6\u5f8c\uff0c\u5373\u53ef\u57f7\u884c\uff1a</p> <pre><code>import os\nfrom finlab.online.masterlink_account import MasterlinkAccount\nos.environ['MASTERLINK_NATIONAL_ID'] = '\u8eab\u5206\u8b49\u5b57\u865f'\nos.environ['MASTERLINK_ACCOUNT'] = '\u4ea4\u6613\u5e33\u865f'\nos.environ['MASTERLINK_ACCOUNT_PASS'] = '\u5bc6\u78bc'\nos.environ['MASTERLINK_CERT_PATH'] = '\u5143\u5bcc\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nos.environ['MASTERLINK_CERT_PASS'] = '\u5143\u5bcc\u8b49\u5238\u6191\u8b49\u5bc6\u78bc' # \u9810\u8a2d\u8207\u8eab\u5206\u8b49\u5b57\u865f\nacc = MasterlinkAccount()\n</code></pre> <p>\u5373\u53ef\u5b8c\u6210\u8a2d\u5b9a\uff01</p> <p>\u8acb\u53c3\u8003\u5bcc\u90a6\u8b49\u5238\u7684\u6559\u5b78 \u4f86\u7372\u53d6\u6191\u8b49\uff0c\u4e26\u4e14\u5c07\u6191\u8b49\u653e\u5728\u76f8\u5c0d\u61c9\u7684\u8def\u5f91\u4e4b\u4e2d\uff0c\u4e26\u4e14\u5b89\u88dd\u76f8\u5c0d\u61c9\u7684\u5957\u4ef6\u5f8c\uff0c\u5373\u53ef\u57f7\u884c\uff1a</p> <pre><code>import os\nfrom fubon_account import FubonAccount\n# \u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578\nimport os\nos.environ['FUBON_NATIONAL_ID'] = \"A123456789\"\nos.environ['FUBON_ACCOUNT_PASS'] = \"your_password\"\nos.environ['FUBON_CERT_PATH'] = \"/path/to/cert.pfx\"\naccount = FubonAccount()\n</code></pre> <p>\u5373\u53ef\u5b8c\u6210\u8a2d\u5b9a\uff01</p>"},{"location":"details/order_api/#3","title":"3. \u6279\u6b21\u4e0b\u55ae","text":"<p>\u6700\u5f8c\u5229\u7528 <code>OrderExecuter</code> \u5c07\u7576\u8b49\u5238\u5e33\u6236\u7684\u90e8\u4f4d\uff0c\u6309\u7167 <code>position</code> \u7684\u90e8\u4f4d\u9032\u884c\u8abf\u6574\u3002</p> <pre><code>from finlab.online.order_executor import OrderExecutor\n# Order Executer\norder_executer = OrderExecutor(position , account=acc)\n</code></pre> <p>\u82e5\u4e0b\u55ae\u90e8\u4f4d\u542b\u6709\u300c \u5168\u984d\u4ea4\u5272\u80a1\u300d\u3001\u300c\u8655\u7f6e\u80a1\u300d\u3001\u300c\u8b66\u793a\u80a1\u300d\uff0c\u9700\u5148\u65bc\u8b49\u5238\u5e33\u6236\u5708\u5b58\u3002\u53c3\u8003\u5bcc\u679c\u5708\u5b58\u3001\u6c38\u8c50\u5708\u5b58\u65b9\u5f0f\u3002</p> <pre><code># \u986f\u793a\u4e0b\u55ae\u90e8\u4f4d\u662f\u5426\u6709\u8b66\u793a\u80a1\u53ca\u76f8\u95dc\u8cc7\u8a0a\norder_executer.show_alerting_stocks()\n</code></pre> <p><pre><code>\u8cb7\u5165 8101 0.429 \u5f35 - \u7e3d\u50f9\u7d04         2672.67\n</code></pre> \u6839\u64da<code>show_alerting_stocks</code>\u986f\u793a\u7d50\u679c\u9032\u884c\u5708\u5b58\u5f8c\uff0c\u5373\u53ef\u7e7c\u7e8c\u57f7\u884c\u4e0b\u55ae\u3002</p> <pre><code># \u4e0b\u55ae\u6aa2\u67e5\uff08\u700f\u89bd\u6a21\u5f0f\uff0c\u4e0d\u6703\u771f\u7684\u4e0b\u55ae\uff09\norder_executer.create_orders(view_only=True)\n# \u57f7\u884c\u4e0b\u55ae\uff08\u6703\u771f\u7684\u4e0b\u55ae\uff0c\u521d\u6b21\u4f7f\u7528\u5efa\u8b70\u6536\u5e02\u6642\u6e2c\u8a66\uff09\n# \u9810\u8a2d\u4f7f\u7528\u6700\u8fd1\u4e00\u7b46\u6210\u4ea4\u50f9\u7576\u6210\u9650\u50f9\norder_executer.create_orders()\n# \u66f4\u65b0\u9650\u50f9\uff08\u5c07\u6700\u5f8c\u4e00\u7b46\u6210\u4ea4\u50f9\u7576\u6210\u65b0\u7684\u9650\u50f9\uff09\norder_executer.update_order_price()\n# \u522a\u9664\u6240\u6709\u59d4\u8a17\u55ae\norder_executer.cancel_orders()\n</code></pre>"},{"location":"details/order_api/#_9","title":"\u67e5\u770b\u5e33\u6236\u90e8\u4f4d","text":"<p>\u4e0d\u8ad6\u662f\u6c38\u8c50\u9084\u662f\u5bcc\u679c\u5e33\u6236\uff0c\u90fd\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u67e5\u627e\u5e33\u6236\u7684\u90e8\u4f4d</p> <p><pre><code># \u9078\u64c7\u6b32\u4f7f\u7528\u7684\u5238\u5546(\u64c7\u4e00\u5373\u53ef)\n# \u6c38\u8c50\nfrom finlab.online.sinopac_account import SinopacAccount\nacc = SinopacAccount()\n# \u7389\u5c71\u5bcc\u679c\nfrom finlab.online.fugle_account import FugleAccount\nacc = FugleAccount()\nprint(acc.get_position())\n</code></pre> \u53ef\u4ee5\u5370\u51fa\u4ee5\u4e0b\u7d50\u679c <pre><code>[{'stock_id': '2330', 'quantity': 1, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}\n {'stock_id': '1101', 'quantity': 1.001, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}]\n</code></pre></p>"},{"location":"details/order_api2/","title":"\u4e0b\u55ae(\u591a\u7b56\u7565)","text":"<p>\u672c\u6307\u5357\u9069\u7528\u65bc\u6709\u660e\u78ba\u4ea4\u6613\u7b56\u7565\u7684\u7528\u6236\uff0c\u5305\u62ec\u4ee5\u4e0b\u6b65\u9a5f\uff1a</p> <ol> <li>\u57f7\u884c\u4ea4\u6613\u7b56\u7565</li> <li>\u7d44\u5408\u4ea4\u6613\u90e8\u4f4d</li> <li>\u8a08\u7b97\u80a1\u7968\u5f35\u6578</li> <li>\u5be6\u969b\u4e0b\u55ae</li> </ol> <p>\u4e0b\u9762\u5c07\u6703\u4e00\u4e00\u4ecb\u7d39\u5982\u4f55\u9032\u884c\u4e0b\u55ae\u3002</p> <p>\u6b64\u529f\u80fd\u70baBETA\u7248</p> <p>\u672c\u529f\u80fd\u76ee\u524d\u5df2\u6709\u4e0a\u5343\u842c\u7684\u8cc7\u91d1\u6b63\u5728\u4f7f\u7528\uff0c\u4f46\u7b2c\u4e00\u6b21\u4f7f\u7528\u6642\uff0c\u8acb\u65bc\u76e4\u5f8c\u6216\u76e4\u524d\u9032\u884c\uff0c\u907f\u514d\u5728\u4ea4\u6613\u6642\u6bb5\u64cd\u4f5c\uff0c\u4ee5\u514d\u767c\u751f\u975e\u9810\u671f\u7684\u932f\u8aa4\u3002</p>"},{"location":"details/order_api2/#1","title":"1. \u57f7\u884c\u4ea4\u6613\u7b56\u7565","text":"<p>\u5728\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u958b\u76e4\u524d\uff0c\u9996\u5148\u9700\u8981\u57f7\u884c\u7b56\u7565\u4e26\u53d6\u5f97\u4ea4\u6613\u5831\u544a\u3002\u4ee5\u4e0b\u4ecb\u7d39\u4e09\u7a2e\u65b9\u5f0f\uff1a</p>"},{"location":"details/order_api2/#a-backtestsim","title":"A. \u4f7f\u7528 <code>backtest.sim</code> \u9032\u884c\u56de\u6e2c\uff0c","text":"<p>\u7528\u6236\u53ef\u4ee5\u6839\u64da \u56de\u6e2c\u6559\u5b78 \u64b0\u5beb\u81ea\u5df1\u7684\u7b56\u7565\uff0c\u4e26\u901a\u904e\u56de\u6e2c\u7372\u53d6\u5831\u544a\uff1a</p> <p><pre><code>from finlab import backtest\n# \u64b0\u5beb\u60a8\u7684\u7b56\u7565\nreport1 = backtest.sim(...)\nreport2 = backtest.sim(...)\n</code></pre> \u8aaa\u660e\uff1a\u9019\u7a2e\u65b9\u5f0f\u9700\u8981\u5b8c\u6574\u57f7\u884c\u7a0b\u5f0f\u78bc\uff0c\u53ef\u80fd\u6703\u82b1\u8cbb\u4e00\u4e9b\u6642\u9593\u3002</p>"},{"location":"details/order_api2/#b","title":"B. \u4e0b\u8f09\u5e73\u53f0\u4e0a\u4f7f\u7528\u8005\u7684\u7b56\u7565\u4f86\u7372\u5f97\u56de\u6e2c\u5831\u544a","text":"<p>\u7528\u6236\u53ef\u4ee5\u5728\u5e73\u53f0\u4e0a\u7684 \u6211\u7684\u7b56\u7565 \u4e2d\u9078\u64c7\u60f3\u8981\u4e0b\u55ae\u7684\u7b56\u7565\uff0c\u8a18\u9304\u540d\u7a31\u5f8c\u4e0b\u8f09\u5831\u544a\u4e26\u4e0b\u55ae\uff1a</p> <pre><code>from finlab.portfolio import create_report_from_cloud\nreport1 = create_report_from_cloud('NAME_OF_STRATEGY1')\nreport2 = create_report_from_cloud('NAME_OF_STRATEGY2')\n</code></pre>"},{"location":"details/order_api2/#c","title":"C. \u76f4\u63a5\u8a2d\u5b9a\u90e8\u4f4d","text":"<p>\u9069\u5408\u5df2\u6709\u6301\u80a1\u4e26\u5e0c\u671b\u5b9a\u671f\u9032\u884c\u91cd\u65b0\u5e73\u8861\u7684\u7528\u6236\uff1a</p> <p><pre><code>from finlab.portfolio import create_multi_asset_report\nreport1 = create_multi_asset_report({'2330': 0.5, '1101': 0.5}, resample='Q')\nreport2 = create_multi_asset_report({'2330': 0.7, '1101': 0.3}, resample='M')\n</code></pre> \u8aaa\u660e\uff1a<code>resample</code> \u53c3\u6578\u8868\u793a\u91cd\u65b0\u5e73\u8861\u7684\u983b\u7387\uff0c\u4f8b\u5982 <code>Q</code> \u8868\u793a\u6309\u5b63\u5ea6\u91cd\u65b0\u5e73\u8861\u3002</p>"},{"location":"details/order_api2/#2","title":"2. \u7d44\u5408\u4ea4\u6613\u90e8\u4f4d","text":"<p>\u53d6\u5f97\u591a\u500b\u7b56\u7565\u5831\u544a\u5f8c\uff0c\u53ef\u4ee5\u7d44\u5408\u9019\u4e9b\u90e8\u4f4d\u4e26\u8a55\u4f30\u7e3e\u6548\uff1a</p> <pre><code>from finlab.portfolio import Portfolio\nport = Portfolio({\n'strategy1': (report1, 0.5),\n'strategy2': (report2, 0.5)\n})\nport.display()\n</code></pre> <p>\u6b64\u6642\u7a0b\u5f0f\u6703\u6a21\u64ec\u9019\u5169\u500b\u90e8\u4f4d\u7684\u7d44\u5408\u4e26\u8a08\u7b97\u51fa\u7e3e\u6548\u3002\u5982\u4e0b\u5716\u6240\u793a\uff1a </p>"},{"location":"details/order_api2/#3","title":"3. \u8a08\u7b97\u80a1\u7968\u5f35\u6578","text":"<p>\u63a5\u4e0b\u4f86\uff0c\u6211\u5011\u9700\u8981\u8a08\u7b97\u6bcf\u6a94\u80a1\u7968\u6295\u8cc7\u7684\u5f35\u6578\u3002\u4f7f\u7528 <code>PortfolioSyncManager</code> \u53ef\u4ee5\u9054\u6210\u4ee5\u4e0b\u76ee\u6a19\uff1a</p> <ul> <li>\u5224\u65b7\u662f\u5426\u9700\u8981\u66f4\u65b0\u90e8\u4f4d</li> <li>\u5728\u7b56\u7565\u63db\u80a1\u65e5\uff0c\u91cd\u65b0\u8a08\u7b97\u6bcf\u6a94\u80a1\u7968\u7684\u5f35\u6578</li> <li>\u5728\u6bcf\u500b\u4ea4\u6613\u65e5\u5f8c\uff0c\u6aa2\u67e5\u662f\u5426\u9700\u8981\u505c\u640d\u6216\u6b62\u76c8</li> <li>\u5728\u63db\u80a1\u6642\uff0c\u78ba\u4fdd\u5728\u6307\u5b9a\u7684\u91d1\u984d (<code>total_balance</code>) \u5167\u9032\u884c\u63db\u80a1</li> </ul>"},{"location":"details/order_api2/#portfoliosyncmanager","title":"\u5275\u5efa <code>PortfolioSyncManager</code>","text":"<p>\u7528\u6236\u53ef\u4ee5\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\u4f86\u5275\u5efa PortfolioSyncManager\uff1a</p> \u7b2c\u4e00\u6b21\u5275\u7acb\u90e8\u4f4d\u5f9e\u96f2\u7aef\u53d6\u5f97\u539f\u672c\u7684\u90e8\u4f4d\u5f9e\u672c\u5730\u7aef\u53d6\u5f97\u539f\u672c\u7684\u90e8\u4f4d <pre><code>from finlab.portfolio import PortfolioSyncManager\n# \u5efa\u7acb\u4e00\u500b\u65b0\u7684\u8cc7\u6599\u5eab\npm = PortfolioSyncManager()\n</code></pre> <pre><code>from finlab.portfolio import PortfolioSyncManager\n# \u5f9e\u96f2\u7aef\u53d6\u5f97\u539f\u672c\u7684\u90e8\u4f4d\npm = PortfolioSyncManager.from_cloud()\n</code></pre> <pre><code>from finlab.portfolio import PortfolioSyncManager\n# \u5f9e\u672c\u5730\u7aef\u53d6\u5f97\u539f\u672c\u7684\u90e8\u4f4d\npm = PortfolioSyncManager.from_local()\n</code></pre>"},{"location":"details/order_api2/#_1","title":"\u66f4\u65b0\u6301\u80a1\uff1a","text":"<p>\u53ef\u4ee5\u6839\u64da\u9700\u6c42\u9078\u64c7\u4e0d\u540c\u7684\u66f4\u65b0\u65b9\u5f0f\uff1a</p> \u63db\u80a1\u65e5\u624d\u63db\u80a1\u96f6\u80a1\u878d\u8cc7\u4ea4\u6613 <pre><code># \u7a0b\u5f0f\u6703\u5728\u63db\u80a1\u65e5\u7576\u5929\uff0c\u624d\u6703\u9032\u884c\u63db\u80a1\uff0c\u6240\u4ee5\u7b2c\u4e00\u6b21\u5275\u5efa\u6642\uff0c\u6703\u662f\u7a7a\u7684\u3002\npm.update(port, total_balance=1000000)\n</code></pre> <pre><code># \u96f6\u80a1\u4ea4\u6613\npm.update(port, total_balance=1000000, odd_lot=True)\n</code></pre> <pre><code># \u878d\u8cc7\u3001\u878d\u5238\u4ea4\u6613\npm.update(port, total_balance=1000000, margin_trading=True)\n</code></pre> <p><pre><code>print(pm)\n</code></pre> <pre><code>Estimate value 9633950\n\n          quantity  price    weight  close_price    volume                    strategy            type\nstock_id                                                                                              \n1213          19.0  10.15  0.019055        10.15    69.948                       r2,r3  MARGIN_TRADING\n1336           8.0  22.05  0.017430        22.05   270.865                    r5,r6,r7  MARGIN_TRADING\n1441          12.0  14.70  0.017430        14.70    76.901                       r0,r8  MARGIN_TRADING\n1468           8.0  14.60  0.011541        14.60    33.000                          r9  MARGIN_TRADING\n1474           8.0  13.90  0.010987        13.90   113.962                          r1  MARGIN_TRADING\n2496          15.0  73.50  0.108936        73.50    11.613     r0,r1,r2,r3,r4,r5,r8,r9  MARGIN_TRADING\n3019           3.0  85.90  0.025463        85.90  5376.965                    r3,r4,r5  MARGIN_TRADING\n3430           6.0  60.30  0.035749        60.30   300.173                 r4,r5,r6,r7  MARGIN_TRADING\n3632          42.0  15.30  0.063494        15.30    15.637        r0,r1,r3,r4,r5,r6,r7  MARGIN_TRADING\n4154          20.0  15.75  0.031125        15.75    57.116                 r4,r5,r6,r7  MARGIN_TRADING\n4554           3.0  29.50  0.008745        29.50    43.018                          r8  MARGIN_TRADING\n</code></pre> \u8acb\u6bcf\u65e5\u57f7\u884c <code>PortfolioSyncManager.update</code>\uff0c\u4ee5\u78ba\u4fdd\u90e8\u4f4d\u7684\u6b63\u78ba\u6027\u3002</p> PortfolioSyncManager.update \u63a7\u5236\u53c3\u6578 <p><code>PortfolioSyncManager.update</code> \u6709\u4ee5\u4e0b\u53c3\u6578\uff0c\u8acb\u8a73\u7d30\u95b1\u8b80\u78ba\u4fdd\u60a8\u7684\u90e8\u4f4d\u66f4\u65b0\u6b63\u78ba\uff1a</p> <p>portfolio (Portfolio or Report)</p> <p>\u9019\u662f\u4e00\u500b\u5305\u542b\u6295\u8cc7\u7d44\u5408\uff0c\u9019\u500b\u8a08\u7b97\u80a1\u7968\u540c\u6b65\u5e33\u6236\u7684\u6838\u5fc3\u6578\u64da\u7d50\u69cb\uff0c\u6240\u6709\u80a1\u7968\u5f35\u6578\u904b\u7b97\u90fd\u6703\u53c3\u8003 portfolio \u9032\u884c\u3002</p> <p>total_balance (float)</p> <p>\u7e3d\u8cc7\u7522\u7684\u6d6e\u9ede\u6578\u503c\uff0c\u8868\u793a\u6295\u8cc7\u8005\u7684\u6574\u9ad4\u8cc7\u91d1\u72c0\u6cc1\u3002\u9019\u500b\u6578\u503c\u5305\u62ec\u6240\u6709\u73fe\u91d1\u548c\u8cc7\u7522\u8207\u80a1\u7968\u7684\u7e3d\u548c\u3002</p> <p>rebalance_safety_weight (float)</p> <p>\u73fe\u91d1\u7684\u6b0a\u91cd\uff0c\u78ba\u4fdd\u5728\u4ee5\u5e02\u50f9\u8cb7\u8ce3\u8cc7\u7522\u6642\uff0c\u65b0\u7684\u7b56\u7565\u7d44\u5408\u7684\u7e3d\u50f9\u503c\u4e0d\u6703\u8d85\u904e\u539f\u6709\u7684\u7d44\u5408\u50f9\u503c\u3002\u9019\u500b\u53c3\u6578\u662f\u518d\u5e73\u8861\u7b56\u7565\u7684\u4e00\u90e8\u5206\uff0c\u7528\u65bc\u8a08\u7b97\u8ce3\u51fa\u80a1\u7968\u5f8c\uff0c\u6709\u591a\u5c11\u6bd4\u4f8b\u9700\u8981\u8f49\u63db\u6210\u73fe\u91d1\u3002\u8209\u4f8b\u4f86\u8aaa\uff0c\u5982\u679c\u8a2d\u5b9a\u70ba20\uff05\uff0c\u5247\u8ce3\u51fa\u8cc7\u7522\u5f8c\uff0c20\uff05\u7684\u8cc7\u91d1\u5c07\u4fdd\u7559\u70ba\u73fe\u91d1\uff0c\u5176\u9918\u90e8\u5206\u5c07\u7528\u65bc\u8cfc\u8cb7\u65b0\u7684\u8cc7\u7522\u3002\u9019\u6709\u52a9\u65bc\u7ba1\u7406\u6295\u8cc7\u98a8\u96aa\u548c\u78ba\u4fdd\u6d41\u52d5\u6027\u3002\u5047\u5982\u4f7f\u7528\u8005\u4f7f\u7528\u9650\u50f9\u4ea4\u6613\uff0c\u53ef\u4ee5\u5c07\u6b64\u53c3\u6578\u8a2d\u5b9a\u70ba 5\uff05\u3002</p> <p>smooth_transition (bool)</p> <p>\u6b64\u53c3\u6578\u6c7a\u5b9a\u662f\u5426\u63a1\u7528\u5e73\u6ed1\u904e\u6e21\u7684\u65b9\u5f0f\u9032\u884c\u6295\u8cc7\u7d44\u5408\u66f4\u65b0\u3002\u7576\u65b0\u589e\u6216\u6e1b\u5c11\u7b56\u7565\u3001\u4ee5\u53ca\u66f4\u65b0\u6b0a\u91cd\u6642\uff0c\u5982\u679c\u8a2d\u5b9a\u70ba True\uff0c\u6295\u8cc7\u7d44\u5408\u4e0d\u6703\u7acb\u5373\u8b8a\u66f4\uff0c\u800c\u662f\u5728\u6bcf\u500b\u7b56\u7565\u7684\u5230\u671f\u65e5\u9032\u884c\u66f4\u65b0\u3002\u9019\u6a23\u53ef\u4ee5\u907f\u514d\u983b\u7e41\u7684\u4ea4\u6613\uff0c\u6e1b\u5c11\u4ea4\u6613\u6210\u672c\uff0c\u4e26\u6709\u52a9\u65bc\u6295\u8cc7\u7d44\u5408\u7684\u7a69\u5b9a\u6027\u3002\u9810\u8a2d\u503c\u70ba True\u3002</p> <p>force_override_difference (bool)</p> <p>\u6b64\u53c3\u6578\u6c7a\u5b9a\u662f\u5426\u5f37\u5236\u8986\u84cb\u73fe\u6709\u7684\u4e0d\u540c\u90e8\u4f4d\uff0c\u5047\u5982\u7576\u5929\u4e0d\u662f\u63db\u80a1\u65e5\uff0c\u800c\u4e14\u6c92\u6709\u505c\u640d\u505c\u5229\uff0c\u7a0b\u5f0f\u9084\u662f\u6703\u9a57\u8b49\u7576\u524d\u90e8\u4f4d\uff0c\u4ee5\u53ca\u8ddf\u6a21\u64ec\u90e8\u4f4d\u662f\u5426\u4e00\u81f4\uff08\u7406\u8ad6\u4e0a\u61c9\u8a72\u4e00\u81f4\uff0c\u4f46\u73fe\u5be6\u4e0a\u6709\u53ef\u80fd\u56e0\u70ba\u8cc7\u6599\u5ef6\u9072\u767b\u8f09\u3001\u4f7f\u7528\u8005\u5fd8\u8a18\u57f7\u884c\u7b56\u7565\u3001\u4f7f\u7528\u8005\u5728\u8cc7\u6599\u767b\u8f09\u524d\u57f7\u884c\u7b56\u7565\uff0c\u800c\u5c0e\u81f4\u7a0d\u6709\u4e0d\u540c\uff09\u3002\u82e5\u6b64\u53c3\u6578\u8a2d\u5b9a\u70ba True\uff0c\u767c\u73fe\u6709\u5dee\u7570\u6642\uff0c\u5247\u6703\u5f37\u5236\u6309\u7167\u65b0\u7684\u7b56\u7565\u9032\u884c\u8abf\u6574\uff0c\u9810\u8a2d\u503c\u70ba False\uff0c\u4ee5\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u4ea4\u6613\u548c\u6f5b\u5728\u98a8\u96aa\u3002</p> <p>\u9019\u4e9b\u53c3\u6578\u5728\u9032\u884c\u6295\u8cc7\u7d44\u5408\u540c\u6b65\u548c\u518d\u5e73\u8861\u6642\u975e\u5e38\u91cd\u8981\uff0c\u6b63\u78ba\u8a2d\u5b9a\u548c\u7406\u89e3\u9019\u4e9b\u53c3\u6578\u53ef\u4ee5\u5e6b\u52a9\u6295\u8cc7\u8005\u5be6\u73fe\u66f4\u6709\u6548\u7684\u8cc7\u7522\u7ba1\u7406\u548c\u98a8\u96aa\u63a7\u5236\u3002</p> PortfolioSyncManager.update \u5be6\u969b\u6848\u4f8b\u5206\u6790 <p><code>update</code> \u51fd\u6578\u4ecb\u7d39<code>update</code> \u51fd\u6578\u662f\u7ba1\u7406\u6295\u8cc7\u7d44\u5408\u7684\u91cd\u8981\u5de5\u5177\u3002\u5b83\u78ba\u4fdd\u6295\u8cc7\u7d44\u5408\u4fdd\u6301\u5e73\u8861\uff0c\u4e26\u5728\u5fc5\u8981\u6642\u91cd\u65b0\u8abf\u6574\u6295\u8cc7\uff0c\u4ee5\u9075\u5faa\u7b56\u7565\u5206\u914d\u3002\u4ee5\u4e0b\u662f\u8a72\u51fd\u6578\u7684\u8a73\u7d30\u5de5\u4f5c\u539f\u7406\u3002</p> <p>\u65b0\u589e\u79fb\u9664\u7b56\u7565</p> <p>\u7576\u60a8\u6bcf\u5929\u4f7f\u7528 <code>pm.update</code> \u6642\uff0c\u53ef\u4ee5\u4e1f\u5165\u4e0d\u540c\u7684\u7b56\u7565\uff0c\u4e0d\u540c\u7684\u53c3\u6578\uff0c\u4f86\u9032\u884c\u4e0d\u540c\u7684\u64cd\u4f5c\uff0c\u4e0d\u8ad6\u5982\u4f55\uff0c\u5b83\u5c31\u662f\u6703\u7528\u6700\u5408\u7406\u7684\u65b9\u5f0f\uff0c\u5b8c\u6210\u60a8\u7684\u90e8\u4f4d\u66f4\u65b0\u3002 \u7576\u4f60\u60f3\u8981\u99ac\u4e0a\u5207\u63db\u7b56\u7565\uff0c\u4e0d\u60f3\u8981\u7b49\u5f85\u63db\u80a1\u65e5\u624d\u5207\u63db\uff0c\u53ef\u4ee5\u8a2d\u5b9a <code>pm.update(..., smooth_transition=False)</code></p>"},{"location":"details/order_api2/#_2","title":"\u6b65\u9a5f\u8aaa\u660e","text":"<ol> <li> <p>\u8b58\u5225\u9700\u8981\u66f4\u65b0\u7684\u7b56\u7565</p> <ul> <li> <p>\u51fd\u6578\u9996\u5148\u6aa2\u67e5\u54ea\u4e9b\u7b56\u7565\u9700\u8981\u66f4\u65b0\u3002\u9019\u57fa\u65bc\u7b56\u7565\u4e2d\u8a2d\u5b9a\u7684\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u671f\u3002\u5982\u679c\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u671f\u5df2\u5230\u6216\u5df2\u904e\uff0c\u6216\u7b56\u7565\u6b0a\u91cd\u767c\u751f\u8b8a\u5316\uff0c\u5c31\u9700\u8981\u66f4\u65b0\u3002</p> </li> <li> <p>\u5b83\u9084\u6703\u8003\u616e\u662f\u5426\u555f\u7528\u5e73\u6ed1\u904e\u6e21\uff0c\u9019\u610f\u5473\u8457\u66f4\u65b0\u5c07\u50c5\u5728\u4e0b\u4e00\u500b\u9810\u5b9a\u4ea4\u6613\u65e5\u671f\u9032\u884c\uff0c\u4ee5\u907f\u514d\u7acb\u5373\u8b8a\u66f4\u3002</p> </li> </ul> </li> <li> <p>\u6aa2\u67e5\u7576\u524d\u6301\u5009 </p> <ul> <li>\u51fd\u6578\u6703\u6aa2\u67e5\u6295\u8cc7\u7d44\u5408\u4e2d\u7576\u524d\u6301\u6709\u7684\u80a1\u7968\u5217\u8868\uff0c\u78ba\u8a8d\u5b83\u5011\u662f\u5426\u8207\u7b56\u7565\u5831\u544a\u4e2d\u7684\u80a1\u7968\u5339\u914d\u3002\u5982\u679c\u6709\u5dee\u7570\uff0c\u51fd\u6578\u6703\u8a18\u9304\u8b66\u544a\uff0c\u4e26\u5728\u5fc5\u8981\u6642\u5f37\u5236\u66f4\u65b0\u3002</li> </ul> </li> <li> <p>\u8a08\u7b97\u8cc7\u7522\u50f9\u503c\u548c\u6d41\u52d5\u8cc7\u91d1 </p> <ul> <li> <p>\u7e3d\u8cc7\u7522\u50f9\u503c \uff1a\u51fd\u6578\u6703\u5c07\u6295\u8cc7\u7d44\u5408\u4e2d\u6240\u6709\u7576\u524d\u6301\u5009\u7684\u50f9\u503c\u76f8\u52a0\uff0c\u9019\u662f\u76ee\u524d\u6301\u6709\u7684\u8cc7\u7522\u7e3d\u50f9\u503c\u3002</p> </li> <li> <p>\u6d41\u52d5\u8cc7\u91d1 \uff1a\u9019\u4ee3\u8868\u901a\u904e\u51fa\u552e\u7576\u524d\u6301\u5009\u53ef\u4ee5\u7372\u5f97\u7684\u8cc7\u91d1\u3002\u5c0d\u65bc\u9700\u8981\u91cd\u65b0\u8abf\u6574\u7684\u7b56\u7565\uff08\u90a3\u4e9b\u4e0b\u4e00\u500b\u4ea4\u6613\u65e5\u671f\u5df2\u5230\u7684\u7b56\u7565\uff09\uff0c\u5176\u6301\u5009\u50f9\u503c\u5c07\u8a08\u5165\u6d41\u52d5\u8cc7\u91d1\u4e2d\u3002\u9084\u6703\u8003\u616e\u5269\u9918\u9918\u984d\uff08\u7e3d\u9918\u984d\u6e1b\u53bb\u7576\u524d\u8cc7\u7522\u50f9\u503c\uff09\u3002</p> </li> <li> <p>\u9650\u5236\u6d41\u52d5\u8cc7\u91d1 \uff1a\u6d41\u52d5\u8cc7\u91d1\u6703\u88ab\u9650\u5236\uff0c\u4ee5\u78ba\u4fdd\u4e0d\u8d85\u904e\u6839\u64da\u7b56\u7565\u6b0a\u91cd\u7e3d\u548c\u8a08\u7b97\u51fa\u7684\u7e3d\u9918\u984d\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7e3d\u9918\u984d\u70ba $1,000,000\uff0c\u800c\u5169\u500b\u7b56\u7565\u5404\u81ea\u7684\u6b0a\u91cd\u70ba 50%\uff0c\u5247\u6700\u5927\u6d41\u52d5\u8cc7\u91d1\u70ba $500,000\u3002</p> </li> <li> <p>\u5b89\u5168\u8cc7\u91d1 \uff1a\u6d41\u52d5\u8cc7\u91d1\u7684\u4e00\u90e8\u5206\u5c07\u88ab\u4fdd\u7559\u70ba\u5b89\u5168\u8cc7\u91d1\uff0c\u4ee5\u78ba\u4fdd\u91cd\u65b0\u8abf\u6574\u671f\u9593\u6295\u8cc7\u7d44\u5408\u7684\u7a69\u5b9a\u6027\u3002\u9019\u901a\u5e38\u662f\u6d41\u52d5\u8cc7\u91d1\u7684\u4e00\u500b\u767e\u5206\u6bd4\uff08\u4f8b\u5982 20%\uff09\u3002</p> </li> <li> <p>\u53ef\u6295\u8cc7\u8cc7\u91d1 \uff1a\u4fdd\u7559\u5b89\u5168\u8cc7\u91d1\u5f8c\u7684\u5269\u9918\u6d41\u52d5\u8cc7\u91d1\u5373\u70ba\u53ef\u6295\u8cc7\u8cc7\u91d1\u3002\u9019\u4e9b\u8cc7\u91d1\u53ef\u7528\u65bc\u6839\u64da\u66f4\u65b0\u7684\u7b56\u7565\u5206\u914d\u9032\u884c\u65b0\u6295\u8cc7\u3002</p> </li> </ul> </li> <li> <p>\u66f4\u65b0\u5404\u7b56\u7565\u7684\u6301\u5009 </p> <ul> <li> <p>\u5c0d\u65bc\u6bcf\u500b\u9700\u8981\u66f4\u65b0\u7684\u7b56\u7565\uff0c\u51fd\u6578\u6703\u6839\u64da\u7b56\u7565\u6b0a\u91cd\u548c\u53ef\u6295\u8cc7\u8cc7\u91d1\u8a08\u7b97\u8cc7\u91d1\u5206\u914d\u3002</p> </li> <li> <p>\u5c07\u8a72\u7b56\u7565\u7684\u820a\u6301\u5009\u6e05\u7b97\uff0c\u4e26\u6839\u64da\u66f4\u65b0\u7684\u7b56\u7565\u5206\u914d\u5275\u5efa\u65b0\u6301\u5009\u3002\u5982\u679c\u67d0\u652f\u80a1\u7968\u540c\u6642\u51fa\u73fe\u5728\u820a\u6301\u5009\u548c\u65b0\u6301\u5009\u4e2d\uff0c\u5247\u5728\u91cd\u65b0\u5e73\u8861\u904e\u7a0b\u4e2d\u5c07\u4fdd\u7559\u8a72\u80a1\u7968\u3002</p> </li> <li> <p>\u5982\u679c\u4efb\u4f55\u80a1\u7968\u89f8\u767c\u505c\u640d\u6216\u6b62\u76c8\u8a02\u55ae\uff0c\u5176\u6301\u5009\u5c07\u88ab\u8a2d\u7f6e\u70ba\u96f6\uff0c\u800c\u4e0d\u6703\u91cd\u65b0\u5e73\u8861\u6574\u500b\u7b56\u7565\u3002</p> </li> </ul> </li> <li> <p>\u4fdd\u5b58\u66f4\u65b0\u5f8c\u7684\u6295\u8cc7\u7d44\u5408 </p> <ul> <li>\u6700\u5f8c\uff0c\u6839\u64da\u521d\u59cb\u8a2d\u7f6e\uff0c\u5c07\u66f4\u65b0\u5f8c\u7684\u6295\u8cc7\u7d44\u5408\u4fe1\u606f\u4fdd\u5b58\u5230\u672c\u5730\u6216\u96f2\u7aef\uff0c\u78ba\u4fdd\u8b8a\u66f4\u662f\u6301\u4e45\u7684\uff0c\u672a\u4f86\u53ef\u4ee5\u8a2a\u554f\u3002</li> </ul> </li> </ol>"},{"location":"details/order_api2/#_3","title":"\u793a\u4f8b\u60c5\u5883","text":"<p>\u70ba\u4e86\u66f4\u5177\u9ad4\uff0c\u6211\u5011\u4f86\u8003\u616e\u4e00\u500b\u4f8b\u5b50\uff1a</p> <ul> <li> <p>\u521d\u59cb\u8a2d\u7f6e \uff1a\u60a8\u7684\u6295\u8cc7\u7d44\u5408\u6709\u5169\u500b\u7b56\u7565\uff0cA \u548c B\uff0c\u5404\u81ea\u7684\u6b0a\u91cd\u70ba 50%\u3002</p> </li> <li> <p>\u7576\u524d\u50f9\u503c \uff1a\u7e3d\u6de8\u503c\u70ba $1,000,000\u3002\u5176\u4e2d\u7b56\u7565 A \u7684\u7576\u524d\u50f9\u503c\u70ba $300,000\uff0c\u7b56\u7565 B \u7684\u50f9\u503c\u4e5f\u662f $600,000\u3002\u4e4b\u6240\u4ee5\u7b56\u7565 A \u7684\u50f9\u503c\u8f03\u4f4e\uff0c\u662f\u56e0\u70ba\u505c\u640d\u8a02\u55ae\u5c0e\u81f4\u90e8\u5206\u80a1\u7968\u6301\u5009\u88ab\u6e05\u7b97\uff1b\u800c\u7b56\u7565 B \u7684\u50f9\u503c\u8f03\u9ad8\uff0c\u662f\u56e0\u70ba\u5176\u80a1\u7968\u8868\u73fe\u826f\u597d\uff0c\u4e0a\u6f32\u4e86\u3002</p> </li> <li> <p>\u91cd\u65b0\u8abf\u6574\u689d\u4ef6 \uff1a\u7b56\u7565 B \u8a08\u5283\u5728\u660e\u5929\u662f\u63db\u80a1\u65e5\uff0c\u4f46 A \u4e26\u4e0d\u662f\u3002</p> </li> </ul> <p>\u66f4\u65b0\u904e\u7a0b \uff1a </p> <ol> <li> <p>\u8b58\u5225\u9700\u8981\u66f4\u65b0\u7684\u7b56\u7565 \uff1a</p> <ul> <li>\u51fd\u6578\u8b58\u5225\u5230\u7b56\u7565 B \u9700\u8981\u66f4\u65b0\u3002</li> </ul> </li> <li> <p>\u8a08\u7b97\u8cc7\u7522\u50f9\u503c\u548c\u6d41\u52d5\u8cc7\u91d1 \uff1a </p> <ul> <li> <p>\u7e3d\u8cc7\u7522\u50f9\u503c \uff1a$1,000,000\u3002</p> </li> <li> <p>\u6d41\u52d5\u8cc7\u91d1\u8a08\u7b97 \uff1a</p> <ul> <li> <p>\u7b56\u7565 B \u7684\u6301\u5009\u6f5b\u5728\u6d41\u52d5\u8cc7\u91d1\uff1a$600,000\u3002</p> </li> <li> <p>\u5269\u9918\u9918\u984d\uff1a$100,000\u3002</p> </li> <li> <p>\u660e\u65e5\u7e3d\u6d41\u52d5\u8cc7\u91d1\u70ba \\(700,000\uff08\\)100,000 + $600,000\uff09\u3002</p> </li> <li> <p>\u63d0\u4f9b\u7d66 B \u7684\u6d41\u52d5\u8cc7\u91d1\u9650\u5236\u70ba $500,000\uff08\u7531\u65bc\u7b56\u7565 B \u7684\u6b0a\u91cd\u70ba 50%\uff09\u3002</p> </li> </ul> </li> <li> <p>\u5b89\u5168\u8cc7\u91d1\u8a08\u7b97 \uff1a</p> <ul> <li>\u5b89\u5168\u8cc7\u91d1\uff1a$500,000 \u7684 20% = $100,000\u3002</li> </ul> </li> <li> <p>\u53ef\u6295\u8cc7\u8cc7\u91d1\u8a08\u7b97 \uff1a</p> <ul> <li>\u53ef\u6295\u8cc7\u8cc7\u91d1\uff1a$500,000\uff08\u6d41\u52d5\u8cc7\u91d1\uff09- $100,000\uff08\u5b89\u5168\u8cc7\u91d1\uff09= $400,000\u3002</li> </ul> </li> <li> <p>\u9592\u7f6e\u8cc7\u91d1\u8a08\u7b97 \uff1a</p> <ul> <li>\u9592\u7f6e\u8cc7\u91d1\uff1a\u7b56\u7565 A (\\(300,000)\u8207\u65b0\u7684\u7b56\u7565 B (\\)500,000) \u7684\u7e3d\u6301\u5009\u50f9\u503c\u70ba $800,000\uff0c\u56e0\u6b64\u5269\u9918\u9918\u984d\u70ba $200,000\u3002</li> </ul> </li> <li> <p>\u4ee5\u9592\u7f6e\u8cc7\u91d1\u53d6\u4ee3\u5b89\u5168\u8cc7\u91d1 \uff1a</p> <ul> <li>\u7531\u65bc\u9592\u7f6e\u8cc7\u91d1\uff08\\(200,000\uff09\u5927\u65bc\u5b89\u5168\u8cc7\u91d1\uff08\\)100,000\uff09\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u5b89\u5168\u8cc7\u91d1\u4f86\u63db\u80a1\uff0c\u800c\u662f\u4f7f\u7528\u9592\u7f6e\u8cc7\u91d1\u5373\u53ef\u3002</li> <li>\u91cd\u65b0\u8a08\u7b97\u53ef\u6295\u8cc7\u8cc7\u91d1\uff1a$500,000\uff08\u539f\u59cb\u53ef\u6295\u8cc7\u8cc7\u91d1\uff09- $0\uff08\u5b89\u5168\u8cc7\u91d1\uff09= $500,000\u3002</li> </ul> </li> </ul> </li> <li> <p>\u66f4\u65b0\u7b56\u7565 B \u7684\u6301\u5009 \uff1a</p> <ul> <li> <p>\u5728\u4ea4\u6613\u65e5\u671f\uff0c\u7b56\u7565 B \u7684\u820a\u6301\u5009 $600,000 \u5c07\u88ab\u6e05\u7b97\u3002</p> </li> <li> <p>\u4e4b\u5f8c\u5c07\u7528 $500,000 \u6839\u64da\u7b56\u7565 B \u8cb7\u9032\u80a1\u7968\u3002</p> </li> <li> <p>\u4efb\u4f55 A \u89f8\u767c\u505c\u640d\u6216\u6b62\u76c8\u8a02\u55ae\u7684\u80a1\u7968\uff0c\u5176\u6301\u5009\u5c07\u88ab\u8a2d\u7f6e\u70ba\u96f6\uff0c\u800c\u4e0d\u6703\u91cd\u65b0\u5e73\u8861 B \u7b56\u7565\u6301\u80a1\u3002</p> </li> </ul> </li> <li> <p>\u4fdd\u5b58\u66f4\u65b0\u5f8c\u7684\u6295\u8cc7\u7d44\u5408 \uff1a</p> <ul> <li>\u4fdd\u5b58\u66f4\u65b0\u5f8c\u7684\u8cc7\u8a0a\uff0c\u4ee5\u78ba\u4fdd\u672a\u4f86\u53ef\u4ee5\u8a2a\u554f\u3002</li> </ul> </li> </ol>"},{"location":"details/order_api2/#_4","title":"\u7e3d\u7d50","text":"<p><code>update</code> \u51fd\u6578\u78ba\u4fdd\u60a8\u7684\u6295\u8cc7\u7d44\u5408\u4fdd\u6301\u5e73\u8861\u4e26\u9075\u5faa\u7b56\u7565\u5206\u914d\u3002\u5b83\u4ed4\u7d30\u8a08\u7b97\u7576\u524d\u6301\u5009\u7684\u50f9\u503c\uff0c\u78ba\u5b9a\u53ef\u7528\u8cc7\u91d1\uff0c\u4e26\u6839\u64da\u6700\u65b0\u7b56\u7565\u66f4\u65b0\u6295\u8cc7\u7d44\u5408\uff0c\u540c\u6642\u78ba\u4fdd\u904e\u7a0b\u4e2d\u7684\u7a69\u5b9a\u6027\u3002\u89f8\u767c\u505c\u640d\u6216\u6b62\u76c8\u8a02\u55ae\u7684\u80a1\u7968\u5c07\u88ab\u8a2d\u7f6e\u70ba\u96f6\uff0c\u800c\u4e0d\u6703\u91cd\u65b0\u5e73\u8861\u6574\u500b\u7b56\u7565\u3002\u9019\u6709\u52a9\u65bc\u7ba1\u7406\u98a8\u96aa\u4e26\u96a8\u6642\u9593\u4fdd\u6301\u671f\u671b\u7684\u6295\u8cc7\u7b56\u7565\u3002</p>"},{"location":"details/order_api2/#_5","title":"\u5132\u5b58\u90e8\u4f4d\uff1a","text":"<p>\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u4f86\u5132\u5b58\u90e8\u4f4d\uff1a</p> \u5132\u5b58\u5230\u96f2\u7aef\u5132\u5b58\u5230\u672c\u5730 <pre><code>pm.to_cloud()\n</code></pre> <pre><code>pm.to_local()\n</code></pre>"},{"location":"details/order_api2/#_6","title":"\u81ea\u52d5\u5316\u8a2d\u8a08\u8173\u672c","text":"<p>\u7b2c\u4e00\u6b21\u8acb\u5148\u5275\u5efa\u90e8\u4f4d\uff1a</p> <pre><code># \u521d\u59cb\u5316 PortfolioSyncManager\npm = PortfolioSyncManager()\npm.to_local()\n</code></pre> <p>\u4e4b\u5f8c\u53ef\u4ee5\u6bcf\u5929\u81ea\u52d5\u5316\u57f7\u884c\uff1a</p> <pre><code># \u521d\u59cb\u5316 PortfolioSyncManager\npm = PortfolioSyncManager.from_local()\n# \u76f8\u95dc\u64cd\u4f5c\n# pm.update(...)\n# \u4fdd\u5b58\u6700\u5f8c\u7684\u64cd\u4f5c\u7d50\u679c\npm.to_local()\n</code></pre>"},{"location":"details/order_api2/#4","title":"4. \u5be6\u969b\u4e0b\u55ae","text":"<p>\u76ee\u524d\u652f\u63f4 <code>Fugle</code> \u548c <code>\u6c38\u8c50</code> \u8b49\u5238\u7684\u4e0b\u55ae\u7cfb\u7d71\uff0c\u53ef\u4ee5\u5148\u5c07\u5e33\u865f\u5bc6\u78bc\u8a2d\u5b9a\u6210\u74b0\u5883\u8b8a\u6578\uff0c\u53ea\u8981\u91dd\u5c0d\u60a8\u9700\u8981\u7684\u5238\u5546\u4f86\u8a2d\u5b9a\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5169\u500b\u5238\u5546\u540c\u6642\u4e32\u63a5\u3002</p> <p>\u9078\u64c7\u60a8\u7684\u5238\u5546</p> \u7389\u5c71\u5bcc\u679c\u6c38\u8c50\u8b49\u5238\u5143\u5bcc\u8b49\u5238\u5bcc\u90a6\u8b49\u5238 <p></p> <ul> <li>\u8acb\u5148\u6309\u7167config \u6559\u5b78\u7372\u53d6 config \u8a2d\u5b9a\u6a94\u3002</li> <li>\u4e26\u5230\u767b\u5165\u5bcc\u679cAPI\uff0c\u7372\u5f97\u5e02\u5834\u884c\u60c5 Token\u3002</li> </ul> <pre><code>from finlab.online.fugle_account import FugleAccount\nimport os\nos.environ['FUGLE_CONFIG_PATH'] = '\u7389\u5c71\u5bcc\u679c\u4ea4\u6613\u8a2d\u5b9a\u6a94(config.ini.example)\u8def\u5f91'\nos.environ['FUGLE_MARKET_API_KEY'] = '\u7389\u5c71\u5bcc\u679c\u7684\u884c\u60c5API Token'\nos.environ['FUGLE_ACCOUNT_PASSWORD'] = '\u7389\u5c71\u5bcc\u679c\u7684\u5e33\u865f\u5bc6\u78bc'\nos.environ['FUGLE_CERT_PASSWORD'] = '\u7389\u5c71\u5bcc\u679c\u7684\u6191\u8b49\u5bc6\u78bc'\naccount = FugleAccount()\n</code></pre> <p>\u5047\u5982\u4f7f\u7528\u4e2d\u4e0b\u55ae\u51fa\u73fe\u932f\u8aa4\u4ee3\u78bc\uff0c\u53ef\u4ee5\u5230\u5bcc\u679c\u6587\u4ef6 \u4f86\u67e5\u627e\u539f\u56e0\u3002\u5047\u5982\u5c0d\u65bc Finlab Package \u4e0b\u55ae\u4e0d\u719f\u7fd2\uff0c\u5efa\u8b70\u4e5f\u53ef\u4ee5\u5148\u6309\u7167\u5238\u5546\u7684\u6559\u5b78\u4f86\u7df4\u7fd2\uff0c\u5047\u5982\u4e32\u63a5\u6210\u529f\uff0c\u5247 FinLab Package \u7684\u4e32\u63a5\u4e5f\u5c31\u662f\u5982\u6cd5\u70ae\u88fd\u7684\u8a2d\u5b9a\u56c9\uff01</p> <p></p> <ul> <li> <p>\u8acb\u5148\u7372\u53d6\u6191\u8b49</p> <ul> <li>Windows \u6191\u8b49\u4e0b\u8f09\u65b9\u5f0f</li> <li>MacOS \u6191\u8b49\u4e0b\u8f09\uff1a\u76ee\u524d\u6c38\u8c50\u96d6\u652f\u63f4 MacOS \u4e0b\u55ae\uff0c\u4f46\u4e26\u4e0d\u652f\u63f4\u7528 MacOS \u7372\u53d6\u6191\u8b49\uff0c\u53ef\u4ee5\u5148\u627e\u4e00\u53f0 Windows \u4f5c\u696d\u7cfb\u7d71\uff0c\u4e26\u4e14\u4f7f\u7528\u4e0a\u8ff0\u65b9\u6cd5\u7372\u53d6\u6191\u8b49\u5f8c\uff0c\u518d\u5c07\u6191\u8b49\u65bc MacOS \u4f86\u4f7f\u7528\u3002</li> </ul> </li> </ul> <p><pre><code>import os\nfrom finlab.online.sinopac_account import SinopacAccount\nos.environ['SHIOAJI_API_KEY'] = '\u6c38\u8c50\u8b49\u5238API_KEY'\nos.environ['SHIOAJI_SECRET_KEY'] = '\u6c38\u8c50\u8b49\u5238SECRET_KEY'\nos.environ['SHIOAJI_CERT_PERSON_ID']= '\u8eab\u4efd\u8b49\u5b57\u865f'\nos.environ['SHIOAJI_CERT_PATH']= '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nos.environ['SHIOAJI_CERT_PASSWORD'] = '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u5bc6\u78bc' # \u9810\u8a2d\u8207\u8eab\u4efd\u8b49\u5b57\u865f\naccount = SinopacAccount()\n</code></pre> \u5047\u5982\u5c0d\u65bc Finlab Package \u4e0b\u55ae\u4e0d\u719f\u7fd2\uff0c\u5efa\u8b70\u4e5f\u53ef\u4ee5\u5148\u6309\u7167 \u5238\u5546\u7684\u6559\u5b78 \u4f86\u7df4\u7fd2\uff0c\u5047\u5982\u4e32\u63a5\u6210\u529f\uff0c\u5247 FinLab Package \u7684\u4e32\u63a5\u5c31\u6703\u975e\u5e38\u7c21\u55ae\u56c9\uff01</p> <p>\u8acb\u53c3\u8003\u5143\u5bcc\u8b49\u5238\u7684\u6559\u5b78 \u4f86\u7372\u53d6\u6191\u8b49\uff0c\u4e26\u4e14\u5c07\u6191\u8b49\u653e\u5728\u76f8\u5c0d\u61c9\u7684\u8def\u5f91\u4e4b\u4e2d\uff0c\u4e26\u4e14\u5b89\u88dd\u76f8\u5c0d\u61c9\u7684\u5957\u4ef6\u5f8c\uff0c\u5373\u53ef\u57f7\u884c\uff1a</p> <pre><code>import os\nfrom finlab.online.masterlink_account import MasterlinkAccount\nos.environ['MASTERLINK_NATIONAL_ID'] = '\u8eab\u5206\u8b49\u5b57\u865f'\nos.environ['MASTERLINK_ACCOUNT'] = '\u4ea4\u6613\u5e33\u865f'\nos.environ['MASTERLINK_ACCOUNT_PASS'] = '\u5bc6\u78bc'\nos.environ['MASTERLINK_CERT_PATH'] = '\u5143\u5bcc\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nos.environ['MASTERLINK_CERT_PASS'] = '\u5143\u5bcc\u8b49\u5238\u6191\u8b49\u5bc6\u78bc' # \u9810\u8a2d\u8207\u8eab\u5206\u8b49\u5b57\u865f\naccount = MasterlinkAccount()\n</code></pre> <p>\u5373\u53ef\u5b8c\u6210\u8a2d\u5b9a\uff01</p> <p>\u8acb\u53c3\u8003\u5bcc\u90a6\u8b49\u5238\u7684\u6559\u5b78 \u4f86\u7372\u53d6\u6191\u8b49\uff0c\u4e26\u4e14\u5c07\u6191\u8b49\u653e\u5728\u76f8\u5c0d\u61c9\u7684\u8def\u5f91\u4e4b\u4e2d\uff0c\u4e26\u4e14\u5b89\u88dd\u76f8\u5c0d\u61c9\u7684\u5957\u4ef6\u5f8c\uff0c\u5373\u53ef\u57f7\u884c\uff1a</p> <pre><code>import os\nfrom fubon_account import FubonAccount\n# \u8a2d\u5b9a\u74b0\u5883\u8b8a\u6578\nimport os\nos.environ['FUBON_NATIONAL_ID'] = \"A123456789\"\nos.environ['FUBON_ACCOUNT_PASS'] = \"your_password\"\nos.environ['FUBON_CERT_PATH'] = \"/path/to/cert.pfx\"\naccount = FubonAccount()\n</code></pre> <p>\u5373\u53ef\u5b8c\u6210\u8a2d\u5b9a\uff01</p>"},{"location":"details/order_api2/#_7","title":"\u6279\u6b21\u4e0b\u55ae\uff0c\u8207\u80a1\u7968\u5e33\u6236\u540c\u6b65\uff1a","text":"\u6a21\u64ec\u4e0b\u55ae\u6700\u65b0\u50f9\u683c\u4e0b\u55ae\u5e02\u50f9\u55ae\u4ee5\u512a\u52e2 1\uff05 \u9650\u50f9\u4e0b\u55ae\u6bd4\u52a3\u52e2 1% \u9650\u50f9\u639b\u55ae <pre><code># \u4e0d\u6703\u771f\u7684\u4e0b\u55ae\uff0c\u6a21\u64ec\u800c\u5df2\npm.sync(account, view_only=True)\n</code></pre> <pre><code># \u9810\u8a2d\u4f7f\u7528\u6700\u8fd1\u4e00\u7b46\u6210\u4ea4\u50f9\u7576\u6210\u9650\u50f9\npm.sync(account)\n</code></pre> <pre><code># \u6f32\u505c\u8cb7\u5165\uff0c\u8dcc\u505c\u8ce3\u51fa\uff0c\u91dd\u5c0d\u6d41\u52d5\u6027\u9ad8\u7684\u500b\u80a1\u8f03\u9069\u5408\npm.sync(account, market_order=True)\n</code></pre> <pre><code># \u4ee5\u512a\u52e2 1\uff05 \u9650\u50f9\u4e0b\u55ae (\u8f03\u5bb9\u6613\u6210\u4ea4)\npm.sync(account, extra_bid_pct=0.01)\n</code></pre> <pre><code># \u6bd4\u52a3\u52e2 1% \u9650\u50f9\u639b\u55ae(\u8f03\u4e0d\u5bb9\u6613\u6210\u4ea4)\npm.sync(account, extra_bid_pct=-0.01)\n</code></pre>"},{"location":"details/order_api2/#_8","title":"\u5176\u4ed6\u64cd\u4f5c","text":""},{"location":"details/order_api2/#_9","title":"\u66f4\u65b0\u9650\u50f9","text":"<pre><code>order_executor = pm.create_order_executor(account)\norder_executor.update_order_price()\n</code></pre>"},{"location":"details/order_api2/#_10","title":"\u522a\u9664\u6240\u6709\u59d4\u8a17\u55ae","text":"<pre><code>order_executor.cancel_orders()\n</code></pre> <p>\u82e5\u4e0b\u55ae\u90e8\u4f4d\u542b\u6709\u300c \u5168\u984d\u4ea4\u5272\u80a1\u300d\u3001\u300c\u8655\u7f6e\u80a1\u300d\u3001\u300c\u8b66\u793a\u80a1\u300d\uff0c\u9700\u5148\u65bc\u8b49\u5238\u5e33\u6236\u5708\u5b58\u3002\u53c3\u8003\u5bcc\u679c\u5708\u5b58\u3001\u6c38\u8c50\u5708\u5b58\u65b9\u5f0f\u3002</p>"},{"location":"details/strategy_dashboard/","title":"Strategy dashboard","text":""},{"location":"details/strategy_dashboard/#_1","title":"\u7b56\u7565\u6aa2\u8996","text":"<p>FinLab\u7684\u91cf\u5316\u5e73\u53f0\u63d0\u4f9b\u4f60\u7b56\u7565\u7ba1\u7406\u9801\u9762\uff0c\u53ef\u4ee5\u4e00\u76ee\u77ad\u7136\u7b56\u7565\u6578\u64da\u52d5\u614b\uff01</p> <p></p>"},{"location":"details/strategy_dashboard/#_2","title":"\u90e8\u7f72\u7b56\u7565","text":"<p>\u7b56\u7565\u7a0b\u5f0f\u78bc\u82e5\u662f\u5f9e colab \u6216 \u672c\u6a5f Python \u4e0a\u50b3\uff0c\u82e5\u8981\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u7b56\u7565\uff0c\u9032\u884c\u4ee5\u4e0b\u6b65\u9a5f\u5f8c\u5c31\u53ef\u4ee5\u6bcf\u5929\u8ffd\u8e64\u7b56\u7565\u6700\u65b0\u52d5\u614b\u3002</p>"},{"location":"details/strategy_dashboard/#_3","title":"\u9ede\u9078\u7b56\u7565","text":""},{"location":"details/strategy_dashboard/#_4","title":"\u7de8\u8f2f\u7b56\u7565","text":""},{"location":"details/strategy_dashboard/#_5","title":"\u8cbc\u4e0a\u7b56\u7565\u7a0b\u5f0f\u78bc","text":"<p>\u5c07\u7a0b\u5f0f\u78bc\u8cbc\u81f3\u7a0b\u5f0f\u7de8\u8f2f\u5340\u3002</p> <p></p>"},{"location":"details/strategy_dashboard/#_6","title":"\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u7b56\u7565","text":"<p>\u9ede\u9078\u53f3\u4e0a\"\u8a2d\u5b9a\u81ea\u52d5\u66f4\u65b0\u7b56\u7565\"\u6309\u9215\uff0c\u8a2d\u5b9a\u9700\u8981\u6bcf\u65e5\u81ea\u52d5\u66f4\u65b0\u6e05\u55ae\u8207\u56de\u6e2c\u7684\u7b56\u7565\uff0c\u9078\u53d6\u7b56\u7565\u540d\u7a31\u8207\u66f4\u65b0\u6642\u9593\uff0c\u76ee\u524d\u6bcf\u500b\u5e33\u865f\u9650\u5b9a3\u9805\u7b56\u7565\u53ef\u81ea\u52d5\u66f4\u65b0\u3002 </p>"},{"location":"details/strategy_dashboard/#_7","title":"\u5206\u4eab\u7b56\u7565","text":"<p>\u9032\u5165\u7b56\u7565\u7db2\u5740\u7684\u5206\u4eab\u6b0a\u9650\u8a2d\u5b9a\uff0c\u672a\u8a2d\u5b9a\u516c\u958b\u524d\uff0c\u53ea\u6709\u5e33\u6236\u672c\u4eba\u624d\u80fd\u770b\u5230\u81ea\u5df1\u7684\u7b56\u7565\u3002 \u82e5\u60f3\u5206\u4eab\u7b56\u7565\u6e05\u55ae\u8207\u76f8\u95dc\u7a0b\u5f0f\uff0c\u6b0a\u9650\u53ef\u4ee5\u9078\u64c7\"\u96b1\u85cf\"\u4e4b\u5916\u7684\u9078\u9805\u3002 \u78ba\u8a8d\u8a2d\u5b9a\u5f8c\uff0c\u5373\u53ef\u5206\u4eab\u7b56\u7565\u7684\u7db2\u5740\u7d66\u5176\u4ed6\u4eba\u53c3\u8003\u3002</p> <p></p>"},{"location":"details/strategy_dashboard/#_8","title":"\u5132\u5b58\u7b56\u7565","text":"<p>\u6240\u6709\u8a2d\u5b9a\u7d50\u675f\u5f8c\uff0c\u8a18\u5f97\u9ede\u9078\"\u5132\u5b58\"\u6309\u9215\uff0c\u65b9\u80fd\u5132\u5b58\u524d\u9762\u7684\u8a2d\u5b9a\u7d50\u679c\u5594\uff01 </p>"},{"location":"details/strategy_dashboard/#_9","title":"\u91cd\u65b0\u547d\u540d\u7b56\u7565","text":"<p>\u82e5\u9700\u8981\u66f4\u65b0\u7b56\u7565\u540d\u5403\u7a31\uff0c\u53ef\u7167\u5716\u4e2d\u9ede\u9078\u4e26\u8f38\u5165\u65b0\u540d\u7a31\u3002 </p>"},{"location":"details/strategy_dashboard/#_10","title":"\u522a\u9664\u7b56\u7565","text":"<p>\u82e5\u60f3\u522a\u6389\u5100\u9336\u677f\u4e0a\u7684\u7b56\u7565\uff0c\u9ede\u9078\u7b56\u7565\u53f3\u5074\u9f52\u8f2a\u7b26\u865f (\u4e0b\u5716\u7d05\u5708\u8655)\uff0c\u5373\u53ef\u522a\u9664\u3002</p> <p></p>"},{"location":"details/tech_ind/","title":"\u6307\u6a19","text":"<p>FinLab \u652f\u63f4 talib \u548c pandas_ta \u4e0a\u767e\u7a2e\u6280\u8853\u6307\u6a19\uff01\u53ea\u9700\u8981\u4e00\u884c\uff0c\u5e6b\u4f60\u7b97\u51fa2000\u6a94\u80a1\u7968\u300110\u5e74\u7684\u6240\u6709\u8cc7\u8a0a\uff01\u53ef\u4ee5\u7528\u65bc\u500b\u80a1\u5206\u6790\u3001\u6a5f\u5668\u5b78\u7fd2\uff0c\u7528\u6cd5\u975e\u5e38\u7c21\u55ae\uff0c\u529f\u80fd\u975e\u5e38\u5f37\u5927\uff01</p>"},{"location":"details/tech_ind/#ta-lib","title":"\u5b89\u88ddta-lib","text":"<p>\u5728\u8a08\u7b97\u6280\u8853\u6307\u6a19\u524d\uff0c\u5fc5\u9700\u8981\u5148\u5b89\u88dd talib \u5957\u4ef6\uff0c</p> <ul> <li>\u672c\u5730\u7aef\uff1a\u53ef\u4ee5\u53c3\u8003 \u5b98\u65b9\u5b89\u88dd\u6559\u5b78 \u4f86\u5b89\u88dd\uff0c\u652f\u63f4 Windows\u3001MacOS\u3001Linux\u3002</li> <li>Google Colab\uff1a\u8acb\u904b\u884c\u4ee5\u4e0b\u6307\u4ee4\u5373\u53ef\uff1a <pre><code>!pip install ta-lib-bin\n</code></pre></li> </ul> <p>\u5efa\u8b70\u4f7f\u7528\u8005\u53ef\u4ee5\u5148\u53c3\u8003\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u4e26\u4e14\u642d\u914d talib\u5b98\u65b9\u6587\u4ef6\uff0c\u5c31\u53ef\u4ee5\u638c\u63e1\u88fd\u4f5c\u6280\u8853\u6307\u6a19\u7684\u65b9\u6cd5\u4e86\u3002</p>"},{"location":"details/tech_ind/#rsi","title":"\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI \u6578\u503c","text":"<p>\u4f7f\u7528 finlab \u5957\u4ef6\u8a08\u7b97 RSI\uff1a\u4f7f\u7528 data.indicator() \u51fd\u5f0f\u8a08\u7b97 RSI\uff0c\u9700\u6307\u5b9a timeperiod \u53c3\u6578\u70ba 14\uff0c\u4ee3\u8868\u4f7f\u7528 14 \u5929\u7684\u8cc7\u6599\u4f86\u8a08\u7b97 RSI\u3002\u8a08\u7b97\u5b8c\u7562\u5f8c\uff0c\u6703\u56de\u50b3\u4e00\u500b DataFrame \u7269\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6240\u6709\u80a1\u7968\u7684 RSI \u6578\u503c\u3002</p> <pre><code>from finlab import data\ndata.indicator('RSI', timeperiod=14)\n</code></pre> <p></p> <p>\u4e0a\u5716\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u8cc7\u6599\u5305\u542b <code>NaN</code> \uff0c\u4ee3\u8868\u8cc7\u6599\u7b46\u6578\u4e0d\u8db3\uff0c\u7121\u6cd5\u8a08\u7b97\u51fa\u6578\u503c\uff0c\u6bcf\u4e00\u6a94\u80a1\u7968\u9664\u4e86\u525b\u958b\u59cb\u7684 14 \u5929\u5916\uff0c\u5e7e\u4e4e\u90fd\u6703\u6709\u6578\u503c\u3002</p>"},{"location":"details/tech_ind/#kd","title":"\u5169\u500b\u6642\u9593\u5e8f\u5217\u7684\u6280\u8853\u6307\u6a19\uff08KD\u503c\uff09","text":"<p>\u4f7f\u7528 finlab \u5957\u4ef6\u8a08\u7b97 KD \u503c\uff1a\u4f7f\u7528 data.indicator() \u51fd\u5f0f\u8a08\u7b97 KD \u503c\uff0c\u9810\u8a2d timeperiod \u70ba 9\uff0cslowk_period \u70ba 3\uff0cslowd_period \u70ba 3\uff0c\u4f7f\u7528\u7684\u662f\u4e09\u500d\u5e73\u6ed1\u79fb\u52d5\u5e73\u5747\u7dda\u4f86\u8a08\u7b97 K \u503c\u548c D \u503c\u3002\u8a08\u7b97\u5b8c\u7562\u5f8c\uff0c\u6703\u56de\u50b3\u5169\u500b DataFrame \u7269\u4ef6\uff0c\u5206\u5225\u4ee3\u8868\u6240\u6709\u80a1\u7968\u7684 K \u503c\u548c D \u503c\u3002</p> <pre><code>from finlab import data\nk, d = data.indicator('STOCH')\nk\n</code></pre> <p></p>"},{"location":"details/tech_ind/#kd_1","title":"\u5229\u7528 KD \u503c\u4f86\u9078\u80a1","text":"<p>\u5ef6\u7e8c\u4e0a\u8ff0\u7684\u7bc4\u4f8b\u4e8c\uff0c\u5047\u5982\u6211\u5011\u5e0c\u671b\u5c07\u6700\u8fd1\u4e00\u5929 K &gt; D \u503c\u7684\u80a1\u7968\u6e05\u55ae\u5217\u51fa\u4f86\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8a9e\u6cd5 <pre><code>(k &gt; d).iloc[-1]\n</code></pre> <pre><code>0015    False\n0050     True\n0051    False\n0052     True\n0053     True\n...  \n9951     True\n9955    False\n9958    False\n9960     True\n9962     True\nName: 2021-07-13 00:00:00, Length: 2269, dtype: bool\n</code></pre> \u4e0a\u8ff0\u8a9e\u6cd5\u4e2d\uff0c(k &gt; d) \u6703\u56de\u50b3\u4e00\u500b DataFrame \u7269\u4ef6\uff0c\u5176\u4e2d\u6bcf\u500b\u5143\u7d20\u90fd\u662f\u4e00\u500b\u5e03\u6797\u503c\uff0c\u4ee3\u8868\u5c0d\u61c9\u7684\u80a1\u7968\u7576\u524d\u7684 K \u503c\u662f\u5426\u5927\u65bc D \u503c\u3002\u800c .iloc[-1] \u5247\u4ee3\u8868\u53d6\u51fa\u6700\u5f8c\u4e00\u5217\uff0c\u4e5f\u5c31\u662f\u6700\u8fd1\u4e00\u5929\u7684\u8cc7\u6599\u3002\u6700\u5f8c\uff0c\u5c07\u6703\u56de\u50b3\u4e00\u500b\u5e03\u6797\u503c\u5e8f\u5217\uff0c\u5176\u4e2d\u503c\u70ba True \u7684\u80a1\u7968\u4ee3\u8868\u7576\u524d K &gt; D\u3002</p>"},{"location":"details/tech_ind/#pandas_ta","title":"\u8a08\u7b97 Pandas_ta \u6280\u8853\u6307\u6a19","text":"<p>Pandas_ta \u662f\u4e00\u500b Python \u5957\u4ef6\uff0c\u7528\u65bc\u8a08\u7b97\u91d1\u878d\u5e02\u5834\u7684\u6280\u8853\u6307\u6a19\u3002\u9019\u4e9b\u6307\u6a19\u5305\u62ec RSI\u3001MACD\u3001\u5e03\u6797\u901a\u9053\u7b49\u7b49\u3002Pandas_ta \u4ee5 pandas DataFrame \u70ba\u8f38\u5165\uff0c\u4e26\u8fd4\u56de DataFrame \u5305\u542b\u8a08\u7b97\u51fa\u7684\u6280\u8853\u6307\u6a19\u3002Pandas_ta \u7684\u4f7f\u7528\u65b9\u6cd5\u5f88\u7c21\u55ae\uff0c\u53ea\u9700\u5728 Python \u4e2d\u5b89\u88dd\u8a72\u5957\u4ef6\u4e26\u5c0e\u5165\uff0c\u7136\u5f8c\u4f7f\u7528\u8a72\u5957\u4ef6\u63d0\u4f9b\u7684\u51fd\u6578\u5373\u53ef\u8a08\u7b97\u6307\u5b9a\u7684\u6280\u8853\u6307\u6a19\u3002\u5957\u4ef6\u5b89\u88dd\u65b9\u6cd5\u53ca\u6307\u6a19\u9078\u9805\u8acb\u898bPandas_ta\u5b98\u65b9\u6587\u4ef6</p> <p><pre><code>pip install pandas-ta\n</code></pre> \u5728 Finlab \u4e2d\uff0c\u6211\u5011\u5c07 Pandas_ta \u6574\u5408\u5230\u6211\u5011\u7684\u6578\u64da\u5eab\u4e2d\uff0c\u4ee5\u4fbf\u8a08\u7b97\u5927\u91cf\u7684\u80a1\u7968\u7684\u6280\u8853\u6307\u6a19\u3002\u4f7f\u7528\u65b9\u5f0f\u5f88\u7c21\u55ae\uff0c\u53ea\u9700\u8abf\u7528 data.indicator() \u51fd\u6578\uff0c\u4e26\u5c07\u6240\u9700\u7684\u6280\u8853\u6307\u6a19\u540d\u7a31\u50b3\u905e\u7d66\u8a72\u51fd\u6578\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u8a08\u7b97 supertrend \u6280\u8853\u6307\u6a19\uff0c\u53ea\u9700\u8abf\u7528\u4ee5\u4e0b\u4ee3\u78bc\uff1a</p> <p><pre><code>from finlab import data\nvalues = data.indicator('supertrend')\n</code></pre> \u9019\u500b\u4ee3\u78bc\u6703\u8fd4\u56de\u4e00\u500b\u5305\u542b supertrend \u6307\u6a19\u6578\u503c\u7684 DataFrame\uff0c\u8a72 DataFrame \u5305\u542b\u591a\u500b\u80a1\u7968\u7684\u6578\u503c\uff0c\u6bcf\u500b\u80a1\u7968\u4e00\u5217\u3002<code>data.indicator</code> \u5c07\u512a\u5148\u4f7f\u7528 TaLib \u4e2d\u7684\u51fd\u6578\u8a08\u7b97\u6280\u8853\u6307\u6a19\u3002\u5982\u679c TaLib \u4e2d\u6c92\u6709\u5c0d\u61c9\u7684\u51fd\u6578\uff0c\u5247 Pandas_ta \u6703\u88ab\u7528\u4f86\u8a08\u7b97\u6307\u6a19\u3002\u5118\u7ba1 Pandas_ta \u975e\u5e38\u5f37\u5927\uff0c\u4f46\u5b83\u7684\u8a08\u7b97\u901f\u5ea6\u53ef\u80fd\u6703\u6bd4 TaLib \u6162\uff0c\u6240\u4ee5\u5728\u8a08\u7b97\u8a31\u591a\u80a1\u7968\u7684\u6307\u6a19\u6642\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u8010\u5fc3\u7b49\u5f85\u3002</p>"},{"location":"reference/analysis/","title":"finlab.analysis","text":"<p>\u5047\u5982\u5e0c\u671b\u958b\u767c\u4ea4\u6613\u5206\u6790\u7cfb\u7d71\uff0c\u53ef\u4ee5\u7e7c\u627f <code>finlab.analysis.Analysis</code> \u4f86\u5be6\u505a\u5206\u6790\u3002 </p>"},{"location":"reference/analysis/#finlab.analysis.liquidityAnalysis.LiquidityAnalysis","title":"finlab.analysis.liquidityAnalysis.LiquidityAnalysis","text":"<pre><code>LiquidityAnalysis(required_volume=200000, required_turnover=1000000)\n</code></pre> <p>             Bases: <code>Analysis</code></p> <p>\u5206\u6790\u53f0\u80a1\u7b56\u7565\u6d41\u52d5\u6027\u98a8\u96aa\u9805\u76ee\u7684\u6a5f\u7387</p> <p>Note</p> <p>\u53c3\u8003VIP\u9650\u5b9a\u6587\u7ae0\u66f4\u4e86\u89e3\u6d41\u52d5\u6027\u6aa2\u6e2c\u5167\u5bb9\u7d30\u7bc0\u3002</p> <p>Args:     required_volume (int): \u8981\u6c42\u9032\u51fa\u5834\u6642\u7684\u55ae\u65e5\u6210\u4ea4\u80a1\u6578\u81f3\u5c11\u8981\u591a\u5c11\uff1f     required_turnover (int): \u8981\u6c42\u9032\u51fa\u5834\u6642\u7684\u55ae\u65e5\u6210\u4ea4\u91d1\u984d\u81f3\u5c11\u8981\u591a\u5c11\u5143\uff1f\u907f\u514d\u6210\u4ea4\u80a1\u6578\u5920\uff0c\u4f46\u56e0\u4f4e\u50f9\u80a1\u56e0\u7d20\uff0c\u9020\u6210\u80c3\u7d0d\u91cf\u4ecd\u7121\u6cd5\u7b26\u5408\u8cc7\u91d1\u9700\u6c42\u3002</p> <p>Examples:</p> <pre><code># better syntax\nreport.run_analysis('LiquidityAnalysis', required_volume=100000)\n# original syntax\nfrom finlab.analysis.liquidityAnalysis import LiquidityAnalysis\nreport.run_analysis(LiquidityAnalysis(required_volume=100000))\n</code></pre>"},{"location":"reference/analysis/#finlab.analysis.inequalityAnalysis.InequalityAnalysis","title":"finlab.analysis.inequalityAnalysis.InequalityAnalysis","text":"<pre><code>InequalityAnalysis(name, df=None, date_type='entry_sig_date', target='return')\n</code></pre> <p>             Bases: <code>Analysis</code></p> <p>Analyze return of trades with condition inequality</p> PARAMETER  DESCRIPTION <code>name</code> <p>name of the condition</p> <p> TYPE: <code>str</code> </p> <code>df</code> <p>value used in condition. If df is None, <code>data.get(name)</code> will be automatically perform to fetch the values.</p> <p> TYPE: <code>DataFrame or None</code> DEFAULT: <code>None</code> </p> <code>date_type</code> <p>can be either <code>entry_date</code>, <code>entry_sig_date</code>, <code>exit_date</code>, <code>exit_sig_date</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'entry_sig_date'</code> </p> <code>target</code> <p>the target to optimize. Any column name in report.get_trades()</p> <p> TYPE: <code>str</code> DEFAULT: <code>'return'</code> </p> <p>Examples:</p> <pre><code>report.run_analysis('InequalityAnalysis', name='price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\n</code></pre>"},{"location":"reference/analysis/#finlab.analysis.periodStatsAnalysis.PeriodStatsAnalysis","title":"finlab.analysis.periodStatsAnalysis.PeriodStatsAnalysis","text":"<pre><code>PeriodStatsAnalysis()\n</code></pre> <p>             Bases: <code>Analysis</code></p> <p>\u5206\u6790\u53f0\u80a1\u7b56\u7565\u7684\u4e0d\u540c\u6642\u671f\u8207\u5927\u76e4\u6307\u6a19\u4f5c\u6bd4\u8f03</p> <p>Examples:</p> <p>\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\u4f86\u7522\u751f\u5206\u6790\u7d50\u679c\uff1a</p> <pre><code>report.run_analysis('PeriodStatsAnalysis')\n</code></pre> <p>\u7522\u751f\u7684\u7d50\u679c\uff1a</p> benchmark strategy ('overall_daily', 'calmar_ratio') 0.149192 0.0655645 ('overall_daily', 'sortino_ratio') 0.677986 0.447837 ('overall_daily', 'sharpe_ratio') 0.532014 0.306351 ('overall_daily', 'profit_factor') 1.20022 1.07741 ('overall_daily', 'tail_ratio') 0.914881 0.987751 ('overall_daily', 'return') 0.0835801 0.0478957 ('overall_daily', 'volatility') 0.182167 0.312543 ('overall_monthly', 'calmar_ratio') 0.155321 0.0731378 ('overall_monthly', 'sortino_ratio') 0.697382 0.439003 ('overall_monthly', 'sharpe_ratio') 0.524943 0.307292 ('overall_monthly', 'profit_factor') 1.75714 1.27059 ('overall_monthly', 'tail_ratio') 1.03322 0.903335 ('overall_monthly', 'return') 0.0836545 0.0479377 ('overall_monthly', 'volatility') 0.186989 0.316178 ('overall_yearly', 'calmar_ratio') 0.436075 0.127784 ('overall_yearly', 'sortino_ratio') 0.738327 0.694786 ('overall_yearly', 'sharpe_ratio') 0.407324 0.350986 ('overall_yearly', 'profit_factor') 2.2 1.66667 ('overall_yearly', 'tail_ratio') 1.71647 1.359 ('overall_yearly', 'return') 0.0814469 0.0663674 ('overall_yearly', 'volatility') 0.284742 0.419087"},{"location":"reference/analysis/#finlab.analysis.Analysis","title":"finlab.analysis.Analysis","text":"<p>             Bases: <code>ABC</code></p>"},{"location":"reference/analysis/#finlab.analysis.Analysis.analyze","title":"analyze","text":"<pre><code>analyze(report)\n</code></pre> <p>Analyze trading report.</p> <p>One could assume self.caluclate_trade_info will be executed before self.analyze, so the <code>report.get_trades()</code> will contain the required trade info.</p>"},{"location":"reference/analysis/#finlab.analysis.Analysis.calculate_trade_info","title":"calculate_trade_info","text":"<pre><code>calculate_trade_info(report)\n</code></pre> <p>Additional trade info can be calculated easily.</p> <p>User could override this function if additional trade info is required for later anlaysis.</p> <p>Examples:</p> <pre><code>from finlab.analysis import Analysis\nclass SomeAnalysis(Analysis):\ndef calculate_trade_info(self, report):\nreturn [\n['\u80a1\u50f9\u6de8\u503c\u6bd4', data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4'), 'entry_sig_date']\n]\nreport.run_analysis(SomeAnalysis())\ntrades = report.get_trades()\nassert '\u80a1\u50f9\u6de8\u503c\u6bd4@entry_sig_date' in trades.columns\nprint(trades)\n</code></pre>"},{"location":"reference/analysis/#finlab.analysis.Analysis.display","title":"display","text":"<pre><code>display()\n</code></pre> <p>Display result</p> <p>When implement this function, returning Plotly figure instance is recommended.</p>"},{"location":"reference/analysis/#finlab.analysis.Analysis.is_market_supported","title":"is_market_supported","text":"<pre><code>is_market_supported(market)\n</code></pre> <p>Check if market info is supported</p> RETURNS DESCRIPTION <code>bool</code> <p>True, support. False not support.</p>"},{"location":"reference/backtest/","title":"finlab.backtest","text":""},{"location":"reference/backtest/#finlab.backtest.sim","title":"finlab.backtest.sim","text":"<pre><code>sim(position, resample=None, resample_offset=None, trade_at_price='close', position_limit=1, fee_ratio=1.425 / 1000, tax_ratio=3 / 1000, name='\u672a\u547d\u540d', stop_loss=None, take_profit=None, trail_stop=None, touched_exit=False, retain_cost_when_rebalance=False, stop_trading_next_period=True, live_performance_start=None, mae_mfe_window=0, mae_mfe_window_step=1, market=None, upload=True, fast_mode=False, notification_enable=False, line_access_token='')\n</code></pre> <p>Simulate the equity given the stock position history. \u56de\u6e2c\u6a21\u64ec\u80a1\u7968\u90e8\u4f4d\u6240\u7522\u751f\u7684\u6de8\u503c\u5831\u916c\u7387\u3002</p> PARAMETER  DESCRIPTION <code>position</code> <p>\u8cb7\u8ce3\u8a0a\u865f\u7d00\u9304\u3002True \u70ba\u6301\u6709\uff0c False \u70ba\u7a7a\u624b\u3002 \u82e5\u9078\u64c7\u505a\u7a7aposition\uff0c\u53ea\u8981\u5c07 sim(position) \u6539\u6210\u8ca0\u7684 sim(-position.astype(float))\u5373\u53ef\u505a\u7a7a\u3002</p> <p> TYPE: <code>DataFrame or Series</code> </p> <code>resample</code> <p>\u4ea4\u6613\u9031\u671f\u3002\u5c07 position \u7684\u8a0a\u865f\u4ee5\u9031\u671f\u6027\u7684\u65b9\u5f0f\u8ad6\u52d5\u80a1\u7968\uff0c\u9810\u8a2d\u70ba\u6bcf\u5929\u63db\u80a1\u3002\u5176\u4ed6\u5e38\u7528\u6578\u503c\u70ba W\u3001 M \u3001 Q \uff08\u6bcf\u9031\u3001\u6bcf\u6708\u3001\u6bcf\u5b63\u63db\u80a1\u4e00\u6b21\uff09\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 W-Fri \u5728\u9031\u4e94\u7684\u6642\u5019\u7522\u751f\u65b0\u7684\u80a1\u7968\u6e05\u55ae\uff0c\u4e26\u4e14\u65bc\u4e0b\u9031\u4ea4\u6613\u65e5\u4e0b\u55ae\u3002</p> <ul> <li><code>D</code>: Daily</li> <li><code>W</code>: Weekly</li> <li><code>W-Wed</code>: Every Wednesday</li> <li><code>M</code>: Monthly</li> <li><code>MS</code>: Start of every month</li> <li><code>Q</code>: Quarterly</li> <li><code>QS</code>: Start of every quarter</li> </ul> <p>Note</p> <p>'D'\u8207'None'\u7684\u5dee\u5225\uff1f resample='D' \u7684\u610f\u7fa9\u70ba\u6bcf\u5929\u96a8\u80a1\u50f9\u8b8a\u5316\u505a\u518d\u5e73\u8861\uff0c\u5c31\u7b97\u7576\u5929\u80a1\u7968\u6e05\u55ae\u6c92\u8b8a\uff0c\u4f46\u80a1\u7968\u6f32\u8dcc\u5f8c\uff0c\u90e8\u4f4d\u5927\u5c0f\u6703\u8b8a\u5316\uff0c\u800c resample='D' \u6703\u5f37\u5236\u518d\u5e73\u8861\uff0c\u5e73\u5747\u5206\u6563\u98a8\u96aa\u3002</p> <p>\u4f46\u662f\u7576 resample=None \u7684\u8a71\uff0c\u5047\u5982\u6e05\u55ae\u4e0d\u8b8a\uff0c\u5247\u4e0d\u6703\u5f37\u5236\u518d\u5e73\u8861\uff0c\u53ea\u6709\u6e05\u55ae\u6539\u8b8a\u6642\uff0c\u624d\u505a\u518d\u5e73\u8861\u3002\u9069\u7528\u60c5\u5883\u5728\u8f03\u5e38\u9078\u5230\u5927\u6ce2\u6bb5\u6a19\u7684\u7684\u8da8\u52e2\u7b56\u7565\uff0c\u8f03\u6709\u6a5f\u6703\u5c07\u5f37\u52e2\u80a1\u7559\u4e0b\uff0c\u800c\u4e0d\u6703\u6c70\u5f37\u7559\u5f31\u505a\u518d\u5e73\u8861\u3002</p> <p>\u53e6\u5916 <code>resample</code> \u4e5f\u63a5\u53d7 pd.DataFrame \u4ee5\u53ca pd.Series\uff0c\u4e26\u4e14\u5c07\u5176 index \u7528\u4f86\u7576\u6210\u63db\u80a1\u7684\u6642\u9593\u9ede\uff0c\u4f8b\u5982\u4ee5\u4e0b\u7684\u7bc4\u4f8b\uff1a</p> <pre><code>from finlab import backtest, data\nrev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\nposition = ...\n# \u6708\u71df\u6536\u767c\u5e03\u6642\u624d\u63db\u80a1\nbacktest.sim(position, resample=rev)\n</code></pre> <p> TYPE: <code>(str, None, DataFrame, Series, FinlabDataFrame)</code> DEFAULT: <code>None</code> </p> <code>resample_offset</code> <p>\u4ea4\u6613\u9031\u671f\u7684\u6642\u9593\u4f4d\u79fb\uff0c\u4f8b\u5982\u3002</p> <ul> <li>'1D': \u4f4d\u79fb\u4e00\u5929</li> <li>'1H': \u4f4d\u79fb\u4e00\u5c0f\u6642</li> </ul> <p> TYPE: <code>str or None</code> DEFAULT: <code>None</code> </p> <code>trade_at_price</code> <p>\u9078\u64c7\u56de\u6e2c\u4e4b\u9084\u539f\u80a1\u50f9\u4ee5\u6536\u76e4\u50f9\u6216\u958b\u76e4\u50f9\u8a08\u7b97\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078'close'\u3001'open'\u3001'open_close_avg'\u3001'high_low_avg'\u6216 'price_avg'\u3002</p> <p> TYPE: <code>str or DataFrame</code> DEFAULT: <code>'close'</code> </p> <code>position_limit</code> <p>maximum amount of investing a stock. \u55ae\u6a94\u6a19\u7684\u6301\u80a1\u6bd4\u4f8b\u4e0a\u9650\uff0c\u63a7\u5236\u5009\u4f4d\u98a8\u96aa\u3002\u9810\u8a2d\u70baNone\u3002\u7bc4\u4f8b\uff1a0.2\uff0c\u4ee3\u8868\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u6709 20 % \u90e8\u4f4d\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>1</code> </p> <code>fee_ratio</code> <p>fee ratio of buying or selling a stock. \u4ea4\u6613\u624b\u7e8c\u8cbb\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u7121\u6253\u6298\u624b\u7e8c\u8cbb 0.001425\u3002\u53ef\u8996\u500b\u4eba\u4f7f\u7528\u7684\u5238\u5546\u512a\u60e0\u8abf\u6574\u8cbb\u7387\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>1.425 / 1000</code> </p> <code>tax_ratio</code> <p>tax ratio of selling a stock. \u4ea4\u6613\u7a05\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u666e\u901a\u80a1\u4e00\u822c\u4ea4\u6613\u4ea4\u6613\u7a05\u7387 0.003\u3002\u82e5\u4ea4\u6613\u7b56\u7565\u7684\u6a19\u7684\u7686\u70baETF\uff0c\u8a18\u5f97\u8a2d\u6210 0.001\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>3 / 1000</code> </p> <code>name</code> <p>name of the strategy. \u7b56\u7565\u540d\u7a31\uff0c\u9810\u8a2d\u70ba \u672a\u6307\u540d\u3002\u7b56\u7565\u540d\u7a31\u3002\u76f8\u540c\u540d\u7a31\u4e4b\u7b56\u7565\u4e0a\u50b3\u6703\u8986\u5beb\u3002\u547d\u540d\u898f\u5247:\u5168\u82f1\u6587\u6216\u958b\u982d\u4e2d\u6587\uff0c\u4e0d\u63a5\u53d7\u958b\u982d\u82f1\u6587\u63a5\u4e2d\u6587\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'\u672a\u547d\u540d'</code> </p> <code>stop_loss</code> <p>\u505c\u640d\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u640d\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u5f9e\u518d\u5e73\u8861\u958b\u59cb\uff0c\u8667\u640d 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>None</code> </p> <code>take_profit</code> <p>\u505c\u5229\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u505c\u5229\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u5f9e\u518d\u5e73\u8861\u958b\u59cb\uff0c 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>None</code> </p> <code>trail_stop</code> <p>\u79fb\u52d5\u505c\u640d\u505c\u5229\u57fa\u6e96\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u57f7\u884c\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u5f9e\u6700\u9ad8\u9ede\u958b\u59cb\u4e0b\u8dcc\uff0c\u8dcc\u81f3 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>None</code> </p> <code>touched_exit</code> <p>\u662f\u5426\u5728\u56de\u6e2c\u6642\uff0c\u4f7f\u7528\u89f8\u50f9\u505c\u640d\u505c\u5229\uff1f\u9810\u8a2d\u70ba False\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>retain_cost_when_rebalance</code> <p>\u7576\u6301\u80a1\u518d\u5e73\u8861\u6642\uff0c\u5982\u6709\u80a1\u7968\u7e7c\u7e8c\u6301\u6709\uff0c\u662f\u5426\u4fdd\u7559\u539f\u672c\u9032\u5834\u7684\u6210\u672c\uff0c\u7576\u6210\u505c\u640d\u505c\u5229\u7684\u53c3\u8003\uff1f\u9810\u8a2d\u70ba False\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>stop_trading_next_period</code> <p>\u7576\u671f\u5df2\u7d93\u505c\u640d\u505c\u5229\uff0c\u5247\u4e0b\u4e00\u671f\u4e0d\u8cb7\u5165\uff0c\u9810\u8a2d\u70ba True\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <code>live_performance_start</code> <p>\u7b56\u7565\u5efa\u69cb\u7684\u65e5\u671f\uff0c\u4f8b\u5982 <code>2022-01-01</code> \u6b64\u65e5\u671f\u4e4b\u524d\uff0c\u7b56\u7565\u672a\u64b0\u5beb\uff0c\u6b64\u65e5\u671f\u4e4b\u5f8c\u5247\u8996\u70ba\u8207\u5be6\u55ae\u6709\u985e\u4f3c\u6548\u679c\uff0c\u5be6\u969b\u4e0d\u5f71\u97ff\u56de\u6e2c\u7684\u7d50\u679c\uff0c\u55ae\u7d14\u7d00\u9304\u800c\u5df2\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>mae_mfe_window</code> <p>\u8a08\u7b97mae_mfe\u65bc\u9032\u5834\u5f8c\u65bc\u4e0d\u540c\u6301\u6709\u5929\u6578\u4e0b\u7684\u6578\u64da\u8b8a\u5316\uff0c\u4e3b\u8981\u61c9\u7528\u70baedge_ratio (\u512a\u52e2\u6bd4\u7387)\u8a08\u7b97\u3002\u9810\u8a2d\u70ba0\uff0c\u5247Report.display_mae_mfe_analysis(...)\u4e2d\u7684edge_ratio\u4e0d\u6703\u986f\u73fe\u3002</p> <p> TYPE: <code>int</code> DEFAULT: <code>0</code> </p> <code>mae_mfe_window_step</code> <p>\u8207mae_mfe_window\u53c3\u6578\u505a\u642d\u914d\uff0c\u70ba\u6642\u9593\u9593\u9694\u8a2d\u5b9a\uff0c\u9810\u8a2d\u70ba1\u3002\u82e5mae_mfe_window\u8a2d20\uff0cmae_mfe_window_step\u8a2d\u5b9a\u70ba2\uff0c\u76f8\u7576\u65bcpython\u7684range(0,20,2)\uff0c\u4ee52\u65e5\u70ba\u9593\u8ddd\u8a08\u7b97mae_mfe\u3002</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>market</code> <p>\u53ef\u9078\u64c7<code>'TW_STOCK', 'US_STOCK'</code>\uff0c\u5206\u5225\u70ba\u53f0\u80a1\u6216\u52a0\u5bc6\u8ca8\u5e63\uff0c \u6216\u7e7c\u627f finlab.market.Market \u958b\u767c\u56de\u6e2c\u5e02\u5834\u985e\u5225\u3002</p> <p> TYPE: <code>str or Market</code> DEFAULT: <code>None</code> </p> <code>upload</code> <p>\u4e0a\u50b3\u7b56\u7565\uff0c\u9810\u8a2d\u70baTrue\uff0c\u4e0a\u50b3\u7b56\u7565\u3002 \u7bc4\u4f8b\uff1a False\uff0c\u4e0d\u4e0a\u50b3\uff0c\u53ef\u7528 finlab.backtest.sim(position, upload=False, ...).display() \u5feb\u901f\u6aa2\u8996\u7b56\u7565\u7e3e\u6548\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <code>fast_mode</code> <p>\u9810\u8a2d\u70baFalse\uff0c\u82e5\u8a2d\u5b9a\u70baTrue\uff0c\u5247\u6703\u4f7f\u7528\u5feb\u901f\u6a21\u5f0f\uff0c\u5feb\u901f\u6a21\u5f0f\u6703\u5ffd\u7565\u6240\u6709\u7684\u505c\u5229\u505c\u640d\u8a2d\u5b9a\uff0c\u4e26\u4e14\u53ea\u6709\u63db\u80a1\u65e5\u9032\u884c\u5831\u916c\u7387\u6a21\u64ec\uff0c\u56e0\u6b64\u6703\u6709\u4e00\u4e9b\u8aa4\u5dee\uff0c\u7576\u6301\u6709\u8f03\u591a\u6a94\u80a1\u7968\u6642\uff0c\u53ef\u4ee5\u5927\u5e45\u52a0\u901f\u56de\u6e2c\u901f\u5ea6\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <code>Report</code> <p>\u56de\u6e2c\u6578\u64da\u5831\u544a</p> <p>Examples:</p> <p>Assume the history of portfolio is construct as follows: When market close on 2021-12-31, the portfolio {B: 0.2, C: 0.4} is calculated. When market close on 2022-03-31, the portfolio {A:1} is calculated.</p> Stock 2330 Stock 1101 Stock 2454 2021-12-31 0% 20% 40% 2022-03-31 100% 0% 0% 2022-06-30 100% 0% 0% <p>With the portfolio, one could backtest the equity history as follows:</p> <pre><code>import pandas as pd\nfrom finlab import backtest\nposition = pd.DataFrame({\n'2330': [0, 1, 1],\n'1101': [0.2, 0, 0],\n'2454': [0.4, 0, 0]\n}, index=pd.to_datetime(['2021-12-31', '2022-03-31', '2022-06-30']))\nreport = backtest.sim(position)\n</code></pre>"},{"location":"reference/backtest/#finlab.backtest.line_notify","title":"finlab.backtest.line_notify","text":"<pre><code>line_notify(report=None, line_access_token='', test=False, name='')\n</code></pre> <p>\u50b3\u9001\u56de\u6e2c\u7d50\u679c\u4e4b\u76ee\u524d\u90e8\u4f4d\u3001\u8fd1\u671f\u63db\u80a1\u8a0a\u606f\u81f3Line\u804a\u5929\u5ba4\u3002</p> PARAMETER  DESCRIPTION <code>report</code> <p>\u56de\u6e2c\u5b8c\u7684\u7d50\u679c\u5831\u544a\u3002</p> <p> TYPE: <code>Report</code> DEFAULT: <code>None</code> </p> <code>line_access_token</code> <p>\u65bcLine Notify\u53d6\u5f97\u7684access_token(\u6b0a\u6756)\u3002\u81f3Line Notify\u767b\u5165Line\u5e33\u865f\u5f8c\uff0c\u9ede\u9078\u500b\u4eba\u9801\u9762\uff0c\u9ede\u9078\u300c\u767c\u884c\u6b0a\u6756\u300d\uff0c\u9078\u64c7\u6b32\u63a5\u6536\u8a0a\u606f\u7684\u804a\u5929\u5ba4(\u53ef\u9078\u64c71\u5c0d1\u63a5\u6536Line Notify\u901a\u77e5\u3001\u6216\u662f\u9078\u64c7\u5176\u4ed6\u7fa4\u7d44\u804a\u5929\u5ba4)\uff0c\u5373\u53ef\u53d6\u5f97\u6b0a\u6756\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>''</code> </p> <code>test</code> <p>\u662f\u5426\u9032\u884c\u50b3\u9001\u8a0a\u606f\u6e2c\u8a66\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>name</code> <p>\u7b56\u7565\u540d\u7a31\uff0c\u9810\u8a2d\u70ba\u7a7a\u5b57\u4e32\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>''</code> </p> <p>Examples:</p> <p>\u6b32\u9032\u884c\u6e2c\u8a66\uff0c\u5247\u8a2d\u5b9a<code>test</code>\u53c3\u6578\u70baTrue\u3002</p> <pre><code>from finlab import backtest\nline_access_token = 'xxxxxxxxxxxx'\nbacktest.line_notify(line_access_token=line_access_token, test=True)\n</code></pre> <p>\u82e5\u6210\u529f\u6536\u5230\u901a\u77e5\uff0c\u5247\u6b0a\u6756\u8a2d\u5b9a\u5df2\u5b8c\u7562\uff0c\u53ef\u76f4\u63a5\u5728<code>sim</code>\u56de\u6e2c\u6a21\u7d44\u4e2d\u958b\u555f\u4f7f\u7528\uff0c\u6216\u55ae\u7368\u8abf\u7528\u6b64\u51fd\u5f0f\u767c\u9001\u56de\u6e2c\u63db\u80a1\u8a0a\u606f\u3002 \u65bcsim\u4e2d\u4f7f\u7528:</p> <pre><code>from finlab import backtest\nline_access_token = 'xxxxxxxxxxxx'\nposition = ...\nreport = backtest.sim(position, notification_enable =True, line_access_token = line_access_token)\n</code></pre> <p>\u5df2\u56de\u6e2c\u5b8c\uff0c\u55ae\u7368\u50b3\u8a0a\u606f\u7528:</p> <pre><code>from finlab import backtest\nline_access_token = 'xxxxxxxxxxxx'\nreport = backtest.sim(position)\nbacktest.line_notify(report, line_access_token=line_access_token)\n</code></pre>"},{"location":"reference/data/","title":"finlab.data","text":""},{"location":"reference/data/#_1","title":"\u5168\u57df\u8b8a\u6578","text":"<p>finlab.data \u6703\u81ea\u884c\u5224\u65b7\u662f\u5426\u4f7f\u7528\u672c\u5730\u7aef\u8cc7\u6599\uff0c\u82e5\u8981\u5f37\u5236\u4f7f\u7528\u96f2\u7aef\u8cc7\u6599\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u4ee5\u4e0b\u8b8a\u6578\uff1a <pre><code>from finlab import data\ndata.force_cloud_download = False\n</code></pre></p> <p>\u82e5\u8981\u5f37\u5236\u4f7f\u7528\u672c\u5730\u7aef\u8cc7\u6599\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u4ee5\u4e0b\u8b8a\u6578\uff1a <pre><code>data.use_local_data_only = False\n</code></pre></p> <p>\u8b80\u53d6\u8cc7\u6599\u6642\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u4ee5\u4e0b\u8b8a\u6578\uff0c\u4f86\u9650\u5236\u8b80\u53d6\u7684\u8cc7\u6599\u7bc4\u570d\uff1a <pre><code>data.truncate_start = '2019-01-01'\ndata.truncate_end = '2020-01-01'\n</code></pre></p>"},{"location":"reference/data/#finlab.data.get","title":"finlab.data.get","text":"<pre><code>get(dataset, save_to_storage=True, force_download=False)\n</code></pre> <p>\u4e0b\u8f09\u6b77\u53f2\u8cc7\u6599</p> <p>\u8acb\u81f3\u6b77\u53f2\u8cc7\u6599\u76ee\u9304 \u4f86\u7372\u5f97\u6240\u6709\u6b77\u53f2\u8cc7\u6599\u7684\u540d\u7a31\uff0c\u5373\u53ef\u4f7f\u7528\u6b64\u51fd\u5f0f\u4f86\u7372\u53d6\u6b77\u53f2\u8cc7\u6599\u3002 \u5047\u8a2d <code>save_to_storage</code> \u70ba <code>True</code> \u5247\uff0c\u7a0b\u5f0f\u6703\u81ea\u52d5\u5728\u672c\u5730\u8907\u88fd\u4e00\u4efd\uff0c\u4ee5\u907f\u514d\u91cd\u8907\u4e0b\u8f09\u5927\u91cf\u6578\u64da\u3002</p> PARAMETER  DESCRIPTION <code>dataset</code> <p>The name of dataset.</p> <p> TYPE: <code>str</code> </p> <code>save_to_storage</code> <p>Whether to save the dataset to storage for later use. Default is True. The argument will be removed in the future. Please use data.set_storage(FileStorage(use_cache=True)) instead.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <code>force_download</code> <p>Whether to force download the dataset from cloud. Default is False.</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>financial data</p> <p>Examples:</p> <p>\u6b32\u4e0b\u8f09\u6240\u6709\u4e0a\u5e02\u4e0a\u6ac3\u4e4b\u6536\u76e4\u50f9\u6b77\u53f2\u8cc7\u6599\uff0c\u53ea\u9700\u8981\u4f7f\u7528\u6b64\u51fd\u5f0f\u5373\u53ef:</p> <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nclose\n</code></pre> date 0015 0050 0051 0052 0053 2007-04-23 9.54 57.85 32.83 38.4 nan 2007-04-24 9.54 58.1 32.99 38.65 nan 2007-04-25 9.52 57.6 32.8 38.59 nan 2007-04-26 9.59 57.7 32.8 38.6 nan 2007-04-27 9.55 57.5 32.72 38.4 nan <p>Note</p> <p>\u4f7f\u7528 <code>data.get</code> \u6642\uff0c\u6703\u9810\u8a2d\u512a\u5148\u4e0b\u8f09\u8fd1\u671f\u8cc7\u6599\uff0c\u4e26\u8207\u672c\u5730\u8cc7\u6599\u5408\u4f75\uff0c\u4ee5\u907f\u514d\u91cd\u8907\u4e0b\u8f09\u5927\u91cf\u6578\u64da\u3002</p> <p>\u5047\u5982\u60f3\u8981\u5f37\u5236\u4e0b\u8f09\u6240\u6709\u8cc7\u6599\uff0c\u53ef\u4ee5\u5728\u4e0b\u8f09\u8cc7\u6599\u524d\uff0c\u4f7f\u7528 <pre><code>data.force_cloud_download = True\n</code></pre> \u5047\u5982\u60f3\u8981\u5f37\u5236\u4f7f\u7528\u672c\u5730\u8cc7\u6599\uff0c\u4e0d\u984d\u5916\u4e0b\u8f09\uff0c\u53ef\u4ee5\u5728\u4e0b\u8f09\u8cc7\u6599\u524d\uff0c\u4f7f\u7528 <pre><code>data.use_local_data_only = True\n</code></pre></p>"},{"location":"reference/data/#finlab.data.indicator","title":"finlab.data.indicator","text":"<pre><code>indicator(indname, adjust_price=False, resample='D', **kwargs)\n</code></pre> <p>\u652f\u63f4 Talib \u548c pandas_ta \u4e0a\u767e\u7a2e\u6280\u8853\u6307\u6a19\uff0c\u8a08\u7b97 2000 \u6a94\u80a1\u7968\u300110\u5e74\u7684\u6240\u6709\u8cc7\u8a0a\u3002</p> <p>\u5728\u4f7f\u7528\u9019\u500b\u51fd\u5f0f\u524d\uff0c\u9700\u8981\u5b89\u88dd\u8a08\u7b97\u6280\u8853\u6307\u6a19\u7684 Packages</p> <ul> <li>Ta-Lib</li> <li>Pandas-ta</li> </ul> PARAMETER  DESCRIPTION <code>indname</code> <p>\u6307\u6a19\u540d\u7a31\uff0c \u4ee5 TA-Lib \u8209\u4f8b\uff0c\u4f8b\u5982 SMA, STOCH, RSI \u7b49\uff0c\u53ef\u4ee5\u53c3\u8003 talib \u6587\u4ef6\u3002</p> <p>\u4ee5 Pandas-ta \u8209\u4f8b\uff0c\u4f8b\u5982 supertrend, ssf \u7b49\uff0c\u53ef\u4ee5\u53c3\u8003 Pandas-ta \u6587\u4ef6\u3002</p> <p> TYPE: <code>str</code> </p> <code>adjust_price</code> <p>\u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\u8a08\u7b97\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>resample</code> <p>\u6280\u8853\u6307\u6a19\u50f9\u683c\u9031\u671f\uff0cex: <code>D</code> \u4ee3\u8868\u65e5\u7dda, <code>W</code> \u4ee3\u8868\u9031\u7dda, <code>M</code> \u4ee3\u8868\u6708\u7dda\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'D'</code> </p> <code>market</code> <p>\u5e02\u5834\u9078\u64c7\uff0cex: <code>TW_STOCK</code> \u4ee3\u8868\u53f0\u80a1, <code>US_STOCK</code> \u4ee3\u8868\u7f8e\u80a1\u3002</p> <p> TYPE: <code>str</code> </p> <code>**kwargs</code> <p>\u6280\u8853\u6307\u6a19\u7684\u53c3\u6578\u8a2d\u5b9a\uff0cTA-Lib \u4e2d\u7684 RSI \u70ba\u4f8b\uff0c\u8abf\u6574\u9805\u70ba\u8a08\u7b97\u9031\u671f <code>timeperiod=14</code>\u3002</p> <p> TYPE: <code>dict</code> DEFAULT: <code>{}</code> </p> <p>\u5efa\u8b70\u4f7f\u7528\u8005\u53ef\u4ee5\u5148\u53c3\u8003\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u4e26\u4e14\u642d\u914d talib\u5b98\u65b9\u6587\u4ef6\uff0c\u5c31\u53ef\u4ee5\u638c\u63e1\u88fd\u4f5c\u6280\u8853\u6307\u6a19\u7684\u65b9\u6cd5\u4e86\u3002</p>"},{"location":"reference/data/#finlab.data.universe","title":"finlab.data.universe","text":"<pre><code>universe(market='ALL', category='ALL')\n</code></pre> <p>\u7576\u547c\u53eb <code>data.get</code> \u6216\u662f <code>data.indicator</code> \u6642\uff0c\u8fd4\u56de\u7522\u696d\u76f8\u95dc\u985e\u80a1\u3002</p> PARAMETER  DESCRIPTION <code>market</code> <p>Universe market type. ex: <code>ALL</code>, <code>TSE</code>, <code>OTC</code>, <code>TSE_OTC</code>, <code>ETF</code>, <code>STOCK_FUTURE</code></p> <p> TYPE: <code>str</code> DEFAULT: <code>'ALL'</code> </p> <code>category</code> <p>Stock categories. ex: <code>\u5149\u96fb\u696d</code>, <code>\u5176\u4ed6</code>, <code>\u5176\u4ed6\u96fb\u5b50\u696d</code>, <code>\u5316\u5b78\u5de5\u696d</code>, <code>\u534a\u5c0e\u9ad4</code>, <code>\u5851\u81a0\u5de5\u696d</code>, <code>\u5b58\u8a17\u6191\u8b49</code>, <code>\u5efa\u6750\u71df\u9020</code>, <code>\u6587\u5316\u5275\u610f\u696d</code>, <code>\u6a61\u81a0\u5de5\u696d</code>, <code>\u6c34\u6ce5\u5de5\u696d</code>,<code>\u6c7d\u8eca\u5de5\u696d</code>, <code>\u6cb9\u96fb\u71c3\u6c23\u696d</code>, <code>\u73bb\u7483\u9676\u74f7</code>, <code>\u751f\u6280\u91ab\u7642</code>, <code>\u751f\u6280\u91ab\u7642\u696d</code>, <code>\u7d21\u7e54\u7e96\u7dad</code>, <code>\u822a\u904b\u696d</code>, <code>\u89c0\u5149\u4e8b\u696d</code>, <code>\u8cbf\u6613\u767e\u8ca8</code>, <code>\u8cc7\u8a0a\u670d\u52d9\u696d</code>, <code>\u8fb2\u696d\u79d1\u6280</code>, <code>\u901a\u4fe1\u7db2\u8def\u696d</code>, <code>\u9020\u7d19\u5de5\u696d</code>, <code>\u91d1\u878d</code>, <code>\u92fc\u9435\u5de5\u696d</code>, <code>\u96fb\u5668\u96fb\u7e9c</code>, <code>\u96fb\u5b50\u5546\u52d9</code>, <code>\u96fb\u5b50\u901a\u8def\u696d</code>, <code>\u96fb\u5b50\u96f6\u7d44\u4ef6</code>, <code>\u96fb\u6a5f\u6a5f\u68b0</code>, <code>\u96fb\u8166\u53ca\u9031\u908a</code>, <code>\u98df\u54c1\u5de5\u696d</code></p> <p> TYPE: <code>str or list</code> DEFAULT: <code>'ALL'</code> </p> <p>Examples:</p> <p>A. \u591a\u7522\u696d\u9078\u53d6: \u60f3\u8981\u7576\u92fc\u9435\u4eba\u3001\u822a\u6d77\u738b\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u6cd5\u5c07\u9019\u4e9b\u985e\u80a1\u4e00\u6b21\u9078\u51fa\u4f86 <pre><code>with universe('TSE_OTC', ['\u92fc\u9435\u5de5\u696d', '\u822a\u904b\u696d']):\nclose_subset = data.get('price:\u6536\u76e4\u50f9')\nprint(close_subset)\n</code></pre></p> date 2002 2006 .. 2008 2009 2007-04-23 39.65 38.3 .. 7.8 17.55 2007-04-24 39.85 38.85 .. 8.34 17.5 2007-04-25 39.25 38.1 .. 8.25 17.3 2007-04-26 39 37.85 .. 8.2 17.3 2007-04-27 38.2 37.2 .. 7.88 16.6 <p>B. \u4f7f\u7528\u6b63\u898f\u8868\u9054\u5f0f\u9078\u53d6\uff1a\u7531\u65bc\u7a0b\u5f0f\u662f\u4f7f\u7528 regex \u4f86\u9032\u884c\u6bd4\u5c0d\uff0c\u6240\u4ee5\u6703\u8b8a\u6210\u6a21\u7cca\u6bd4\u5c0d\uff0c\u7576 categories \u662f\u300c\u5176\u4ed6\u300d\uff0c            \u5247\u6703\u9078\u51fa\u6240\u6709\u7684\u300c\u5176\u4ed6\u300d\u985e\u80a1\uff0c\u5305\u542b\u300c\u5176\u4ed6\u8b49\u5238\u300d\u3002\u5982\u679c\u4f7f\u7528\u8005\u5982\u679c\u5e0c\u671b\u9078\u51fa\u300c\u5176\u4ed6\u300d\u4f46\u4e0d\u60f3\u8981\u9078\u51fa\u300c\u5176\u4ed6\u8b49\u5238\u300d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\uff1a</p> <pre><code>with universe('TSE_OTC', ['^\u5176\u4ed6$']):\nclose_subset = data.get('price:\u6536\u76e4\u50f9')\nprint(close_subset)\n</code></pre> <p>\u9019\u6a23\u5c31\u6703\u660e\u78ba\u6307\u660e\u958b\u982d\u8ddf\u7d50\u5c3e\u4e2d\u9593\uff0c\u53ea\u6709\u300c\u5176\u4ed6\u300d\u7684\u985e\u80a1\u6703\u88ab\u9078\u51fa\u4f86\u3002</p>"},{"location":"reference/data/#finlab.data.us_universe","title":"finlab.data.us_universe","text":"<pre><code>us_universe(market='ALL', sector='ALL', industry='ALL', exchange='ALL')\n</code></pre> <p>\u7576\u547c\u53eb <code>data.get</code> \u6216\u662f <code>data.indicator</code> \u6642\uff0c\u8fd4\u56de\u7f8e\u80a1\u7522\u696d\u76f8\u95dc\u985e\u80a1\u3002</p> PARAMETER  DESCRIPTION <code>market</code> <p>Universe market type.           ex: <code>Common Stock</code>, <code>Preferred Stock</code>, <code>Domestic</code>, <code>Domestic Common Stock</code>, <code>ADR</code></p> <p> TYPE: <code>str</code> DEFAULT: <code>'ALL'</code> </p> <code>sector</code> <p>The sector the stock belongs to.                   ex:<code>Basic Materials</code>,<code>Communication Services</code>,<code>Consumer Cyclical</code>,<code>Consumer Defensive</code>,<code>Energy</code>,<code>Financial Services</code>,<code>Healthcare</code>,<code>Industrials</code>,<code>Real Estate</code>,<code>Technology</code>,<code>Utilities</code></p> <p> TYPE: <code>str or list</code> DEFAULT: <code>'ALL'</code> </p> <code>industry</code> <p>The industry the stock belongs to.See industry list from <code>set(data.get('us_tickers')['industry'])</code>.ex:<code>Steel</code>,<code>Software - Application</code>...</p> <p> TYPE: <code>str or list</code> DEFAULT: <code>'ALL'</code> </p> <code>exchange</code> <p>The exchange the stock belongs to.                    ex:<code>BATS</code>, <code>INDEX</code>, <code>NASDAQ</code>, <code>NYSE</code>, <code>NYSEARCA</code>, <code>NYSEMKT</code>, <code>OTC</code></p> <p> TYPE: <code>str or list</code> DEFAULT: <code>'ALL'</code> </p> <p>Examples:</p> <p>\u60f3\u9078\u51fa\u7f8e\u80a1\u666e\u901a\u80a1\u4e2d\u7684\u79d1\u6280\u985e\u80a1 <pre><code>with us_universe('Common Stock', ['Technology']):\nclose_subset = data.get('us_price:close')\nprint(close_subset)\n</code></pre></p> date AAOI AAPL .. ABCO NVDA 2017-01-03 39.65 38.3 .. 7.8 17.55 2017-01-04 39.85 38.85 .. 8.34 17.5 2017-01-05 39.25 38.1 .. 8.25 17.3 2017-01-06 39 37.85 .. 8.2 17.3 2017-01-09 38.2 37.2 .. 7.88 16.6 <p>\u60f3\u9078\u51fa\u7f8e\u80a1\u7279\u5225\u80a1\u4e2d\u7684\u57fa\u790e\u539f\u7269\u6599\u548c\u80fd\u6e90\u985e\u80a1 <pre><code>with data.us_universe('Preferred Stock', ['Basic Materials','Energy']):\nclose_subset = data.get('us_price:close')\nprint(close_subset)\n</code></pre></p> date AEUA ALIN-PA .. ALIN-PB ALIN-PE 2017-01-03 39.65 38.3 .. 7.8 17.55 2017-01-04 39.85 38.85 .. 8.34 17.5 2017-01-05 39.25 38.1 .. 8.25 17.3 2017-01-06 39 37.85 .. 8.2 17.3 2017-01-09 38.2 37.2 .. 7.88 16.6 <p>\u60f3\u5f9e\u7f8e\u80a1 NASDAQ \u4ea4\u6613\u6240\u7684\u666e\u901a\u80a1\u4e2d\u7be9\u9078\u51fa\u8edf\u9ad4\u985e\u80a1 <pre><code>with data.us_universe('Common Stock', industry='Software', exchange='NASDAQ'):\nclose_subset = data.get('us_price:close')\nprint(close_subset)\n</code></pre></p> date ACIW ACVA .. ZI ZS 2017-01-03 39.65 38.3 .. 7.8 17.55 2017-01-04 39.85 38.85 .. 8.34 17.5 2017-01-05 39.25 38.1 .. 8.25 17.3 2017-01-06 39 37.85 .. 8.2 17.3 2017-01-09 38.2 37.2 .. 7.88 16.6 <p>\u6aa2\u8996\u6709\u54ea\u4e9b\u7522\u696d\u53ef\u9078\u64c7 <pre><code>print(set(data.get('us_tickers')['industry']))\n</code></pre> <pre><code>{'Advertising Agencies',\n 'Aerospace &amp; Defense',\n 'Agricultural Inputs',\n 'Airlines',\n 'Airports &amp; Air Services',\n 'Aluminum',\n ...}\n</code></pre></p>"},{"location":"reference/data/#finlab.data.set_storage","title":"finlab.data.set_storage","text":"<pre><code>set_storage(storage)\n</code></pre> <p>\u8a2d\u5b9a\u672c\u5730\u7aef\u5132\u5b58\u6b77\u53f2\u8cc7\u6599\u7684\u65b9\u5f0f \u5047\u8a2d\u4f7f\u7528 <code>data.get</code> \u7372\u53d6\u6b77\u53f2\u8cc7\u6599\u5247\uff0c\u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u7a0b\u5f0f\u6703\u81ea\u52d5\u5728\u672c\u5730\u8907\u88fd\u4e00\u4efd\uff0c\u4ee5\u907f\u514d\u91cd\u8907\u4e0b\u8f09\u5927\u91cf\u6578\u64da\u3002 storage \u5c31\u662f\u7528\u4f86\u5132\u5b58\u6b77\u53f2\u8cc7\u6599\u7684\u63a5\u53e3\u3002\u6211\u5011\u63d0\u4f9b\u5169\u7a2e <code>storage</code> \u63a5\u53e3\uff0c\u5206\u5225\u662f <code>finlab.data.CacheStorage</code> (\u9810\u8a2d) \u4ee5\u53ca <code>finlab.data.FileStorage</code>\u3002\u524d\u8005\u662f\u76f4\u63a5\u5b58\u5728\u8a18\u61b6\u9ad4\u4e2d\uff0c\u5f8c\u8005\u662f\u5b58\u5728\u6a94\u6848\u4e2d\u3002\u8a73\u60c5\u8acb\u53c3\u8003 <code>CacheStorage</code> \u548c <code>FileStorage</code> \u4f86\u7372\u5f97\u66f4\u8a73\u7d30\u7684\u8cc7\u8a0a\u3002 \u5728\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u7a0b\u5f0f\u6703\u81ea\u52d5\u4f7f\u7528 <code>finlab.data.FileStorage</code> \u4e26\u5c07\u91cd\u8907\u7d22\u53d6\u4e4b\u6b77\u53f2\u8cc7\u6599\u5b58\u5728\u4f5c\u696d\u7cfb\u7d71\u9810\u8a2d\u300c\u66ab\u6642\u8cc7\u6599\u593e\u300d\u3002</p> PARAMETER  DESCRIPTION <code>storage</code> <p>The interface of storage</p> <p> TYPE: <code>Storage</code> </p> <p>Examples:</p> <p>\u6b32\u5207\u63db\u6210\u4ee5\u6a94\u6848\u65b9\u5f0f\u5132\u5b58\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4e4b\u65b9\u5f0f\uff1a</p> <pre><code>from finlab import data\ndata.set_storage(data.FileStorage())\nclose = data.get('price:\u6536\u76e4\u50f9')\n</code></pre> <p>\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u7684 <code>./finlab_db/price#\u6536\u76e4\u50f9.pickle</code> \u4e2d\uff0c\u770b\u5230\u4e0b\u8f09\u7684\u8cc7\u6599\uff0c \u53ef\u4ee5\u4f7f\u7528 <code>pickle</code> \u8abf\u95b1\u6b77\u53f2\u8cc7\u6599\uff1a <pre><code>import pickle\nclose = pickle.load(open('finlab_db/price#\u6536\u76e4\u50f9.pickle', 'rb'))\n</code></pre></p>"},{"location":"reference/data/#finlab.data.CacheStorage","title":"finlab.data.CacheStorage","text":"<pre><code>CacheStorage()\n</code></pre> <p>\u5c07\u6b77\u53f2\u8cc7\u6599\u5132\u5b58\u65bc\u5feb\u53d6\u4e2d</p> <p>Examples:</p> <p>\u6b32\u5207\u63db\u6210\u4ee5\u6a94\u6848\u65b9\u5f0f\u5132\u5b58\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4e4b\u65b9\u5f0f\uff1a</p> <pre><code>from finlab import data\ndata.set_storage(data.CacheStorage())\nclose = data.get('price:\u6536\u76e4\u50f9')\n</code></pre> <p>\u53ef\u4ee5\u76f4\u63a5\u8abf\u95b1\u5feb\u53d6\u8cc7\u6599\uff1a</p> <pre><code>close = data._storage._cache['price:\u6536\u76e4\u50f9']\n</code></pre>"},{"location":"reference/data/#finlab.data.FileStorage","title":"finlab.data.FileStorage","text":"<pre><code>FileStorage(path=None, use_cache=True)\n</code></pre> <p>\u5c07\u6b77\u53f2\u8cc7\u6599\u5132\u5b58\u65bc\u6a94\u6848\u4e2d</p> PARAMETER  DESCRIPTION <code>path</code> <p>\u8cc7\u6599\u5132\u5b58\u7684\u8def\u5f91</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>use_cache</code> <p>\u662f\u5426\u984d\u5916\u4f7f\u7528\u5feb\u53d6\uff0c\u5c07\u8cc7\u6599\u8907\u88fd\u4e00\u4efd\u5230\u8a18\u61b6\u9ad4\u4e2d\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <p>Examples:</p> <p>\u6b32\u5207\u63db\u6210\u4ee5\u6a94\u6848\u65b9\u5f0f\u5132\u5b58\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u4e4b\u65b9\u5f0f\uff1a</p> <pre><code>from finlab import data\ndata.set_storage(data.FileStorage())\nclose = data.get('price:\u6536\u76e4\u50f9')\n</code></pre> <p>\u53ef\u4ee5\u5728\u672c\u5730\u7aef\u7684 <code>./finlab_db/price#\u6536\u76e4\u50f9.pickle</code> \u4e2d\uff0c\u770b\u5230\u4e0b\u8f09\u7684\u8cc7\u6599\uff0c \u53ef\u4ee5\u4f7f\u7528 <code>pickle</code> \u8abf\u95b1\u6b77\u53f2\u8cc7\u6599\uff1a <pre><code>import pickle\nclose = pickle.load(open('finlab_db/price#\u6536\u76e4\u50f9.pickle', 'rb'))\n</code></pre></p>"},{"location":"reference/data/#finlab.data.get_strategies","title":"finlab.data.get_strategies","text":"<pre><code>get_strategies(api_token=None)\n</code></pre> <p>\u53d6\u5f97\u5df2\u4e0a\u50b3\u91cf\u5316\u5e73\u53f0\u7684\u7b56\u7565\u56de\u50b3\u8cc7\u6599\u3002</p> <p>\u53ef\u53d6\u5f97\u81ea\u5df1\u7b56\u7565\u5100\u8868\u677f\u4e0a\u7684\u6578\u64da\uff0c\u4f8b\u5982\u6bcf\u500b\u7b56\u7565\u7684\u5831\u916c\u7387\u66f2\u7dda\u3001\u5831\u916c\u7387\u7d71\u8a08\u3001\u590f\u666e\u7387\u3001\u8fd1\u671f\u90e8\u4f4d\u3001\u8fd1\u671f\u63db\u80a1\u65e5...\uff0c \u9019\u4e9b\u6578\u64da\u53ef\u4ee5\u7528\u4f86\u9032\u884c\u591a\u7b56\u7565\u5f59\u6574\u7684\u61c9\u7528\u5594\uff01</p> PARAMETER  DESCRIPTION <code>api_token</code> <p>\u82e5\u672a\u5e36\u5165finlab\u6a21\u7d44\u7684api_token\uff0c\u6703\u81ea\u52d5\u8df3\u51faGUI\u9801\u9762\uff0c              \u8907\u88fd\u7db2\u9801\u5167\u7684api_token\u8cbc\u81f3\u8f38\u5165\u6b04\u4f4d\u5373\u53ef\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <p>Returns:     (dict): strategies data Response detail:</p> <pre><code>``` py\n{\n  strategy1:{\n    'asset_type': '',\n    'drawdown_details': {\n       '2015-06-04': {\n         'End': '2015-11-03',\n         'Length': 152,\n         'drawdown': -0.19879090089478024\n         },\n         ...\n      },\n    'fee_ratio': 0.000475,\n    'last_trading_date': '2022-06-10',\n    'last_updated': 'Sun, 03 Jul 2022 12:02:27 GMT',\n    'ndays_return': {\n      '1': -0.01132480035770611,\n      '10': -0.0014737286933147464,\n      '20': -0.06658015749110646,\n      '5': -0.002292995729485159,\n      '60': -0.010108700314771735\n      },\n    'next_trading_date': '2022-06-10',\n    'positions': {\n      '1413 \u5b8f\u6d32': {\n        'entry_date': '2022-05-10',\n        'entry_price': 10.05,\n        'exit_date': '',\n        'next_weight': 0.1,\n        'return': -0.010945273631840613,\n        'status': '\u8cb7\u9032',\n        'weight': 0.1479332345384493\n        },\n      'last_updated': 'Sun, 03 Jul 2022 12:02:27 GMT',\n      'next_trading_date': '2022-06-10',\n      'trade_at': 'open',\n      'update_date': '2022-06-10'\n      },\n    'return_table': {\n      '2014': {\n        'Apr': 0.0,\n        'Aug': 0.06315180932606546,\n        'Dec': 0.0537589857541485,\n        'Feb': 0.0,\n        'Jan': 0.0,\n        'Jul': 0.02937490104459939,\n        'Jun': 0.01367930162104769,\n        'Mar': 0.0,\n        'May': 0.0,\n        'Nov': -0.0014734320286596825,\n        'Oct': -0.045082529665408266,\n        'Sep': 0.04630906972509852,\n        'YTD': 0.16626214846456966\n        },\n        ...\n      },\n    'returns': {\n      'time': [\n        '2014-06-10',\n        '2014-06-11',\n        '2014-06-12',\n        ...\n        ],\n      'value': [\n        100,\n        99.9,\n        100.2,\n        ...\n        ]\n      },\n    'stats': {\n      'avg_down_month': -0.03304015302646822,\n      'avg_drawdown': -0.0238021414698247,\n      'avg_drawdown_days': 19.77952755905512,\n      'avg_up_month': 0.05293384465715908,\n      'cagr': 0.33236021285588846,\n      'calmar': 1.65261094975066,\n      'daily_kurt': 4.008888367138843,\n      'daily_mean': 0.3090784769257415,\n      'daily_sharpe': 1.747909002374217,\n      'daily_skew': -0.6966018726321078,\n      'daily_sortino': 2.8300677082214034,\n      ...\n      },\n    'tax_ratio': 0.003,\n    'trade_at': 'open',\n    'update_date': '2022-06-10'\n    },\n  strategy2:{...},\n  ...}\n```\n</code></pre>"},{"location":"reference/data/#finlab.data.search","title":"finlab.data.search","text":"<pre><code>search(keyword='.*', display_info=['name', 'description', 'items'])\n</code></pre> <p>\u67e5\u8a62\u8207\u53d6\u5f97\u8cc7\u6599\u5eab\u76ee\u9304\u8cc7\u8a0a\u3002</p> <p>\u67e5\u8a62FinLab\u8cc7\u6599\u5eab\u76ee\u9304\u4e2d\u7684\u8cc7\u6599\u8868\u540d\u7a31\u6216\u9805\u76ee\u6b04\u4f4d\u540d\u7a31\u662f\u5426\u5305\u542b\u95dc\u9375\u5b57\uff0c\u65b9\u4fbf\u641c\u5c0b\u8cc7\u6599\u5eab\u662f\u5426\u5b58\u5728\u76ee\u6a19\u8cc7\u6599\u3002</p> PARAMETER  DESCRIPTION <code>keyword</code> <p>\u6b32\u67e5\u8a62\u95dc\u9375\u5b57\uff0c\u9810\u8a2d\u5217\u8209\u5168\u90e8\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'.*'</code> </p> <code>display_info</code> <p>\u6307\u5b9a\u986f\u793a\u7684\u8cc7\u8a0a\u9805\u76ee\uff0c\u9810\u8a2d\u53ea\u986f\u793a\u300c\u8cc7\u6599\u8868\u82f1\u6587\u4ee3\u7a31\u3001\u8cc7\u6599\u8868\u7684\u4e2d\u6587\u63cf\u8ff0\u3001\u8cc7\u6599\u8868\u6b04\u4f4d\u540d\u7a31\u300d\uff0c\u82e5\u8a2d\u5b9a\u70baNone\uff0c\u5247\u986f\u793a\u5168\u90e8\u8cc7\u8a0a\u3002</p> <p> TYPE: <code>list</code> DEFAULT: <code>['name', 'description', 'items']</code> </p> RETURNS DESCRIPTION <code>list</code> <p>database information</p> Response detail <pre><code>[{'name': 'financial_statement',\n'description': '\u8ca1\u5831',\n'items': {'\u5b58\u8ca8': {'type': 'float', 'description': '\u8cc7\u7522\u8ca0\u50b5\u8868(\u4edf\u5143)'},\n'\u5b58\u8ca8_\u589e\u52a0_\u6e1b\u5c11': {'type': 'float', 'description': '\u55ae\u5b63\u73fe\u91d1\u6d41\u91cf\u8868(\u4edf\u5143)'}}},\n{'name': 'fundamental_features',\n'description': '\u8ca1\u52d9\u6307\u6a19',\n'items': {'\u5b58\u8ca8\u9031\u8f49\u7387': {'type': 'float', 'description': '(%)'}}},...]\n</code></pre> <p>Examples:     <pre><code># \u67e5\u8a62\u5404\u8cc7\u6599\u8868\u7684\u6b04\u4f4d\u540d\u7a31\u542b\u6709'\u5b58\u8ca8'\u95dc\u9375\u5b57\u8cc7\u6599\u8868\u7684\u57fa\u672c\u8cc7\u8a0a\nex1 = data.search(keyword='\u5b58\u8ca8')\n# \u53d6\u5f97\u542b\u6709'\u5b58\u8ca8'\u95dc\u9375\u5b57\u76f8\u95dc\u8cc7\u6599\u8868\u7684\u6240\u6709\u8cc7\u8a0a\nex2 = data.search(keyword='\u5b58\u8ca8', display_info=None)\n</code></pre></p>"},{"location":"reference/dataframe/","title":"finlab.dataframe","text":""},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame","title":"finlab.dataframe.FinlabDataFrame","text":"<pre><code>FinlabDataFrame(*args, **kwargs)\n</code></pre> <p>             Bases: <code>DataFrame</code></p> <p>\u56de\u6e2c\u8a9e\u6cd5\u7cd6 \u9664\u4e86\u4f7f\u7528\u719f\u6089\u7684 Pandas \u8a9e\u6cd5\u5916\uff0c\u6211\u5011\u4e5f\u63d0\u4f9b\u5f88\u591a\u8a9e\u6cd5\u7cd6\uff0c\u8b93\u5927\u5bb6\u958b\u767c\u7a0b\u5f0f\u6642\uff0c\u53ef\u4ee5\u7528\u7c21\u6613\u7684\u8a9e\u6cd5\u5b8c\u6210\u8907\u96dc\u7684\u529f\u80fd\uff0c\u8b93\u958b\u767c\u7b56\u7565\u66f4\u7c21\u6f54\uff01 \u6211\u5011\u5c07\u6240\u6709\u7684\u8a9e\u6cd5\u7cd6\u5305\u88f9\u5728 <code>FinlabDataFrame</code> \u4e2d\uff0c\u7528\u8d77\u4f86\u8ddf <code>pd.DataFrame</code> \u4e00\u6a23\uff0c\u4f46\u662f\u591a\u4e86\u5f88\u591a\u529f\u80fd\uff01 \u53ea\u8981\u4f7f\u7528 <code>finlab.data.get()</code> \u6240\u7372\u5f97\u7684\u8cc7\u6599\uff0c\u7686\u70ba <code>FinlabDataFrame</code> \u683c\u5f0f\uff0c \u63a5\u4e0b\u4f86\u6211\u5011\u5c31\u4f86\u770b\u770b\uff0c <code>FinlabDataFrame</code> \u6709\u54ea\u4e9b\u597d\u7528\u7684\u8a9e\u6cd5\u7cd6\u5427\uff01</p> <p>\u7576\u8cc7\u6599\u65e5\u671f\u6c92\u6709\u5c0d\u9f4a\uff08\u4f8b\u5982: \u8ca1\u5831 vs \u6536\u76e4\u50f9 vs \u6708\u5831\uff09\u6642\uff0c\u5728\u4f7f\u7528\u4ee5\u4e0b\u904b\u7b97\u7b26\u865f\uff1a <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&amp;</code>, <code>|</code>, <code>~</code>\uff0c \u4e0d\u9700\u8981\u5148\u5c07\u8cc7\u6599\u5c0d\u9f4a\uff0c\u56e0\u70ba <code>FinlabDataFrame</code> \u6703\u81ea\u52d5\u5e6b\u4f60\u8655\u7406\uff0c\u4ee5\u4e0b\u662f\u793a\u610f\u5716\u3002</p> <p></p> <p>\u4ee5\u4e0b\u662f\u7bc4\u4f8b\uff1a<code>cond1</code> \u8207 <code>cond2</code> \u5206\u5225\u70ba\u300c\u6bcf\u5929\u300d\uff0c\u548c\u300c\u6bcf\u5b63\u300d\u7684\u8cc7\u6599\uff0c\u5047\u5982\u8981\u53d6\u4ea4\u96c6\u7684\u6642\u9593\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u8a9e\u6cd5\uff1a</p> <p><pre><code>from finlab import data\n# \u53d6\u5f97 FinlabDataFrame\nclose = data.get('price:\u6536\u76e4\u50f9')\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\n# \u904b\u7b97\u5169\u500b\u9078\u80a1\u689d\u4ef6\u4ea4\u96c6\ncond1 = close &gt; 37\ncond2 = roa &gt; 0\ncond_1_2 = cond1 &amp; cond2\n</code></pre> \u64f7\u53d6 1101 \u53f0\u6ce5 \u7684\u8a0a\u865f\u5982\u4e0b\u5716\uff0c\u53ef\u4ee5\u770b\u5230 <code>cond1</code> \u8ddf <code>cond2</code> \u8a0a\u865f\u7684\u983b\u7387\u96d6\u7136\u4e0d\u76f8\u540c\uff0c \u4f46\u662f\u7531\u65bc <code>cond1</code> \u8ddf <code>cond2</code> \u662f <code>FinlabDataFrame</code>\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u53d6\u4ea4\u96c6\uff0c\u800c\u4e0d\u7528\u8655\u7406\u8cc7\u6599\u983b\u7387\u5c0d\u9f4a\u7684\u554f\u984c\u3002  </p> <p>\u7e3d\u7d50\u4f86\u8aaa\uff0cFinlabDataFrame \u8207\u4e00\u822c dataframe \u552f\u4e8c\u4e0d\u540c\u4e4b\u8655\uff1a 1. \u591a\u4e86\u4e00\u4e9b method\uff0c\u5982<code>df.is_largest()</code>, <code>df.sustain()</code>...\u7b49\u3002 2. \u5728\u505a\u56db\u5247\u904b\u7b97\u3001\u4e0d\u7b49\u5f0f\u904b\u7b97\u524d\uff0c\u6703\u5c07 df1\u3001df2 \u7684 index \u53d6\u806f\u96c6\uff0ccolumn \u53d6\u4ea4\u96c6\u3002</p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.average","title":"average","text":"<pre><code>average(n)\n</code></pre> <p>\u53d6 n \u7b46\u79fb\u52d5\u5e73\u5747</p> <p>\u82e5\u80a1\u7968\u5728\u6642\u9593\u7a97\u683c\u5167\uff0c\u6709 N/2 \u7b46 NaN\uff0c\u5247\u6703\u7522\u751f NaN\u3002 Args:   n (positive-int): \u8a2d\u5b9a\u79fb\u52d5\u7a97\u683c\u6578\u3002 Returns:   (pd.DataFrame): data Examples:     \u80a1\u50f9\u5728\u5747\u7dda\u4e4b\u4e0a     <pre><code>from finlab import data\nclose = data.get('price:\u6536\u76e4\u50f9')\nsma = close.average(10)\ncond = close &gt; sma\n</code></pre>     \u53ea\u9700\u8981\u7c21\u55ae\u7684\u8a9e\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5c07\u5176\u4e2d\u4e00\u90e8\u5206\u7684\u8a0a\u865f\u7e6a\u88fd\u51fa\u4f86\u6aa2\u67e5\uff1a     <pre><code>import matplotlib.pyplot as plt\nclose.loc['2021', '2330'].plot()\nsma.loc['2021', '2330'].plot()\ncond.loc['2021', '2330'].mul(20).add(500).plot()\nplt.legend(['close', 'sma', 'cond'])\n</code></pre> </p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.deadline","title":"deadline","text":"<pre><code>deadline()\n</code></pre> <p>\u8ca1\u52d9\u7d22\u5f15\u8f49\u63db\u6210\u516c\u544a\u622a\u6b62\u65e5</p> <p>\u5c07\u8ca1\u52d9\u5b63\u5831 (ex:2022Q1) \u5f9e\u6587\u5b57\u683c\u5f0f\u8f49\u70ba\u516c\u544a\u622a\u6b62\u65e5\u7684datetime\u683c\u5f0f\uff0c \u901a\u5e38\u4f7f\u7528\u60c5\u5883\u70ba\u5c0d\u4e0d\u540c\u9031\u671f\u7684dataframe\u505areindex\uff0c\u5e38\u7528\u65bc\u4ee5\u516c\u544a\u622a\u6b62\u65e5\u4f5c\u70ba\u8a0a\u865f\u7522\u751f\u65e5\u3002 Returns:   (pd.DataFrame): data Examples:     <pre><code>data.get('financial_statement:\u73fe\u91d1\u53ca\u7d04\u7576\u73fe\u91d1').deadline()\ndata.get('monthly_revenue:\u7576\u6708\u71df\u6536').deadline()\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.fall","title":"fall","text":"<pre><code>fall(n=1)\n</code></pre> <p>\u6578\u503c\u4e0b\u964d\u4e2d</p> <p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u4f4e\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002  Args:   n (positive-int): \u8a2d\u5b9a\u6bd4\u8f03\u524d\u7b2cn\u7b46\u4f4e\u3002 Returns:   (pd.DataFrame): data Examples:     \u6536\u76e4\u50f9\u662f\u5426\u4f4e\u65bc10\u65e5\u524d\u80a1\u50f9     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').fall(10)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.groupby_category","title":"groupby_category","text":"<pre><code>groupby_category()\n</code></pre> <p>\u8cc7\u6599\u6309\u7522\u696d\u5206\u7fa4</p> <p>\u985e\u4f3c <code>pd.DataFrame.groupby()</code>\u7684\u8655\u7406\u6548\u679c\u3002 Returns:   (pd.DataFrame): data Examples:   \u534a\u5c0e\u9ad4\u5e73\u5747\u80a1\u50f9\u6de8\u503c\u6bd4\u6642\u9593\u5e8f\u5217     <pre><code>from finlab import data\npe = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\npe.groupby_category().mean()['\u534a\u5c0e\u9ad4'].plot()\n</code></pre> </p> <pre><code>\u5168\u7403 2020 \u91cf\u5316\u5bec\u9b06\u52a0\u4e0a\u6676\u7247\u77ed\u7f3a\uff0c\u4f7f\u5f97\u534a\u5c0e\u9ad4\u80a1\u50f9\u6de8\u503c\u6bd4\u885d\u9ad8\u3002\n</code></pre>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.hold_until","title":"hold_until","text":"<pre><code>hold_until(exit, nstocks_limit=None, stop_loss=-np.inf, take_profit=np.inf, trade_at='close', rank=None)\n</code></pre> <p>\u8a0a\u865f\u9032\u51fa\u5834</p> <p>\u9019\u5927\u6982\u662f\u6240\u6709\u7b56\u7565\u64b0\u5beb\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u8a9e\u6cd5\u7cd6\uff0c\u4e0a\u8ff0\u8a9e\u6cd5\u4e2d <code>entries</code> \u70ba\u9032\u5834\u8a0a\u865f\uff0c\u800c <code>exits</code> \u662f\u51fa\u5834\u8a0a\u865f\u3002\u6240\u4ee5 <code>entries.hold_until(exits)</code> \uff0c\u5c31\u662f\u9032\u5834\u8a0a\u865f\u70ba <code>True</code> \u6642\uff0c\u8cb7\u5165\u4e26\u6301\u6709\u8a72\u6a94\u80a1\u7968\uff0c\u76f4\u5230\u51fa\u5834\u8a0a\u865f\u70ba <code>True</code> \u5247\u8ce3\u51fa\u3002  \u6b64\u51fd\u5f0f\u6709\u5f88\u591a\u7d30\u90e8\u8a2d\u5b9a\uff0c\u53ef\u4ee5\u8b93\u4f60\u6700\u591a\u9078\u64c7 N \u6a94\u80a1\u7968\u505a\u8f2a\u52d5\u3002\u53e6\u5916\uff0c\u7576\u8d85\u904e N \u6a94\u9032\u5834\u8a0a\u865f\u767c\u751f\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u5ba2\u5236\u5316\u7684\u6392\u5e8f\uff0c\u9078\u64c7\u512a\u5148\u9078\u5165\u7684\u80a1\u7968\u3002\u6700\u5f8c\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u50f9\u683c\u6ce2\u52d5\u7576\u8f2a\u52d5\u8a0a\u865f\uff0c\u4f86\u589e\u52a0\u51fa\u5834\u7684\u6642\u6a5f\u9ede\u3002</p> PARAMETER  DESCRIPTION <code>exit</code> <p>\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>Dataframe</code> </p> <code>nstocks_limit</code> <p>\u8f2a\u52d5\u6a94\u6578\u4e0a\u9650\uff0c\u9810\u8a2d\u70baNone\u3002</p> <p> TYPE: <code>int)`</code> DEFAULT: <code>None</code> </p> <code>stop_loss</code> <p>\u50f9\u683c\u6ce2\u52d5\u8f2a\u52d5\u8a0a\u865f\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u751f\u6210\u8f2a\u52d5\u8a0a\u865f\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0b\u8dcc 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>-inf</code> </p> <code>take_profit</code> <p>\u50f9\u683c\u6ce2\u52d5\u8f2a\u52d5\u8a0a\u865f\uff0c\u9810\u8a2d\u70baNone\uff0c\u4e0d\u751f\u6210\u8f2a\u52d5\u8a0a\u865f\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0a\u6f32 10% \u6642\u7522\u751f\u51fa\u5834\u8a0a\u865f\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>inf</code> </p> <code>trade_at</code> <p>\u50f9\u683c\u6ce2\u52d5\u8f2a\u52d5\u8a0a\u865f\u53c3\u8003\u50f9\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078 <code>close</code> \u6216 <code>open</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>rank</code> <p>\u7576\u5929\u9032\u5834\u8a0a\u865f\u6578\u91cf\u8d85\u904e nstocks_limit \u6642\uff0c\u4ee5 rank \u6578\u503c\u8d8a\u5927\u7684\u80a1\u7968\u512a\u5148\u9032\u5834\u3002</p> <p> TYPE: <code>Dataframe</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>data</p> <p>Examples:</p> <p>\u50f9\u683c &gt; 20 \u65e5\u5747\u7dda\u5165\u5834, \u50f9\u683c &lt; 60 \u65e5\u5747\u7dda\u51fa\u5834\uff0c\u6700\u591a\u6301\u670910\u6a94\uff0c\u8d85\u904e 10 \u500b\u9032\u5834\u8a0a\u865f\uff0c\u5247\u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u5c0f\u7684\u80a1\u7968\u512a\u5148\u9078\u5165\u3002 <pre><code>from finlab import data\nfrom finlab.backtest import sim\nclose = data.get('price:\u6536\u76e4\u50f9')\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nsma20 = close.average(20)\nsma60 = close.average(60)\nentries = close &gt; sma20\nexits = close &lt; sma60\n#pb\u524d10\u5c0f\u7684\u6a19\u7684\u505a\u8f2a\u52d5\nposition = entries.hold_until(exits, nstocks_limit=10, rank=-pb)\nsim(position)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.index_str_to_date","title":"index_str_to_date","text":"<pre><code>index_str_to_date()\n</code></pre> <p>\u8ca1\u52d9\u6708\u5b63\u5831\u7d22\u5f15\u683c\u5f0f\u8f49\u63db</p> <p>\u5c07\u4ee5\u4e0b\u8cc7\u6599\u7684\u7d22\u5f15\u8f49\u63db\u6210datetime\u683c\u5f0f:</p> <p>\u8ca1\u52d9\u5b63\u5831 (ex:2022-Q1) \u5f9e\u6587\u5b57\u683c\u5f0f\u8f49\u70ba\u8ca1\u5831\u96fb\u5b50\u6a94\u8cc7\u6599\u4e0a\u50b3\u65e5\u3002</p> <p>\u901a\u5e38\u4f7f\u7528\u60c5\u5883\u70ba\u5c0d\u4e0d\u540c\u9031\u671f\u7684dataframe\u505areindex\uff0c\u5e38\u7528\u65bc\u4ee5\u516c\u544a\u622a\u6b62\u65e5\u4f5c\u70ba\u8a0a\u865f\u7522\u751f\u65e5\u3002</p> RETURNS DESCRIPTION <code>DataFrame</code> <p>data</p> <p>Examples:</p> <pre><code>data.get('financial_statement:\u73fe\u91d1\u53ca\u7d04\u7576\u73fe\u91d1').index_str_to_date()\n</code></pre>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.industry_rank","title":"industry_rank","text":"<pre><code>industry_rank(categories=None)\n</code></pre> <p>\u8a08\u7b97\u7522\u696d ranking \u6392\u540d\uff0c0 \u4ee3\u8868\u7522\u696d\u5167\u6700\u4f4e\uff0c1 \u4ee3\u8868\u7522\u696d\u5167\u6700\u9ad8 Args:   categories (list of str): \u6b32\u8003\u616e\u7684\u7522\u696d\uff0cex: ['\u8cbf\u6613\u767e\u8ca8', '\u96f2\u7aef\u904b\u7b97']\uff0c\u9810\u8a2d\u70ba\u5168\u7522\u696d\uff0c\u8acb\u53c3\u8003 <code>data.get('security_industry_themes')</code> \u4e2d\u7684\u7522\u696d\u9805\u76ee\u3002 Examples:     \u672c\u610f\u6bd4\u7522\u696d\u6392\u540d\u5206\u6578     <pre><code>from finlab import data\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\npe_rank = pe.industry_rank()\nprint(pe_rank)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.is_entry","title":"is_entry","text":"<pre><code>is_entry()\n</code></pre> <p>\u9032\u5834\u9ede</p> <p>\u53d6\u9032\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002 Returns:   (pd.DataFrame): data Examples:   \u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u9032\u5834\u9ede\u3002     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_entry()\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.is_exit","title":"is_exit","text":"<pre><code>is_exit()\n</code></pre> <p>\u51fa\u5834\u9ede</p> <p>\u53d6\u51fa\u5834\u8a0a\u865f\u9ede\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70ba True\uff0c\u53cd\u4e4b\u70ba False\u3002 Returns:   (pd.DataFrame): data Examples:   \u7b56\u7565\u70ba\u6bcf\u65e5\u6536\u76e4\u50f9\u524d10\u9ad8\uff0c\u53d6\u51fa\u5834\u9ede\u3002     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').is_largest(10).is_exit()\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.is_largest","title":"is_largest","text":"<pre><code>is_largest(n)\n</code></pre> <p>\u53d6\u6bcf\u5217\u524d n \u7b46\u5927\u7684\u6578\u503c</p> <p>\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5927\u7684\u80a1\u7968\u3002</p> <p> Args:   n (positive-int): \u8a2d\u5b9a\u6bcf\u5217\u524d n \u7b46\u5927\u7684\u6578\u503c\u3002 Returns:   (pd.DataFrame): data Examples:     \u6bcf\u5b63 ROA \u524d 10 \u540d\u7684\u80a1\u7968     <pre><code>from finlab import data\nroa = data.get('fundamental_features:ROA\u7a05\u5f8c\u606f\u524d')\ngood_stocks = roa.is_largest(10)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.is_smallest","title":"is_smallest","text":"<pre><code>is_smallest(n)\n</code></pre> <p>\u53d6\u6bcf\u5217\u524d n \u7b46\u5c0f\u7684\u6578\u503c</p> <p>\u82e5\u7b26\u5408 <code>True</code> \uff0c\u53cd\u4e4b\u70ba <code>False</code> \u3002\u7528\u4f86\u7be9\u9078\u6bcf\u5929\u6578\u503c\u6700\u5c0f\u7684\u80a1\u7968\u3002 Args:   n (positive-int): \u8a2d\u5b9a\u6bcf\u5217\u524d n \u7b46\u5c0f\u7684\u6578\u503c\u3002 Returns:   (pd.DataFrame): data Examples:     \u80a1\u50f9\u6de8\u503c\u6bd4\u6700\u5c0f\u7684 10 \u6a94\u80a1\u7968     <pre><code>from finlab import data\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\ncheap_stocks = pb.is_smallest(10)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.quantile_row","title":"quantile_row","text":"<pre><code>quantile_row(c)\n</code></pre> <p>\u80a1\u7968\u7576\u5929\u6578\u503c\u5206\u4f4d\u6578</p> <p>\u53d6\u5f97\u6bcf\u5217c\u5b9a\u5206\u4f4d\u6578\u7684\u503c\u3002 Args:   c (positive-int): \u8a2d\u5b9a\u6bcf\u5217 n \u5b9a\u5206\u4f4d\u6578\u7684\u503c\u3002 Returns:   (pd.DataFrame): data Examples:     \u53d6\u6bcf\u65e5\u80a1\u50f9\u524d90\uff05\u5206\u4f4d\u6578     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').quantile_row(0.9)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.rise","title":"rise","text":"<pre><code>rise(n=1)\n</code></pre> <p>\u6578\u503c\u4e0a\u5347\u4e2d</p> <p>\u53d6\u662f\u5426\u6bd4\u524d\u7b2cn\u7b46\u9ad8\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002  Args:   n (positive-int): \u8a2d\u5b9a\u6bd4\u8f03\u524d\u7b2cn\u7b46\u9ad8\u3002 Returns:   (pd.DataFrame): data Examples:     \u6536\u76e4\u50f9\u662f\u5426\u9ad8\u65bc10\u65e5\u524d\u80a1\u50f9     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise(10)\n</code></pre></p>"},{"location":"reference/dataframe/#finlab.dataframe.FinlabDataFrame.sustain","title":"sustain","text":"<pre><code>sustain(nwindow, nsatisfy=None)\n</code></pre> <p>\u6301\u7e8c N \u5929\u6eff\u8db3\u689d\u4ef6</p> <p>\u53d6\u79fb\u52d5 nwindow \u7b46\u52a0\u7e3d\u5927\u65bc\u7b49\u65bcnsatisfy\uff0c\u82e5\u7b26\u5408\u689d\u4ef6\u7684\u503c\u5247\u70baTrue\uff0c\u53cd\u4e4b\u70baFalse\u3002</p> PARAMETER  DESCRIPTION <code>nwindow</code> <p>\u8a2d\u5b9a\u79fb\u52d5\u7a97\u683c\u3002</p> <p> TYPE: <code>positive - int</code> </p> <code>nsatisfy</code> <p>\u8a2d\u5b9a\u79fb\u52d5\u7a97\u683c\u8a08\u7b97\u5f8c\u6700\u4f4e\u6eff\u8db3\u6578\u503c\u3002</p> <p> TYPE: <code>positive - int</code> DEFAULT: <code>None</code> </p> <p>Returns:   (pd.DataFrame): data Examples:     \u6536\u76e4\u50f9\u662f\u5426\u9023\u5169\u65e5\u4e0a\u6f32     <pre><code>from finlab import data\ndata.get('price:\u6536\u76e4\u50f9').rise().sustain(2)\n</code></pre></p>"},{"location":"reference/finlab/","title":"finlab","text":""},{"location":"reference/finlab/#finlab.login","title":"finlab.login","text":"<pre><code>login(api_token=None)\n</code></pre> <p>\u767b\u9304\u91cf\u5316\u5e73\u53f0\u3002</p> <p>\u53ef\u4ee5\u81f3 api_token\u67e5\u8a62\u9801\u9762 \u7372\u53d6api_token\uff0c\u50b3\u5165\u51fd\u6578\u5f8c\u57f7\u884c\u767b\u9304\u52d5\u4f5c\u3002 \u4e4b\u5f8c\u4f7f\u7528Finlab\u6a21\u7d44\u7684\u6703\u54e1\u529f\u80fd\u6642\uff0c\u7cfb\u7d71\u5c31\u4e0d\u6703\u81ea\u52d5\u8df3\u51fa\u8acb\u6c42\u8f38\u5165api_token\u7684GUI\u9801\u9762\u3002 \u82e5\u50b3\u5165\u7684api_toke\u683c\u5f0f\u6709\u8aa4\uff0c\u7cfb\u7d71\u6703\u8981\u6c42\u518d\u6b21\u8f38\u5165\u3002</p> PARAMETER  DESCRIPTION <code>api_token</code> <p>FinLab api_token</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p>"},{"location":"reference/finlab/#finlab.get_token","title":"finlab.get_token","text":"<pre><code>get_token()\n</code></pre> <p>\u53d6\u5f97\u767b\u9304\u6703\u54e1\u7684finlab_id\u3002</p> <p>\u82e5\u672a\u767b\u9304\u904e\uff0c\u6703\u8df3\u51fa\u767b\u9304\u9801\u9762\u8acb\u6c42\u767b\u9304\u3002</p> RETURNS DESCRIPTION <code>str</code> <p>finlab api token</p>"},{"location":"reference/machine_learning/","title":"finlab.ml","text":""},{"location":"reference/machine_learning/#finlab.ml.feature","title":"finlab.ml.feature","text":""},{"location":"reference/machine_learning/#finlab.ml.feature.combine","title":"combine","text":"<pre><code>combine(features, resample=None, sample_filter=None, **kwargs)\n</code></pre> <p>The combine function takes a dictionary of features as input and combines them into a single pandas DataFrame. combine \u51fd\u6578\u63a5\u53d7\u4e00\u500b\u7279\u5fb5\u5b57\u5178\u4f5c\u70ba\u8f38\u5165\uff0c\u4e26\u5c07\u5b83\u5011\u5408\u4f75\u6210\u4e00\u500b pandas DataFrame\u3002</p> PARAMETER  DESCRIPTION <code>features</code> <p>a dictionary where values are dataframes or callables returning dataframes. \u7d22\u5f15\u70ba\u65e5\u671f\u6642\u9593\uff0c\u6b04\u4f4d \u70ba\u8b49\u5238\u4ee3\u78bc\u7684 DataFrame\uff0c\u6216\u53ef\u547c\u53eb\u4ee5\u53d6\u5f97 DataFrame \u7684\u51fd\u5f0f\u3002</p> <p> TYPE: <code>Dict[str, DataFrame | Callable]</code> </p> <code>resample</code> <p>Optional argument to resample the data in the features. Default is None. \u9078\u64c7\u6027\u7684\u53c3\u6578\uff0c\u7528\u65bc\u91cd\u65b0\u53d6\u6a23\u7279\u5fb5\u4e2d\u7684\u8cc7\u6599\u3002\u9810\u8a2d\u70ba None\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>sample_filter</code> <p>a boolean dictionary where index is date and columns are instrument representing the filter of features.</p> <p> TYPE: <code>DataFrame</code> DEFAULT: <code>None</code> </p> <code>**kwargs</code> <p>Additional keyword arguments to pass to the resampler function. \u50b3\u905e\u7d66\u91cd\u65b0\u53d6\u6a23\u51fd\u6578 resampler \u7684\u5176\u4ed6\u95dc\u9375\u5b57\u5f15\u6578\u3002</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <p>A pandas DataFrame containing all the input features combined. \u4e00\u500b\u5305\u542b\u6240\u6709\u8f38\u5165\u7279\u5fb5\u5408\u4f75\u5f8c\u7684 pandas DataFrame\u3002</p> <p>Examples:</p> <p>\u9019\u6bb5\u7a0b\u5f0f\u78bc\u6559\u6211\u5011\u5982\u4f55\u4f7f\u7528finlab.ml.feature\u548cfinlab.data\u6a21\u7d44\uff0c\u4f86\u5408\u4f75\u5169\u500b\u7279\u5fb5\uff1aRSI\u548c\u80a1\u50f9\u6de8\u503c\u6bd4\u3002\u6211\u5011\u4f7f\u7528f.combine\u51fd\u6578\u4f86\u9032\u884c\u5408\u4f75\uff0c\u5176\u4e2d\u7279\u5fb5\u7684\u540d\u7a31\u662f\u5b57\u5178\u7684\u9375\uff0c\u5c0d\u61c9\u7684\u8cc7\u6599\u662f\u503c\u3002 \u6211\u5011\u5f9edata.indicator('RSI')\u53d6\u5f97'rsi'\u7279\u5fb5\uff0c\u9019\u500b\u51fd\u6578\u8a08\u7b97\u76f8\u5c0d\u5f37\u5f31\u6307\u6578\u3002\u6211\u5011\u5f9edata.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\u53d6\u5f97'pb'\u7279\u5fb5\uff0c\u9019\u500b\u51fd\u6578\u7372\u53d6\u80a1\u50f9\u6de8\u503c\u6bd4\u3002\u6700\u5f8c\uff0c\u6211\u5011\u5f97\u5230\u4e00\u500b\u5305\u542b\u9019\u5169\u500b\u7279\u5fb5\u7684DataFrame\u3002</p> <pre><code>from finlab import data\nimport finlab.ml.feature as f\nimport finlab.ml.qlib as q\nfeatures = f.combine({\n# \u7528 data.get \u7c21\u55ae\u7522\u751f\u51fa\u6280\u8853\u6307\u6a19\n'pb': data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4'),\n# \u7528 data.indicator \u7522\u751f\u6280\u8853\u6307\u6a19\u7684\u7279\u5fb5\n'rsi': data.indicator('RSI'),\n# \u7528 f.ta \u679a\u8209\u8d85\u591a\u7a2e talib \u6307\u6a19\n'talib': f.ta(f.ta_names()),\n# \u5229\u7528 qlib alph158 \u7522\u751f\u6280\u8853\u6307\u6a19\u7684\u7279\u5fb5(\u8acb\u5148\u57f7\u884c q.init(), q.dump() \u624d\u80fd\u4f7f\u7528)\n'qlib158': q.alpha('Alpha158')\n})\nfeatures.head()\n</code></pre> datetime instrument rsi pb 2020-01-01 1101 0 2 2020-01-02 1102 100 3 2020-01-03 1108 100 4"},{"location":"reference/machine_learning/#finlab.ml.feature.ta","title":"ta","text":"<pre><code>ta(feature_names, factories=None, resample=None, start_time=None, end_time=None, adj=False, cpu=-1, **kwargs)\n</code></pre> <p>Calculate technical indicator values for a list of feature names.</p> PARAMETER  DESCRIPTION <code>feature_names</code> <p>A list of technical indicator feature names. Defaults to None.</p> <p> TYPE: <code>Optional[List[str]]</code> </p> <code>factories</code> <p>A dictionary of factories to generate technical indicators. Defaults to {\"talib\": TalibIndicatorFactory()}.</p> <p> TYPE: <code>Optioanl[Dict[str, TalibIndicatorFactory]]</code> DEFAULT: <code>None</code> </p> <code>resample</code> <p>The frequency to resample the data to. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>start_time</code> <p>The start time of the data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>end_time</code> <p>The end time of the data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>**kwargs</code> <p>Additional keyword arguments to pass to the resampler function.</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>pd.DataFrame: technical indicator feature names and their corresponding values.</p>"},{"location":"reference/machine_learning/#finlab.ml.feature.ta_names","title":"ta_names","text":"<pre><code>ta_names(lb=1, ub=10, n=1, factory=None)\n</code></pre> <p>Generate a list of technical indicator feature names.</p> PARAMETER  DESCRIPTION <code>lb</code> <p>The lower bound of the multiplier of the default parameter for the technical indicators.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>ub</code> <p>The upper bound of the multiplier of the default parameter for the technical indicators.</p> <p> TYPE: <code>int</code> DEFAULT: <code>10</code> </p> <code>n</code> <p>The number of random samples for each technical indicator.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>factory</code> <p>A factory object to generate technical indicators. Defaults to TalibIndicatorFactory.</p> <p> TYPE: <code>IndicatorFactory</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>List[str]</code> <p>List[str]: A list of technical indicator feature names.</p> <p>Examples:</p> <pre><code>import finlab.ml.feature as f\n# method 1: generate each indicator with random parameters\nfeatures = f.ta()\n# method 2: generate specific indicator\nfeature_names = ['talib.MACD__macdhist__fastperiod__52__slowperiod__212__signalperiod__75__']\nfeatures = f.ta(feature_names, resample='W')\n# method 3: generate some indicator\nfeature_names = f.ta_names()\nfeatures = f.ta(feature_names)\n</code></pre>"},{"location":"reference/machine_learning/#finlab.ml.label","title":"finlab.ml.label","text":""},{"location":"reference/machine_learning/#finlab.ml.label.daytrading_percentage","title":"daytrading_percentage","text":"<pre><code>daytrading_percentage(index, **kwargs)\n</code></pre> <p>Calculate the percentage change of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.label.excess_over_mean","title":"excess_over_mean","text":"<pre><code>excess_over_mean(index, resample=None, period=1, trade_at_price='close', **kwargs)\n</code></pre> <p>Calculate the excess over mean of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.label.excess_over_median","title":"excess_over_median","text":"<pre><code>excess_over_median(index, resample=None, period=1, trade_at_price='close', **kwargs)\n</code></pre> <p>Calculate the excess over median of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.label.maximum_adverse_excursion","title":"maximum_adverse_excursion","text":"<pre><code>maximum_adverse_excursion(index, period=1, trade_at_price='close')\n</code></pre> <p>Calculate the maximum adverse excursion of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.label.maximum_favorable_excursion","title":"maximum_favorable_excursion","text":"<pre><code>maximum_favorable_excursion(index, period=1, trade_at_price='close')\n</code></pre> <p>Calculate the maximum favorable excursion of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.label.return_percentage","title":"return_percentage","text":"<pre><code>return_percentage(index, resample=None, period=1, trade_at_price='close', bfill=False, **kwargs)\n</code></pre> <p>Calculate the percentage change of market prices over a given period.</p> PARAMETER  DESCRIPTION <code>index</code> <p>A multi-level index of datetime and instrument.</p> <p> TYPE: <code>Index</code> </p> <code>resample</code> <p>The resample frequency for the output data. Defaults to None.</p> <p> TYPE: <code>Optional[str]</code> DEFAULT: <code>None</code> </p> <code>period</code> <p>The number of periods to calculate the percentage change over. Defaults to 1.</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> <code>trade_at_price</code> <p>The price for execution. Defaults to <code>close</code>.</p> <p> TYPE: <code>str</code> DEFAULT: <code>'close'</code> </p> <code>**kwargs</code> <p>Additional arguments to be passed to the resampler function.</p> <p> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: A pd.Series containing the percentage change of stock prices.</p>"},{"location":"reference/machine_learning/#finlab.ml.qlib","title":"finlab.ml.qlib","text":""},{"location":"reference/machine_learning/#finlab.ml.qlib.DumpDataBase","title":"DumpDataBase","text":"<pre><code>DumpDataBase(csv_path, qlib_dir, backup_dir=None, freq='day', max_workers=16, date_field_name='date', file_suffix='.csv', symbol_field_name='symbol', exclude_fields='', include_fields='', limit_nums=None)\n</code></pre> <p>Base class for dumping data to Qlib format.</p> PARAMETER  DESCRIPTION <code>csv_path</code> <p>The path to the CSV file or directory containing the CSV files.</p> <p> TYPE: <code>str</code> </p> <code>qlib_dir</code> <p>The directory where the Qlib data will be saved.</p> <p> TYPE: <code>str</code> </p> <code>backup_dir</code> <p>The directory where the backup of the Qlib data will be saved. Defaults to None.</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>freq</code> <p>The frequency of the data. Defaults to \"day\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>'day'</code> </p> <code>max_workers</code> <p>The maximum number of workers for parallel processing. Defaults to 16.</p> <p> TYPE: <code>int</code> DEFAULT: <code>16</code> </p> <code>date_field_name</code> <p>The name of the date field in the CSV file. Defaults to \"date\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>'date'</code> </p> <code>file_suffix</code> <p>The suffix of the CSV file. Defaults to \".csv\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>'.csv'</code> </p> <code>symbol_field_name</code> <p>The name of the symbol field in the CSV file. Defaults to \"symbol\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>'symbol'</code> </p> <code>exclude_fields</code> <p>The fields to exclude from the dumped data. Defaults to \"\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>''</code> </p> <code>include_fields</code> <p>The fields to include in the dumped data. Defaults to \"\".</p> <p> TYPE: <code>str</code> DEFAULT: <code>''</code> </p> <code>limit_nums</code> <p>The maximum number of CSV files to process. Defaults to None.</p> <p> TYPE: <code>int</code> DEFAULT: <code>None</code> </p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.CatBoostModel","title":"CatBoostModel","text":"<pre><code>CatBoostModel()\n</code></pre> <p>CatBoostModel is a wrapper model for CatBoost model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.CatBoostModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.DEnsmbleModel","title":"DEnsmbleModel","text":"<pre><code>DEnsmbleModel()\n</code></pre> <p>DEnsmbleModel is a wrapper model for Double Ensemble model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.DEnsmbleModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.DNNModel","title":"DNNModel","text":"<pre><code>DNNModel()\n</code></pre> <p>DNNModel is a wrapper model for Deep Neural Network model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.DNNModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.LGBModel","title":"LGBModel","text":"<pre><code>LGBModel()\n</code></pre> <p>LGBModel is a wrapper model for LightGBM model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.LGBModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.LinearModel","title":"LinearModel","text":"<pre><code>LinearModel()\n</code></pre> <p>LinearModel is a wrapper model for Linear model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.LinearModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.SFMModel","title":"SFMModel","text":"<pre><code>SFMModel()\n</code></pre> <p>SFMModel is a wrapper model for SFM. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.SFMModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.TabnetModel","title":"TabnetModel","text":"<pre><code>TabnetModel()\n</code></pre> <p>TabnetModel is a wrapper model for Tabnet model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.TabnetModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.XGBModel","title":"XGBModel","text":"<pre><code>XGBModel()\n</code></pre> <p>XGBModel is a wrapper model for XGBoost model. <pre><code>import finlab.ml.qlib as q\n# build X_train, y_train, X_test\nmodel = q.XGBModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.alpha","title":"alpha","text":"<pre><code>alpha(handler='Alpha158', **kwargs)\n</code></pre> <p>\u7522\u751f Qlib \u7684\u7279\u5fb5 Args:     handler (str): \u9810\u8a2d\u70ba 'alpha158' \u4e5f\u53ef\u4ee5\u8a2d\u5b9a\u6210 'Alpha360' Examples:     <pre><code>import finlab.ml.qlib as q\nfeatures = q.alpha('Alpha158')\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.dump","title":"dump","text":"<pre><code>dump(freq='day')\n</code></pre> <p>\u7522\u751fQlib \u65bc\u53f0\u80a1\u7684\u8cc7\u6599\u5eab Examples:     <pre><code>import qlib\nimport finlab.ml.qlib as q\nq.dump() # generate tw stock database\nq.init() # initiate tw stock to perform machine leraning tasks (similar to qlib.init)\nimport qlib\n# qlib functions and operations\n</code></pre></p>"},{"location":"reference/machine_learning/#finlab.ml.qlib.get_models","title":"get_models","text":"<pre><code>get_models()\n</code></pre> <p>Return a list of available models. Examples:     <pre><code>import finlab.ml._qlib as q\nmodels = q.get_models()\nprint(models)\n</code></pre>     output:</p> <pre><code>{ 'LGBModel': LGBModel, 'XGBModel': XGBModel, 'DEnsmbleModel': DEnsmbleModel, 'CatBoostModel': CatBoostModel, 'LinearModel': LinearModel, 'TabnetModel': TabnetModel, 'DNNModel': DNNModel, 'SFMModel': SFMModel}\n</code></pre>"},{"location":"reference/machine_learning/#finlab.ml.qlib.init","title":"init","text":"<pre><code>init()\n</code></pre> <p>Qlib \u521d\u59cb\u5316 (\u985e\u4f3c\u65bc\u53f0\u80a1\u7248 qlib.init() \u4f46\u66f4\u7c21\u55ae\u6613\u7528) Examples:     <pre><code>import qlib\nimport finlab.ml.qlib as q\nq.dump() # generate tw stock database\nq.init() # initiate tw stock to perform machine leraning tasks (similar to qlib.init)\nimport qlib\n# qlib functions and operations\n</code></pre></p>"},{"location":"reference/market/","title":"finlab.market","text":""},{"location":"reference/market/#finlab.market.Market","title":"finlab.market.Market","text":"<p>             Bases: <code>ABC</code></p> <p>\u5e02\u5834\u985e\u5225 \u5047\u5982\u5e0c\u671b\u958b\u767c\u65b0\u7684\u4ea4\u6613\u5e02\u5834\u5957\u7528\u5230\u56de\u6e2c\u7cfb\u7d71\uff0c\u53ef\u4ee5\u7e7c\u627f <code>finlab.market.Market</code> \u4f86\u5be6\u505a\u65b0\u985e\u5225\u3002</p>"},{"location":"reference/market/#finlab.market.Market.get_asset_id_to_name","title":"get_asset_id_to_name  <code>staticmethod</code>","text":"<pre><code>get_asset_id_to_name()\n</code></pre> <p>\u8a2d\u5b9a\u5c0d\u6a19\u5831\u916c\u7387\u7684\u6642\u9593\u5e8f\u5217 Returns:   (dict): \u80a1\u865f\u8207\u80a1\u540d\u5c0d\u7167\u8868\uff0cex:<code>{'2330':'\u53f0\u7a4d\u96fb'}</code></p>"},{"location":"reference/market/#finlab.market.Market.get_benchmark","title":"get_benchmark  <code>staticmethod</code>","text":"<pre><code>get_benchmark()\n</code></pre> <p>\u8a2d\u5b9a\u5c0d\u6a19\u5831\u916c\u7387\u7684\u6642\u9593\u5e8f\u5217</p> <p>\u9019\u500b\u51fd\u6578\u7528\u65bc\u8a2d\u5b9a\u5c0d\u6a19\u5831\u916c\u7387\u7684\u6642\u9593\u5e8f\u5217\u3002</p> RETURNS DESCRIPTION <code>Series</code> <p>pd.Series: \u6642\u9593\u5e8f\u5217\u7684\u5831\u916c\u7387\u3002</p> RAISES DESCRIPTION <code>ExceptionType</code> <p>Description of conditions under which the exception is raised.</p> <p>Examples:</p> date 0050 2007-04-23 100 2007-04-24 100.1 2007-04-25 99 2007-04-26 98.3 2007-04-27 99.55"},{"location":"reference/market/#finlab.market.Market.get_board_lot_size","title":"get_board_lot_size  <code>staticmethod</code>","text":"<pre><code>get_board_lot_size()\n</code></pre> <p>Returns the board lot size of the market.</p> RETURNS DESCRIPTION <code>int</code> <p>The board lot size of the market.</p> <p> TYPE: <code>int</code> </p>"},{"location":"reference/market/#finlab.market.Market.get_freq","title":"get_freq  <code>staticmethod</code>","text":"<pre><code>get_freq()\n</code></pre> <p>Returns the frequency of the data. Used to determine how to resample the data when the data is not daily. The freq will be saved in <code>finlab.core.report</code>.</p> <p>Returns: str: The frequency of the data.</p>"},{"location":"reference/market/#finlab.market.Market.get_market_value","title":"get_market_value  <code>staticmethod</code>","text":"<pre><code>get_market_value()\n</code></pre> <p>\u53d6\u5f97\u56de\u6e2c\u7528\u5e02\u503c\u6578\u64da</p> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u5e02\u503c\u6578\u64da\uff0c\u5176\u4e2d index \u70ba\u65e5\u671f\uff0c\u800c columns \u662f\u80a1\u7968\u4ee3\u865f\u3002</p>"},{"location":"reference/market/#finlab.market.Market.get_name","title":"get_name  <code>staticmethod</code>","text":"<pre><code>get_name()\n</code></pre> <p>Returns the name of the market data source.</p> <p>This function is used to get the name of the market data source.</p>"},{"location":"reference/market/#finlab.market.Market.get_odd_lot","title":"get_odd_lot  <code>staticmethod</code>","text":"<pre><code>get_odd_lot()\n</code></pre> <p>Returns the odd lot size of the market.</p> RETURNS DESCRIPTION <code>int</code> <p>The odd lot size of the market.</p> <p> TYPE: <code>int</code> </p>"},{"location":"reference/market/#finlab.market.Market.get_price","title":"get_price  <code>abstractmethod</code>","text":"<pre><code>get_price(trade_at_price, adj=True)\n</code></pre> <p>\u53d6\u5f97\u56de\u6e2c\u7528\u50f9\u683c\u6578\u64da</p> PARAMETER  DESCRIPTION <code>trade_at_price</code> <p>\u9078\u64c7\u56de\u6e2c\u4e4b\u9084\u539f\u80a1\u50f9\u4ee5\u6536\u76e4\u50f9\u6216\u958b\u76e4\u50f9\u8a08\u7b97\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078'close'\u6216'open'\u3002</p> <p> TYPE: <code>str</code> </p> <code>adj</code> <p>\u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\u8a08\u7b97\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>True</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u50f9\u683c\u6578\u64da</p> <p>Examples:</p> <p>\u683c\u5f0f\u7bc4\u4f8b</p> date 0015 0050 0051 0052 2007-04-23 9.54 57.85 32.83 38.4 2007-04-24 9.54 58.1 32.99 38.65 2007-04-25 9.52 57.6 32.8 38.59 2007-04-26 9.59 57.7 32.8 38.6 2007-04-27 9.55 57.5 32.72 38.4"},{"location":"reference/market/#finlab.market.Market.get_reference_price","title":"get_reference_price","text":"<pre><code>get_reference_price()\n</code></pre> <p>Returns the most recent reference price of the market.</p> RETURNS DESCRIPTION <code>Dict[str, float]</code> <p>pandas.Series: The most recent reference price of the market.</p>"},{"location":"reference/market/#finlab.market.Market.get_trading_price","title":"get_trading_price","text":"<pre><code>get_trading_price(name, adj=True)\n</code></pre> <p>\u53d6\u5f97\u56de\u6e2c\u7528\u50f9\u683c\u6578\u64da</p> PARAMETER  DESCRIPTION <code>name</code> <p>\u9078\u64c7\u56de\u6e2c\u4e4b\u9084\u539f\u80a1\u50f9\u4ee5\u6536\u76e4\u50f9\u6216\u958b\u76e4\u50f9\u8a08\u7b97\uff0c\u9810\u8a2d\u70ba'close'\u3002\u53ef\u9078 'open'\u3001'close'\u3001'high'\u3001'low'\u3001'open_close_avg'\u3001'high_low_avg'\u3001\u6216 'price_avg'\u3002</p> <p> TYPE: <code>str</code> </p> <p>Returns:     (pd.DataFrame): \u50f9\u683c\u6578\u64da</p>"},{"location":"reference/market/#finlab.market.Market.market_close_at_timestamp","title":"market_close_at_timestamp","text":"<pre><code>market_close_at_timestamp(timestamp=None)\n</code></pre> <p>Returns the timestamp of the market close of the given timestamp.</p> PARAMETER  DESCRIPTION <code>timestamp</code> <p>The timestamp to find the market close to.</p> <p> TYPE: <code>datetime</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>datetime</code> <p>The timestamp of the closest market close.</p>"},{"location":"reference/market/#finlab.market.Market.tzinfo","title":"tzinfo  <code>staticmethod</code>","text":"<pre><code>tzinfo()\n</code></pre> <p>Returns the timezone of the market.</p> RETURNS DESCRIPTION <code>Union[timezone, None]</code> <p>datetime.timezone: The timezone of the market.</p>"},{"location":"reference/online/","title":"finlab.online","text":""},{"location":"reference/online/#finlab.online.base_account.Account","title":"finlab.online.base_account.Account","text":"<p>             Bases: <code>ABC</code></p>"},{"location":"reference/online/#finlab.online.base_account.Account.module_version","title":"module_version  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>module_version = ''\n</code></pre> <p>\u80a1\u7968\u5e33\u6236\u7684 abstract class \u53ef\u4ee5\u7e7c\u627f\u6b64 Account\uff0c\u4f86\u5be6\u505a\u5238\u5546\u7684\u5e33\u6236\u8cb7\u8ce3\u52d5\u4f5c\uff0c\u76ee\u524d\u5df2\u7d93\u5be6\u505a SinopacAccount (\u6c38\u8c50\u8b49\u5238) \u4ee5\u53ca FugleAccount (\u7389\u5c71\u5bcc\u679c)\uff0c\u4f86\u9032\u884c\u4ea4\u6613\u3002\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u5efa\u69cb\u7269\u4ef6\u4e26\u7528\u4f86\u4ea4\u6613\uff1a</p> <p>\u6c38\u8c50\u8b49\u5238 <pre><code>import os\nfrom finlab.online.sinopac_account import SinopacAccount\n# \u820a\u7248\u8acb\u4f7f\u7528\n# shioaji &lt; 1.0.0 and finlab &lt; 0.3.18\nos.environ['SHIOAJI_ACCOUNT']= '\u6c38\u8c50\u8b49\u5238\u5e33\u865f'\nos.environ['SHIOAJI_PASSWORD']= '\u6c38\u8c50\u8b49\u5238\u5bc6\u78bc'\n# \u65b0\u7248\u8acb\u4f7f\u7528\n# shioaji &gt;= 1.0.0 and finlab &gt;= 0.3.18\nos.environ['SHIOAJI_API_KEY'] = '\u6c38\u8c50\u8b49\u5238API_KEY'\nos.environ['SHIOAJI_SECRET_KEY'] = '\u6c38\u8c50\u8b49\u5238SECRET_KEY'\nos.environ['SHIOAJI_CERT_PERSON_ID']= '\u8eab\u4efd\u8b49\u5b57\u865f'\n# shioaji\nos.environ['SHIOAJI_CERT_PATH']= '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u8def\u5f91'\nos.environ['SHIOAJI_CERT_PASSWORD'] = '\u6c38\u8c50\u8b49\u5238\u6191\u8b49\u5bc6\u78bc' # \u9810\u8a2d\u8207\u8eab\u4efd\u8b49\u5b57\u865f\nacc = SinopacAccount()\n</code></pre> \u7389\u5c71\u5bcc\u679c: <pre><code>from finlab.online.fugle_account import FugleAccount\nimport os\nos.environ['FUGLE_CONFIG_PATH'] = '\u7389\u5c71\u5bcc\u679c\u4ea4\u6613\u8a2d\u5b9a\u6a94(config.ini.example)\u8def\u5f91'\nos.environ['FUGLE_MARKET_API_KEY'] = '\u7389\u5c71\u5bcc\u679c\u7684\u884c\u60c5API Token'\nacc = FugleAccount()\n</code></pre></p>"},{"location":"reference/online/#finlab.online.base_account.Account.cancel_order","title":"cancel_order  <code>abstractmethod</code>","text":"<pre><code>cancel_order(order_id)\n</code></pre> <p>\u522a\u9664\u59d4\u8a17\u55ae</p> <p>\u5efa\u8b70\u4f7f\u7528 \u522a\u9664\u59d4\u8a17\u55ae\u6b64\u529f\u80fd\u524d\uff0c\u5148\u4f7f\u7528 update_order() \u4f86\u66f4\u65b0\u59d4\u8a17\u55ae\u7684\u72c0\u6cc1\uff01\u5982\u4e0b <pre><code>acc.update_order()\nacc.cancel_order('ORDER_ID')\n</code></pre></p> ATTRIBUTE DESCRIPTION <code>order_id</code> <p>\u5238\u5546\u6240\u63d0\u4f9b\u7684\u59d4\u8a17\u55ae ID</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>None</code> <p>\u4ee3\u8868\u6210\u529f\u66f4\u65b0\u59d4\u8a17\u55ae</p>"},{"location":"reference/online/#finlab.online.base_account.Account.create_order","title":"create_order  <code>abstractmethod</code>","text":"<pre><code>create_order(action, stock_id, quantity, price=None, odd_lot=False, market_order=False, best_price_limit=None, order_cond=OrderCondition.CASH)\n</code></pre> <p>\u7522\u751f\u65b0\u7684\u59d4\u8a17\u55ae</p> PARAMETER  DESCRIPTION <code>action</code> <p>\u8cb7\u8ce3\u65b9\u5411\uff0c\u901a\u5e38\u70ba 'BUY' \u6216\u662f 'SELL'</p> <p> TYPE: <code>Action</code> </p> <code>stock_id</code> <p>\u80a1\u7968\u4ee3\u865f ex: '2330'</p> <p> TYPE: <code>str</code> </p> <code>quantity</code> <p>\u59d4\u8a17\u80a1\u7968\u7684\u7e3d\u6578\u91cf\uff08\u5f35\u6578\uff09\uff0c\u5141\u8a31\u5c0f\u6578\u9ede</p> <p> TYPE: <code>Number</code> </p> <code>price</code> <p>\u80a1\u7968\u8cb7\u8ce3\u7684\u50f9\u683c(\u9650\u50f9\u55ae)</p> <p> TYPE: <code>Number</code> DEFAULT: <code>None</code> </p> <code>force</code> <p>\u662f\u5426\u7528\u6700\u5dee\u4e4b\u50f9\u683c\uff08\u9577\u8dcc\u505c\uff09\u5f37\u5236\u6210\u4ea4? \u7576\u6210\u4ea4\u91cf\u8db3\u5920\u6642\uff0c\u53ef\u4ee5\u6bd4\u8f03\u5feb\u6210\u4ea4\uff0c\u7136\u800c\u7576\u6210\u4ea4\u91cf\u4f4e\u6642\uff0c\u5bb9\u6613\u6709\u5927\u7684\u6ed1\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>wait_for_best_price</code> <p>\u662f\u5426\u7528\u6700\u4f73\u4e4b\u50f9\u683c\uff08\u9577\u8dcc\u505c\uff09\uff0c\u7121\u9650\u6642\u9593\u7b49\u5f85\uff1f\u7576\u4eca\u5929\u8981\u51fa\u5834\u6642\uff0c\u53ef\u4ee5\u958b\u555f\u7b49\u6f32\u505c\u50f9\u4f86\u8cfc\u8cb7\uff0c\u7576\u4eca\u5929\u8981\u8cb7\u5165\u6642\uff0c\u53ef\u4ee5\u639b\u8dcc\u505c\u50f9\u7b49\u5f85\u8cb7\u5165\u6642\u6a5f\u3002</p> <p> TYPE: <code>bool</code> </p> RETURNS DESCRIPTION <code>str</code> <p>order id \u5238\u5546\u63d0\u4f9b\u7684\u59d4\u8a17\u55ae\u7de8\u865f</p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_cash","title":"get_cash  <code>abstractmethod</code>","text":"<pre><code>get_cash()\n</code></pre> <p>\u62ff\u5230\u7576\u524d\u5e33\u6236\u7684\u73fe\u91d1</p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_market","title":"get_market","text":"<pre><code>get_market()\n</code></pre> <p>\u62ff\u5230\u7576\u524d\u5e33\u6236\u7684\u5e02\u5834</p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_orders","title":"get_orders  <code>abstractmethod</code>","text":"<pre><code>get_orders()\n</code></pre> <p>\u62ff\u5230\u73fe\u5728\u6240\u6709\u59d4\u8a17\u55ae</p> RETURNS DESCRIPTION <code>Dict[str, Order]</code> <p>\u6240\u6709\u59d4\u8a17\u55ae id \u8207\u59d4\u8a17\u55ae\u8cc7\u6599</p> <p>Example</p> <p><code>{'12345A': Order(order_id='12345A', stock_id='5410',...),...}</code></p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_position","title":"get_position  <code>abstractmethod</code>","text":"<pre><code>get_position()\n</code></pre> <p>\u62ff\u5230\u7576\u524d\u5e33\u6236\u7684\u80a1\u7968\u90e8\u4f4d</p> RETURNS DESCRIPTION <code>Position</code> <p>\u7576\u524d\u80a1\u7968\u90e8\u4f4d</p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_settlement","title":"get_settlement  <code>abstractmethod</code>","text":"<pre><code>get_settlement()\n</code></pre> <p>\u62ff\u5230\u7576\u524d\u5e33\u6236\u7684\u7d50\u7b97\u8cc7\u6599</p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_stocks","title":"get_stocks  <code>abstractmethod</code>","text":"<pre><code>get_stocks(stock_ids)\n</code></pre> <p>\u62ff\u5230\u73fe\u5728\u80a1\u7968\u5831\u50f9</p> ATTRIBUTE DESCRIPTION <code>stock_ids</code> <p>\u4e00\u6b21\u62ff\u53d6\u6240\u6709\u80a1\u7968\u7684\u5831\u50f9\uff0cex: ['1101', '2330']</p> <p> TYPE: <code>`list` of `str`</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>\u5831\u50f9\u8cc7\u6599\uff0c</p> <p>Example</p> <p><code>{'1101': Stock(stock_id='1101', open=31.15, high=31.85, low=31.1, close=31.65, bid_price=31.6, bid_volume=728.0, ask_price=31.65, ask_volume=202)}</code></p>"},{"location":"reference/online/#finlab.online.base_account.Account.get_total_balance","title":"get_total_balance  <code>abstractmethod</code>","text":"<pre><code>get_total_balance()\n</code></pre> <p>\u62ff\u5230\u7576\u524d\u5e33\u6236\u7684\u80a1\u7968\u90e8\u4f4d\u6de8\u503c</p>"},{"location":"reference/online/#finlab.online.base_account.Account.update_order","title":"update_order  <code>abstractmethod</code>","text":"<pre><code>update_order(order_id, price=None, quantity=None)\n</code></pre> <p>\u7522\u751f\u65b0\u7684\u59d4\u8a17\u55ae</p> ATTRIBUTE DESCRIPTION <code>order_id</code> <p>\u5238\u5546\u6240\u63d0\u4f9b\u7684\u59d4\u8a17\u55ae ID</p> <p> TYPE: <code>str</code> </p> <code>price</code> <p>\u66f4\u65b0\u7684\u9650\u50f9</p> <p> TYPE: <code>Number</code> </p> <code>quantity</code> <p>\u66f4\u65b0\u7684\u5f85\u6210\u4ea4\u91cf</p> <p> TYPE: <code>Number</code> </p> RETURNS DESCRIPTION <code>None</code> <p>\u7121\u8df3\u51fa erorr \u4ee3\u8868\u6210\u529f\u66f4\u65b0\u59d4\u8a17\u55ae</p>"},{"location":"reference/online/#finlab.online.order_executor.Position","title":"finlab.online.order_executor.Position","text":"<pre><code>Position(stocks, weights=None, margin_trading=False, short_selling=False, day_trading_long=False, day_trading_short=False)\n</code></pre> <p>\u4f7f\u7528\u8005\u53ef\u4ee5\u5229\u7528 Position \u8f15\u9b06\u5efa\u69cb\u80a1\u7968\u7684\u90e8\u4f4d\uff0c\u4e26\u4e14\u5229\u7528 OrderExecuter \u5c07\u6b64\u90e8\u4f4d\u540c\u6b65\u65bc\u5be6\u969b\u7684\u80a1\u7968\u5e33\u6236\u3002</p> <p>\u5efa\u69cb\u80a1\u7968\u90e8\u4f4d</p> ATTRIBUTE DESCRIPTION <code>stocks</code> <p><code>number.Number</code>): \u80a1\u7968\u4ee3\u865f\u8207\u5f35\u6578 ex: {'1101': 1} \u662f\u6307\u6301\u6709\u4e00\u5f35 1101 \u53f0\u6ce5\uff0c\u53ef\u4ee5\u63a5\u53d7\u8ca0\u6578\uff0c\u4ee3\u8868\u505a\u7a7a\u3002</p> <p> TYPE: <code>`dict` of `str`</code> </p> <code>margin_trading</code> <p>\u505a\u591a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u8cc7</p> <p> TYPE: <code>bool</code> </p> <code>short_selling</code> <p>\u505a\u7a7a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u5238</p> <p> TYPE: <code>bool</code> </p> <code>day_trading_long</code> <p>\u505a\u591a\u90e8\u4f4d\u70ba\u7576\u6c96\u5148\u505a\u591a</p> <p> TYPE: <code>bool</code> </p> <code>day_trading_short</code> <p>\u505a\u7a7a\u90e8\u4f4d\u70ba\u7576\u6c96\u5148\u505a\u7a7a</p> <p> TYPE: <code>bool</code> </p> <p>Examples:</p> <p>\u8a2d\u8a08\u90e8\u4f4d\uff0c\u6301\u6709\u4e00\u5f35\u548c 100 \u80a1 1101 <pre><code>from finlab.online.order_executor import Position\nPosition({'1101': 1.1})\n</code></pre> output <pre><code>[\n{'stock_id': '1101',\n'quantity': 1.1,\n'order_condition': &lt;OrderCondition.CASH: 1&gt;\n}\n]\n</code></pre></p> <p>\u5c07\u5169\u500b\u90e8\u4f4d\u76f8\u52a0 <pre><code>from finlab.online.order_executor import Position\np1 = Position({'1101': 1})\np2 = Position({'2330': 1})\np1 + p2\n</code></pre> output <pre><code>[\n{'stock_id': '1101', 'quantity': 1.0, 'order_condition': &lt;OrderCondition.CASH: 1&gt;},\n{'stock_id': '2330', 'quantity': 1.0, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}\n]\n</code></pre></p>"},{"location":"reference/online/#finlab.online.order_executor.Position.from_json","title":"from_json  <code>classmethod</code>","text":"<pre><code>from_json(path)\n</code></pre> <p>Load a JSON file from the given path and convert it to a list of positions.</p> PARAMETER  DESCRIPTION <code>path</code> <p>The path to the JSON file.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/online/#finlab.online.order_executor.Position.from_list","title":"from_list  <code>classmethod</code>","text":"<pre><code>from_list(position)\n</code></pre> <p>\u5229\u7528 <code>dict</code> \u5efa\u69cb\u80a1\u7968\u90e8\u4f4d</p> ATTRIBUTE DESCRIPTION <code>position</code> <p>\u80a1\u7968\u8a73\u7d30\u90e8\u4f4d <pre><code>from finlab.online.enums import OrderCondition\nfrom finlab.online.order_executor import Position\nPosition.from_list(\n[{\n'stock_id': '1101', # \u80a1\u7968\u4ee3\u865f\n'quantity': 1.1, # \u5f35\u6578\n'order_condition': OrderCondition.CASH # \u73fe\u80a1\u878d\u8cc7\u878d\u5238\u3001\u5148\u8cb7\u5f8c\u8ce3\n}])\n</code></pre></p> <p>\u5176\u4e2d OrderCondition \u9664\u4e86 <code>CASH</code> \u5916\uff0c\u9084\u6709 <code>MARGIN_TRADING</code>\u3001<code>DAY_TRADING_LONG</code>\u3001<code>SHORT_SELLING</code>\u3001<code>DAY_TRADING_SHORT</code>\u3002</p> <p> TYPE: <code>`list` of `dict`</code> </p>"},{"location":"reference/online/#finlab.online.order_executor.Position.from_report","title":"from_report  <code>classmethod</code>","text":"<pre><code>from_report(report, fund, **kwargs)\n</code></pre> <p>\u5229\u7528\u56de\u6e2c\u5b8c\u7684\u5831\u544a <code>finlab.report.Report</code> \u5efa\u69cb\u80a1\u7968\u90e8\u4f4d\u3002</p> ATTRIBUTE DESCRIPTION <code>report</code> <p>\u56de\u6e2c\u5b8c\u7684\u7d50\u679c\u5831\u544a\u3002</p> <p> TYPE: <code>Report</code> </p> <code>fund</code> <p>\u5e0c\u671b\u90e8\u5c6c\u7684\u8cc7\u91d1\u3002</p> <p> TYPE: <code>int</code> </p> <code>price</code> <p>\u80a1\u7968\u4ee3\u865f\u5c0d\u61c9\u5230\u7684\u50f9\u683c\uff0c\u82e5\u7121\u5247\u4f7f\u7528\u6700\u8fd1\u500b\u4ea4\u6613\u65e5\u7684\u6536\u76e4\u50f9\u3002</p> <p> TYPE: <code>pd.Series or `dict` of `float`</code> </p> <code>odd_lot</code> <p>\u662f\u5426\u8003\u616e\u96f6\u80a1\u3002\u9810\u8a2d\u70ba False\uff0c\u53ea\u4f7f\u7528\u6574\u5f35\u64cd\u4f5c\u3002</p> <p> TYPE: <code>bool</code> </p> <code>board_lot_size</code> <p>\u4e00\u5f35\u80a1\u7968\u7b49\u65bc\u5e7e\u80a1\u3002\u9810\u8a2d\u70ba1000\uff0c\u4e00\u5f35\u7b49\u65bc1000\u80a1\u3002</p> <p> TYPE: <code>int</code> </p> <code>allocation</code> <p>\u8cc7\u7522\u914d\u7f6e\u6f14\u7b97\u6cd5\u9078\u5b9a\uff0c\u9810\u8a2d\u70ba<code>finlab.online.utils.greedy_allocation</code>\uff08\u6700\u5927\u8cc7\u91d1\u90e8\u5c6c\u8caa\u5a6a\u6cd5\uff09\u3002</p> <p> TYPE: <code>func</code> </p> <code>margin_trading</code> <p>\u505a\u591a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u8cc7</p> <p> TYPE: <code>bool</code> </p> <code>short_selling</code> <p>\u505a\u7a7a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u5238</p> <p> TYPE: <code>bool</code> </p> <code>day_trading_long</code> <p>\u505a\u591a\u90e8\u4f4d\u70ba\u7576\u6c96\u5148\u505a\u591a</p> <p> TYPE: <code>bool</code> </p> <code>day_trading_short</code> <p>\u505a\u7a7a\u90e8\u4f4d\u70ba\u7576\u6c96\u5148\u505a\u7a7a</p> <p> TYPE: <code>bool</code> </p> <code>leverage</code> <p>\u76ee\u6a19\u69d3\u687f\u500d\u6578\uff0c\u9810\u8a2d\u70ba1.0\uff08\u4e0d\u4f7f\u7528\u878d\u8cc7\uff09\u3002\u82e5&gt;1.0\uff0c\u6703\u6839\u64da\u6ce2\u52d5\u5ea6\u5206\u914d\u878d\u8cc7\u3002</p> <p> TYPE: <code>float</code> </p> <p>Example</p> <pre><code>from finlab import backtest\nfrom finlab.online.order_executor import Position\nreport1 = backtest.sim(...)\nreport2 = backtest.sim(...)\nposition1 = Position.from_report(report1, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\nposition2 = Position.from_report(report2, 1000000) # \u7b56\u7565\u64cd\u4f5c\u91d1\u984d\u4e00\u767e\u842c\ntotal_position = position1 + position2\n</code></pre>"},{"location":"reference/online/#finlab.online.order_executor.Position.from_weight","title":"from_weight  <code>classmethod</code>","text":"<pre><code>from_weight(weights, fund, price=None, odd_lot=False, board_lot_size=None, allocation=greedy_allocation, precision=None, leverage=1.0, price_history=None, **kwargs)\n</code></pre> <p>\u5229\u7528 <code>weight</code> \u5efa\u69cb\u80a1\u7968\u90e8\u4f4d</p> ATTRIBUTE DESCRIPTION <code>weights</code> <p>\u80a1\u7968\u8a73\u7d30\u90e8\u4f4d\uff0c\u80a1\u7968\u4ee3\u865f\u5c0d\u61c9\u6b0a\u91cd</p> <p> TYPE: <code>dict[str, float] \u6216 pd.Series</code> </p> <code>fund</code> <p>\u8cc7\u91d1\u5927\u5c0f</p> <p> TYPE: <code>int</code> </p> <code>price</code> <p>\u80a1\u7968\u4ee3\u865f\u5c0d\u61c9\u5230\u7684\u50f9\u683c\uff0c\u82e5\u7121\u5247\u4f7f\u7528\u6700\u8fd1\u500b\u4ea4\u6613\u65e5\u7684\u6536\u76e4\u50f9\u3002</p> <p> TYPE: <code>None \u6216 pd.Series \u6216 dict[str, float]</code> </p> <code>odd_lot</code> <p>\u662f\u5426\u8003\u616e\u96f6\u80a1</p> <p> TYPE: <code>bool</code> </p> <code>board_lot_size</code> <p>\u4e00\u5f35\u80a1\u7968\u7b49\u65bc\u5e7e\u80a1</p> <p> TYPE: <code>None \u6216 int</code> </p> <code>allocation</code> <p>\u8cc7\u7522\u914d\u7f6e\u6f14\u7b97\u6cd5\u9078\u5b9a\uff0c\u9810\u8a2d\u70ba<code>finlab.online.utils.greedy_allocation</code>\uff08\u6700\u5927\u8cc7\u91d1\u90e8\u5c6c\u8caa\u5a6a\u6cd5\uff09</p> <p> TYPE: <code>function</code> </p> <code>precision</code> <p>\u8a08\u7b97\u5f35\u6578\u6642\u7684\u7cbe\u5ea6\uff0c\u9810\u8a2d\u70ba None \u4ee3\u8868\u4f9d\u7167 board_lot_size \u800c\u5b9a\uff0c\u800c 1 \u4ee3\u8868 0.1 \u5f35\uff0c2 \u4ee3\u8868 0.01 \u5f35\uff0c\u4ee5\u6b64\u985e\u63a8\u3002</p> <p> TYPE: <code>None \u6216 int</code> </p> <code>leverage</code> <p>\u76ee\u6a19\u69d3\u687f\u500d\u6578\uff0c\u9810\u8a2d\u70ba1.0\uff08\u4e0d\u4f7f\u7528\u878d\u8cc7\uff09\u3002\u82e5&gt;1.0\uff0c\u6703\u6839\u64da\u6ce2\u52d5\u5ea6\u5206\u914d\u878d\u8cc7\u3002</p> <p> TYPE: <code>float</code> </p> <code>price_history</code> <p>\u80a1\u7968\u6b77\u53f2\u50f9\u683c\uff0c\u82e5 leverage &gt; 1.0 \u6642\u5fc5\u9808\u63d0\u4f9b\u3002</p> <p> TYPE: <code>None \u6216 pd.DataFrame</code> </p> <code>margin_trading</code> <p>\u505a\u591a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u8cc7</p> <p> TYPE: <code>bool</code> </p> <code>short_selling</code> <p>\u505a\u7a7a\u90e8\u4f4d\u662f\u5426\u4f7f\u7528\u878d\u5238</p> <p> TYPE: <code>bool</code> </p> <code>day_trading_long</code> <p>\u505a\u591a\u90e8\u4f4d\u70ba\u7576\u6c96\u5148\u505a\u591a</p> <p> TYPE: <code>bool</code> </p> <p>Examples:</p> <p>\u4f8b\u5982\uff0c\u7528 100 \u842c\u7684\u8cc7\u91d1\uff0c\u5168\u90e8\u6295\u5165\uff0c\u6301\u6709 1101 \u548c 2330 \u5404\u4e00\u534a\uff1a <pre><code>from finlab.online.order_executor import Position\nPosition.from_weight({\n'1101': 0.5,\n'2330': 0.5,\n}, fund=1000000)\n</code></pre> output ``` [</p> <pre><code>{'stock_id': '1101', 'quantity': 13, 'order_condition': &lt;OrderCondition.CASH: 1&gt;},\n{'stock_id': '2330', 'quantity': 1, 'order_condition': &lt;OrderCondition.CASH: 1&gt;}\n  ]\n  ```\n</code></pre>"},{"location":"reference/online/#finlab.online.order_executor.Position.to_json","title":"to_json","text":"<pre><code>to_json(path)\n</code></pre> <p>Converts the position dictionary to a JSON file and saves it to the specified path.</p> PARAMETER  DESCRIPTION <code>path</code> <p>The path where the JSON file will be saved.</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor","title":"finlab.online.order_executor.OrderExecutor","text":"<pre><code>OrderExecutor(target_position, account)\n</code></pre> <p>\u5c0d\u6bd4\u5be6\u969b\u5e33\u6236\u8207\u6b32\u90e8\u5c6c\u7684\u80a1\u7968\u90e8\u4f4d\uff0c\u9032\u884c\u540c\u6b65 Arguments:     target_position (Position): \u60f3\u8981\u90e8\u5c6c\u7684\u80a1\u7968\u90e8\u4f4d\u3002     account (Account): \u76ee\u524d\u652f\u63f4\u6c38\u8c50\u8207\u5bcc\u679c\u5e33\u6236\uff0c\u8acb\u53c3\u8003 Account \u4f86\u5be6\u505a\u3002</p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.cancel_orders","title":"cancel_orders","text":"<pre><code>cancel_orders()\n</code></pre> <p>\u522a\u9664\u6240\u6709\u672a\u5be6\u73fe\u59d4\u8a17\u55ae</p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.create_orders","title":"create_orders","text":"<pre><code>create_orders(market_order=False, best_price_limit=False, view_only=False, extra_bid_pct=0, progress=1, progress_precision=0, buy_only=False, sell_only=False)\n</code></pre> <p>\u7522\u751f\u59d4\u8a17\u55ae\uff0c\u5c07\u90e8\u4f4d\u540c\u6b65\u6210 self.target_position \u9810\u8a2d\u4ee5\u8a72\u5546\u54c1\u6700\u5f8c\u4e00\u7b46\u6210\u4ea4\u50f9\u8a2d\u5b9a\u70ba\u9650\u50f9\u4f86\u4e0b\u55ae</p> ATTRIBUTE DESCRIPTION <code>market_order</code> <p>\u4ee5\u985e\u5e02\u50f9\u76e1\u91cf\u5373\u523b\u6210\u4ea4\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u6f32\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u8dcc\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>best_price_limit</code> <p>\u639b\u82ad\u6a02\u50f9\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u8dcc\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u6f32\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>view_only</code> <p>\u9810\u8a2d\u70ba False\uff0c\u6703\u5be6\u969b\u4e0b\u55ae\u3002\u82e5\u8a2d\u70ba True\uff0c\u4e0d\u6703\u4e0b\u55ae\uff0c\u53ea\u6703\u56de\u50b3\u6b32\u57f7\u884c\u7684\u59d4\u8a17\u55ae\u8cc7\u6599(dict)</p> <p> TYPE: <code>bool</code> </p> <code>extra_bid_pct</code> <p>\u4ee5\u8a72\u767e\u5206\u6bd4\u503c\u4e58\u4ee5\u50f9\u683c\u9032\u884c\u8ffd\u50f9\u4e0b\u55ae\uff0c\u5982\u8a2d\u5b9a\u70ba 0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 +(-)5% \u7684\u9650\u50f9\u9032\u8cb7\u5165(\u8ce3\u51fa)\uff0c\u4e5f\u5c31\u662f\u66f4\u6709\u6a5f\u6703\u53ef\u4ee5\u6210\u4ea4\uff0c\u4f46\u662f\u6210\u4ea4\u50f9\u683c\u53ef\u80fd\u4e0d\u7406\u60f3\uff1b \u5047\u5982\u8a2d\u5b9a\u70ba -0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 -(+)5% \u9032\u884c\u8cb7\u5165\u8ce3\u51fa\uff0c\u4e5f\u5c31\u662f\u9650\u50f9\u55ae\u5c07\u4e0d\u6703\u7acb\u5373\u6210\u4ea4\uff0c\u7136\u800c\u5047\u5982\u6210\u4ea4\u5f8c\uff0c\u50f9\u683c\u6bd4\u8f03\u7406\u60f3\u3002\u53c3\u6578\u6709\u6548\u7bc4\u570d\u70ba -0.1 \u5230 0.1 \u5167\u3002</p> <p> TYPE: <code>float</code> </p> <code>progress</code> <p>\u9032\u5ea6\uff0c\u9810\u8a2d\u70ba 1\uff0c\u5373\u5168\u90e8\u4e0b\u55ae\u3002\u82e5\u8a2d\u5b9a\u70ba 0.5\uff0c\u5247\u53ea\u4e0b\u4e00\u534a\u7684\u55ae\u3002</p> <p> TYPE: <code>float</code> </p> <code>progress_precision</code> <p>\u9032\u5ea6\u7684\u7cbe\u5ea6\uff0c\u9810\u8a2d\u70ba 0\uff0c\u5373\u53ea\u4e0b\u6574\u6578\u5f35\u3002\u82e5\u8a2d\u5b9a\u70ba 1\uff0c\u5247\u4e0b\u5230 0.1 \u5f35\u3002</p> <p> TYPE: <code>int</code> </p> <code>buy_only</code> <p>\u82e5\u8a2d\u70ba True\uff0c\u53ea\u4e0b\u8cb7\u55ae</p> <p> TYPE: <code>bool</code> </p> <code>sell_only</code> <p>\u82e5\u8a2d\u70ba True\uff0c\u53ea\u4e0b\u8ce3\u55ae</p> <p> TYPE: <code>bool</code> </p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.execute_orders","title":"execute_orders","text":"<pre><code>execute_orders(orders, market_order=False, best_price_limit=False, view_only=False, extra_bid_pct=0, cancel_orders=True, buy_only=False, sell_only=False)\n</code></pre> <p>\u7522\u751f\u59d4\u8a17\u55ae\uff0c\u5c07\u90e8\u4f4d\u540c\u6b65\u6210 self.target_position \u9810\u8a2d\u4ee5\u8a72\u5546\u54c1\u6700\u5f8c\u4e00\u7b46\u6210\u4ea4\u50f9\u8a2d\u5b9a\u70ba\u9650\u50f9\u4f86\u4e0b\u55ae</p> ATTRIBUTE DESCRIPTION <code>orders</code> <p>\u6b32\u4e0b\u55ae\u7684\u90e8\u4f4d\uff0c\u901a\u5e38\u662f\u7531 <code>self.generate_orders</code> \u7522\u751f\u3002</p> <p> TYPE: <code>list</code> </p> <code>market_order</code> <p>\u4ee5\u985e\u5e02\u50f9\u76e1\u91cf\u5373\u523b\u6210\u4ea4\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u6f32\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u8dcc\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>best_price_limit</code> <p>\u639b\u82ad\u6a02\u50f9\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u8dcc\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u6f32\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>view_only</code> <p>\u9810\u8a2d\u70ba False\uff0c\u6703\u5be6\u969b\u4e0b\u55ae\u3002\u82e5\u8a2d\u70ba True\uff0c\u4e0d\u6703\u4e0b\u55ae\uff0c\u53ea\u6703\u56de\u50b3\u6b32\u57f7\u884c\u7684\u59d4\u8a17\u55ae\u8cc7\u6599(dict)</p> <p> TYPE: <code>bool</code> </p> <code>extra_bid_pct</code> <p>\u4ee5\u8a72\u767e\u5206\u6bd4\u503c\u4e58\u4ee5\u50f9\u683c\u9032\u884c\u8ffd\u50f9\u4e0b\u55ae\uff0c\u5982\u8a2d\u5b9a\u70ba 0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 +(-)5% \u7684\u9650\u50f9\u9032\u8cb7\u5165(\u8ce3\u51fa)\uff0c\u4e5f\u5c31\u662f\u66f4\u6709\u6a5f\u6703\u53ef\u4ee5\u6210\u4ea4\uff0c\u4f46\u662f\u6210\u4ea4\u50f9\u683c\u53ef\u80fd\u4e0d\u7406\u60f3\uff1b \u5047\u5982\u8a2d\u5b9a\u70ba -0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 -(+)5% \u9032\u884c\u8cb7\u5165\u8ce3\u51fa\uff0c\u4e5f\u5c31\u662f\u9650\u50f9\u55ae\u5c07\u4e0d\u6703\u7acb\u5373\u6210\u4ea4\uff0c\u7136\u800c\u5047\u5982\u6210\u4ea4\u5f8c\uff0c\u50f9\u683c\u6bd4\u8f03\u7406\u60f3\u3002\u53c3\u6578\u6709\u6548\u7bc4\u570d\u70ba -0.1 \u5230 0.1 \u5167\u3002</p> <p> TYPE: <code>float</code> </p> <code>buy_only</code> <p>\u82e5\u8a2d\u70ba True\uff0c\u53ea\u4e0b\u8cb7\u55ae</p> <p> TYPE: <code>bool</code> </p> <code>sell_only</code> <p>\u82e5\u8a2d\u70ba True\uff0c\u53ea\u4e0b\u8ce3\u55ae</p> <p> TYPE: <code>bool</code> </p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.generate_orders","title":"generate_orders","text":"<pre><code>generate_orders(progress=1, progress_precision=0)\n</code></pre> <p>Generate orders based on the difference between target position and present position.</p> <p>Returns: orders (dict): Orders to be executed.</p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.show_alerting_stocks","title":"show_alerting_stocks","text":"<pre><code>show_alerting_stocks()\n</code></pre> <p>\u7522\u751f\u4e0b\u55ae\u90e8\u4f4d\u662f\u5426\u6709\u8b66\u793a\u80a1\uff0c\u4ee5\u53ca\u76f8\u95dc\u8cc7\u8a0a</p>"},{"location":"reference/online/#finlab.online.order_executor.OrderExecutor.update_order_price","title":"update_order_price","text":"<pre><code>update_order_price(extra_bid_pct=0)\n</code></pre> <p>\u66f4\u65b0\u59d4\u8a17\u55ae\uff0c\u5c07\u59d4\u8a17\u55ae\u7684\u9650\u50f9\u8abf\u6574\u6210\u7576\u5929\u6700\u5f8c\u4e00\u7b46\u50f9\u683c\u3002 \uff08\u8b93\u6c92\u6210\u4ea4\u7684\u9650\u50f9\u55ae\u53bb\u8ffd\u50f9\uff09 Attributes:     extra_bid_pct (float): \u4ee5\u8a72\u767e\u5206\u6bd4\u503c\u4e58\u4ee5\u50f9\u683c\u9032\u884c\u8ffd\u50f9\u4e0b\u55ae\uff0c\u5982\u8a2d\u5b9a\u70ba 0.1 \u6642\uff0c\u5c07\u4ee5\u8d85\u51fa(\u4f4e\u65bc)\u73fe\u50f9\u4e4b10%\u50f9\u683c\u4e0b\u55ae\uff0c\u4ee5\u6f32\u505c(\u8dcc\u505c)\u50f9\u70ba\u9650\u3002\u53c3\u6578\u6709\u6548\u7bc4\u570d\u70ba 0 \u5230 0.1 \u5167</p>"},{"location":"reference/online/#finlab.online.base_account.Order","title":"finlab.online.base_account.Order  <code>dataclass</code>","text":"<p>Order status</p> <p>\u59d4\u8a17\u55ae\u7684\u72c0\u614b</p> ATTRIBUTE DESCRIPTION <code>order_id</code> <p>\u59d4\u8a17\u55ae\u7684 id\uff0c\u8207\u5238\u5546 API \u6240\u63d0\u4f9b\u7684 id \u4e00\u81f4</p> <p> TYPE: <code>str</code> </p> <code>stock_id</code> <p>\u80a1\u7968\u4ee3\u865f ex: '2330'</p> <p> TYPE: <code>str</code> </p> <code>action</code> <p>\u8cb7\u8ce3\u65b9\u5411\uff0c\u901a\u5e38\u70ba 'BUY' \u6216\u662f 'SELL'</p> <p> TYPE: <code>Action</code> </p> <code>price</code> <p>\u80a1\u7968\u8cb7\u8ce3\u7684\u50f9\u683c(\u9650\u50f9\u55ae)</p> <p> TYPE: <code>Number</code> </p> <code>quantity</code> <p>\u59d4\u8a17\u80a1\u7968\u7684\u7e3d\u6578\u91cf\uff08\u5f35\u6578\uff09\uff0c\u5141\u8a31\u5c0f\u6578\u9ede</p> <p> TYPE: <code>Number</code> </p> <code>filled_quantity</code> <p>\u4ee5\u6210\u4ea4\u80a1\u7968\u7684\u6578\u91cf\uff08\u5f35\u6578\uff09\uff0c\u5141\u8a31\u5c0f\u6578\u9ede</p> <p> TYPE: <code>Number</code> </p> <code>status</code> <p>\u59d4\u8a17\u72c0\u614b\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u70ba\uff1a'NEW', 'PARTIALLY_FILLED', 'FILLED', 'CANCEL'</p> <p> TYPE: <code>OrderStatus</code> </p> <code>time</code> <p>\u59d4\u8a17\u6642\u9593</p> <p> TYPE: <code>datetime</code> </p> <code>org_order</code> <p>\u5238\u5546\u6240\u63d0\u4f9b\u7684\u59d4\u8a17\u7269\u4ef6\u683c\u5f0f</p> <p> TYPE: <code>Any = None</code> </p>"},{"location":"reference/online/#finlab.online.panel.order_panel","title":"finlab.online.panel.order_panel","text":"<pre><code>order_panel(account)\n</code></pre> <p>\u4e0b\u55ae GUI \u4ecb\u9762 Arguments:     account (Account): \u8acb\u53c3\u8003 Account \u91dd\u5c0d\u4e0d\u540c\u5238\u5546\u4f86\u5efa\u69cb\u76f8\u5c0d\u61c9\u7684\u64cd\u4f5c\u5e33\u6236</p>"},{"location":"reference/optimize/","title":"finlab.optimize","text":""},{"location":"reference/optimize/#finlab.optimize.combinations.sim_conditions","title":"finlab.optimize.combinations.sim_conditions","text":"<pre><code>sim_conditions(conditions, hold_until={}, *args, **kwargs)\n</code></pre> <p>\u53d6\u5f97\u56de\u6e2c\u5831\u544a\u96c6\u5408</p> <p>\u5c07\u9078\u80a1\u689d\u4ef6\u6392\u51fa\u6240\u6709\u7684\u7d44\u5408\u4e26\u9032\u884c\u56de\u6e2c\uff0c\u65b9\u4fbf\u627e\u51fa\u6700\u597d\u689d\u4ef6\u7684\u4ea4\u96c6\u7d50\u679c\u3002</p> PARAMETER  DESCRIPTION <code>conditions</code> <p>\u9078\u80a1\u689d\u4ef6\u96c6\u5408\uff0ckey \u70ba\u689d\u4ef6\u540d\u7a31\uff0cvalue \u70ba\u689d\u4ef6\u8b8a\u6578\uff0cex:<code>{'c1':c1, 'c2':c2}</code></p> <p> TYPE: <code>dict</code> </p> <code>hold_until</code> <p>\u8a2d\u5b9a\u8a0a\u865f\u9032\u51fa\u5834\u8a9e\u6cd5\u7cd6\u53c3\u6578\uff0c\u9810\u8a2d\u70ba\u4e0d\u4f7f\u7528\u3002ex:<code>{'exit':exit, 'stop_loss':0.1}</code></p> <p> TYPE: <code>dict</code> DEFAULT: <code>{}</code> </p> <code>*args</code> <p><code>finlab.backtest.sim()</code> \u56de\u6e2c\u53c3\u6578\u8a2d\u5b9a\u3002</p> <p> TYPE: <code>tuple</code> DEFAULT: <code>()</code> </p> <code>**kwargs</code> <p><code>finlab.backtest.sim()</code> \u56de\u6e2c\u53c3\u6578\u8a2d\u5b9a\u3002</p> <p> TYPE: <code>dict</code> DEFAULT: <code>{}</code> </p> RETURNS DESCRIPTION <code>ReportCollection</code> <p>\u56de\u6e2c\u6578\u64da\u5831\u544a</p> <p>Examples:</p> <p><pre><code>from finlab import data\nfrom finlab.backtest import sim\nfrom finlab.optimize.combinations import sim_conditions\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\nrev=data.get('monthly_revenue:\u7576\u6708\u71df\u6536').index_str_to_date()\nrev_ma3=rev.average(3)\nrev_ma12=rev.average(12)\nc1 = (close &gt; close.average(20)) &amp; (close &gt; close.average(60))\nc2 = (close == close.rolling(20).max())\nc3 = pe &lt; 15\nc4 = rev_ma3/rev_ma12 &gt; 1.1\nc5 = rev/rev.shift(1) &gt; 0.9\nexits = close &lt; close.average(20)\nconditions = {'c1':c1, 'c2':c2, 'c3':c3, 'c4':c4, 'c5':c5}\nreport_collection = sim_conditions(conditions=conditions, hold_until={'exit':exits, 'stop_loss':0.1}, resample='M', position_limit=0.1, upload=False)\n# \u7b56\u7565\u5206\u7d44\u6307\u6a19\u5831\u544a\n# print(report_collection.stats)\nreport_collection.plot_creturns().show()\nreport_collection.plot_stats('bar').show()\nreport_collection.plot_stats('heatmap')\n</code></pre> \u8996\u89ba\u5316\u7bc4\u4f8b</p> <p>ex1:</p> <p><code>report_collection.plot_creturns().show()</code></p> <p>\u7e6a\u88fd\u6298\u7dda\u5716\u6307\u6a19\u5206\u7fa4\u68d2\u72c0\u5716</p> <p></p> <p>ex2:</p> <p><code>report_collection.plot_stats('bar').show()</code></p> <p>\u7e6a\u88fd\u6307\u6a19\u5206\u7fa4\u68d2\u72c0\u5716</p> <p></p> <p>ex3:</p> <p><code>report_collection.plot_stats('heatmap')</code></p> <p>\u7e6a\u88fd\u6307\u6a19\u5206\u7d1a\u71b1\u529b\u5716\uff0c\u6578\u503c\u8d8a\u5927\u70ba\u6392\u540d\u8d8a\u524d\u9762\uff0cavg_score\u70ba\u6307\u6a19\u5e73\u5747\u5206\u6578\uff0c\u5206\u6578\u8d8a\u9ad8\u70ba\u8a55\u50f9\u8f03\u6b63\u5411\u7684\u7b56\u7565\u3002</p> <p></p>"},{"location":"reference/optimize/#finlab.optimize.combinations.ReportCollection","title":"finlab.optimize.combinations.ReportCollection","text":"<pre><code>ReportCollection(reports)\n</code></pre> <p>\u56de\u6e2c\u7d44\u5408\u6bd4\u8f03\u5831\u544a</p> <p>\u5224\u65b7\u7b56\u7565\u7d44\u5408\u6578\u64da\u512a\u52a3\uff0c\u5f9e\u7b56\u7565\u6d77\u4e2d\u5feb\u901f\u627e\u5230\u9ad4\u8cea\u6700\u5f37\u7684\u7b56\u7565\u3002 \u4e5f\u53ef\u4ee5\u89c0\u5bdf\u5728\u540c\u689d\u4ef6\u4e0b\u7684\u7b56\u7565\u758a\u52a0\u66f4\u591a\u689d\u4ef6\u5f8c\u6703\u6709\u4ec0\u9ebc\u8b8a\u5316\uff1f Args:   reports (dict): \u56de\u6e2c\u7269\u4ef6\u96c6\u5408\uff0cex:<code>{'strategy1': finlab.backtest.sim(),'strategy2': finlab.backtest.sim()}</code></p>"},{"location":"reference/optimize/#finlab.optimize.combinations.ReportCollection.get_stats","title":"get_stats","text":"<pre><code>get_stats()\n</code></pre> <p>\u53d6\u5f97\u7b56\u7565\u6307\u6a19\u6bd4\u8f03\u8868</p> <p>\u6307\u6a19\u6b04\u4f4d\u8aaa\u660e\uff1a</p> <ul> <li><code>'daily_mean'</code>: \u7b56\u7565\u5e74\u5316\u5831\u916c</li> <li><code>'daily_sharpe'</code>: \u7b56\u7565\u5e74\u5316\u590f\u666e\u7387</li> <li><code>'daily_sortino'</code>: \u7b56\u7565\u5e74\u5316\u7d22\u63d0\u8afe\u6bd4\u7387</li> <li><code>'max_drawdown'</code>: \u7b56\u7565\u5831\u916c\u7387\u6700\u5927\u56de\u64a4\u7387(\u8ca0\u5411)</li> <li><code>'avg_drawdown'</code>: \u7b56\u7565\u5e73\u5747\u56de\u64a4(\u8ca0\u5411)</li> <li><code>'ytd'</code>: \u4eca\u5e74\u5ea6\u7b56\u7565\u5831\u916c\u7387</li> <li><code>'win_ratio'</code>: \u6bcf\u7b46\u4ea4\u6613\u52dd\u7387</li> <li><code>'avg_return'</code>: \u6bcf\u7b46\u4ea4\u6613\u5e73\u5747\u7372\u5229\u7387</li> <li><code>'avg_mae'</code>: \u6bcf\u7b46\u4ea4\u6613\u5e73\u5747\u6700\u5927\u4e0d\u5229\u65b9\u5411\u5e45\u5ea6(\u8ca0\u5411)</li> <li><code>'avg_bmfe'</code>: \u6700\u5927\u4e0d\u5229\u65b9\u5411\u767c\u751f\u524d\u7684\"\u6bcf\u7b46\u4ea4\u6613\u5e73\u5747\u6700\u5927\u6709\u5229\u65b9\u5411\u5e45\u5ea6\"\uff0c\u82e5\u6578\u503c\u8d8a\u9ad8\uff0c\u8d8a\u6709\u6a5f\u6703\u5728\u505c\u640d\u4e4b\u524d\u64cd\u4f5c\u505c\u5229\u3002</li> <li><code>'avg_gmfe'</code>: \u6bcf\u7b46\u4ea4\u6613\u5e73\u5747\u6700\u5927\u6709\u5229\u65b9\u5411\u5e45\u5ea6</li> <li><code>'avg_mdd'</code>: \u6bcf\u7b46\u4ea4\u6613\u5e73\u5747\u7684\u6700\u5927\u56de\u64a4\u7387(\u8ca0\u5411)</li> </ul> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u7b56\u7565\u6307\u6a19\u6bd4\u8f03\u5831\u8868</p>"},{"location":"reference/optimize/#finlab.optimize.combinations.ReportCollection.plot_creturns","title":"plot_creturns","text":"<pre><code>plot_creturns()\n</code></pre> <p>\u7e6a\u88fd\u7b56\u7565\u7d2f\u7a4d\u5831\u916c\u7387</p> <p>\u6bd4\u8f03\u7b56\u7565\u6de8\u503c\u66f2\u7dda\u8b8a\u5316</p> RETURNS DESCRIPTION <code>Figure</code> <p>\u6298\u7dda\u5716</p> <p>Examples:</p> <p></p>"},{"location":"reference/optimize/#finlab.optimize.combinations.ReportCollection.plot_stats","title":"plot_stats","text":"<pre><code>plot_stats(mode='bar', heatmap_sort_by='avg_score', indicators=[])\n</code></pre> <p>\u7b56\u7565\u6307\u6a19\u6bd4\u8f03\u5831\u8868\u8996\u89ba\u5316</p> PARAMETER  DESCRIPTION <code>mode</code> <p>\u7e6a\u5716\u6a21\u5f0f\u3002<code>'bar'</code> - \u6307\u6a19\u5206\u7fa4\u68d2\u72c0\u5716\u3002<code>'heatmap'</code> - \u6307\u6a19\u5206\u7d1a\u71b1\u529b\u5716\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'bar'</code> </p> <code>heatmap_sort_by</code> <p>heatmap \u964d\u51aa\u6392\u5e8f\u7684\u6c7a\u5b9a\u6b04\u4f4d</p> <p> TYPE: <code>str or list of str</code> DEFAULT: <code>'avg_score'</code> </p> <code>indicators</code> <p>\u8981\u986f\u793a\u7684\u7279\u5b9a\u6307\u6a19\u6b04\u4f4d\uff0c\u9810\u8a2d\u70ba\u5c07\u6307\u6a19\u5168\u90e8\u986f\u793a</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> RETURNS DESCRIPTION <code>Figure</code> <p>\u9577\u689d\u5716</p> <code>DataFrame</code> <p>\u71b1\u529b\u5716</p> <p>Examples:</p> <p>ex1:</p> <p>\u7e6a\u88fd\u6307\u6a19\u5206\u7fa4\u68d2\u72c0\u5716</p> <p></p> <p>ex2:</p> <p>\u7e6a\u88fd\u6307\u6a19\u5206\u7d1a\u71b1\u529b\u5716\u3002</p> <p><code>'avg_score'</code>: \u5404\u6307\u6a19\u52a0\u7e3d\u5f8c\u7684\u5e73\u5747\u5206\u6578\uff0c\u5206\u6578\u8d8a\u9ad8\u70ba\u6574\u9ad4\u8a55\u50f9\u8f03\u6b63\u5411\u7684\u7b56\u7565\u3002</p> <p>\u9810\u8a2d\u4ee5avg_score\u70ba\u6392\u5e8f\uff0c\u6578\u503c\u8d8a\u5927\u70ba\u6392\u540d\u8d8a\u524d\u9762\uff0c\u5206\u6578\u8d8a\u9ad8\u70ba\u6574\u9ad4\u8a55\u50f9\u8f03\u512a\u7684\u7b56\u7565\u3002</p> <p></p>"},{"location":"reference/plot/","title":"finlab.plot","text":""},{"location":"reference/plot/#finlab.plot.plot_tw_stock_candles","title":"finlab.plot.plot_tw_stock_candles","text":"<pre><code>plot_tw_stock_candles(stock_id, recent_days=400, adjust_price=False, resample='D', overlay_func=None, technical_func=None)\n</code></pre> <p>\u7e6a\u88fd\u53f0\u80a1\u6280\u8853\u7dda\u5716\u5716\u7d44 Args:     stock_id (str): \u53f0\u80a1\u80a1\u865f\uff0cex:<code>'2330'</code>\u3002     recent_days (int):\u53d6\u8fd1n\u500b\u4ea4\u6613\u65e5\u8cc7\u6599\u3002     adjust_price (bool):\u662f\u5426\u4f7f\u7528\u9084\u539f\u80a1\u50f9\u8a08\u7b97\u3002     resample (str): \u6280\u8853\u6307\u6a19\u50f9\u683c\u9031\u671f\uff0cex: <code>D</code> \u4ee3\u8868\u65e5\u7dda, <code>W</code> \u4ee3\u8868\u9031\u7dda, <code>M</code> \u4ee3\u8868\u6708\u7dda\u3002     overlay_func (dict):         K\u7dda\u5716\u8f14\u52a9\u7dda\uff0c\u9810\u8a2d\u4f7f\u7528\u5e03\u6797\u901a\u9053\u3002          <pre><code>from finlab.data import indicator\noverlay_func={\n'ema_5':indicator('EMA',timeperiod=5),\n'ema_10':indicator('EMA',timeperiod=10),\n'ema_20':indicator('EMA',timeperiod=20),\n'ema_60':indicator('EMA',timeperiod=60),\n}\n</code></pre>     technical_func (list):         \u6280\u8853\u6307\u6a19\u5b50\u5716\uff0c\u9810\u8a2d\u4f7f\u7528KD\u6280\u8853\u6307\u6a19\u55ae\u7d44\u5b50\u5716\u3002</p> <pre><code>    \u8a2d\u5b9a\u591a\u7d44\u6280\u8853\u6307\u6a19\uff1a\n    ```py\n    from finlab.data import indicator\n\n    k,d = indicator('STOCH')\n    rsi = indicator('RSI')\n    technical_func = [{'K':k,'D':d},{'RSI':rsi}]\n    ```\n</code></pre> RETURNS DESCRIPTION <code>Figure</code> <p>\u6280\u8853\u7dda\u5716</p> <p>Examples:</p> <pre><code>from finlab.plot import plot_tw_stock_candles\nfrom finlab.data import indicator\noverlay_func={\n'ema_5':indicator('EMA',timeperiod=5),\n'ema_10':indicator('EMA',timeperiod=10),\n'ema_20':indicator('EMA',timeperiod=20),\n'ema_60':indicator('EMA',timeperiod=60),\n}\nk,d = indicator('STOCH')\nrsi = indicator('RSI')\ntechnical_func = [{'K':k,'D':d},{'RSI':rsi}]\nplot_tw_stock_candles(stock_id='2330',recent_days=600,adjust_price=False,overlay_func=overlay_func,technical_func=technical_func)\n</code></pre>"},{"location":"reference/plot/#finlab.plot.create_treemap_data","title":"finlab.plot.create_treemap_data","text":"<pre><code>create_treemap_data(start, end, item='return_ratio', clip=None)\n</code></pre> <p>\u7522\u751f\u53f0\u80a1\u677f\u584a\u5716\u8cc7\u6599</p> <p>\u7522\u751f\u7e6a\u88fd\u6a39\u72c0\u5716\u6240\u7528\u7684\u8cc7\u6599\uff0c\u53ef\u518d\u5916\u52a0FinLab\u8cc7\u6599\u5eab\u4ee5\u5916\u7684\u6307\u6a19\u88fd\u4f5c\u5ba2\u88fd\u5316DataFrame\uff0c \u4e26\u50b3\u5165<code>plot_tw_stock_treemap(treemap_data=treemap_data)\u3002</code></p> PARAMETER  DESCRIPTION <code>start</code> <p>\u8cc7\u6599\u958b\u59cb\u65e5\uff0cex:<code>\"2021-01-02\"</code>\u3002</p> <p> TYPE: <code>str</code> </p> <code>end</code> <p>\u8cc7\u6599\u7d50\u675f\u65e5\uff0cex:<code>\"2021-01-05\"</code>\u3002</p> <p> TYPE: <code>str</code> </p> <code>item</code> <p>\u6c7a\u5b9a\u677f\u584a\u984f\u8272\u6df1\u6dfa\u7684\u6307\u6a19\u3002           \u9664\u4e86\u53ef\u9078\u64c7\u4f9d\u7167 start \u8207 end \u8a08\u7b97\u7684<code>\"return_ratio\"</code>(\u5831\u916c\u7387)\uff0c           \u4ea6\u53ef\u9078\u64c7FinLab\u8cc7\u6599\u5eab\u5167\u7684\u6307\u6a19\u986f\u793a\u8fd1\u4e00\u671f\u8cc7\u6599\u3002   example:</p> <ul> <li><code>'price_earning_ratio:\u672c\u76ca\u6bd4'</code> - \u986f\u793a\u8fd1\u65e5\u7522\u696d\u7684\u672c\u76ca\u6bd4\u9ad8\u4f4e\u3002</li> <li><code>'monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)'</code> - \u986f\u793a\u8fd1\u6708\u7684\u55ae\u6708\u71df\u6536\u5e74\u589e\u7387\u3002</li> </ul> <p> TYPE: <code>str</code> DEFAULT: <code>'return_ratio'</code> </p> <code>clip</code> <p>\u5c07item\u908a\u754c\u5916\u7684\u503c\u5206\u914d\u7d66\u908a\u754c\u503c\uff0c\u9632\u6b62\u8cc7\u6599\u4e0a\u9650\u503c\u904e\u5927\u6216\u904e\u5c0f\uff0c\u9020\u6210\u984f\u8272\u6df1\u6dfa\u8b8a\u5316\u4e0d\u660e\u986f\u3002             ex:(0,100)\uff0c\u5c07\u6578\u503c\u4f4e\u9ad8\u754c\u7dda\uff0c\u8a2d\u70ba0~100\uff0c\u8d85\u904e\u7684\u6578\u503c\u3002</p> <p>Note</p> <p>\u53c3\u8003pandas\u6587\u4ef6\u66f4\u4e86\u89e3<code>pd.clip</code>\u7d30\u7bc0\u3002</p> <p> TYPE: <code>tuple</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u53f0\u80a1\u500b\u80a1\u6307\u6a19</p> <p>Examples:</p> <pre><code>\u6b32\u4e0b\u8f09\u6240\u6709\u4e0a\u5e02\u4e0a\u6ac3\u4e4b\u50f9\u91cf\u6b77\u53f2\u8cc7\u6599\u8207\u7522\u696d\u5206\u985e\uff0c\u53ea\u9700\u57f7\u884c\u6b64\u51fd\u5f0f:\n\n``` py\nfrom finlab.plot import create_treemap_data\ncreate_treemap_data(start= '2021-07-01',end = '2021-07-02')\n```\n\n| stock_id   |  close |turnover|category|market|market_value|return_ratio|country|\n|:-----------|-------:|-------:|-------:|-------:|-------:|-------:|-------:|\n| 1101       |   20 |  57.85 |  \u6c34\u6ce5\u5de5\u696d |  sii   |    111  |    0.1  |  TW-Stock|\n| 1102       |  20 |  58.1  |  \u6c34\u6ce5\u5de5\u696d |  sii    |    111  |    -0.1 |  TW-Stock|\n</code></pre>"},{"location":"reference/plot/#finlab.plot.plot_tw_stock_treemap","title":"finlab.plot.plot_tw_stock_treemap","text":"<pre><code>plot_tw_stock_treemap(start=None, end=None, area_ind='market_value', item='return_ratio', clip=None, color_continuous_scale='Temps', treemap_data=None)\n</code></pre> <p>\u7e6a\u88fd\u53f0\u80a1\u677f\u584a\u5716\u8cc7\u6599</p> <p>\u5de2\u72c0\u6a39\u72c0\u5716\u53ef\u4ee5\u986f\u793a\u591a\u7dad\u5ea6\u8cc7\u6599\uff0c\u5c07\u4f9d\u7167\u7522\u696d\u5206\u985e\u7684\u53f0\u80a1\u8cc7\u6599\u7d62\u9e97\u986f\u793a\u3002</p> PARAMETER  DESCRIPTION <code>start</code> <p>\u8cc7\u6599\u958b\u59cb\u65e5\uff0cex:<code>'2021-01-02'</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>end</code> <p>\u8cc7\u6599\u7d50\u675f\u65e5\uff0cex:<code>'2021-01-05'</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>area_ind</code> <p>\u6c7a\u5b9a\u677f\u584a\u9762\u7a4d\u6578\u503c\u7684\u6307\u6a19\u3002               \u53ef\u9078\u64c7<code>[\"market_value\",\"turnover\"]</code>\uff0c\u6578\u503c\u4ee3\u8868\u542b\u7fa9\u5206\u5225\u70ba\u5e02\u503c\u3001\u6210\u4ea4\u91d1\u984d\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'market_value'</code> </p> <code>item</code> <p>\u6c7a\u5b9a\u677f\u584a\u984f\u8272\u6df1\u6dfa\u7684\u6307\u6a19\u3002           \u9664\u4e86\u53ef\u9078\u64c7\u4f9d\u7167 start \u8207 end \u8a08\u7b97\u7684<code>\"return_ratio\"</code>(\u5831\u916c\u7387)\uff0c           \u4ea6\u53ef\u9078\u64c7FinLab\u8cc7\u6599\u5eab\u5167\u7684\u6307\u6a19\u986f\u793a\u8fd1\u4e00\u671f\u8cc7\u6599\u3002   example:</p> <ul> <li><code>'price_earning_ratio:\u672c\u76ca\u6bd4'</code> - \u986f\u793a\u8fd1\u65e5\u7522\u696d\u7684\u672c\u76ca\u6bd4\u9ad8\u4f4e\u3002</li> <li><code>'monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)'</code> - \u986f\u793a\u8fd1\u6708\u7684\u55ae\u6708\u71df\u6536\u5e74\u589e\u7387\u3002</li> </ul> <p> TYPE: <code>str</code> DEFAULT: <code>'return_ratio'</code> </p> <code>clip</code> <p>\u5c07 item \u908a\u754c\u5916\u7684\u503c\u5206\u914d\u7d66\u908a\u754c\u503c\uff0c\u9632\u6b62\u8cc7\u6599\u4e0a\u9650\u503c\u904e\u5927\u6216\u904e\u5c0f\uff0c\u9020\u6210\u984f\u8272\u6df1\u6dfa\u8b8a\u5316\u4e0d\u660e\u986f\u3002             ex:(0,100)\uff0c\u5c07\u6578\u503c\u4f4e\u9ad8\u754c\u7dda\uff0c\u8a2d\u70ba 0~100\uff0c\u8d85\u904e\u7684\u6578\u503c\u3002</p> <p>Note</p> <p>\u53c3\u8003pandas\u6587\u4ef6\u66f4\u4e86\u89e3<code>pd.clip</code>\u7d30\u7bc0\u3002</p> <p> TYPE: <code>tuple</code> DEFAULT: <code>None</code> </p> <code>color_continuous_scale</code> <p>\u984f\u8272\u8b8a\u5316\u5e8f\u5217\u7684\u6a23\u5f0f\u540d\u7a31</p> <p> TYPE: <code>str</code> DEFAULT: <code>'Temps'</code> </p> <code>treemap_data</code> <p>\u5ba2\u88fd\u5316\u8cc7\u6599\uff0c\u683c\u5f0f\u53c3\u7167 <code>create_treemap_data()</code> \u8fd4\u56de\u503c\u3002</p> <p> TYPE: <code>DataFrame</code> DEFAULT: <code>None</code> </p> <p>Returns:     (plotly.graph_objects.Figure): \u6a39\u72c0\u677f\u584a\u5716 Examples:     ex1:     \u677f\u584a\u9762\u7a4d\u986f\u793a\u6210\u4ea4\u91d1\u984d\uff0c\u984f\u8272\u986f\u793a'2021-07-01'\uff5e'2021-07-02'\u7684\u5831\u916c\u7387\u8b8a\u5316\uff0c\u53ef\u4ee5\u89c0\u5bdf\u5e02\u5834\u8cc7\u91d1\u96c6\u4e2d\u7684\u7522\u696d\u8207\u6f32\u8dcc\u5f37\u5f31\u3002     <pre><code>from finlab.plot import plot_tw_stock_treemap\nplot_tw_stock_treemap(start= '2021-07-01',end = '2021-07-02',area_ind=\"turnover\",item=\"return_ratio\")\n</code></pre>      ex2:     \u677f\u584a\u9762\u7a4d\u986f\u793a\u5e02\u503c(\u80a1\u672c*\u6536\u76e4\u50f9)\uff0c\u984f\u8272\u986f\u793a\u8fd1\u671f\u672c\u76ca\u6bd4\uff0c\u53ef\u4ee5\u89c0\u5bdf\u5168\u5e02\u5834\u54ea\u4e9b\u662f\u6b0a\u503c\u80a1\uff1f\u54ea\u4e9b\u7522\u696d\u672c\u76ca\u6bd4\u8a55\u50f9\u9ad8\uff1f\u9650\u5236\u6578\u503c\u7bc4\u570d\u5728(0,50)\uff0c     \u5c07\u904e\u9ad8\u672c\u76ca\u6bd4\u7684\u6578\u503c\u58d3\u572850\uff0c\u4e0d\u8b93\u984f\u8272\u8b8a\u5316\u7a81\u5140\uff0c\u80fd\u5206\u51fa\u9ad8\u4f4e\u968e\u5c64\u5373\u53ef\u3002     <pre><code>from finlab.plot import plot_tw_stock_treemap\nplot_tw_stock_treemap(area_ind=\"market_value\",item=\"price_earning_ratio:\u672c\u76ca\u6bd4\",clip=(0,50), color_continuous_scale='RdBu_r')\n</code></pre> </p>"},{"location":"reference/plot/#finlab.plot.plot_tw_stock_radar","title":"finlab.plot.plot_tw_stock_radar","text":"<pre><code>plot_tw_stock_radar(portfolio, feats=None, mode='line_polar', line_polar_fill=None, period=None, cut_bins=10, title=None, custom_data=None)\n</code></pre> <p>\u7e6a\u88fd\u53f0\u80a1\u96f7\u9054\u5716</p> <p>\u6bd4\u8f03\u6301\u80a1\u7d44\u5408\u7684\u6307\u6a19\u5206\u7d1a\u7279\u6027\u3002\u82e5\u6578\u503c\u70banan\uff0c\u5247\u4e0d\u986f\u793a\u5206\u7d1a\u3002</p> PARAMETER  DESCRIPTION <code>portfolio</code> <p>\u6301\u80a1\u7d44\u5408\uff0cex:<code>['1101','1102']</code>\u3002</p> <p> TYPE: <code>list</code> </p> <code>feats</code> <p>\u9078\u5b9aFinLab\u8cc7\u6599\u5eab\u5167\u7684\u6307\u6a19\u7d44\u6210\u8cc7\u6599\u96c6\u3002\u9810\u8a2d\u70ba18\u9805\u8ca1\u52d9\u6307\u6a19\u3002             ex:['fundamental_features:\u71df\u696d\u6bdb\u5229\u7387','fundamental_features:\u71df\u696d\u5229\u76ca\u7387']</p> <p> TYPE: <code>list</code> DEFAULT: <code>None</code> </p> <code>mode</code> <p>\u96f7\u9054\u5716\u6a21\u5f0f \uff0cex:'bar_polar','scatter_polar','line_polar'`\u3002</p> <p>Note</p> <p>\u53c3\u8003\u4e0d\u540c\u6a21\u5f0f\u7684\u5dee\u7570</p> <p> TYPE: <code>str</code> DEFAULT: <code>'line_polar'</code> </p> <code>line_polar_fill</code> <p>\u5c07\u5340\u57df\u8a2d\u7f6e\u70ba\u7528\u7d14\u8272\u586b\u5145 \u3002ex:<code>None,'toself','tonext'</code> <code>'toself'</code>\u5c07\u8de1\u7dda\u7684\u7aef\u9ede\uff08\u6216\u8de1\u7dda\u7684\u6bcf\u4e00\u6bb5\uff0c\u5982\u679c\u5b83\u6709\u9593\u9699\uff09\u9023\u63a5\u6210\u4e00\u500b\u5c01\u9589\u7684\u5f62\u72c0\u3002                    \u5982\u679c\u4e00\u689d\u5b8c\u5168\u5305\u570d\u53e6\u4e00\u689d\uff08\u4f8b\u5982\u9023\u7e8c\u7684\u7b49\u9ad8\u7dda\uff09\uff0c\u5247<code>'tonext'</code>\u586b\u5145\u5169\u689d\u8de1\u7dda\u4e4b\u9593\u7684\u7a7a\u9593\uff0c\u5982\u679c\u4e4b\u524d\u6c92\u6709\u8de1\u7dda\uff0c                    \u5247\u5176\u884c\u70ba\u985e\u4f3c\u65bc<code>'toself'</code>\u3002\u5982\u679c\u4e00\u689d\u8de1\u7dda\u4e0d\u5305\u542b\u53e6\u4e00\u689d\u8de1\u7dda\uff0c\u5247\u4e0d\u61c9\u4f7f\u7528<code>'tonext'</code>\u3002 \u6b32\u4f7f\u7528 line_polar\uff0c\u8acb\u5c07pandas\u7248\u672c\u964d\u81f3 1.4.4\u3002</p> <p>Note</p> <p>\u53c3\u8003plotly.graph_objects.Scatterpolar.fill</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>period</code> <p>\u9078\u64c7\u7b2c\u5e7e\u671f\u7684\u7279\u5fb5\u8cc7\u6599\uff0c\u9810\u8a2d\u70ba\u8fd1\u4e00\u5b63\u3002             ex: \u8a2d\u5b9a\u6578\u503c\u70ba'2020-Q2\uff0c\u53d6\u5f972020\u5e74\u7b2c\u4e8c\u5b63\u8cc7\u6599\u6bd4\u8f03\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>cut_bins</code> <p>\u7279\u5fb5\u5206\u7d1a\u7d1a\u8ddd\u3002</p> <p> TYPE: <code>int</code> DEFAULT: <code>10</code> </p> <code>title</code> <p>\u5716\u7247\u6a19\u984c\u540d\u7a31\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>custom_data</code> <p>\u5ba2\u88fd\u5316\u6307\u6a19\u5206\u7d1a\uff0c\u6b04\u540d\u70ba\u7279\u5fb5             \u683c\u5f0f\u7bc4\u4f8b:</p> stock_id \u71df\u696d\u6bdb\u5229\u7387 \u71df\u696d\u5229\u76ca\u7387 \u7a05\u5f8c\u6de8\u5229\u7387 1101 2 5 3 1102 1 8 4 <p> TYPE: <code>DataFrame</code> DEFAULT: <code>None</code> </p> <p>Returns:     (plotly.graph_objects.Figure): \u96f7\u9054\u5716 Examples:     ex1:\u6bd4\u8f03\u6301\u80a1\u7d44\u5408\u7d2f\u8a08\u5206\u6578\uff0c\u770b\u6301\u80a1\u7d44\u5408\u504f\u91cd\u54ea\u50cf\u7279\u5fb5\u3002     <pre><code>from finlab.plot import plot_tw_stock_radar\nplot_tw_stock_radar(portfolio=[\"1101\", \"2330\", \"8942\", \"6263\"], mode=\"bar_polar\", line_polar_fill='None')\n</code></pre>      ex2:\u770b\u55ae\u4e00\u500b\u80a1\u7279\u5fb5\u5206\u7d1a\u843d\u9ede\u3002     <pre><code>from finlab.plot import plot_tw_stock_radar\nfeats = ['fundamental_features:\u71df\u696d\u6bdb\u5229\u7387', 'fundamental_features:\u71df\u696d\u5229\u76ca\u7387', 'fundamental_features:\u7a05\u5f8c\u6de8\u5229\u7387',\n'fundamental_features:\u73fe\u91d1\u6d41\u91cf\u6bd4\u7387', 'fundamental_features:\u8ca0\u50b5\u6bd4\u7387']\nplot_tw_stock_radar(portfolio=[\"9939\"], feats=feats, mode=\"line_polar\", line_polar_fill='toself', cut_bins=8)\n</code></pre> </p>"},{"location":"reference/plot/#finlab.plot.plot_tw_stock_river","title":"finlab.plot.plot_tw_stock_river","text":"<pre><code>plot_tw_stock_river(stock_id='2330', start=None, end=None, mode='pe', split_range=8)\n</code></pre> <p>\u7e6a\u88fd\u53f0\u80a1\u6cb3\u6d41\u5716</p> <p>\u4f7f\u7528 PE or PB \u7684\u6700\u9ad8\u8207\u6700\u4f4e\u503c\u7e6a\u88fd\u6cb3\u6d41\u5716\uff0c\u5224\u65b7\u6307\u6a19\u6240\u8655\u4f4d\u968e\u3002</p> PARAMETER  DESCRIPTION <code>stock_id</code> <p>\u53f0\u80a1\u80a1\u865f\uff0cex:<code>'2330'</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'2330'</code> </p> <code>start</code> <p>\u8cc7\u6599\u958b\u59cb\u65e5\uff0cex:<code>'2020-01-02'</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>end</code> <p>\u8cc7\u6599\u7d50\u675f\u65e5\uff0cex:<code>'2022-01-05'</code>\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>mode</code> <p><code>'pe'</code> or <code>'pb'</code> (\u672c\u76ca\u6bd4\u6216\u80a1\u50f9\u6de8\u503c\u6bd4)\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>'pe'</code> </p> <code>split_range</code> <p>\u6cb3\u6d41\u968e\u5c64\u6578\u3002</p> <p> TYPE: <code>int</code> DEFAULT: <code>8</code> </p> <p>Returns:     (plotly.graph_objects.Figure): \u6cb3\u6d41\u5716 Examples:   <pre><code>from finlab.plot import plot_tw_stock_river\nplot_tw_stock_river(stock_id='2330', start='2015-1-1', end='2022-7-1', mode='pe', split_range=10)\n</code></pre> </p>"},{"location":"reference/plot/#finlab.plot.StrategySunburst","title":"finlab.plot.StrategySunburst","text":"<pre><code>StrategySunburst()\n</code></pre> <p>\u7e6a\u88fd\u7b56\u7565\u90e8\u4f4d\u65ed\u65e5\u5716</p> <p>\u76e3\u63a7\u591a\u7b56\u7565\u3002</p>"},{"location":"reference/plot/#finlab.plot.StrategySunburst.get_strategy_df","title":"get_strategy_df","text":"<pre><code>get_strategy_df(select_strategy=None)\n</code></pre> <p>\u7372\u53d6\u7b56\u7565\u90e8\u4f4d\u8207\u5206\u914d\u6b0a\u91cd\u5f8c\u8a08\u7b97\u7684\u8cc7\u6599</p> PARAMETER  DESCRIPTION <code>select_strategy</code> <p>\u9078\u64c7\u7b56\u7565\u540d\u7a31\u4e26\u8a2d\u5b9a\u6b0a\u91cd\uff0c\u9810\u8a2d\u662f\u6293\u53d6\u6b0a\u7b56\u7565\u4e26\u5e73\u5206\u8cc7\u91d1\u6bd4\u4f8b\u5230\u5404\u7b56\u7565\u3002                      ex:<code>{'\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4':0.5,'\u7814\u767c\u9b54\u4eba':0.2, '\u73fe\u91d1':0.2}</code></p> <p> TYPE: <code>dict</code> DEFAULT: <code>None</code> </p> <p>Returns:     (pd.DataFrame): strategies data</p>"},{"location":"reference/plot/#finlab.plot.StrategySunburst.plot","title":"plot","text":"<pre><code>plot(select_strategy=None, path=None, color_continuous_scale='RdBu_r')\n</code></pre> <p>\u7e6a\u5716</p> PARAMETER  DESCRIPTION <code>select_strategy</code> <p>\u9078\u64c7\u7b56\u7565\u540d\u7a31\u4e26\u8a2d\u5b9a\u6b0a\u91cd\uff0c\u9810\u8a2d\u662f\u6293\u53d6\u6b0a\u7b56\u7565\u4e26\u5e73\u5206\u8cc7\u91d1\u6bd4\u4f8b\u5230\u5404\u7b56\u7565\u3002                      ex:<code>{'\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4':0.5,'\u7814\u767c\u9b54\u4eba':0.2, '\u73fe\u91d1':0.2}</code></p> <p> TYPE: <code>dict</code> DEFAULT: <code>None</code> </p> <code>path</code> <p>\u65ed\u65e5\u5716\u7531\u88e1\u5230\u5916\u7684\u986f\u793a\u8def\u5f91\uff0c\u9810\u8a2d\u70ba<code>['s_name', 'market', 'category', 'stock_id']</code>\u3002            <code>['market', 'category','stock_id','s_name']</code>\u4e5f\u662f\u5e38\u7528\u9078\u9805\u3002</p> <p> TYPE: <code>list</code> DEFAULT: <code>None</code> </p> <code>color_continuous_scale</code> <p>\u984f\u8272\u8b8a\u5316\u5e8f\u5217\u7684\u6a23\u5f0f\u540d\u7a31</p> <p> TYPE: <code>str</code> DEFAULT: <code>'RdBu_r'</code> </p> RETURNS DESCRIPTION <code>Figure</code> <p>\u7b56\u7565\u90e8\u4f4d\u65ed\u65e5\u5716</p> <p>Examples:     <pre><code>from finlab.plot import StrategySunburst\n# \u5be6\u4f8b\u5316\u7269\u4ef6\nstrategies = StrategySunburst()\nstrategies.plot().show()\nstrategies.plot(select_strategy={'\u9ad8\u6b96\u5229\u7387\u70cf\u9f9c':0.4,'\u71df\u6536\u5f37\u52e2\u52d5\u80fd\u760b\u72d7':0.25,'\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4':0.2,'\u73fe\u91d1':0.15},path =  ['market', 'category','stock_id','s_name']).show()\n</code></pre> ex1:\u7b56\u7565\u9078\u5230\u54ea\u4e9b\u6a19\u7684? </p> <p>ex2:\u90e8\u4f4d\u88ab\u54ea\u4e9b\u7b56\u7565\u9078\u5230\uff0c\u6a19\u7684\u82e5\u88ab\u4e0d\u540c\u7b56\u7565\u9078\u5230\uff0c\u53ef\u80fd\u6709\u7368\u7279\u4e4b\u8655\u5594\uff01 </p>"},{"location":"reference/plot/#finlab.plot.StrategyReturnStats","title":"finlab.plot.StrategyReturnStats","text":"<pre><code>StrategyReturnStats(start_date, end_date, strategy_names=[], benchmark_return=None)\n</code></pre> <p>\u7e6a\u88fd\u7b56\u7565\u5831\u916c\u7387\u7d71\u8a08\u6bd4\u8f03\u5716</p> <p>\u76e3\u63a7\u7b56\u7565\u7fa4\u9ad4\u76f8\u5c0d\u5c0d\u6a19\u6307\u6578\u7684\u8868\u73fe\u3002</p> PARAMETER  DESCRIPTION <code>start_date</code> <p>\u5831\u916c\u7387\u8a08\u7b97\u958b\u59cb\u65e5</p> <p> TYPE: <code>str</code> </p> <code>end_date</code> <p>\u5831\u916c\u7387\u8a08\u7b97\u7d50\u675f\u65e5</p> <p> TYPE: <code>str</code> </p> <code>strategy_names</code> <p>\u7528\u6236\u672c\u4eba\u7684\u7b56\u7565\u96c6\u8a2d\u5b9a\uff0c\u586b\u5165\u6b32\u7d0d\u5165\u7d71\u8a08\u7684\u7b56\u7565\u540d\u7a31\uff0c\u53ea\u9650\u5b9a\u81ea\u5df1\u7684\u7b56\u7565\u3002ex:<code>['\u81bd\u5c0f\u8c93','\u4e09\u983b\u7387RSI\u7b56\u7565', '\u4e8c\u6b21\u5275\u9ad8\u80a1\u7968',...]</code>\uff0c\u9810\u8a2d\u70ba\u5168\u90e8\u5df2\u4e0a\u50b3\u7684\u7b56\u7565\u3002</p> <p> TYPE: <code>list</code> DEFAULT: <code>[]</code> </p> <code>benchmark_return</code> <p>\u7b56\u7565\u6bd4\u5c0d\u57fa\u6e96\u5e8f\u5217\uff0c\u9810\u8a2d\u70ba\u53f0\u80a1\u52a0\u6b0a\u5831\u916c\u6307\u6578\u3002</p> <p> TYPE: <code>Series</code> DEFAULT: <code>None</code> </p> <p>Examples:</p> <pre><code>\u7d71\u8a082022-12-31~2023-07-31\u7684\u5831\u916c\u7387\u6578\u64da\n``` py\n# \u56de\u6e2c\u8d77\u59cb\u6642\u9593\nstart_date = '2022-12-31'\nend_date  = '2023-07-31'\n\n# \u9078\u5b9a\u7b56\u7565\u7bc4\u570d\nstrategy_names = ['\u81bd\u5c0f\u8c93','\u4e09\u983b\u7387RSI\u7b56\u7565', '\u4e8c\u6b21\u5275\u9ad8\u80a1\u7968', '\u4f4e\u6ce2\u52d5\u672c\u76ca\u6210\u9577\u6bd4', '\u5408\u7d04\u8ca0\u50b5\u5efa\u7bc9\u5de5', '\u591a\u7522\u696d\u50f9\u6295', '\u5c0f\u8766\u7c73\u8ddf\u5927\u9be8\u9b5a', '\u5c0f\u8cc7\u65cf\u8cc7\u512a\u751f\u7b56\u7565', '\u672c\u76ca\u6210\u9577\u6bd4', '\u71df\u6536\u80a1\u50f9\u96d9\u6e26\u8f2a', '\u73fe\u91d1\u6d41\u50f9\u503c\u6210\u9577', '\u7814\u767c\u9b54\u4eba', '\u80a1\u50f9\u6de8\u503c\u6bd4\u7b56\u7565', '\u85cf\u7352', '\u9ad8\u6b96\u5229\u7387\u70cf\u9f9c','\u76e3\u7344\u5154', '\u8ca1\u5831\u6307\u6a1920\u5927']\n\nreport = StrategyReturnStats(start_date ,end_date, strategy_names)\n# \u7e6a\u88fd\u7b56\u7565\u5831\u916c\u7387\u8fd1\u671f\u5831\u916c\u7387\u9577\u689d\u5716\nreport.plot_strategy_last_return().show()\n# \u7e6a\u88fd\u7b56\u7565\u7d2f\u7a4d\u5831\u916c\u7387\u6642\u9593\u5e8f\u5217\nreport.plot_strategy_creturn().show()\n```\n</code></pre>"},{"location":"reference/plot/#finlab.plot.StrategyReturnStats.get_benchmark_return","title":"get_benchmark_return","text":"<pre><code>get_benchmark_return()\n</code></pre> <p>\u8a2d\u5b9a\u5c0d\u6a19\u6307\u6578 Returns:     (pandas.Series): \u5c0d\u6a19\u6307\u6578\u6642\u9593\u5e8f\u5217</p>"},{"location":"reference/plot/#finlab.plot.StrategyReturnStats.plot_strategy_creturn","title":"plot_strategy_creturn","text":"<pre><code>plot_strategy_creturn()\n</code></pre> <p>\u7e6a\u88fd\u7b56\u7565\u7d2f\u7a4d\u5831\u916c\u7387\u6642\u9593\u5e8f\u5217 Returns:     (plotly.graph_objects.Figure): \u5716\u8868\u7269\u4ef6 </p>"},{"location":"reference/plot/#finlab.plot.StrategyReturnStats.plot_strategy_last_return","title":"plot_strategy_last_return","text":"<pre><code>plot_strategy_last_return()\n</code></pre> <p>\u7e6a\u88fd\u7b56\u7565\u5831\u916c\u7387\u8fd1\u671f\u5831\u916c\u7387\u9577\u689d\u5716 Returns:     (plotly.graph_objects.Figure): \u5716\u8868\u7269\u4ef6 </p>"},{"location":"reference/portfolio/","title":"finlab.portfolio","text":""},{"location":"reference/portfolio/#finlab.portfolio.Portfolio","title":"finlab.portfolio.Portfolio","text":"<pre><code>Portfolio(reports)\n</code></pre> <p>             Bases: <code>Report</code></p> <p>\u5efa\u69cb Portfolio \u7269\u4ef6\u3002</p> PARAMETER  DESCRIPTION <code>-</code> <p>\u4ee3\u8868\u6295\u8cc7\u7d44\u5408\u7684\u5b57\u5178\uff0ckey \u70ba\u8cc7\u7522\u540d\u7a31\uff0cvalue \u662f\u56de\u6e2c\u5831\u544a\u8207\u90e8\u4f4d\u3002</p> <p> TYPE: <code>reports (Dict[str, Tuple[Report, float]]</code> </p> Example <p>\u7d44\u5408\u591a\u500b\u7b56\u7565 <pre><code>from finlab import sim\nfrom finlab.portfolio import Portfolio\n\n# \u8acb\u53c3\u95b1 sim \u51fd\u6578\u7684\u6587\u4ef6\u4ee5\u7372\u53d6\u66f4\u591a\u4fe1\u606f\n# https://doc.finlab.tw/getting-start/\n\nreport_strategy1 = sim(...)\nreport_strategy2 = sim(...)\nreport_strategy3 = sim(...)\n\nportfolio = Portfolio({\n    'strategy1': (report_strategy1, 0.3),\n    'strategy2': (report_strategy2, 0.4),\n    'strategy3': (report_strategy3, 0.3),\n})\n</code></pre></p>"},{"location":"reference/portfolio/#finlab.portfolio.create_multi_asset_report","title":"finlab.portfolio.create_multi_asset_report","text":"<pre><code>create_multi_asset_report(stock_list, **kwargs)\n</code></pre> <p>\u6839\u64da\u63d0\u4f9b\u7684\u80a1\u7968\u6e05\u55ae\u5275\u5efa\u591a\u8cc7\u7522\u5831\u544a\u3002 Create a multi-asset report based on the stock list provided.</p> PARAMETER  DESCRIPTION <code>stock_list</code> <p>\u4e00\u500b\u4ee5\u80a1\u7968\u4ee3\u865f\u70ba key\uff0c\u6b0a\u91cd\u5927\u5c0f\u70ba value\u3002 A dictionary with stock id as key and weight as value.</p> <p> TYPE: <code>dict</code> </p> RETURNS DESCRIPTION <code>Report</code> <p>\u4e00\u500b\u5305\u542b\u56de\u6e2c\u7d50\u679c\u7684\u5831\u544a\u5c0d\u8c61\u3002A report object with the backtest result.</p> <p>Example:</p> <pre><code>&gt;&gt;&gt; from finlab.portfolio import create_multi_asset_report\n...\n...\n&gt;&gt;&gt; report = create_multi_asset_report({'2330': 0.5, '1101': 0.5})\n</code></pre>"},{"location":"reference/portfolio/#finlab.portfolio.create_report_from_cloud","title":"finlab.portfolio.create_report_from_cloud","text":"<pre><code>create_report_from_cloud(strategy_id, user_id=None, market=None)\n</code></pre> <p>\u6839\u64da\u63d0\u4f9b\u7684\u7528\u6236ID\u548c\u7b56\u7565ID\u5275\u5efa\u5728\u7dda\u5831\u544a\u3002 Create an online report based on the user id and strategy id provided.</p> PARAMETER  DESCRIPTION <code>user_id</code> <p>The user id.</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>strategy_id</code> <p>The</p> <p> TYPE: <code>str</code> </p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager","title":"finlab.portfolio.PortfolioSyncManager","text":"<pre><code>PortfolioSyncManager(data=None, start_with_empty=False)\n</code></pre> <p>\u6295\u8cc7\u7d44\u5408\u985e\u5225\uff0c\u7528\u65bc\u8a2d\u5b9a\u548c\u7372\u53d6\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u3002</p> ATTRIBUTE DESCRIPTION <code>path</code> <p>\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u7684\u5132\u5b58\u8def\u5f91\u3002</p> <p> TYPE: <code>str</code> </p> METHOD DESCRIPTION <code>set</code> <p>Dict[str, Tuple[int, Report]]): \u8a2d\u5b9a\u6295\u8cc7\u7d44\u5408\u7684\u51fd\u6578\u3002</p> <code>get_position</code> <p>\u7372\u53d6\u6301\u5009\u8cc7\u8a0a\u3002</p> <p>Examples:</p> <pre><code>from finlab.portfolio import Portfolio, PortfolioSyncManager\n# \u521d\u59cb\u5316\u6295\u8cc7\u7d44\u5408\nport = Portfolio({'\u7b56\u7565A': (report1, 0.3), '\u7b56\u7565B': (report2, 0.7)})\n# \u8a2d\u5b9a\u6295\u8cc7\u7d44\u5408\n# pm = PortfolioSyncManager.from_local() or \n# pm = PortfolioSyncManager.from_cloud()\npm = PortfolioSyncManager() \npm.update(port, total_balance=1000000)\npm.to_cloud() # pm.to_local()\nprint(pm)\n# \u4e0b\u55ae\naccount = ... # \u8acb\u53c3\u8003 Account \u7522\u751f\u65b9\u5f0f\npm.sync(account) # \u5e73\u76e4\u50f9\u683c\u4e0b\u55ae\n</code></pre> <p>\u5efa\u69cb\u6295\u8cc7\u7d44\u5408\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.clear","title":"clear","text":"<pre><code>clear()\n</code></pre> <p>\u6e05\u9664\u6301\u5009\u8cc7\u8a0a\u3002</p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.create_order_executor","title":"create_order_executor","text":"<pre><code>create_order_executor(account, at='close', consider_margin_as_asset=False, market_name=None, **kwargs)\n</code></pre> <p>\u540c\u6b65\u6301\u5009\u8cc7\u8a0a\u3002</p> PARAMETER  DESCRIPTION <code>account</code> <p>\u4ea4\u6613\u5e33\u6236\u3002</p> <p> TYPE: <code>Account</code> </p> <code>consider_margin_as_asset</code> <p>\u662f\u5426\u5c07\u878d\u8cc7\u878d\u5238\u8996\u70ba\u8cc7\u7522\u3002\u9810\u8a2d\u70ba True\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>market_name</code> <p>\u6307\u5b9a\u5e02\u5834\u540d\u7a31\u3002\u9810\u8a2d\u70ba None\uff0c\u4e5f\u5c31\u662f\u7372\u53d6\u6240\u6709\u5e02\u5834\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>market_order</code> <p>\u4ee5\u985e\u5e02\u50f9\u76e1\u91cf\u5373\u523b\u6210\u4ea4\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u6f32\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u8dcc\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>best_price_limit</code> <p>\u639b\u82ad\u6a02\u50f9\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u8dcc\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u6f32\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>view_only</code> <p>\u9810\u8a2d\u70ba False\uff0c\u6703\u5be6\u969b\u4e0b\u55ae\u3002\u82e5\u8a2d\u70ba True\uff0c\u4e0d\u6703\u4e0b\u55ae\uff0c\u53ea\u6703\u56de\u50b3\u6b32\u57f7\u884c\u7684\u59d4\u8a17\u55ae\u8cc7\u6599(dict)</p> <p> TYPE: <code>bool</code> </p> <code>extra_bid_pct</code> <p>\u4ee5\u8a72\u767e\u5206\u6bd4\u503c\u4e58\u4ee5\u50f9\u683c\u9032\u884c\u8ffd\u50f9\u4e0b\u55ae\uff0c\u5982\u8a2d\u5b9a\u70ba 0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 +(-)5% \u7684\u9650\u50f9\u9032\u8cb7\u5165(\u8ce3\u51fa)\uff0c\u4e5f\u5c31\u662f\u66f4\u6709\u6a5f\u6703\u53ef\u4ee5\u6210\u4ea4\uff0c\u4f46\u662f\u6210\u4ea4\u50f9\u683c\u53ef\u80fd\u4e0d\u7406\u60f3\uff1b \u5047\u5982\u8a2d\u5b9a\u70ba -0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 -(+)5% \u9032\u884c\u8cb7\u5165\u8ce3\u51fa\uff0c\u4e5f\u5c31\u662f\u9650\u50f9\u55ae\u5c07\u4e0d\u6703\u7acb\u5373\u6210\u4ea4\uff0c\u7136\u800c\u5047\u5982\u6210\u4ea4\u5f8c\uff0c\u50f9\u683c\u6bd4\u8f03\u7406\u60f3\u3002\u53c3\u6578\u6709\u6548\u7bc4\u570d\u70ba -0.1 \u5230 0.1 \u5167\u3002</p> <p> TYPE: <code>float</code> </p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.from_cloud","title":"from_cloud  <code>classmethod</code>","text":"<pre><code>from_cloud(name='default')\n</code></pre> <p>\u5f9e\u96f2\u7aef\u6a94\u6848\u521d\u59cb\u5316\u6295\u8cc7\u7d44\u5408\u3002</p> PARAMETER  DESCRIPTION <code>path</code> <p>\u96f2\u7aef\u6a94\u6848\u7684\u8def\u5f91\u3002\u9810\u8a2d\u70ba 'default'\u3002</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>PortfolioSyncManager</code> <p>\u6295\u8cc7\u7d44\u5408\u985e\u5225\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.from_local","title":"from_local  <code>classmethod</code>","text":"<pre><code>from_local(name='default')\n</code></pre> <p>\u5f9e\u672c\u5730\u6a94\u6848\u521d\u59cb\u5316\u6295\u8cc7\u7d44\u5408\u3002</p> PARAMETER  DESCRIPTION <code>path</code> <p>\u672c\u5730\u6a94\u6848\u7684\u8def\u5f91\u3002</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>PortfolioSyncManager</code> <p>\u6295\u8cc7\u7d44\u5408\u985e\u5225\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.from_path","title":"from_path  <code>classmethod</code>","text":"<pre><code>from_path(path)\n</code></pre> <p>\u5f9e\u672c\u5730\u6a94\u6848\u521d\u59cb\u5316\u6295\u8cc7\u7d44\u5408\u3002</p> PARAMETER  DESCRIPTION <code>path</code> <p>\u672c\u5730\u6a94\u6848\u7684\u8def\u5f91\u3002</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>PortfolioSyncManager</code> <p>\u6295\u8cc7\u7d44\u5408\u985e\u5225\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.get_position","title":"get_position","text":"<pre><code>get_position(at='close', market_name=None)\n</code></pre> <p>\u7372\u53d6\u6301\u5009\u8cc7\u8a0a\u3002</p> PARAMETER  DESCRIPTION <code>market_name</code> <p>\u6307\u5b9a\u5e02\u5834\u540d\u7a31\u3002\u9810\u8a2d\u70ba None\uff0c\u4e5f\u5c31\u662f\u7372\u53d6\u6240\u6709\u5e02\u5834\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <p>dict or Position: \u82e5 combined \u70ba True\uff0c\u5247\u8fd4\u56de\u5408\u4f75\u5f8c\u7684\u6301\u5009\u8cc7\u8a0a\uff08Position \u7269\u4ef6\uff09\uff1b                 \u82e5 combined \u70ba False\uff0c\u5247\u8fd4\u56de\u539f\u59cb\u6301\u5009\u8cc7\u8a0a\uff08dict\uff09\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.get_strategy_position","title":"get_strategy_position","text":"<pre><code>get_strategy_position(strategy_name, at)\n</code></pre> <p>\u7372\u53d6\u7b56\u7565\u7684\u958b\u5009\u90e8\u4f4d\u3002</p> PARAMETER  DESCRIPTION <code>strategy_name</code> <p>\u7b56\u7565\u540d\u7a31\u3002</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>dict</code> <p>\u958b\u5009\u90e8\u4f4d\u8cc7\u8a0a\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.get_total_position","title":"get_total_position","text":"<pre><code>get_total_position()\n</code></pre> <p>\u56de\u50b3\u76ee\u524d\u6301\u5009\u7684 DataFrame\uff08\u8207 repr \u986f\u793a\u7684 df \u76f8\u540c\uff09\u3002</p> RETURNS DESCRIPTION <p>pd.DataFrame: \u6301\u5009\u8cc7\u8a0a\u7684 DataFrame\u3002</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.margin_cash_position_combine","title":"margin_cash_position_combine  <code>staticmethod</code>","text":"<pre><code>margin_cash_position_combine(acp, idp)\n</code></pre> <p>\u5408\u4f75\u73fe\u91d1\u8207\u4fdd\u8b49\u91d1\u90e8\u4f4d\u3002</p> PARAMETER  DESCRIPTION <code>acp</code> <p>\u7576\u524d\u5e33\u6236\u7684\u80a1\u7968\u90e8\u4f4d\u3002</p> <p> TYPE: <code>Position</code> </p> <code>idp</code> <p>\u65b0\u7684\u5e33\u6236\u7684\u80a1\u7968\u90e8\u4f4d\u3002</p> <p> TYPE: <code>Position</code> </p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.sync","title":"sync","text":"<pre><code>sync(account, at='close', consider_margin_as_asset=True, market_name=None, **kwargs)\n</code></pre> <p>\u540c\u6b65\u6301\u5009\u8cc7\u8a0a\u3002</p> PARAMETER  DESCRIPTION <code>account</code> <p>\u4ea4\u6613\u5e33\u6236\u3002</p> <p> TYPE: <code>Account</code> </p> <code>consider_margin_as_asset</code> <p>\u662f\u5426\u5c07\u4fdd\u8b49\u91d1\u4ea4\u6613\u8996\u70ba\u8cc7\u7522\u3002\u9810\u8a2d\u70ba True\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> <code>market_name</code> <p>\u6307\u5b9a\u5e02\u5834\u540d\u7a31\u3002\u9810\u8a2d\u70ba None\uff0c\u4e5f\u5c31\u662f\u7372\u53d6\u6240\u6709\u5e02\u5834\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> <code>market_order</code> <p>\u4ee5\u985e\u5e02\u50f9\u76e1\u91cf\u5373\u523b\u6210\u4ea4\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u6f32\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u8dcc\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>best_price_limit</code> <p>\u639b\u82ad\u6a02\u50f9\uff1a\u6240\u6709\u8cb7\u55ae\u639b\u8dcc\u505c\u50f9\uff0c\u6240\u6709\u8ce3\u55ae\u639b\u6f32\u505c\u50f9</p> <p> TYPE: <code>bool</code> </p> <code>view_only</code> <p>\u9810\u8a2d\u70ba False\uff0c\u6703\u5be6\u969b\u4e0b\u55ae\u3002\u82e5\u8a2d\u70ba True\uff0c\u4e0d\u6703\u4e0b\u55ae\uff0c\u53ea\u6703\u56de\u50b3\u6b32\u57f7\u884c\u7684\u59d4\u8a17\u55ae\u8cc7\u6599(dict)</p> <p> TYPE: <code>bool</code> </p> <code>extra_bid_pct</code> <p>\u4ee5\u8a72\u767e\u5206\u6bd4\u503c\u4e58\u4ee5\u50f9\u683c\u9032\u884c\u8ffd\u50f9\u4e0b\u55ae\uff0c\u5982\u8a2d\u5b9a\u70ba 0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 +(-)5% \u7684\u9650\u50f9\u9032\u8cb7\u5165(\u8ce3\u51fa)\uff0c\u4e5f\u5c31\u662f\u66f4\u6709\u6a5f\u6703\u53ef\u4ee5\u6210\u4ea4\uff0c\u4f46\u662f\u6210\u4ea4\u50f9\u683c\u53ef\u80fd\u4e0d\u7406\u60f3\uff1b \u5047\u5982\u8a2d\u5b9a\u70ba -0.05 \u6642\uff0c\u5c07\u4ee5\u7576\u524d\u50f9\u7684 -(+)5% \u9032\u884c\u8cb7\u5165\u8ce3\u51fa\uff0c\u4e5f\u5c31\u662f\u9650\u50f9\u55ae\u5c07\u4e0d\u6703\u7acb\u5373\u6210\u4ea4\uff0c\u7136\u800c\u5047\u5982\u6210\u4ea4\u5f8c\uff0c\u50f9\u683c\u6bd4\u8f03\u7406\u60f3\u3002\u53c3\u6578\u6709\u6548\u7bc4\u570d\u70ba -0.1 \u5230 0.1 \u5167\u3002</p> <p> TYPE: <code>float</code> </p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.to_cloud","title":"to_cloud","text":"<pre><code>to_cloud(name='default')\n</code></pre> <p>\u5c07\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u5b58\u81f3\u96f2\u7aef\u6a94\u6848\u3002</p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.to_local","title":"to_local","text":"<pre><code>to_local(name='default')\n</code></pre> <p>\u5c07\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u5b58\u81f3\u672c\u5730\u6a94\u6848\u3002</p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.to_path","title":"to_path","text":"<pre><code>to_path(path)\n</code></pre> <p>\u5c07\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u5b58\u81f3\u672c\u5730\u6a94\u6848\u3002</p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/portfolio/#finlab.portfolio.PortfolioSyncManager.update","title":"update","text":"<pre><code>update(portfolio, total_balance=0, rebalance_safety_weight=0.2, smooth_transition=None, force_override_difference=False, custom_position=None, excluded_stock_ids=None, **kwargs)\n</code></pre> <p>\u8a2d\u5b9a\u6295\u8cc7\u7d44\u5408\u7684\u51fd\u6578\u3002</p> PARAMETER  DESCRIPTION <code>portfolio</code> <p>\u5305\u542b\u6295\u8cc7\u7d44\u5408\u8cc7\u8a0a\u7684\u5b57\u5178\u3002</p> <p> TYPE: <code>Portfolio</code> </p> <code>total_balance</code> <p>\u7e3d\u8cc7\u7522\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>0</code> </p> <code>rebalance_safety_weight</code> <p>\u73fe\u91d1\u7684\u6b0a\u91cd\uff0c\u78ba\u4fdd\u4ee5\u5e02\u50f9\u8cb7\u8ce3\u6642\uff0c\u65b0\u7684\u7b56\u7565\u7d44\u5408\u50f9\u503c\u4e0d\u8d85\u904e\u820a\u7684\u50f9\u503c\uff0c\u8a08\u7b97\u65b9\u5f0f\u70ba\uff1a\u8ce3\u51fa\u80a1\u7968\u5f8c\uff0c\u6709\u591a\u5c11\u6bd4\u4f8b\u8981\u8b8a\u6210\u73fe\u91d1(\u4f8b\u5982 20\uff05)\uff0c\u518d\u8cb7\u5165\u65b0\u7684\u80a1\u7968\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>0.2</code> </p> <code>smooth_transition</code> <p>\u662f\u5426\u53ea\u5728\u63db\u80a1\u65e5\u624d\u66f4\u65b0\uff0c\u9810\u8a2d\u70ba None\uff0c\u7cfb\u7d71\u6703\u81ea\u884c\u5224\u65b7\uff0c\u5047\u5982\u7b2c\u4e00\u6b21\u547c\u53eb\u51fd\u793a\uff0c\u6703\u662f False\uff0c\u4e4b\u5f8c\u6703\u662f True\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>None</code> </p> <code>force_override_difference</code> <p>\u662f\u5426\u5f37\u5236\u8986\u84cb\u4e0d\u540c\u7684\u90e8\u4f4d\uff0c\u9810\u8a2d\u70ba False\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>custom_position</code> <p>\u81ea\u5b9a\u7fa9\u90e8\u4f4d\uff0c\u9810\u8a2d\u70ba None\u3002\u7576 custom_position \u4e0d\u70ba None \u6642\uff0c\u6703\u5c07 custom_position \u52a0\u5165\u5230\u90e8\u4f4d\u4e2d\u3002\u7a0b\u5f0f\u5728\u8a08\u7b97\u90e8\u4f4d\u6642\uff0c\u6703\u5c07 custom_position \u6392\u9664\u5728\u5916\uff0c\u4e0d\u5217\u5165\u3002</p> <p> TYPE: <code>Position or dict</code> DEFAULT: <code>None</code> </p> <code>excluded_stock_ids</code> <p>\u6392\u9664\u7684\u80a1\u7968\u4ee3\u78bc\u5217\u8868\u3002\u9810\u8a2d\u70ba None\u3002</p> <p> TYPE: <code>List[str]</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <p>None</p> <p>Examples:</p> <pre><code>from finlab.backtest import sim\nfrom finlab.portfolio import Portfolio, OnlineReport\n# create report 1\nreport1 = sim(...) # \u8acb\u53c3\u8003\u56de\u6e2c\u8a9e\u6cd5\n# download online report\nreport2 = OnlineReport.from_cloud('strategyName') # \u4e0b\u8f09\u7b56\u7565\u5831\u544a\n# create portfolio\nportfolio = Portfolio({'\u7b56\u75651': (report1, 0.5), '\u7b56\u75652': (report2, 0.5)})\n# create PortfolioSyncManager\npm = PortfolioSyncManager.from_cloud()\npm.update(portfolio, total_balance=1000000, cash_weight=0.2) # \u6295\u8cc7 100 \u842c\u5143\n# create orders\naccount = ... # \u8acb\u53c3\u8003 Account \u7522\u751f\u65b9\u5f0f\npm.sync(account) # \u5e73\u76e4\u50f9\u683c\u4e0b\u55ae\npm.sync(account, market_order=True) # \u5e02\u50f9\u4e0b\u55ae\n</code></pre>"},{"location":"reference/report/","title":"finlab.report","text":""},{"location":"reference/report/#finlab.analysis.Report","title":"finlab.analysis.Report","text":"<pre><code>Report(creturn, position, fee_ratio, tax_ratio, trade_at, next_trading_date, market)\n</code></pre> <p>             Bases: <code>Report</code></p> <p>\u7b56\u7565\u56de\u6e2c\u57fa\u790e\u5831\u544a Args:   creturn (pd.Series): \u7b56\u7565\u5831\u916c\u7387\u6642\u9593\u5e8f\u5217\u3002   position (pd.DataFrame): \u7b56\u7565\u5831\u916c\u7387\u6642\u9593\u5e8f\u5217\u3002   fee_ratio (float): \u4ea4\u6613\u624b\u7e8c\u8cbb\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u7121\u6253\u6298\u624b\u7e8c\u8cbb 0.001425\u3002\u53ef\u8996\u500b\u4eba\u4f7f\u7528\u7684\u5238\u5546\u512a\u60e0\u8abf\u6574\u8cbb\u7387\u3002   tax_ratio (float): \u4ea4\u6613\u7a05\u7387\uff0c\u9810\u8a2d\u70ba\u53f0\u7063\u666e\u901a\u80a1\u4e00\u822c\u4ea4\u6613\u4ea4\u6613\u7a05\u7387 0.003\u3002\u82e5\u4ea4\u6613\u7b56\u7565\u7684\u6a19\u7684\u7686\u70ba ETF\uff0c\u8a18\u5f97\u8a2d\u6210 0.001\u3002   trade_at (str): \u9078\u64c7\u56de\u6e2c\u4e4b\u9084\u539f\u80a1\u50f9\u4ee5\u6536\u76e4\u50f9\u6216\u958b\u76e4\u50f9\u8a08\u7b97\uff0c\u9810\u8a2d\u70ba close\u3002\u53ef\u9078 close \u6216 open\u3002   next_trading_date (str): \u9810\u671f\u4e0b\u671f\u63db\u80a1\u65e5\u3002   market (str or Market): \u53ef\u9078\u64c7<code>'TWSTOCK', 'CRYPTO'</code>\uff0c\u5206\u5225\u70ba\u53f0\u80a1\u6216\u52a0\u5bc6\u8ca8\u5e63\uff0c                                                              \u6216\u7e7c\u627f <code>finlab.market.Market</code> \u958b\u767c\u56de\u6e2c\u5e02\u5834\u985e\u5225\u3002 Attributes:   benchmark (pd.Series): \u5c0d\u6a19\u5831\u916c\u7387\u66f2\u7dda\u7684\u6642\u9593\u5e8f\u5217\uff0c\u7528\u65bc Report.display() \u986f\u793a\u7b56\u7565\u5831\u916c\u7387\u6bd4\u8f03\u6a19\u6e96\u3002   update_date (str): \u7528\u65bc Report.display() \u986f\u793a\u7b56\u7565\u5c0d\u6a19\u7684\u5831\u916c\u7387\u66f2\u7dda\u3002   asset_type (str): \u8cc7\u7522\u985e\u5225\uff0c tw_stock \u6216 crypto\u3002   last_trading_date (str): \u6700\u8fd1\u7522\u751f\u4ea4\u6613\u8a0a\u865f\u7684\u65e5\u671f\u3002</p>"},{"location":"reference/report/#finlab.analysis.Report.display","title":"display","text":"<pre><code>display(lagacy=False, save_report_path=None)\n</code></pre> <p>\u986f\u793a\u56de\u6e2c\u5831\u544a</p> PARAMETER  DESCRIPTION <code>lagacy</code> <p>True, \u4f7f\u7528\u820a\u7248\u5831\u544a\u683c\u5f0f\u3002False, \u4f7f\u7528\u65b0\u7248\u5831\u544a\u683c\u5f0f\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> <code>save_report_path</code> <p>\u5831\u544a\u5132\u5b58\u8def\u5f91\uff0c\u9810\u8a2d\u70ba None\uff0c\u5373\u4e0d\u5132\u5b58\u5831\u544a\u3002</p> <p> TYPE: <code>str</code> DEFAULT: <code>None</code> </p> RETURNS DESCRIPTION <p>None</p>"},{"location":"reference/report/#finlab.analysis.Report.display_mae_mfe_analysis","title":"display_mae_mfe_analysis","text":"<pre><code>display_mae_mfe_analysis(violinmode='group', mfe_scatter_x='mae', **kwargs)\n</code></pre> <p>\u986f\u793a\u6ce2\u52d5\u5206\u6790\u5716\u7d44</p> <p>\u5206\u6790\u4f7f\u7528\u8aaa\u660e\u3002 Args:   violinmode (str): violin \u578b\u614b\u7d71\u8a08\u5716\u6a23\u5f0f\uff0c\u6a21\u5f0f\u5206\u70ba group \u8207 overlay\u3002                     \u9810\u8a2d\u70ba group\uff0cgroup \u6a21\u5f0f\u70ba\u5c07\u4ea4\u6613\u52dd\u6557\u5206\u7fa4\u7d71\u8a08'\uff0coverlay \u63a1\u53d6\u5168\u6578\u7d71\u8a08\u3002   mfe_scatter_x (str): \u5b50\u5716 2-1\u30012-2 MFE \u6563\u9ede\u5716\u7684X\u8ef8\u6bd4\u8f03\u9805\u76ee\u8a2d\u5b9a\uff0c\u53ef\u9078<code>'mae' or 'return'</code>\u3002   **kwargs (dict): \u5176\u9918\u5716\u8868\u5916\u89c0(layout)\u53c3\u6578\u3002 Returns:   (plotly.graph_objects.Figure): \u6ce2\u52d5\u5206\u6790\u5716\u7d44</p> <p>Examples:</p> <p>group : </p> <p>overlay : </p>"},{"location":"reference/report/#finlab.analysis.Report.from_pickle","title":"from_pickle","text":"<pre><code>from_pickle(file_path)\n</code></pre> <p>\u8b80\u53d6\u56de\u6e2c\u5831\u544a</p>"},{"location":"reference/report/#finlab.analysis.Report.get_mae_mfe","title":"get_mae_mfe","text":"<pre><code>get_mae_mfe()\n</code></pre> <p>\u53d6\u5f97 mae_mfe \u6642\u5e8f\u8cc7\u6599</p> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u6ce2\u52d5\u6642\u5e8f\u8cc7\u6599</p>"},{"location":"reference/report/#finlab.analysis.Report.get_metrics","title":"get_metrics","text":"<pre><code>get_metrics(stats_=None, riskfree_rate=0.02)\n</code></pre> <p>Get the metrics of the backtest result.</p> PARAMETER  DESCRIPTION <code>stats_</code> <p>\u56de\u6e2c\u7d50\u679c\u7684\u7d71\u8a08\u6578\u64da\u3002\u5982\u679c\u70ba None\uff0c\u5247\u6703\u8a08\u7b97\u7d71\u8a08\u6578\u64da\u3002</p> <p> TYPE: <code>dict</code> DEFAULT: <code>None</code> </p> <code>riskfree_rate</code> <p>\u7121\u98a8\u96aa\u5229\u7387\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>0.02</code> </p> <p>Returns:</p> <pre><code>dict: \u56de\u6e2c\u7d50\u679c\u7684\u6307\u6a19:\n    - backtest (dict): \u56de\u6e2c\u4fe1\u606f\u3002\n        - startDate (int): \u56de\u6e2c\u958b\u59cb\u65e5\u671f\u3002\n        - endDate (int): \u56de\u6e2c\u7d50\u675f\u65e5\u671f\u3002\n        - version (str): \u56de\u6e2c\u7248\u672c\u3002\n        - feeRatio (float): \u624b\u7e8c\u8cbb\u6bd4\u7387\u3002\n        - taxRatio (float): \u7a05\u6536\u6bd4\u7387\u3002\n        - tradeAt (str): \u4ea4\u6613\u6642\u9593\u3002\n        - market (str): \u5e02\u5834\u3002\n        - freq (str): \u983b\u7387\u3002\n    - profitability (dict): \u76c8\u5229\u6307\u6a19\u3002\n        - annualReturn (float): \u5e74\u56de\u5831\u7387\u3002\n        - alpha (float): \u963f\u723e\u6cd5\u503c\u3002\n        - beta (float): \u8c9d\u5854\u503c\u3002\n        - avgNStock (float): \u5e73\u5747\u80a1\u7968\u6578\u91cf\u3002\n        - maxNStock (float): \u6700\u5927\u80a1\u7968\u6578\u91cf\u3002\n    - risk (dict): \u98a8\u96aa\u6307\u6a19\u3002\n        - maxDrawdown (float): \u6700\u5927\u56de\u64a4\u3002\n        - avgDrawdown (float): \u5e73\u5747\u56de\u64a4\u3002\n        - avgDrawdownDays (float): \u5e73\u5747\u56de\u64a4\u5929\u6578\u3002\n        - valueAtRisk (float): \u5728\u96aa\u50f9\u503c\u3002\n        - cvalueAtRisk (float): \u689d\u4ef6\u5728\u96aa\u50f9\u503c\u3002\n    - ratio (dict): \u6bd4\u7387\u6307\u6a19\u3002\n        - sharpeRatio (float): \u590f\u666e\u6bd4\u7387\u3002\n        - sortinoRatio (float): \u7d22\u63d0\u8afe\u6bd4\u7387\u3002\n        - calmarRatio (float): \u5361\u723e\u746a\u6bd4\u7387\u3002\n        - volatility (float): \u6ce2\u52d5\u7387\u3002\n        - profitFactor (float): \u5229\u6f64\u56e0\u5b50\u3002\n        - tailRatio (float): \u5c3e\u6bd4\u7387\u3002\n    - winrate (dict): \u52dd\u7387\u6307\u6a19\u3002\n        - winRate (float): \u52dd\u7387\u3002\n        - m12WinRate (float): 12\u500b\u6708\u52dd\u7387\u3002\n        - expectancy (float): \u671f\u671b\u503c\u3002\n        - mae (float): \u6700\u5927\u4e0d\u5229\u504f\u96e2\u3002\n        - mfe (float): \u6700\u5927\u6709\u5229\u504f\u96e2\u3002\n    - liquidity (dict): \u6d41\u52d5\u6027\u6307\u6a19\u3002\n        - capacity (float): \u5bb9\u91cf\u3002\n        - disposalStockRatio (float): \u8655\u7f6e\u80a1\u7968\u6bd4\u7387\u3002\n        - warningStockRatio (float): \u8b66\u544a\u80a1\u7968\u6bd4\u7387\u3002\n        - fullDeliveryStockRatio (float): \u5b8c\u5168\u4ea4\u5272\u80a1\u7968\u6bd4\u7387\u3002\n</code></pre>"},{"location":"reference/report/#finlab.analysis.Report.get_stats","title":"get_stats","text":"<pre><code>get_stats(resample='1d', riskfree_rate=0.02)\n</code></pre> <p>\u53d6\u5f97\u7b56\u7565\u7d71\u8a08\u6578\u64da \u53d6\u5f97\u6578\u64da\u5982\uff1a\u5e74\u5316\u5831\u916c\u3001\u52dd\u7387\u3001\u590f\u666e\u7387\u3001\u7d22\u63d0\u8afe\u6bd4\u7387\u3001\u6700\u5927\u56de\u6a94\u3001\u8fd1\u671f\u5404\u5e74\u6708\u5831\u916c\u7387\u7d71\u8a08\u3001alpha_beta... Args:     resample (str): \u5831\u916c\u7387\u6aa2\u6e2c\u9031\u671f\uff0c\u5176\u4ed6\u5e38\u7528\u6578\u503c\u70ba W\u3001 M \u3001Q\uff08\u6bcf\u9031\u3001\u6bcf\u6708\u3001\u6bcf\u5b63\u63db\u80a1\uff09\u3002     riskfree_rate (float): \u7121\u98a8\u96aa\u5229\u7387\uff0c\u8207\u590f\u666e\u7387\u8a08\u7b97\u6709\u95dc\u3002 Returns:     (dict): \u7b56\u7565\u6307\u6a19\u6578\u64da</p>"},{"location":"reference/report/#finlab.analysis.Report.get_trades","title":"get_trades","text":"<pre><code>get_trades()\n</code></pre> <p>\u53d6\u5f97\u56de\u6e2c\u9010\u7b46\u4ea4\u6613\u7d00\u9304</p> RETURNS DESCRIPTION <code>DataFrame</code> <p>\u4ea4\u6613\u7d00\u9304\uff0c\u6b04\u4f4d\u5305\u542b\uff1a</p> <ul> <li>entry_sig_date:\u9032\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>exit_sig_date:\u51fa\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>entry_date:\u9032\u5834\u65e5\u3002</li> <li>exit_date:\u51fa\u5834\u65e5\u3002</li> <li>position:\u6301\u6709\u4f54\u6bd4\u3002</li> <li>period:\u6301\u6709\u5929\u6578\u3002</li> <li>return:\u5831\u916c\u7387\u3002</li> <li>trade_price@entry_date:\u9032\u5834\u50f9\u3002</li> <li>trade_price@exit_date:\u51fa\u5834\u50f9\u3002</li> <li>mae:\u6301\u6709\u671f\u9593\u6700\u5927\u4e0d\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>gmfe:\u6301\u6709\u671f\u9593\u6700\u5927\u6709\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>bmfe:mae\u767c\u751f\u524d\u7684\u6700\u5927\u6709\u5229\u5831\u916c\u7387\u5e45\u5ea6\u3002</li> <li>mdd:\u6301\u6709\u671f\u9593\u6700\u5927\u56de\u64a4\u3002</li> <li>pdays:\u8655\u65bc\u7372\u5229\u6642\u7684\u5929\u6578\u3002</li> </ul>"},{"location":"reference/report/#finlab.analysis.Report.is_rebalance_due","title":"is_rebalance_due","text":"<pre><code>is_rebalance_due()\n</code></pre> <p>\u5224\u65b7\u662f\u5426\u9700\u8981\u63db\u80a1</p>"},{"location":"reference/report/#finlab.analysis.Report.is_stop_triggered","title":"is_stop_triggered","text":"<pre><code>is_stop_triggered()\n</code></pre> <p>\u5224\u65b7\u662f\u5426\u9700\u8981\u505c\u640d\u505c\u5229</p>"},{"location":"reference/report/#finlab.analysis.Report.position_info","title":"position_info","text":"<pre><code>position_info()\n</code></pre> <p>\u53d6\u5f97\u8fd1\u671f\u6301\u6709\u90e8\u4f4d\u8207\u9810\u671f\u63db\u80a1\u8cc7\u8a0a Returns:   (dict): \u90e8\u4f4d\u8cc7\u8a0a</p>"},{"location":"reference/report/#finlab.analysis.Report.run_analysis","title":"run_analysis","text":"<pre><code>run_analysis(analysis, display=True, **kwargs)\n</code></pre> <p>\u57f7\u884c\u7b56\u7565\u5206\u6790\u5916\u639b\u6a21\u7d44 Args:   analysis (str or object): <code>finlab.analysis</code>\u5167\u7684\u5206\u6790\u6a21\u7d44\u540d\u7a31\uff0cex:<code>'liquidityAnalysis'</code>\u3002   display (bool): \u662f\u5426\u986f\u793a\u6a21\u7d44\u5206\u6790\u5716\u8868\u3002   **kwargs (mapping, optional): \u5206\u6790\u6a21\u7d44\u53c3\u6578\u8abf\u6574\u3002 Returns:   (pd.DataFrame or plotly.graph_objects.Figure): \u5206\u6790\u7d50\u679c</p>"},{"location":"reference/report/#finlab.analysis.Report.to_pickle","title":"to_pickle","text":"<pre><code>to_pickle(file_path)\n</code></pre> <p>\u5132\u5b58\u56de\u6e2c\u5831\u544a</p>"},{"location":"reference/report/#finlab.analysis.Report.to_text","title":"to_text","text":"<pre><code>to_text()\n</code></pre> <p>\u5c07\u56de\u6e2c\u5831\u544a\u4ee5\u6587\u5b57\u65b9\u5f0f\u5448\u73fe</p>"},{"location":"reference/report/#finlab.analysis.Report.upload","title":"upload","text":"<pre><code>upload(name=None)\n</code></pre> <p>\u4e0a\u50b3\u56de\u6e2c\u5831\u544a\u8cc7\u6599\u5230\u91cf\u5316\u5e73\u53f0\u7db2\u7ad9 Args:   name (str): \u7b56\u7565\u540d\u7a31\u3002</p>"},{"location":"reference/tools/","title":"finlab.tools","text":""},{"location":"reference/tools/#finlab.tools.event_study","title":"finlab.tools.event_study","text":""},{"location":"reference/tools/#finlab.tools.event_study.create_factor_data","title":"create_factor_data","text":"<pre><code>create_factor_data(factor, adj_close, days=[5, 10, 20, 60], event=None)\n</code></pre> <p>create factor data, which contains future return</p> PARAMETER  DESCRIPTION <code>factor</code> <p>factor data where index is datetime and columns is asset id</p> <p> TYPE: <code>DataFrame</code> </p> <code>adj_close</code> <p>adj close where index is datetime and columns is asset id</p> <p> TYPE: <code>DataFrame</code> </p> <code>days</code> <p>future return considered</p> <p> TYPE: <code>List[int]</code> DEFAULT: <code>[5, 10, 20, 60]</code> </p> Return <p>Analytic plots and tables</p> Warning <p>This function is not identical to <code>finlab.ml.alphalens.create_factor_data</code></p> <p>Examples:</p> \u73fe\u91d1\u589e\u6e1b\u8cc7\u5206\u6790<pre><code>from finlab.tools.event_study import create_factor_data\nfrom finlab.tools.event_study import event_study\nfactor = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nadj_close = data.get('etl:adj_close')\nbenchmark = data.get('benchmark_return:\u767c\u884c\u91cf\u52a0\u6b0a\u80a1\u50f9\u5831\u916c\u6307\u6578')\n# create event dataframe\ndividend_info = data.get('dividend_announcement')\nv = dividend_info[['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5']].set_index(['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5'])\nv['value'] = 1\nevent = v[~v.index.duplicated()].reset_index().drop_duplicates(\nsubset=['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5']\n).pivot(index='\u9664\u6b0a\u4ea4\u6613\u65e5', columns='stock_id', values='value').notna()\n# calculate factor_data\nfactor_data = create_factor_data({'pb':factor}, adj_close, event=event)\nr = event_study(factor_data, benchmark, adj_close)\nplt.bar(r.columns, r.mean().values)\nplt.plot(r.columns, r.mean().cumsum().values)\n</code></pre>"},{"location":"reference/tools/#finlab.tools.event_study.event_study","title":"event_study","text":"<pre><code>event_study(factor_data, benchmark_adj_close, stock_adj_close, sample_period=(-45, -20), estimation_period=(-5, 20), plot=True)\n</code></pre> <p>Run event study and returns the abnormal returns of each stock on each day.</p> PARAMETER  DESCRIPTION <code>factor_data</code> <p>factor data where index is datetime and columns is asset id</p> <p> TYPE: <code>DataFrame</code> </p> <code>benchmark_adj_close</code> <p>benchmark for CAPM</p> <p> TYPE: <code>DataFrame</code> </p> <code>stock_adj_close</code> <p>stock price for CAPM</p> <p> TYPE: <code>DataFrame</code> </p> <code>sample_period</code> <p>period for fitting CAPM</p> <p> TYPE: <code>(int, int)</code> DEFAULT: <code>(-45, -20)</code> </p> <code>estimation_period</code> <p>period for calculating alpha (abnormal return)</p> <p> TYPE: <code>(int, int)</code> DEFAULT: <code>(-5, 20)</code> </p> <code>plot</code> <p>plot the result</p> <p> TYPE: <code>bool</code> DEFAULT: <code>True</code> </p> Return <p>Abnormal returns of each stock on each day.</p> <p>Examples:</p> \u73fe\u91d1\u589e\u6e1b\u8cc7\u5206\u6790<pre><code>from finlab.tools.event_study import create_factor_data\nfrom finlab.tools.event_study import event_study\nfactor = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nadj_close = data.get('etl:adj_close')\nbenchmark = data.get('benchmark_return:\u767c\u884c\u91cf\u52a0\u6b0a\u80a1\u50f9\u5831\u916c\u6307\u6578')\n# create event dataframe\ndividend_info = data.get('dividend_announcement')\nv = dividend_info[['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5']].set_index(['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5'])\nv['value'] = 1\nevent = v[~v.index.duplicated()].reset_index().drop_duplicates(\nsubset=['stock_id', '\u9664\u6b0a\u4ea4\u6613\u65e5']\n).pivot(index='\u9664\u6b0a\u4ea4\u6613\u65e5', columns='stock_id', values='value').notna()\n# calculate factor_data\nfactor_data = create_factor_data({'pb':factor}, adj_close, event=event)\nr = event_study(factor_data, benchmark, adj_close)\nplt.bar(r.columns, r.mean().values)\nplt.plot(r.columns, r.mean().cumsum().values)\n</code></pre>"},{"location":"reference/tools/#finlab.tools.event_study.plot_event_study","title":"plot_event_study","text":"<pre><code>plot_event_study(returns)\n</code></pre> <p>Plot the event study for the given returns.</p> PARAMETER  DESCRIPTION <code>returns</code> <p>A DataFrame containing the returns data.</p> <p> TYPE: <code>DataFrame</code> </p> Return <p>ax (matplotlib.axes.Axes): The axes object containing the plot.</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis","title":"finlab.tools.factor_analysis","text":""},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_centrality","title":"calc_centrality","text":"<pre><code>calc_centrality(return_df, window_periods, n_components=1)\n</code></pre> <p>\u5c0d\u6307\u5b9a\u7684\u6642\u9593\u5e8f\u5217\u6578\u64da\u8a08\u7b97\u6efe\u52d5\u8cc7\u7522\u96c6\u4e2d\u5ea6\u3002</p> <p>\u6b64\u51fd\u5f0f\u70ba\u901a\u7528\u51fd\u5f0f\uff0c\u53ef\u61c9\u7528\u65bc\u4efb\u4f55\u4ee5\u6642\u9593\u70ba\u7d22\u5f15\u3001\u8cc7\u7522\u70ba\u6b04\u4f4d\u7684 DataFrame(\u4f8b\u5982\u56e0\u5b50\u5831\u916c)\u3002 \u5b83\u73fe\u5728\u662f\u983b\u7387\u7121\u95dc\u7684\uff0c\u6efe\u52d5\u7a97\u53e3\u7531\u6574\u6578 <code>window_periods</code> \u6307\u5b9a\u3002</p> PARAMETER  DESCRIPTION <code>return_df</code> <p>\u4e00\u500b\u6642\u9593\u5e8f\u5217 DataFrame\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u6b04\u4f4d\u70ba\u8cc7\u7522(\u4f8b\u5982\u56e0\u5b50\u540d\u7a31)\u3002 \u96d6\u7136\u53c3\u6578\u540d\u7a31\u70ba <code>return_df</code>\uff0c\u4f46\u6b64\u51fd\u5f0f\u8a2d\u8a08\u4e0a\u53ef\u63a5\u53d7\u4efb\u4f55\u8cc7\u7522\u7684\u6642\u9593\u5e8f\u5217\u6578\u64da\uff0c\u4f8b\u5982\u56e0\u5b50\u6ce2\u52d5\u7387\uff0c\u4f46\u5c31\u662f\u4e0d\u80fd\u89e3\u91cb\u8cc7\u7522\u96c6\u4e2d\u5ea6\u4e86\u3002</p> <p> TYPE: <code>DataFrame</code> </p> <code>window_periods</code> <p>\u6efe\u52d5\u7a97\u53e3\u7684\u9577\u5ea6\uff0c\u4ee5\u6578\u64da\u9ede\u7684\u300c\u6578\u91cf\u300d\u8a08\u3002\u4f8b\u5982\uff0c\u5982\u679c <code>return_df</code> \u662f\u6708\u8cc7\u6599\uff0c <code>window_periods=3</code> \u5c31\u4ee3\u8868\u4f7f\u7528 3 \u500b\u6708\u7684\u6efe\u52d5\u7a97\u53e3\u3002</p> <p> TYPE: <code>int</code> </p> <code>n_components</code> <p>\u7528\u65bc\u8a08\u7b97\u7684 PCA \u4e3b\u6210\u5206\u6578\u91cf\u3002</p> <p> TYPE: <code>int</code> DEFAULT: <code>1</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>pd.DataFrame: \u5305\u542b\u6efe\u52d5\u96c6\u4e2d\u5ea6\u5206\u6578\u7684 DataFrame\u3002</p> Example date FactorA FactorB 2025-01-01 0.1 0.2 2025-01-02 0.1 0.2 2025-01-03 0.1 0.2 2025-01-04 0.1 0.2 2025-01-05 0.1 0.2"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_factor_return","title":"calc_factor_return","text":"<pre><code>calc_factor_return(features, labels)\n</code></pre> <p>\u8a08\u7b97\u57fa\u65bc\u7279\u5fb5\u548c\u6a19\u7c64\u7684\u7b49\u6b0a\u91cd\u6295\u8cc7\u7d44\u5408\u9031\u671f\u8868\u73fe\u3002</p> <p>\u6b64\u51fd\u5f0f\u662f\u56e0\u5b50\u7e3e\u6548\u8a08\u7b97\u7684\u6838\u5fc3\u5f15\u64ce\uff0c\u63a5\u53d7\u9810\u5148\u6e96\u5099\u597d\u7684\u7279\u5fb5\u548c\u6a19\u7c64\uff0c \u7136\u5f8c\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7684\u6295\u8cc7\u7d44\u5408\u5831\u916c\u3002</p> <p>\u51fd\u5f0f\u6703\u81ea\u52d5\u8655\u7406\u4ee5\u4e0b\u6d41\u7a0b\uff1a 1. \u9a57\u8b49\u6240\u6709\u7279\u5fb5\u90fd\u662f\u5e03\u6797\u503c 2. \u5c0d\u6bcf\u500b\u56e0\u5b50\u8a08\u7b97\u7b49\u6b0a\u91cd\u6295\u8cc7\u7d44\u5408\u7684\u9031\u671f\u5831\u916c 3. \u81ea\u52d5\u88c1\u526a\u6389\u7b2c\u4e00\u500b\u975e\u7a7a\u884c\u4e4b\u524d\u7684\u6578\u64da</p> PARAMETER  DESCRIPTION <code>features</code> <p>\u7279\u5fb5 DataFrame\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u6b04\u4f4d\u70ba\u56e0\u5b50\u540d\u7a31\uff0c\u503c\u61c9\u70ba\u5e03\u6797\u503c\u3002</p> <p> TYPE: <code>DataFrame</code> </p> <code>labels</code> <p>\u6a19\u7c64 Series\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u503c\u70ba\u8d85\u984d\u5831\u916c\u3002</p> <p> TYPE: <code>Series</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>pd.DataFrame: \u4e00\u500b\u7d22\u5f15\u70ba\u65e5\u671f\u3001\u6b04\u4f4d\u70ba\u5404\u56e0\u5b50\u540d\u7a31\u7684 DataFrame\uff0c\u5176\u503c\u70ba\u6bcf\u500b\u9031\u671f\u7684\u7b49\u6b0a\u91cd\u6295\u7d44\u8868\u73fe\u3002          \u8f38\u51fa\u6703\u81ea\u52d5\u5f9e\u7b2c\u4e00\u500b\u975e\u7a7a\u884c\u958b\u59cb\uff0c\u78ba\u4fdd\u6578\u64da\u5b8c\u6574\u6027\u3002</p> RAISES DESCRIPTION <code>ValueError</code> <p>\u5982\u679c\u7279\u5fb5\u4e0d\u662f\u5e03\u6797\u503c\u3002</p> Example <p>from finlab import data from finlab.tools.factor_analysis import calc_factor_return, generate_features_and_labels</p> <p>price = data.get('etl:adj_close') marketcap = data.get('etl:market_value') revenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_factor_return--_1","title":"\u5148\u751f\u6210\u7279\u5fb5\u548c\u6a19\u7c64","text":"<p>features, labels = generate_features_and_labels({ ...     'marketcap': marketcap.rank(pct=True, axis=1) &lt; 0.3, ...     'revenue': (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &lt; 0.3, ...     'momentum': price / price.shift(20) - 1 &gt; 0 ... }, resample=revenue.index)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_factor_return--_2","title":"\u8a08\u7b97\u56e0\u5b50\u5831\u916c","text":"<p>factor_return = calc_factor_return(features, labels)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_factor_return--_3","title":"\u8f38\u51fa\u7bc4\u4f8b","text":"<p>print(factor_return.head()) | datetime            |   marketcap |     revenue |    momentum | |:--------------------|------------:|------------:|------------:| | 2013-04-30 00:00:00 |  0.018      | -0.005      |  0.009      | | 2013-05-31 00:00:00 |  0.004      | -0.003      | -0.001      | | 2013-06-30 00:00:00 | -0.013      | -0.006      |  0.023      | | 2013-07-31 00:00:00 |  0.007      | -0.007      |  0.001      | | 2013-08-31 00:00:00 |  0.014      | -0.003      | -0.005      |</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_ic","title":"calc_ic","text":"<pre><code>calc_ic(features, labels, rank=False)\n</code></pre> <p>\u8a08\u7b97\u7279\u5fb5\u8207\u6a19\u7c64\u4e4b\u9593\u7684\u76f8\u95dc\u4fc2\u6578\uff08IC\uff09\uff0c\u53ef\u9078\u64c7\u662f\u5426\u5c0d\u7279\u5fb5\u9032\u884c\u6392\u540d\u3002</p> PARAMETER  DESCRIPTION <code>features</code> <p>\u7279\u5fb5\u8cc7\u6599\uff0c\u7d22\u5f15\u70baMultiIndex\uff08\u65e5\u671f, \u80a1\u7968\u4ee3\u78bc\uff09\uff0c\u6b04\u4f4d\u70ba\u56e0\u5b50\u540d\u7a31\u3002</p> <p> TYPE: <code>DataFrame</code> </p> <code>labels</code> <p>\u6a19\u7c64\u8cc7\u6599\uff0c\u7d22\u5f15\u70baMultiIndex\uff08\u65e5\u671f, \u80a1\u7968\u4ee3\u78bc\uff09\u3002</p> <p> TYPE: <code>Series</code> </p> <code>rank</code> <p>\u662f\u5426\u5c0d\u7279\u5fb5\u9032\u884c\u6392\u540d\u3002\u9810\u8a2d\u70baFalse\u3002</p> <p> TYPE: <code>bool</code> DEFAULT: <code>False</code> </p> RETURNS DESCRIPTION <p>pd.DataFrame: \u6bcf\u500b\u65e5\u671f\u3001\u6bcf\u500b\u56e0\u5b50\u7684IC\u503c\u3002</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_metric","title":"calc_metric","text":"<pre><code>calc_metric(factor, adj_close, days=[10, 20, 60, 120], func=corr)\n</code></pre> <p>\u8a08\u7b97\u56e0\u5b50</p> PARAMETER  DESCRIPTION <code>factor</code> <p>\u56e0\u5b50</p> <p> TYPE: <code>DataFrame</code> </p> <code>adj_close</code> <p>\u80a1\u50f9</p> <p> TYPE: <code>DataFrame</code> </p> <code>days</code> <p>\u9810\u6e2c\u5929\u6578. Defaults to [10, 20, 60, 120].</p> <p> TYPE: <code>list</code> DEFAULT: <code>[10, 20, 60, 120]</code> </p> <code>func</code> <p>\u8a08\u7b97\u51fd\u6578. Defaults to corr.</p> <p> TYPE: <code>function</code> DEFAULT: <code>corr</code> </p> RETURNS DESCRIPTION <p>pd.DataFrame: \u56e0\u5b50\u8a08\u7b97\u7d50\u679c</p> Example <p>factor = data.indicator('RSI') adj_close = data.get('etl:adj_close') calc_metric(factor, adj_close)</p> date factor_10 factor_20 factor_60 factor_120 2010-01-01 0.1 0.2 0.3 0.4 2010-01-02 0.1 0.2 0.3 0.4 2010-01-03 0.1 0.2 0.3 0.4 2010-01-04 0.1 0.2 0.3 0.4 2010-01-05 0.1 0.2 0.3 0.4"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats","title":"calc_regression_stats","text":"<pre><code>calc_regression_stats(df, p_value_threshold=0.05, r_squared_threshold=0.1)\n</code></pre> <p>\u5c0d DataFrame \u4e2d\u7684\u6bcf\u500b\u6642\u9593\u5e8f\u5217\u9032\u884c\u7dda\u6027\u56de\u6b78\uff0c\u4e26\u56de\u50b3\u539f\u59cb\u7d71\u8a08\u6578\u64da\u3002</p> <p>\u6b64\u51fd\u5f0f\u4f7f\u7528\u7d14 pandas \u64cd\u4f5c\u9032\u884c\u5411\u91cf\u5316\u8a08\u7b97\uff0c\u4e0d\u4f9d\u8cf4 scipy\u3002</p> PARAMETER  DESCRIPTION <code>df</code> <p>\u6642\u9593\u5e8f\u5217 DataFrame\uff0c\u7d22\u5f15\u70ba DatetimeIndex\uff0c\u6b04\u4f4d\u70ba\u4e0d\u540c\u7684\u6307\u6a19\u5e8f\u5217\u3002</p> <p> TYPE: <code>DataFrame</code> </p> <code>p_value_threshold</code> <p>p \u503c\u95be\u503c\uff0c\u7528\u65bc\u5224\u65b7\u8da8\u52e2\u7684\u7d71\u8a08\u986f\u8457\u6027\u3002\u9810\u8a2d\u70ba 0.05\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>0.05</code> </p> <code>r_squared_threshold</code> <p>R\u00b2 \u95be\u503c\uff0c\u7528\u65bc\u5224\u65b7\u8da8\u52e2\u7684\u89e3\u91cb\u529b\u3002\u9810\u8a2d\u70ba 0.1\u3002</p> <p> TYPE: <code>float</code> DEFAULT: <code>0.1</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>pd.DataFrame: \u7dda\u6027\u56de\u6b78\u7684\u7d71\u8a08\u7d50\u679c\uff0c\u5305\u542b\u4ee5\u4e0b\u6b04\u4f4d\uff1a - slope: \u7dda\u6027\u56de\u6b78\u659c\u7387 - p_value: \u659c\u7387\u7684 p \u503c - r_squared: \u6c7a\u5b9a\u4fc2\u6578 (R\u00b2) - tail_estimate: \u6642\u9593\u5e8f\u5217\u5c3e\u90e8\u7684\u4f30\u8a08\u503c - trend: \u8da8\u52e2\u5206\u985e (\"up\", \"down\", \"flat\")</p> Example"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--ic_df-ic-dataframe","title":"\u5047\u8a2d ic_df \u662f\u4e00\u500b\u5305\u542b IC \u6642\u9593\u5e8f\u5217\u7684 DataFrame","text":""},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--ic_df-calc_icfeatures-labels","title":"ic_df = calc_ic(features, labels)","text":""},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--1","title":"1. \u8a08\u7b97\u56de\u6b78\u7d71\u8a08\u6578\u64da","text":"<p>trend_stats = calc_regression_stats(ic_df) print(trend_stats)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--2","title":"2. \u57fa\u65bc\u56de\u50b3\u7d50\u679c\u9032\u884c\u5ba2\u88fd\u5316\u5206\u6790","text":""},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--p-value-005-slope-0","title":"\u7bc4\u4f8b\uff1a\u627e\u51fa\u7d71\u8a08\u986f\u8457 (p-value &lt; 0.05) \u4e14\u8da8\u52e2\u5411\u4e0a (slope &gt; 0) \u7684\u56e0\u5b50","text":"<p>significant_up_trend = trend_stats[ ...     (trend_stats['p_value'] &lt; 0.05) &amp; (trend_stats['slope'] &gt; 0) ... ] print(significant_up_trend)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_regression_stats--3","title":"3. \u67e5\u770b\u8da8\u52e2\u5206\u985e\u7d50\u679c","text":"<p>up_trends = trend_stats[trend_stats['trend'] == 'up'] down_trends = trend_stats[trend_stats['trend'] == 'down'] flat_trends = trend_stats[trend_stats['trend'] == 'flat']</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_shapley_values","title":"calc_shapley_values","text":"<pre><code>calc_shapley_values(features, labels)\n</code></pre> <p>\u8a08\u7b97\u56e0\u5b50\u7684 Shapley \u503c\uff0c\u7528\u65bc\u8a55\u4f30\u6bcf\u500b\u56e0\u5b50\u5c0d\u6295\u8cc7\u7d44\u5408\u8868\u73fe\u7684\u908a\u969b\u8ca2\u737b\u3002</p> <p>Shapley \u503c\u662f\u4e00\u7a2e\u5408\u4f5c\u535a\u5f08\u8ad6\u4e2d\u7684\u6982\u5ff5\uff0c\u7528\u65bc\u516c\u5e73\u5206\u914d\u806f\u76df\u7684\u7e3d\u6536\u76ca\u7d66\u5404\u500b\u53c3\u8207\u8005\u3002 \u5728\u56e0\u5b50\u5206\u6790\u4e2d\uff0c\u6211\u5011\u5c07\u6bcf\u500b\u56e0\u5b50\u8996\u70ba\u4e00\u500b\"\u53c3\u8207\u8005\"\uff0c\u6295\u8cc7\u7d44\u5408\u7684\u5831\u916c\u8996\u70ba\"\u806f\u76df\u7684\u7e3d\u6536\u76ca\"\u3002</p> <p>\u8a08\u7b97\u904e\u7a0b\uff1a 1. \u5c0d\u6240\u6709\u53ef\u80fd\u7684\u56e0\u5b50\u7d44\u5408\uff08\u5f9e\u55ae\u4e00\u56e0\u5b50\u5230\u5168\u90e8\u56e0\u5b50\uff09 2. \u8a08\u7b97\u6bcf\u500b\u7d44\u5408\u7684\u6295\u8cc7\u7d44\u5408\u5831\u916c 3. \u6839\u64da Shapley \u503c\u516c\u5f0f\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7684\u908a\u969b\u8ca2\u737b</p> PARAMETER  DESCRIPTION <code>features</code> <p>\u7279\u5fb5 DataFrame\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u6b04\u4f4d\u70ba\u56e0\u5b50\u540d\u7a31\uff0c\u503c\u61c9\u70ba\u5e03\u6797\u503c\u3002 \u6bcf\u500b\u56e0\u5b50\u4ee3\u8868\u4e00\u500b\u6295\u8cc7\u7b56\u7565\uff08True \u8868\u793a\u9078\u4e2d\u8a72\u80a1\u7968\uff09\u3002</p> <p> TYPE: <code>DataFrame</code> </p> <code>labels</code> <p>\u6a19\u7c64 Series\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u503c\u70ba\u8d85\u984d\u5831\u916c\u3002 \u61c9\u70ba MultiIndex\uff0c\u5305\u542b 'datetime' \u548c 'stock_id' \u5c64\u7d1a\u3002</p> <p> TYPE: <code>Series</code> </p> RETURNS DESCRIPTION <code>DataFrame</code> <p>pd.DataFrame:  \u5305\u542b\u6bcf\u500b\u56e0\u5b50 Shapley \u503c\u7684 DataFrame\u3002 \u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u6b04\u4f4d\u70ba\u56e0\u5b50\u540d\u7a31\uff0c\u503c\u70ba\u8a72\u56e0\u5b50\u7684 Shapley \u503c\u3002</p> RAISES DESCRIPTION <code>ValueError</code> <ul> <li>\u5982\u679c features \u70ba\u7a7a\u6216\u6c92\u6709\u6b04\u4f4d</li> <li>\u5982\u679c labels \u7684\u7d22\u5f15\u4e0d\u662f MultiIndex</li> <li>\u5982\u679c features \u4e0d\u662f\u5e03\u6797\u503c</li> <li>\u5982\u679c features \u548c labels \u7684\u6642\u9593\u7d22\u5f15\u4e0d\u5339\u914d</li> </ul> Example <p>from finlab import data from finlab.tools.factor_analysis import calc_shapley_values, generate_features_and_labels</p> <p>price = data.get('etl:adj_close') marketcap = data.get('etl:market_value') revenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')</p> Note <ul> <li>Shapley \u503c\u7684\u8a08\u7b97\u8907\u96dc\u5ea6\u70ba O(2^n)\uff0c\u5176\u4e2d n \u70ba\u56e0\u5b50\u6578\u91cf</li> <li>\u5c0d\u65bc\u5927\u91cf\u56e0\u5b50\uff0c\u8a08\u7b97\u6642\u9593\u53ef\u80fd\u8f03\u9577</li> <li>\u5efa\u8b70\u56e0\u5b50\u6578\u91cf\u4e0d\u8d85\u904e 10 \u500b\u4ee5\u78ba\u4fdd\u5408\u7406\u7684\u8a08\u7b97\u6642\u9593</li> </ul>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_shapley_values--_1","title":"\u751f\u6210\u7279\u5fb5\u548c\u6a19\u7c64","text":"<p>features, labels = generate_features_and_labels({ ...     'marketcap': marketcap.rank(pct=True, axis=1) &lt; 0.3, ...     'revenue': (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &lt; 0.3, ...     'momentum': price / price.shift(20) - 1 &gt; 0 ... }, resample=revenue.index)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.calc_shapley_values--shapley","title":"\u8a08\u7b97 Shapley \u503c","text":"<p>shapley_df = calc_shapley_values(features, labels)</p> <p>print(shapley_df.head()) | datetime            |   marketcap |     revenue |    momentum | |:--------------------|------------:|------------:|------------:| | 2013-04-30 00:00:00 |  0.012      | -0.003      |  0.006      | | 2013-05-31 00:00:00 |  0.002      | -0.001      | -0.001      | | 2013-06-30 00:00:00 | -0.008      | -0.004      |  0.015      | | 2013-07-31 00:00:00 |  0.004      | -0.004      |  0.001      | | 2013-08-31 00:00:00 |  0.009      | -0.002      | -0.003      |</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.generate_features_and_labels","title":"generate_features_and_labels","text":"<pre><code>generate_features_and_labels(dfs, resample)\n</code></pre> <p>\u751f\u6210\u56e0\u5b50\u7279\u5fb5\u548c\u6a19\u7c64\uff0c\u9019\u662f\u56e0\u5b50\u5206\u6790\u7684\u6838\u5fc3\u6b65\u9a5f\u3002</p> <p>\u6b64\u51fd\u5f0f\u5c01\u88dd\u4e86\u56e0\u5b50\u5206\u6790\u4e2d\u7279\u5fb5\u548c\u6a19\u7c64\u751f\u6210\u7684\u6a19\u6e96\u6d41\u7a0b\uff1a 1. \u4f7f\u7528 <code>finlab.ml.feature.combine</code> \u5c07\u56e0\u5b50\u5b57\u5178\u8f49\u63db\u70ba\u7279\u5fb5 DataFrame 2. \u4f7f\u7528 <code>finlab.ml.label.excess_over_mean</code> \u751f\u6210\u8d85\u984d\u5831\u916c\u6a19\u7c64</p> PARAMETER  DESCRIPTION <code>dfs</code> <p>\u56e0\u5b50\u5b57\u5178\uff0c\u5305\u542b\u56e0\u5b50\u540d\u7a31\u548c\u5c0d\u61c9\u7684\u56e0\u5b50\u6578\u64da\u6216\u8a08\u7b97\u51fd\u5f0f\u3002</p> <ul> <li>Key (str): \u56e0\u5b50\u540d\u7a31\uff0c\u5c07\u6210\u70ba\u8f38\u51fa DataFrame \u7684\u6b04\u4f4d\u540d</li> <li>Value (Union[pd.DataFrame, Callable]): \u56e0\u5b50\u6578\u64da\u6216\u8a08\u7b97\u51fd\u5f0f<ul> <li>pd.DataFrame: \u76f4\u63a5\u63d0\u4f9b\u7684\u56e0\u5b50\u6578\u64da</li> <li>Callable: \u8a08\u7b97\u56e0\u5b50\u7684\u51fd\u5f0f\uff0c\u5c07\u88ab\u8abf\u7528\u4ee5\u7372\u53d6\u56e0\u5b50\u6578\u64da</li> </ul> </li> </ul> <p>\u6b64\u70ba <code>finlab.ml.feature.combine</code> \u7684\u6a19\u6e96\u8f38\u5165\u683c\u5f0f\u3002</p> <p> TYPE: <code>Dict[str, Union[DataFrame, Callable]]</code> </p> <code>resample</code> <p>\u91cd\u63a1\u6a23\u983b\u7387\uff0c\u7528\u65bc\u7279\u5fb5\u548c\u6a19\u7c64\u7684\u751f\u6210\u3002</p> <p>\u4f8b\u5982: 'M' (\u6708\u5ea6), 'Q' (\u5b63\u5ea6), 'Y' (\u5e74\u5ea6)</p> <p> TYPE: <code>str</code> </p> RETURNS DESCRIPTION <code>tuple[DataFrame, Series]</code> <p>tuple[pd.DataFrame, pd.Series]:  - pd.DataFrame: \u7279\u5fb5 DataFrame\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u6b04\u4f4d\u70ba\u56e0\u5b50\u540d\u7a31 - pd.Series: \u6a19\u7c64 Series\uff0c\u7d22\u5f15\u70ba\u65e5\u671f\uff0c\u503c\u70ba\u8d85\u984d\u5831\u916c</p> RAISES DESCRIPTION <code>ValueError</code> <p>\u5982\u679c\u8f38\u5165\u7684\u56e0\u5b50\u5b57\u5178\u70ba\u7a7a\u6216\u7121\u6548\u3002</p> Example <p>from finlab import data from finlab.tools.factor_analysis import generate_features_and_labels</p> <p>price = data.get('etl:adj_close') marketcap = data.get('etl:market_value') revenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')</p> <p>features, labels = generate_features_and_labels({ ...     'marketcap': marketcap.rank(pct=True, axis=1) &lt; 0.3, ...     'revenue': (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &lt; 0.3, ...     'momentum': price / price.shift(20) - 1 &gt; 0 ... }, resample=revenue.index)</p> <p>print(f\"Features shape: {features.shape}\") print(f\"Labels shape: {labels.shape}\") Features shape: (120, 3) Labels shape: (120,)</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.ic","title":"ic","text":"<pre><code>ic(factor, adj_close, days=[10, 20, 60, 120])\n</code></pre> <p>\u8a08\u7b97\u56e0\u5b50\u7684IC</p> PARAMETER  DESCRIPTION <code>factor</code> <p>\u56e0\u5b50</p> <p> TYPE: <code>DataFrame</code> </p> <code>adj_close</code> <p>\u80a1\u50f9</p> <p> TYPE: <code>DataFrame</code> </p> <code>days</code> <p>\u9810\u6e2c\u5929\u6578. Defaults to [10, 20, 60, 120].</p> <p> TYPE: <code>list</code> DEFAULT: <code>[10, 20, 60, 120]</code> </p> RETURNS DESCRIPTION <p>pd.DataFrame: \u56e0\u5b50\u8a08\u7b97\u7d50\u679c</p> Example <p>factor = data.indicator('RSI') adj_close = data.get('etl:adj_close') calc_metric(factor, adj_close)</p> date factor_10 factor_20 factor_60 factor_120 2010-01-01 0.1 0.2 0.3 0.4 2010-01-02 0.1 0.2 0.3 0.4 2010-01-03 0.1 0.2 0.3 0.4 2010-01-04 0.1 0.2 0.3 0.4 2010-01-05 0.1 0.2 0.3 0.4"},{"location":"reference/tools/#finlab.tools.factor_analysis.is_boolean_series","title":"is_boolean_series","text":"<pre><code>is_boolean_series(series)\n</code></pre> <p>Check if a pandas Series contains boolean values, handling NaN values.</p> <p>In older pandas versions, boolean Series with NaN values get converted to float dtype. This function detects such cases by checking if the non-NaN values are boolean.</p> PARAMETER  DESCRIPTION <code>series</code> <p>The Series to check</p> <p> TYPE: <code>Series</code> </p> RETURNS DESCRIPTION <code>bool</code> <p>True if the Series contains boolean values (including NaN), False otherwise</p> <p> TYPE: <code>bool</code> </p> Example <p>import pandas as pd import numpy as np</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.is_boolean_series--pure-boolean","title":"Pure boolean","text":"<p>s1 = pd.Series([True, False, True]) is_boolean_series(s1)  # True</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.is_boolean_series--boolean-with-nan-becomes-float-in-old-pandas","title":"Boolean with NaN (becomes float in old pandas)","text":"<p>s2 = pd.Series([True, False, np.nan]) is_boolean_series(s2)  # True</p>"},{"location":"reference/tools/#finlab.tools.factor_analysis.is_boolean_series--non-boolean","title":"Non-boolean","text":"<p>s3 = pd.Series([1, 2, 3]) is_boolean_series(s3)  # False</p>"},{"location":"tools/2330_bband_rebound/","title":"\u53f0\u7a4d\u96fb\u9006\u52e2\u6284\u5e95","text":"<p>\u6284\u5e95\u5c31\u662f\u6240\u8b02\u7684\u9006\u52e2\u7b56\u7565\uff0c\u80fd\u4e0d\u80fd\u7528\u91cf\u5316\u7684\u65b9\u5f0f\u5be6\u6e2c\u5462\uff1f</p> <p>\u5e03\u6797\u901a\u9053\u662f\u6700\u5ee3\u70ba\u4eba\u77e5\u7684\u9006\u52e2\u65b9\u6cd5\uff0c\u539f\u7406\u662f\u904b\u7528\u5747\u7dda\u548c\u6a19\u6e96\u5dee\uff0c\u5927\u90e8\u5206 K \u7dda\u90fd\u6db5\u84cb\u5728 d\u65e5 MA \u4e0a\u4e0b n \u500b\u6a19\u6e96\u5dee\u7684\u7bc4\u570d\u4e4b\u5167\u64cd\u4f5c\u3002</p> <p>d\u6578\u503c\u8d8a\u5927\uff0c\u50f9\u683c\u66f2\u7dda\u8d8a\u5e73\u6ed1\uff0c\u80fd\u6e1b\u5c11\u6ce2\u52d5\u96dc\u8a0a\u3002</p> <p>n\u6578\u503c\u8d8a\u5927\uff0c\u80fd\u7522\u751f\u8d8a\u6975\u7aef\u7684\u8a0a\u865f\uff0c\u4e00\u822cn\u503c\u7bc4\u570d\u4f9d\u64da68\u201395\u201399.7\u6cd5\u5247\uff0868\u201395\u201399.7 rule\uff09\uff0c\u8a2d\u5b9a\u57281-3\uff0c\u5728\u5e38\u614b\u5206\u5e03\u4e2d\uff0c\u8ddd\u5e73\u5747\u503c\u5c0f\u65bc\u4e00\u500b\u6a19\u6e96\u5dee\u3001\u4e8c\u500b\u6a19\u6e96\u5dee\u3001\u4e09\u500b\u6a19\u6e96\u5dee\u4ee5\u5167\u7684\u767e\u5206\u6bd4\u3002\u7576\u80a1\u50f9\u8dcc\u7834\u4e0b\u8ecc\u901a\u9053\uff0c\u53ef\u80fd\u51fa\u73fe\u8d85\u8ce3\u8a0a\u865f\uff0c\u6703\u5728\u4e4b\u5f8c\u5747\u503c\u56de\u6b78\uff0c\u7522\u751f\u53cd\u5f48\u5230\u4e2d\u8ecc\u901a\u9053\u9644\u8fd1\u3002</p> <p>\u8a73\u7d30\u7b56\u7565\u6587\u7ae0</p> In\u00a0[1]: Copied! <pre>!pip install finlab\n!pip install ta-lib-bin\n</pre> !pip install finlab !pip install ta-lib-bin In\u00a0[2]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose=data.get('price:\u6536\u76e4\u50f9')\nupperband, middleband, lowerband = data.indicator('BBANDS', resample='D', nbdevup=float(2.5), nbdevdn=float(2.5),timeperiod=40)\nentries = lowerband &gt; close\nexits = close &gt; middleband\n\n# \u8a2d\u5b9a\u8ce3\u51fa\u689d\u4ef6\nposition = entries.hold_until(exits)['2330']\nreport = sim(position,upload=False,mae_mfe_window=40, name='\u8b77\u570b\u795e\u5c71\u6551\u96e3\u968a')\n</pre> from finlab import data from finlab.backtest import sim  close=data.get('price:\u6536\u76e4\u50f9') upperband, middleband, lowerband = data.indicator('BBANDS', resample='D', nbdevup=float(2.5), nbdevdn=float(2.5),timeperiod=40) entries = lowerband &gt; close exits = close &gt; middleband  # \u8a2d\u5b9a\u8ce3\u51fa\u689d\u4ef6 position = entries.hold_until(exits)['2330'] report = sim(position,upload=False,mae_mfe_window=40, name='\u8b77\u570b\u795e\u5c71\u6551\u96e3\u968a')  <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 113.8 / 5000 MB\nWARNING:finlab.data:price:\u958b\u76e4\u50f9 -- Daily data usage: 135.3 / 5000 MB\nWARNING:finlab.data:price:\u6700\u9ad8\u50f9 -- Daily data usage: 156.9 / 5000 MB\nWARNING:finlab.data:price:\u6700\u4f4e\u50f9 -- Daily data usage: 178.3 / 5000 MB\nWARNING:finlab.data:price:\u6210\u4ea4\u80a1\u6578 -- Daily data usage: 208.3 / 5000 MB\nWARNING:finlab.data:etl:adj_close -- Daily data usage: 236.8 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily data usage: 236.9 / 5000 MB\n</pre> In\u00a0[3]: Copied! <pre>report.display_mae_mfe_analysis(violinmode='overlay').show()\n</pre> report.display_mae_mfe_analysis(violinmode='overlay').show() In\u00a0[5]: Copied! <pre># \u53d6\u5f97\u5831\u916c\u7387\u5716\u8868\nreport.display()\n</pre> # \u53d6\u5f97\u5831\u916c\u7387\u5716\u8868 report.display() <pre>2330    1.0\nName: 2022-09-30 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-09-30 00:00:00')</pre> In\u00a0[4]: Copied! <pre>trade_record = report.trades\ntrade_record\n</pre> trade_record = report.trades trade_record Out[4]: stock_id entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays trade_index 0 2330 \u53f0\u7a4d\u96fb 2007-08-02 2007-09-28 2007-08-01 2007-09-27 1.0 38 71 109 -0.003135 63.8 63.6 -0.075235 0.001567 0.001567 -0.076682 1.0 1 2330 \u53f0\u7a4d\u96fb 2007-11-22 2007-12-07 2007-11-21 2007-12-06 1.0 11 148 159 0.045075 59.9 62.6 -0.023372 0.045075 0.020033 -0.042553 7.0 2 2330 \u53f0\u7a4d\u96fb 2008-01-08 2008-02-01 2008-01-07 2008-01-31 1.0 18 180 198 0.096429 56.0 61.4 -0.114286 0.096429 0.026786 -0.137391 6.0 3 2330 \u53f0\u7a4d\u96fb 2008-07-04 2008-08-11 2008-07-03 2008-08-08 1.0 25 299 324 0.103769 59.0 60.6 -0.023729 0.103769 0.057627 -0.080268 22.0 4 2330 \u53f0\u7a4d\u96fb 2008-10-28 2008-12-11 2008-10-27 2008-12-10 1.0 32 378 410 0.130982 39.7 44.9 -0.073048 0.209068 0.209068 -0.233333 22.0 5 2330 \u53f0\u7a4d\u96fb 2010-02-06 2010-03-09 2010-02-05 2010-03-08 1.0 15 701 716 0.056897 58.0 61.3 -0.010345 0.056897 0.000000 -0.026756 14.0 6 2330 \u53f0\u7a4d\u96fb 2011-06-28 2011-07-27 2011-06-27 2011-07-26 1.0 21 1042 1063 0.056115 72.5 73.4 -0.014388 0.060432 0.057554 -0.068027 20.0 7 2330 \u53f0\u7a4d\u96fb 2011-08-08 2011-08-30 2011-08-05 2011-08-29 1.0 16 1071 1087 0.058282 65.2 69.0 -0.029141 0.064417 0.000000 -0.043413 11.0 8 2330 \u53f0\u7a4d\u96fb 2012-05-24 2012-06-01 2012-05-23 2012-05-31 1.0 6 1268 1274 -0.008685 80.6 79.9 -0.008685 0.055831 0.055831 -0.061105 4.0 9 2330 \u53f0\u7a4d\u96fb 2012-06-05 2012-07-02 2012-06-04 2012-06-29 1.0 19 1276 1295 0.065217 78.2 83.3 -0.005115 0.065217 0.000000 -0.035539 16.0 10 2330 \u53f0\u7a4d\u96fb 2013-07-22 2013-09-03 2013-07-19 2013-09-02 1.0 30 1556 1586 0.051546 97.0 102.0 -0.026804 0.056701 0.056701 -0.079024 16.0 11 2330 \u53f0\u7a4d\u96fb 2015-06-09 2015-06-26 2015-06-08 2015-06-25 1.0 12 2019 2031 0.050360 139.0 146.0 0.000000 0.053957 0.000000 -0.017301 12.0 12 2330 \u53f0\u7a4d\u96fb 2015-08-11 2015-09-17 2015-08-10 2015-09-16 1.0 27 2062 2089 0.003831 130.5 131.0 -0.118774 0.003831 0.000000 -0.118774 1.0 13 2330 \u53f0\u7a4d\u96fb 2016-01-08 2016-01-26 2016-01-07 2016-01-25 1.0 12 2166 2178 0.026119 134.0 137.5 -0.018657 0.041045 0.000000 -0.025362 8.0 14 2330 \u53f0\u7a4d\u96fb 2016-05-04 2016-05-24 2016-05-03 2016-05-23 1.0 14 2239 2253 0.027211 147.0 151.0 -0.020408 0.047619 0.006803 -0.027027 9.0 15 2330 \u53f0\u7a4d\u96fb 2017-12-07 2018-01-04 2017-12-06 2018-01-03 1.0 19 2635 2654 0.057395 226.5 239.5 -0.008830 0.057395 0.017660 -0.026030 13.0 16 2330 \u53f0\u7a4d\u96fb 2018-04-23 2018-06-07 2018-04-20 2018-06-06 1.0 32 2722 2754 0.015453 226.5 230.0 -0.026490 0.028698 0.002208 -0.051502 19.0 17 2330 \u53f0\u7a4d\u96fb 2018-06-26 2018-07-16 2018-06-25 2018-07-13 1.0 14 2766 2780 0.041958 214.5 223.5 -0.011655 0.046620 0.000000 -0.011655 10.0 18 2330 \u53f0\u7a4d\u96fb 2018-10-12 2018-12-04 2018-10-11 2018-12-03 1.0 37 2842 2879 -0.012658 237.0 234.0 -0.080169 0.006329 0.006329 -0.085954 2.0 19 2330 \u53f0\u7a4d\u96fb 2019-01-07 2019-01-23 2019-01-04 2019-01-22 1.0 12 2902 2914 0.035211 213.0 220.5 -0.009390 0.046948 0.000000 -0.015837 11.0 20 2330 \u53f0\u7a4d\u96fb 2020-03-13 2020-04-20 2020-03-12 2020-04-17 1.0 24 3184 3208 0.058453 290.0 304.0 -0.136525 0.067158 0.000000 -0.136525 3.0 21 2330 \u53f0\u7a4d\u96fb 2021-05-13 2021-06-01 2021-05-12 2021-05-31 1.0 13 3468 3481 0.093236 547.0 598.0 0.000000 0.093236 0.000000 -0.014363 13.0 22 2330 \u53f0\u7a4d\u96fb 2021-08-20 2021-08-27 2021-08-19 2021-08-26 1.0 5 3538 3543 0.085145 552.0 599.0 0.000000 0.085145 0.000000 0.000000 5.0 23 2330 \u53f0\u7a4d\u96fb 2022-03-08 2022-05-31 2022-03-07 2022-05-30 1.0 57 3668 3725 0.000048 563.0 560.0 -0.098171 0.071480 0.071480 -0.158333 27.0 24 2330 \u53f0\u7a4d\u96fb 2022-07-04 2022-07-22 2022-07-01 2022-07-21 1.0 14 3748 3762 0.143182 440.0 503.0 -0.010227 0.143182 0.013636 -0.037473 13.0 25 2330 \u53f0\u7a4d\u96fb 2022-10-03 NaT 2022-09-30 NaT 1.0 14 3812 -1 -0.065947 417.0 NaN -0.065947 0.081535 0.081535 -0.136364 4.0 In\u00a0[6]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose=data.get('price:\u6536\u76e4\u50f9')\nupperband, middleband, lowerband = data.indicator('BBANDS', resample='D', nbdevup=float(2.5), nbdevdn=float(2.5), timeperiod=40)\nentries = lowerband &gt; close\nexits = close &gt; middleband\n\nposition = entries.hold_until(exits, take_profit=0.1, stop_loss=-0.15)['2330']\nreport = sim(position, upload=False, mae_mfe_window=40, name='\u8b77\u570b\u795e\u5c71\u6551\u96e3\u968a')\nreport.display_mae_mfe_analysis(violinmode='overlay').show()\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  close=data.get('price:\u6536\u76e4\u50f9') upperband, middleband, lowerband = data.indicator('BBANDS', resample='D', nbdevup=float(2.5), nbdevdn=float(2.5), timeperiod=40) entries = lowerband &gt; close exits = close &gt; middleband  position = entries.hold_until(exits, take_profit=0.1, stop_loss=-0.15)['2330'] report = sim(position, upload=False, mae_mfe_window=40, name='\u8b77\u570b\u795e\u5c71\u6551\u96e3\u968a') report.display_mae_mfe_analysis(violinmode='overlay').show() report.display() <pre>2330    1.0\nName: 2022-09-30 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-09-30 00:00:00')</pre> In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/2330_bband_rebound/","title":"\u5e03\u6797\u901a\u9053\u7b56\u7565\u00b6","text":""},{"location":"tools/2330_bband_rebound/","title":"\u53d6\u5f97\u6ce2\u52d5\u5206\u6790\u5831\u544a\u00b6","text":""},{"location":"tools/2330_bband_rebound/","title":"\u53d6\u5f97\u5831\u916c\u7387\u5716\u8868\u00b6","text":""},{"location":"tools/2330_bband_rebound/","title":"\u53d6\u5f97\u4ea4\u6613\u7d00\u9304\u00b6","text":""},{"location":"tools/2330_bband_rebound/","title":"\u52a0\u5165\u505c\u640d\u505c\u5229\u00b6","text":"<p>\u6436\u53cd\u5f48\u5982\u6436\u9280\u884c\uff0c\u4e0d\u7ba1\u6709\u6c92\u6709\u6436\u5230\u90fd\u8981\u8dd1\uff01</p> <p>\u6975\u7aef\u7684\u66b4\u8dcc\u884c\u60c5\u4e0b\u6436\u53cd\u5f48\uff0c87%\u52dd\u7387\u3001\u5e73\u5747\u6301\u670919\u500b\u4ea4\u6613\u65e5\uff0c\u5e73\u5747\u7372\u52295%\u3002</p> <p>\u6301\u6709\u524d10\u65e5\u5167\u82e5\u591a\u6578\u6642\u9593\u4fdd\u6301\u7372\u5229\u72c0\u614b\uff0c\u5247\u986f\u793a\u6284\u5728\u5e95\u90e8\u7684\u6a5f\u7387\u9ad8\uff0c\u53cd\u4e4b\u82e5\u591a\u6578\u6642\u9593\u70ba\u8667\u640d\uff0c\u5247\u53ef\u80fd\u6284\u932f\u5e95\uff0c\u518d\u7834\u5e95\u98a8\u96aa\u8b8a\u9ad8\uff0c\u82e5\u8dcc\u5e45\u8d85\u904e15%\u5247\u70ba\u767c\u751f\u6a23\u672c\u5916\u7684\u7279\u6b8a\u5d29\u76e4\u60c5\u6cc1\uff0c\u61c9\u505c\u640d\u51fa\u5834\u3002</p> <p>\u5e73\u5747\u4e00\u5e74\u4e0d\u52303\u6b21\uff0c\u8981\u628a\u63e1\u6a5f\u6703\uff1f</p> <p>\u6f32\u5e45\u8d85\u904e10%\u7522\u751f\u505c\u5229\u8a0a\u865f\uff0c\u8dcc\u5e45\u8d85\u904e15%\u7522\u751f\u505c\u640d\u8a0a\u865f\u3002</p>"},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/","title":"Pandas \u7b56\u7565\u958b\u767c\u57fa\u790e\u8a9e\u6cd5","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>import pandas as pd\nimport numpy as np\nfrom finlab import data\n</pre> import pandas as pd import numpy as np from finlab import data In\u00a0[\u00a0]: Copied! <pre># dataframe:\u8cc7\u6599\u683c\u5f0f\u7bc4\u4f8b\ndf=data.get('price:\u6536\u76e4\u50f9')\ndf=df[df.index&lt;='2020-07-01']\n\n# series:\u8cc7\u6599\u683c\u5f0f\u7bc4\u4f8b\nseries=df['0050']\ndf\n</pre> # dataframe:\u8cc7\u6599\u683c\u5f0f\u7bc4\u4f8b df=data.get('price:\u6536\u76e4\u50f9') df=df[df.index&lt;='2020-07-01']  # series:\u8cc7\u6599\u683c\u5f0f\u7bc4\u4f8b series=df['0050'] df In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\n\n# head(n):\u53d6\u524dn\u5217\uff0c\u9810\u8a2d\u70ba5\ndemo_head=df.head(3)\n\n# tail(n):\u53d6\u5f8cn\u5217\uff0c\u9810\u8a2d\u70ba5\ndemo_tail=df.tail(3)\n\n# index:\u53d6\u7d22\u5f15\ndemo_index=df.index\n\n# columns:\u53d6\u6b04\u4f4d\ndemo_columns=df.columns\n\n# values:\u53d6\u503c\ndemo_values=df.values\n\n# boolean indexing:\u7d22\u5f15\u5e03\u6797\u908f\u8f2f\u7be9\u9078\uff0cex:\u53d6\u5f97\u7d22\u5f15\u5927\u65bc2020\u5e74\u4efd\u7684\u8cc7\u6599\ndemo_boolean_indexing=df[df.index&gt;'2020']\n\n# loc:\u4f7f\u7528\u6a19\u7c64\u7be9\u9078\u6b04\u5217\n## ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d\u6240\u6709\u6a19\u5730\u7684\u80a1\u50f9\ndemo_loc1=df.loc['2020-01-03':'2020-01-08']\n\n## ex:\u9078\u64c70050&amp;1101&amp;2330\u7684\u80a1\u50f9\uff0c\u4ee5\u4e0b\u5169\u7a2e\u65b9\u6cd5\u7b49\u50f9\ndemo_loc2=df.loc[:,['0050','1101','2330']]\ndemo_column_select=df[['0050','1101','2330']]\n\n## ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d0050&amp;1101&amp;2330\u7684\u80a1\u50f9\ndemo_loc3=df.loc['2020-01-03':'2020-01-08',['0050','1101','2330']]\n\n# iloc:\u4f7f\u7528\u6a19\u7c64\u4f4d\u7f6e\u7be9\u9078\u6b04\u5217\n## ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599\ndemo_iloc1=df.iloc[5:10]\n\n## ex:\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599\ndemo_iloc2=df.iloc[:,5:10]\n\n## ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599&amp;\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599\ndemo_iloc3=df.iloc[5:10,5:10]\n\n# nlargest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u5927\u7684\u6a19\u5730\ndemo_nlargest=df.iloc[-1].nlargest(10)\n\n# nsmallest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u5c0f\u7684\u6a19\u5730\ndemo_nsmallest=df.iloc[-1].nsmallest(10)\n</pre> df=data.get('price:\u6536\u76e4\u50f9')  # head(n):\u53d6\u524dn\u5217\uff0c\u9810\u8a2d\u70ba5 demo_head=df.head(3)  # tail(n):\u53d6\u5f8cn\u5217\uff0c\u9810\u8a2d\u70ba5 demo_tail=df.tail(3)  # index:\u53d6\u7d22\u5f15 demo_index=df.index  # columns:\u53d6\u6b04\u4f4d demo_columns=df.columns  # values:\u53d6\u503c demo_values=df.values  # boolean indexing:\u7d22\u5f15\u5e03\u6797\u908f\u8f2f\u7be9\u9078\uff0cex:\u53d6\u5f97\u7d22\u5f15\u5927\u65bc2020\u5e74\u4efd\u7684\u8cc7\u6599 demo_boolean_indexing=df[df.index&gt;'2020']  # loc:\u4f7f\u7528\u6a19\u7c64\u7be9\u9078\u6b04\u5217 ## ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d\u6240\u6709\u6a19\u5730\u7684\u80a1\u50f9 demo_loc1=df.loc['2020-01-03':'2020-01-08']  ## ex:\u9078\u64c70050&amp;1101&amp;2330\u7684\u80a1\u50f9\uff0c\u4ee5\u4e0b\u5169\u7a2e\u65b9\u6cd5\u7b49\u50f9 demo_loc2=df.loc[:,['0050','1101','2330']] demo_column_select=df[['0050','1101','2330']]  ## ex:\u9078\u64c72020-01-03~2020-01-08\u4e2d0050&amp;1101&amp;2330\u7684\u80a1\u50f9 demo_loc3=df.loc['2020-01-03':'2020-01-08',['0050','1101','2330']]  # iloc:\u4f7f\u7528\u6a19\u7c64\u4f4d\u7f6e\u7be9\u9078\u6b04\u5217 ## ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599 demo_iloc1=df.iloc[5:10]  ## ex:\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599 demo_iloc2=df.iloc[:,5:10]  ## ex:\u9078\u64c7\u7b2c6\u5217\u5230\u7b2c10\u5217\u7684\u8cc7\u6599&amp;\u9078\u64c7df\u8868\u4e2d\u7b2c6\u6a94\u5230\u7b2c10\u6a94\u6a19\u5730\u8cc7\u6599 demo_iloc3=df.iloc[5:10,5:10]  # nlargest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u5927\u7684\u6a19\u5730 demo_nlargest=df.iloc[-1].nlargest(10)  # nsmallest:\u53d6\u524dn\u5927\uff0cex:\u53d6\u8fd1\u4e00\u65e5\u80a1\u50f9\u524dn\u5c0f\u7684\u6a19\u5730 demo_nsmallest=df.iloc[-1].nsmallest(10)  In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\n\n# \u5217\u6578\u5168\u5c55\u958b\npd.set_option(\"display.max_rows\", None)\n\n# \u6b04\u6578\u5168\u5c55\u958b\npd.set_option(\"display.max_columns\", None)\n\n# \u6700\u591a\u986f\u793a20\u5217\npd.set_option(\"display.max_rows\", 20)\n\n# \u6700\u591a\u986f\u793a20\u6b04\npd.set_option(\"display.max_columns\", 20)\n\n# # \u9084\u539f\u986f\u793a\u6578\u9810\u8a2d\u521d\u59cb\u503c\npd.reset_option(\"^display\")\ndf\n</pre> df=data.get('price:\u6536\u76e4\u50f9')  # \u5217\u6578\u5168\u5c55\u958b pd.set_option(\"display.max_rows\", None)  # \u6b04\u6578\u5168\u5c55\u958b pd.set_option(\"display.max_columns\", None)  # \u6700\u591a\u986f\u793a20\u5217 pd.set_option(\"display.max_rows\", 20)  # \u6700\u591a\u986f\u793a20\u6b04 pd.set_option(\"display.max_columns\", 20)  # # \u9084\u539f\u986f\u793a\u6578\u9810\u8a2d\u521d\u59cb\u503c pd.reset_option(\"^display\") df Out[\u00a0]: 0015 0050 0051 0052 0053 0054 0055 0056 0057 0058 0059 0060 0061 006201 006202 006203 006204 006205 006206 006207 006208 00625K 00631L 00632R 00633L 00634R 00635U 00636 00636K 00637L 00638R 00639 00640L 00641R 00642U 00643 00643K 00645 00646 00647L ... 9908 9910 9911 9912 9914 9915 9917 9918 9919 9921 9922 9924 9925 9926 9927 9928 9929 9930 9931 9933 9934 9935 9937 9938 9939 9940 9941 9941A 9942 9943 9944 9945 9946 9949 9950 9951 9955 9958 9960 9962 date 2007-04-23 9.54 57.85 32.83 38.40 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... 18.60 28.00 10.35 14.00 48.55 32.35 56.5 21.40 16.55 52.0 1.87 29.35 31.05 16.60 34.60 18.30 4.80 37.00 15.80 28.55 48.55 9.93 27.55 31.25 30.80 95.00 21.60 NaN 48.70 19.70 31.00 30.35 9.78 73.60 13.25 51.3 72.40 NaN 46.00 49.60 2007-04-24 9.54 58.10 32.99 38.65 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... 18.50 27.75 10.35 14.40 48.95 32.60 55.5 21.30 16.40 52.5 1.83 29.30 30.95 16.45 34.80 18.25 4.82 39.55 15.30 28.30 47.80 9.75 27.30 31.40 30.60 94.50 21.50 NaN 48.70 19.65 32.00 30.50 9.91 75.00 13.25 50.5 71.60 NaN 45.90 50.40 2007-04-25 9.52 57.60 32.80 38.59 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... 18.10 27.80 10.20 14.00 49.75 32.10 55.5 21.20 17.35 54.1 1.83 29.15 30.70 16.40 34.95 18.15 4.71 42.30 16.20 28.10 46.80 9.68 28.35 31.30 30.00 94.40 21.55 NaN 48.60 19.65 32.30 29.50 10.10 74.60 13.30 49.9 71.60 NaN 49.10 49.10 2007-04-26 9.59 57.70 32.80 38.60 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... 18.25 27.90 10.05 14.00 49.60 32.50 57.4 21.05 16.95 55.4 1.90 29.20 30.70 16.40 34.35 18.05 4.81 42.30 15.80 28.00 46.80 9.81 28.20 31.45 29.75 94.90 21.65 NaN 47.65 19.50 31.60 29.15 10.80 74.50 13.25 49.5 71.00 NaN 48.90 48.00 2007-04-27 9.55 57.50 32.72 38.40 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... 18.25 27.75 9.90 14.00 49.00 31.65 56.8 21.00 17.20 55.6 1.77 29.35 30.70 16.60 34.05 18.00 4.85 40.00 15.70 27.80 44.70 10.20 28.20 29.50 29.35 95.00 21.60 NaN 47.80 19.35 31.40 28.50 11.55 75.70 13.15 48.8 69.50 NaN 48.60 46.50 ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 2021-06-24 NaN 136.70 57.60 124.70 65.75 NaN 21.17 34.66 93.75 NaN NaN NaN 23.55 20.76 NaN 65.20 89.95 38.10 38.00 31.06 78.65 NaN 127.75 5.62 67.30 3.86 23.82 27.22 9.71 26.55 7.77 17.05 28.49 10.62 12.50 18.51 NaN 25.48 36.48 63.80 ... 33.40 223.00 67.00 8.93 312.00 NaN 93.6 40.20 34.60 319.0 NaN 44.60 38.65 48.10 35.40 5.41 11.40 47.00 39.90 38.75 17.05 21.65 47.75 100.50 76.00 30.60 138.50 51.2 96.20 64.00 22.00 54.20 14.80 10.80 12.35 94.5 18.75 134.5 27.55 11.00 2021-06-25 NaN 136.95 57.85 124.30 66.30 31.84 21.25 34.74 94.05 NaN NaN NaN 23.94 20.86 NaN 65.50 90.50 38.65 38.55 31.49 78.90 NaN 128.65 5.61 69.65 3.79 23.82 27.73 9.93 27.54 7.64 17.33 28.91 10.52 12.51 18.77 NaN 25.67 36.54 64.35 ... 33.45 241.50 66.00 9.00 320.00 NaN 93.8 39.90 34.60 322.5 NaN 45.15 38.70 48.25 37.50 5.50 11.40 47.00 39.70 38.35 17.15 22.25 48.20 101.00 76.00 30.20 138.00 51.2 95.30 63.80 22.25 54.80 15.00 10.80 12.30 94.1 18.85 131.5 27.55 12.10 2021-06-28 NaN 137.20 57.90 124.20 66.15 31.84 21.29 35.10 94.05 NaN NaN NaN 24.00 20.83 NaN 65.45 91.10 38.53 38.40 31.63 79.20 NaN 130.30 5.57 69.15 3.80 23.92 27.63 9.90 27.35 7.59 17.55 28.96 10.51 12.64 18.98 NaN 25.67 36.68 64.70 ... 33.45 238.50 66.70 9.39 317.00 NaN 94.4 39.90 34.70 325.0 NaN 45.35 38.85 48.25 37.40 5.45 11.55 47.40 39.70 38.50 17.20 23.30 47.50 103.00 77.00 30.00 138.00 51.3 99.40 63.20 22.15 57.60 14.80 10.80 12.30 95.5 19.00 131.5 27.10 13.30 2021-06-29 NaN 137.60 57.80 124.65 66.45 31.80 21.20 34.80 94.70 NaN NaN NaN 23.86 20.76 NaN 66.00 91.45 38.37 38.12 31.30 79.30 8.98 130.10 5.58 67.95 3.82 23.81 27.44 9.80 26.87 7.70 17.43 28.57 10.62 12.42 18.89 NaN 25.48 36.61 64.80 ... 33.50 233.50 66.50 9.09 314.00 NaN 94.2 40.05 34.25 322.0 NaN 45.45 38.85 47.70 37.20 5.60 11.40 47.25 39.50 39.10 17.15 22.35 47.90 100.00 76.60 29.65 138.00 51.3 98.40 63.00 22.15 56.70 14.75 10.80 12.40 94.1 19.15 131.5 27.20 14.60 2021-06-30 NaN 138.95 58.20 125.00 66.80 31.90 21.26 35.00 95.45 NaN NaN NaN 23.86 20.98 NaN 66.30 92.60 38.40 38.30 31.45 79.90 NaN 133.05 5.50 68.20 3.81 23.60 27.45 9.83 26.96 7.65 17.55 28.62 10.58 12.54 18.92 NaN 25.51 36.72 65.00 ... 33.55 244.50 66.40 9.10 313.00 NaN 94.1 40.10 34.70 318.5 NaN 45.85 38.90 47.80 38.25 5.50 11.40 47.50 39.75 39.20 17.30 22.40 48.00 102.00 76.90 29.60 142.50 51.3 108.00 63.50 22.15 56.60 14.70 10.85 12.55 93.8 19.30 134.0 27.35 16.05 <p>3502 rows \u00d7 2268 columns</p> In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\n\n# \u7522\u751f\u80a1\u50f9\u5927\u65bc100\u5143\u7684\u5e03\u6797dataframe\uff0c\u82e5\u5927\u65bc100\u5247\u986f\u793aTrue(\u8a08\u7b97\u6642\u8996\u70ba1)\uff0c\u82e5\u4e0d\u5927\u65bc100\u5247\u986f\u793aFalse(\u8a08\u7b97\u6642\u8996\u70ba0)\nprice_up_10=df&gt;100\n\n# sum:\u52a0\u7e3d\uff0caxis=0\u70ba\u6574\u6b04\u52a0\u7e3d\uff0caxis=1\u70ba\u6574\u5217\u52a0\u7e3d\u3002ex:\u8a08\u7b97\u6bcf\u65e5\u80a1\u50f9\u5927\u65bc100\u7684\u6a19\u5730\u6578\u91cf\ndemo_sum=price_up_10.sum(axis=1)\n\n# mean:\u5e73\u5747\u6578\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u5747\u7dda\u3002\ndemo_mean=df.mean()\n\n# median:\u4e2d\u4f4d\u6578\ndemo_median=df.median()\n\n# std:\u6a19\u6e96\u5dee\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u4e56\u96e2\u7387\u3002\ndemo_std=df.std()\n\n# max:\u6700\u5927\u503c\ndemo_max=df.max()\n\n# min:\u6700\u5c0f\u503c\ndemo_min=df.min()\n\n# cumsum:\u7d2f\u52a0\n## ex:\u7d2f\u7a4d\u6f32\u591a\u5c11\u5143\ndemo_diff=df.diff()\ndemo_cumsum=demo_diff.cumsum()\n\n# cumprod:\u7d2f\u4e58\n## ex:\u8a08\u7b97\u7d2f\u7a4d\u5831\u916c\u7387\ndemo_pct_change=df.pct_change()+1\ndemo_cumprod=demo_pct_change.cumprod()\n\n# cummax:\u7d2f\u7a4d\u6700\u5927\u503c\uff0c\u5e38\u7528\u65bc\u8a08\u7b97drawdown\ndemo_cummax=df.cummax()\n\n# cummin:\u7d2f\u7a4d\u6700\u5c0f\u503c\ndemo_cummin=df.cummin()\n\n# quantile:\u7b2cc\u767e\u5206\u4f4d\u6578\u6578\u503c\uff0c\u5e38\u7528\u65bc\u53d6\u6a19\u7684\u6578\u524dc%\u5f37\u6a19\u5730\ndemo_quantile=df.iloc[-1].quantile(0.9)\n\n# corr:\u76f8\u95dc\u6027\ndemo_corr=df.iloc[:,:5].corr()\n\n# describe:\u53d6\u7d71\u8a08\u8cc7\u6599\ndemo_describe=df.describe()\n</pre> df=data.get('price:\u6536\u76e4\u50f9')  # \u7522\u751f\u80a1\u50f9\u5927\u65bc100\u5143\u7684\u5e03\u6797dataframe\uff0c\u82e5\u5927\u65bc100\u5247\u986f\u793aTrue(\u8a08\u7b97\u6642\u8996\u70ba1)\uff0c\u82e5\u4e0d\u5927\u65bc100\u5247\u986f\u793aFalse(\u8a08\u7b97\u6642\u8996\u70ba0) price_up_10=df&gt;100  # sum:\u52a0\u7e3d\uff0caxis=0\u70ba\u6574\u6b04\u52a0\u7e3d\uff0caxis=1\u70ba\u6574\u5217\u52a0\u7e3d\u3002ex:\u8a08\u7b97\u6bcf\u65e5\u80a1\u50f9\u5927\u65bc100\u7684\u6a19\u5730\u6578\u91cf demo_sum=price_up_10.sum(axis=1)  # mean:\u5e73\u5747\u6578\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u5747\u7dda\u3002 demo_mean=df.mean()  # median:\u4e2d\u4f4d\u6578 demo_median=df.median()  # std:\u6a19\u6e96\u5dee\uff0c\u5e38\u7528\u65bc\u8a08\u7b97\u4e56\u96e2\u7387\u3002 demo_std=df.std()  # max:\u6700\u5927\u503c demo_max=df.max()  # min:\u6700\u5c0f\u503c demo_min=df.min()  # cumsum:\u7d2f\u52a0 ## ex:\u7d2f\u7a4d\u6f32\u591a\u5c11\u5143 demo_diff=df.diff() demo_cumsum=demo_diff.cumsum()  # cumprod:\u7d2f\u4e58 ## ex:\u8a08\u7b97\u7d2f\u7a4d\u5831\u916c\u7387 demo_pct_change=df.pct_change()+1 demo_cumprod=demo_pct_change.cumprod()  # cummax:\u7d2f\u7a4d\u6700\u5927\u503c\uff0c\u5e38\u7528\u65bc\u8a08\u7b97drawdown demo_cummax=df.cummax()  # cummin:\u7d2f\u7a4d\u6700\u5c0f\u503c demo_cummin=df.cummin()  # quantile:\u7b2cc\u767e\u5206\u4f4d\u6578\u6578\u503c\uff0c\u5e38\u7528\u65bc\u53d6\u6a19\u7684\u6578\u524dc%\u5f37\u6a19\u5730 demo_quantile=df.iloc[-1].quantile(0.9)  # corr:\u76f8\u95dc\u6027 demo_corr=df.iloc[:,:5].corr()  # describe:\u53d6\u7d71\u8a08\u8cc7\u6599 demo_describe=df.describe() In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\n\n# shift:\u8cc7\u6599\u79fb\u52d5\uff0c\u5e38\u7528\u65bc\u524d\u5f8c\u671f\u6578\u503c\u589e\u6e1b\u6bd4\u8f03\u3001\u5e74\u589e\u7387\u8a08\u7b97\n## ex:\u6536\u76e4\u50f9\u5411\u4e0b\u5e73\u79fb\u4e00\u5217\ndemo_shift1=df.shift()\n## ex:\u6536\u76e4\u50f9\u5411\u4e0a\u5e73\u79fb\u4e00\u5217\ndemo_shift2=df.shift(-1)\n\n# rolling:\u79fb\u52d5\u7a97\u683c\u4f5c\u696d\uff0c\u5e38\u7d50\u5408\u8cc7\u6599\u904b\u7b97\u516c\u5f0f\u505a\u6efe\u52d5\u5f0f\u8a08\u7b97\uff0cex:\u8a08\u7b9720\u65e5\u79fb\u52d5\u5e73\u5747\u7dda(\u524dn\u7b46\u6578\u8cc7\u6599\u672a\u6eff10\u65e5\u53d6na\uff0c\u672a\u6eff20\u65e5\u4ee5n\u65e5\u8a08\u7b97)\ndemo_rolling=df.rolling(20,min_periods=10).mean()\n\n# diff:\u5217\u6578\u76f8\u6e1b\uff0cex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u50f9\ndemo_diff=df.diff()\n\n# pct_change:\u5217\u6578\u76f8\u9664\uff0cex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u5e45\ndemo_pct_change=df.pct_change()\n</pre> df=data.get('price:\u6536\u76e4\u50f9')  # shift:\u8cc7\u6599\u79fb\u52d5\uff0c\u5e38\u7528\u65bc\u524d\u5f8c\u671f\u6578\u503c\u589e\u6e1b\u6bd4\u8f03\u3001\u5e74\u589e\u7387\u8a08\u7b97 ## ex:\u6536\u76e4\u50f9\u5411\u4e0b\u5e73\u79fb\u4e00\u5217 demo_shift1=df.shift() ## ex:\u6536\u76e4\u50f9\u5411\u4e0a\u5e73\u79fb\u4e00\u5217 demo_shift2=df.shift(-1)  # rolling:\u79fb\u52d5\u7a97\u683c\u4f5c\u696d\uff0c\u5e38\u7d50\u5408\u8cc7\u6599\u904b\u7b97\u516c\u5f0f\u505a\u6efe\u52d5\u5f0f\u8a08\u7b97\uff0cex:\u8a08\u7b9720\u65e5\u79fb\u52d5\u5e73\u5747\u7dda(\u524dn\u7b46\u6578\u8cc7\u6599\u672a\u6eff10\u65e5\u53d6na\uff0c\u672a\u6eff20\u65e5\u4ee5n\u65e5\u8a08\u7b97) demo_rolling=df.rolling(20,min_periods=10).mean()  # diff:\u5217\u6578\u76f8\u6e1b\uff0cex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u50f9 demo_diff=df.diff()  # pct_change:\u5217\u6578\u76f8\u9664\uff0cex:\u53d6\u6bcf\u65e5\u6f32\u8dcc\u5e45 demo_pct_change=df.pct_change() In\u00a0[\u00a0]: Copied! <pre>df[['0050','1101']].average(10)\ndf.iloc[-10:].is_largest(5)\ndf.iloc[-10:].is_smallest(5)\ndf.iloc[-10:,10:15].rise()\ndf.iloc[-10:,10:15].fall()\n# ex:\u662f\u5426\u9023\u5169\u65e5\u4e0a\u6f32\uff1f\ndf.iloc[-10:,10:15].rise().sustain(2)\n# ex:\u53d6\u8fd110\u65e5\u80a1\u50f9\u524d90\uff05\u5206\u4f4d\u6578\ndf.iloc[-10:].quantile_row(0.9)\n</pre> df[['0050','1101']].average(10) df.iloc[-10:].is_largest(5) df.iloc[-10:].is_smallest(5) df.iloc[-10:,10:15].rise() df.iloc[-10:,10:15].fall() # ex:\u662f\u5426\u9023\u5169\u65e5\u4e0a\u6f32\uff1f df.iloc[-10:,10:15].rise().sustain(2) # ex:\u53d6\u8fd110\u65e5\u80a1\u50f9\u524d90\uff05\u5206\u4f4d\u6578 df.iloc[-10:].quantile_row(0.9) In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9').iloc[-400:]['2330']\nmean_20=df.rolling(20).mean()\nstd_value=df.rolling(20).std()\n\nup=mean_20+std_value*2\ndown=mean_20-std_value*2\nup.plot(label='up',legend=True)\ndown.plot(label='down',legend=True)\nmean_20.plot(label='ma_20',legend=True)\ndf.plot(title='bias plot',label='close',legend=True,figsize=(20, 8),grid=True)\n</pre> df=data.get('price:\u6536\u76e4\u50f9').iloc[-400:]['2330'] mean_20=df.rolling(20).mean() std_value=df.rolling(20).std()  up=mean_20+std_value*2 down=mean_20-std_value*2 up.plot(label='up',legend=True) down.plot(label='down',legend=True) mean_20.plot(label='ma_20',legend=True) df.plot(title='bias plot',label='close',legend=True,figsize=(20, 8),grid=True)  Out[\u00a0]: <pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f1ba253d350&gt;</pre> In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\ncheck_list=['1101','1102','2330','2454','6263','9939']\ndemo_corr=df.iloc[-600:][check_list].corr()\n\ndemo_corr.style.background_gradient(cmap ='viridis')\\\n        .set_properties(**{'font-size': '20px'})\n</pre> df=data.get('price:\u6536\u76e4\u50f9') check_list=['1101','1102','2330','2454','6263','9939'] demo_corr=df.iloc[-600:][check_list].corr()  demo_corr.style.background_gradient(cmap ='viridis')\\         .set_properties(**{'font-size': '20px'}) Out[\u00a0]: 1101 1102 2330 2454 6263 9939 1101 1.000000 0.836385 0.562459 0.636151 0.571586 0.766617 1102 0.836385 1.000000 0.383488 0.445629 0.627689 0.754899 2330 0.562459 0.383488 1.000000 0.976506 0.093435 0.777646 2454 0.636151 0.445629 0.976506 1.000000 0.204041 0.808426 6263 0.571586 0.627689 0.093435 0.204041 1.000000 0.407577 9939 0.766617 0.754899 0.777646 0.808426 0.407577 1.000000 In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\n# \u9650\u5b9a\u7bc4\u570d\ndf=df[(df.index&gt;'2015')&amp;(df.index&lt;'2019')]\n\ncond1=df&gt;df.rolling(5).mean()\ncond2=df&gt;df.rolling(10,min_periods=5).mean()\ncond3=df&gt;df.rolling(20,min_periods=10).mean()\ncond4=df&gt;df.rolling(60,min_periods=40).mean()\n\nposition=(df*(cond1&amp;cond2&amp;cond3&amp;cond4))\nposition=position[position&gt;0]\nposition=position.is_largest(10)\n</pre> df=data.get('price:\u6536\u76e4\u50f9') # \u9650\u5b9a\u7bc4\u570d df=df[(df.index&gt;'2015')&amp;(df.index&lt;'2019')]  cond1=df&gt;df.rolling(5).mean() cond2=df&gt;df.rolling(10,min_periods=5).mean() cond3=df&gt;df.rolling(20,min_periods=10).mean() cond4=df&gt;df.rolling(60,min_periods=40).mean()  position=(df*(cond1&amp;cond2&amp;cond3&amp;cond4)) position=position[position&gt;0] position=position.is_largest(10)  Out[\u00a0]: 00632R 00635U 00638R 00726B 00732 00741B 00744B 0080 008201 1216 1225 1227 1232 1256 1259 1262 1264 1268 1301 1326 1338 1339 1464 1476 1477 1525 1527 1536 1537 1539 1541 1558 1565 1580 1589 1590 1597 1599 1702 1707 ... 8114 8255 8279 8299 8341 8383 8406 8416 8422 8432 8433 8436 8437 8442 8444 8446 8450 8454 8462 8464 8466 8480 8489 8497 8913 8941 8942 9904 9910 9914 9917 9921 9924 9933 9937 9941 9943 9951 9958 9960 date 2015-01-05 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2015-01-06 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2015-01-07 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2015-01-08 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2015-01-09 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... ... 2018-12-24 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2018-12-25 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2018-12-26 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False 2018-12-27 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False True False False False False False False False True False False False False False False False False False False False False False False False False False False False False 2018-12-28 False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False False ... False False False False False False False False False False False True False False False False False False False False False False False False False False False False False False False False False False False False False False False False <p>981 rows \u00d7 314 columns</p> In\u00a0[\u00a0]: Copied! <pre>df=data.get('price:\u6536\u76e4\u50f9')\nmean_20=df.rolling(20).mean()\nstd_value=df.rolling(20).std()\n\nup=mean_20+std_value*2\n\n# \u6536\u76e4\u50f9\u525b\u7ad9\u4e0a\u5e03\u6797\u901a\u9053\u4e0a\u7de3\ncond1=(df&gt;up)&amp;(df.shift()&lt;up)\ncond2=(df&gt;5)&amp;(df&lt;200)\nposition=(cond1&amp;cond2)\nposition=position[position&gt;0]\nposition=position.is_smallest(20)\n</pre> df=data.get('price:\u6536\u76e4\u50f9') mean_20=df.rolling(20).mean() std_value=df.rolling(20).std()  up=mean_20+std_value*2  # \u6536\u76e4\u50f9\u525b\u7ad9\u4e0a\u5e03\u6797\u901a\u9053\u4e0a\u7de3 cond1=(df&gt;up)&amp;(df.shift()5)&amp;(df&lt;200) position=(cond1&amp;cond2) position=position[position&gt;0] position=position.is_smallest(20)  In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#1","title":"1.\u5b89\u88dd\u74b0\u5883\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#2","title":"2.\u5275\u9020\u8cc7\u6599\u7269\u4ef6\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#3","title":"3.\u8cc7\u6599\u6aa2\u7d22\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#4","title":"4.\u986f\u793a\u63a7\u5236\u00b6","text":"<p>pandas\u9810\u9632\u8cc7\u6e90\u6d88\u8017\uff0c\u9810\u8a2d\u986f\u793a\u5217\u6578\u70ba10\uff0c\u4e2d\u9593\u8cc7\u6599\u4ee5\u2018...\u2019\u5e36\u904e\uff0c\u82e5\u60f3\u8981\u5168\u5c55\u958b\u6216\u8abf\u6574\u986f\u793a\u6578\u91cf\u4f86\u6aa2\u8996\u8cc7\u6599\uff0c\u53ef\u4f5c\u4ee5\u4e0b\u63a7\u5236\uff0c\u8981\u6ce8\u610f\u7684\u662f\u6b64\u5f71\u97ff\u70ba\u5168\u57df\uff0c\u63a5\u4e0b\u4f86\u7684\u986f\u793a\u6578\u90fd\u6703\u88ab\u5f71\u97ff\u3002</p>"},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#5","title":"5.\u8cc7\u6599\u904b\u7b97\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#6","title":"6.\u79fb\u52d5\u7a97\u683c\u4f5c\u696d\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#7finlabdataframe","title":"7.\u4f7f\u7528FinlabDataFrame\u7684\u529f\u80fd\u00b6","text":"<p>\u9664\u4e86\u4f7f\u7528\u719f\u6089\u7684 Pandas \u8a9e\u6cd5\uff0c\u9084\u53ef\u4ee5\u4f7f\u7528FinlabDataFrame\u7684function!</p> <p>data.get()\u7684\u8cc7\u6599\u7e7c\u627fFinlabDataFrame\u7684\u529f\u80fd\uff0cfunction\u4e0b\u5217:</p> <ol> <li>average(n):\u53d6\u79fb\u52d5\u5e73\u5747\uff0cmin_periods=int(n/2)\u3002</li> <li>is_largest(n):\u53d6\u524dn\u5927\u3002</li> <li>is_smallest(n):\u53d6\u524dn\u5c0f\u3002</li> <li>rise(n=1):\u53d6\u6bd4\u524d\u7b2cn\u7b46\u9ad8\u3002</li> <li>fall(n=1):\u53d6\u6bd4\u524d\u7b2cn\u7b46\u4f4e\u3002</li> <li>sustain(nwindow, nsatisfy=None):\u53d6\u6efe\u52d5nwindow\u7b46\u52a0\u7e3d\u5927\u65bcnsatisfy\u3002</li> <li>quantile_row(n):\u8fd4\u56de\u8acb\u6c42\u8ef8\u4e0a\u7d66n\u5b9a\u5206\u4f4d\u6578\u7684\u503c\u3002</li> </ol>"},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#8","title":"8.\u8996\u89ba\u5316\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#8-1","title":"8-1.\u4e56\u96e2\u7387\u7dda\u5716\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#8-2","title":"8-2.\u76f8\u95dc\u6027\u71b1\u529b\u5716\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#9","title":"9.\u7b56\u7565\u7bc4\u4f8b\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#9-1","title":"9-1.\u5747\u7dda\u591a\u982d\u00b6","text":""},{"location":"tools/Pandas_%E7%AD%96%E7%95%A5%E9%96%8B%E7%99%BC%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95/#9-2","title":"9-2.\u7a81\u7834\u5e03\u6797\u901a\u9053\u4e0a\u7de3\u00b6","text":""},{"location":"tools/basic_strategy_temp/","title":"Basic strategy temp","text":"<p>\u7d66\u4f60\u66f4\u591a\u7684\u7b56\u7565\u6a21\u677f\uff0c\u5e6b\u52a9\u4f60\u6709\u66f4\u591a\u9748\u611f\uff01</p> <p>colab \u7bc4\u4f8b\u6a94\u6848\u9023\u7d50</p> In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin &gt; log.txt\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin &gt; log.txt In\u00a0[12]: Copied! <pre>from finlab.backtest import sim\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\nposition = (close == close.rolling(250).max())\nreport = sim(position, resample=\"M\", name=\"\u5275\u5e74\u65b0\u9ad8\u7b56\u7565\",upload=False)\nreport.display()\n</pre> from finlab.backtest import sim close = data.get(\"price:\u6536\u76e4\u50f9\") position = (close == close.rolling(250).max()) report = sim(position, resample=\"M\", name=\"\u5275\u5e74\u65b0\u9ad8\u7b56\u7565\",upload=False) report.display() <pre>00632R    0.125\n00664R    0.125\n00674R    0.125\n00676R    0.125\n00682U    0.125\n00683L    0.125\n00686R    0.125\n1218      0.125\nName: 2022-07-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre> In\u00a0[7]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\nrev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\nrev_ma3 = rev.average(3)\nrev_ma12 = rev.average(12)\n\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')\npeg = (pe/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387)\ncond1 = rev_ma3/rev_ma12 &gt; 1.1\ncond2 = rev/rev.shift(1) &gt; 0.9\n\ncond_all = cond1 &amp; cond2\nresult = peg*(cond_all)\n\n# \u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1\nposition = result[result&gt;0].is_smallest(10).reindex(rev.index_str_to_date().index, method='ffill')\n\nreport = sim(position=position, resample='D', name=\"\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:peg_rev\", stop_loss=0.1, upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  pe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4') rev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536') rev_ma3 = rev.average(3) rev_ma12 = rev.average(12) \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387') peg = (pe/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387) cond1 = rev_ma3/rev_ma12 &gt; 1.1 cond2 = rev/rev.shift(1) &gt; 0.9  cond_all = cond1 &amp; cond2 result = peg*(cond_all)  # \u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1 position = result[result&gt;0].is_smallest(10).reindex(rev.index_str_to_date().index, method='ffill')  report = sim(position=position, resample='D', name=\"\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:peg_rev\", stop_loss=0.1, upload=False) report.display() <pre>1457    0.1\n1906    0.1\n2537    0.1\n2603    0.1\n3221    0.1\n3706    0.1\n4971    0.1\n5309    0.1\n6640    0.1\n9906    0.1\nName: 2022-06-10 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-06-10 00:00:00')</pre> In\u00a0[9]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n# \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\nrsi = data.indicator('RSI', timeperiod=20)\nposition = rsi.is_largest(20)\n\n# \u56de\u6e2c\uff0c\u6bcf\u9031(W)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  # \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968 rsi = data.indicator('RSI', timeperiod=20) position = rsi.is_largest(20)  # \u56de\u6e2c\uff0c\u6bcf\u9031(W)\u8abf\u6574\u4e00\u6b21 report = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\", upload=False) report.display() <pre>00632R    0.05\n00643K    0.05\n00664R    0.05\n00674R    0.05\n00676R    0.05\n00686R    0.05\n020004    0.05\n020015    0.05\n02001R    0.05\n2364      0.05\n2936      0.05\n2939      0.05\n3205      0.05\n5102      0.05\n5904      0.05\n6655      0.05\n6796      0.05\n8234      0.05\n8427      0.05\n9188      0.05\nName: 2022-07-10 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-10 00:00:00')</pre> In\u00a0[6]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\u80a1\u672c = data.get('financial_statement:\u80a1\u672c')\nprice = data.get('price:\u6536\u76e4\u50f9')\n\u5e02\u503c = \u80a1\u672c * price / 10 * 1000\n\ndf1 = data.get('financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa')\ndf2 = data.get('financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa')\n\u81ea\u7531\u73fe\u91d1\u6d41 = (df1 + df2).rolling(4).mean()\n\n\u7a05\u5f8c\u6de8\u5229 = data.get('fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229')\n\u6b0a\u76ca\u7e3d\u8a08 = data.get('financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d')\n\u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 = \u7a05\u5f8c\u6de8\u5229/ \u6b0a\u76ca\u7e3d\u8a08\n\n\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')\n\n\u7576\u6708\u71df\u6536 = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')* 1000\n\u7576\u5b63\u71df\u6536 = \u7576\u6708\u71df\u6536.rolling(4).sum()\n\u5e02\u503c\u71df\u6536\u6bd4 = \u5e02\u503c / \u7576\u5b63\u71df\u6536\n\n\ncondition1 = (\u5e02\u503c &lt; 1e10)\ncondition2 = \u81ea\u7531\u73fe\u91d1\u6d41 &gt; 0\ncondition3 = \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 &gt; 0\ncondition4 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 0\ncondition5 = \u5e02\u503c\u71df\u6536\u6bd4 &lt; 5\n\nposition = condition1 &amp; condition2 &amp; condition3 &amp; condition4 &amp; condition5\nreport = sim(position, resample='M', name=\"\u512a\u7b49\u751f\u7b56\u7565\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  \u80a1\u672c = data.get('financial_statement:\u80a1\u672c') price = data.get('price:\u6536\u76e4\u50f9') \u5e02\u503c = \u80a1\u672c * price / 10 * 1000  df1 = data.get('financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa') df2 = data.get('financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa') \u81ea\u7531\u73fe\u91d1\u6d41 = (df1 + df2).rolling(4).mean()  \u7a05\u5f8c\u6de8\u5229 = data.get('fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229') \u6b0a\u76ca\u7e3d\u8a08 = data.get('financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d') \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 = \u7a05\u5f8c\u6de8\u5229/ \u6b0a\u76ca\u7e3d\u8a08  \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')  \u7576\u6708\u71df\u6536 = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')* 1000 \u7576\u5b63\u71df\u6536 = \u7576\u6708\u71df\u6536.rolling(4).sum() \u5e02\u503c\u71df\u6536\u6bd4 = \u5e02\u503c / \u7576\u5b63\u71df\u6536   condition1 = (\u5e02\u503c &lt; 1e10) condition2 = \u81ea\u7531\u73fe\u91d1\u6d41 &gt; 0 condition3 = \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 &gt; 0 condition4 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 0 condition5 = \u5e02\u503c\u71df\u6536\u6bd4 &lt; 5  position = condition1 &amp; condition2 &amp; condition3 &amp; condition4 &amp; condition5 report = sim(position, resample='M', name=\"\u512a\u7b49\u751f\u7b56\u7565\", upload=False) report.display() <pre>INFO:finlab.data:financial_statement:\u80a1\u672c -- Daily data usage: 647.7 / 5000 MB\nINFO:finlab.data:financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa -- Daily data usage: 649.0 / 5000 MB\nINFO:finlab.data:financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa -- Daily data usage: 650.4 / 5000 MB\nINFO:finlab.data:fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229 -- Daily data usage: 651.7 / 5000 MB\nINFO:finlab.data:financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d -- Daily data usage: 653.0 / 5000 MB\n</pre> <pre>stock_id\n1108    0.005814\n1203    0.005814\n1217    0.005814\n1258    0.005814\n1336    0.005814\n          ...   \n8916    0.005814\n8923    0.005814\n8928    0.005814\n8941    0.005814\n9927    0.005814\nName: 2022-07-31 00:00:00, Length: 172, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre> In\u00a0[8]: Copied! <pre>from finlab import data\nfrom finlab import backtest\n\nclose = data.get('price:\u6536\u76e4\u50f9')\n\nposition = close &lt; 0\nposition['2330'] = 0.5\nposition['1101'] = -0.5\n\nreport = backtest.sim(position, upload=False)\nreport.display()\n</pre> from finlab import data from finlab import backtest  close = data.get('price:\u6536\u76e4\u50f9')  position = close &lt; 0 position['2330'] = 0.5 position['1101'] = -0.5  report = backtest.sim(position, upload=False) report.display() <pre>1101   -0.5\n2330    0.5\nName: 2022-07-06 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-06 00:00:00')</pre> In\u00a0[11]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport pandas as pd\n\n# \u9650\u5b9a\u56de\u6e2c\u7522\u696d\u7bc4\u570d\nwith data.universe(category='\u5efa\u6750\u71df\u9020'):\n\n    # \u8cc7\u6599\u5f15\u5165\n    close = data.get('price:\u6536\u76e4\u50f9')\n    contract_debt = data.get('financial_statement:\u5408\u7d04\u8ca0\u50b5_\u6d41\u52d5')\n    contract_debt_gr = (contract_debt/(contract_debt.shift())-1)\n    equity = data.get('financial_statement:\u80a1\u672c')\n\n    # \u8a08\u7b97\u5408\u7d04\u8ca0\u50b5\u4f54\u80a1\u672c\u7684\u6bd4\u7387\uff0c\u6bd4\u7387\u8d8a\u9ad8\u4ee3\u8868\u672a\u4f86\u6f5b\u5728\u8ca2\u737b\u6bcf\u80a1\u71df\u6536\u8d8a\u9ad8\n    ce_ratio = (contract_debt / equity)\n\n    # \u9078\u80a1\u689d\u4ef6\n    cond1 = ce_ratio &gt; 0.5\n    cond2 = (contract_debt_gr &gt; 0.05) &amp; (contract_debt_gr&lt;0.5)\n    cond_all = cond1 &amp; cond2\n\n    result = ce_ratio * (cond_all)\n    position = result[result &gt; 0].is_largest(5)\n    \n    # position_limit \u9650\u5b9a\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u670930%\u90e8\u4f4d\uff0c\u907f\u514d\u6a19\u7684\u6578\u904e\u5c11\u6642\u7522\u751f\u91cd\u58d3\u7684\u975e\u7cfb\u7d71\u6027\u98a8\u96aa\n    report = sim(position,resample='M',position_limit=0.3,stop_loss=0.1,fee_ratio=1.425/1000*0.3,name=\"\u71df\u5efa\u80a1\u5408\u7d04\u8ca0\u50b5\u7b56\u7565\",upload=False)\n\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim import pandas as pd  # \u9650\u5b9a\u56de\u6e2c\u7522\u696d\u7bc4\u570d with data.universe(category='\u5efa\u6750\u71df\u9020'):      # \u8cc7\u6599\u5f15\u5165     close = data.get('price:\u6536\u76e4\u50f9')     contract_debt = data.get('financial_statement:\u5408\u7d04\u8ca0\u50b5_\u6d41\u52d5')     contract_debt_gr = (contract_debt/(contract_debt.shift())-1)     equity = data.get('financial_statement:\u80a1\u672c')      # \u8a08\u7b97\u5408\u7d04\u8ca0\u50b5\u4f54\u80a1\u672c\u7684\u6bd4\u7387\uff0c\u6bd4\u7387\u8d8a\u9ad8\u4ee3\u8868\u672a\u4f86\u6f5b\u5728\u8ca2\u737b\u6bcf\u80a1\u71df\u6536\u8d8a\u9ad8     ce_ratio = (contract_debt / equity)      # \u9078\u80a1\u689d\u4ef6     cond1 = ce_ratio &gt; 0.5     cond2 = (contract_debt_gr &gt; 0.05) &amp; (contract_debt_gr&lt;0.5)     cond_all = cond1 &amp; cond2      result = ce_ratio * (cond_all)     position = result[result &gt; 0].is_largest(5)          # position_limit \u9650\u5b9a\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u670930%\u90e8\u4f4d\uff0c\u907f\u514d\u6a19\u7684\u6578\u904e\u5c11\u6642\u7522\u751f\u91cd\u58d3\u7684\u975e\u7cfb\u7d71\u6027\u98a8\u96aa     report = sim(position,resample='M',position_limit=0.3,stop_loss=0.1,fee_ratio=1.425/1000*0.3,name=\"\u71df\u5efa\u80a1\u5408\u7d04\u8ca0\u50b5\u7b56\u7565\",upload=False)  report.display() <pre>stock_id\n2540    0.2\n2548    0.2\n3056    0.2\n5213    0.2\n6186    0.2\nName: 2022-05-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-05-31 00:00:00')</pre> In\u00a0[13]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n# \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\")\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\nposition = ((close / close.shift(60)).is_largest(30) &amp; (roe &gt; 0))\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample=\"M\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  # \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9 roe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\") close = data.get(\"price:\u6536\u76e4\u50f9\") position = ((close / close.shift(60)).is_largest(30) &amp; (roe &gt; 0)) # \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21 report = sim(position, resample=\"M\", upload=False) report.display() <pre>INFO:finlab.data:fundamental_features:ROE\u7a05\u5f8c -- Daily data usage: 655.7 / 5000 MB\n</pre> <pre>1319    0.055556\n1522    0.055556\n1524    0.055556\n2305    0.055556\n2364    0.055556\n2482    0.055556\n2736    0.055556\n2929    0.055556\n2939    0.055556\n4543    0.055556\n5258    0.055556\n6113    0.055556\n6199    0.055556\n6472    0.055556\n6655    0.055556\n6715    0.055556\n8097    0.055556\n9802    0.055556\nName: 2022-07-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre> In\u00a0[51]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport numpy as np\n\n\n# \u5e02\u5834\u591a\u7a7a\u6392\u5217\u5bb6\u6578\ndef ls_order_position(short=5,mid=10,long=30):\n    close = data.get(\"price:\u6536\u76e4\u50f9\")\n    short_ma = close.average(short)\n    mid_ma = close.average(mid)\n    long_ma = close.average(long)\n    long_order = (short_ma&gt;=mid_ma) &amp; (mid_ma&gt;=long_ma)\n    long_order = long_order.sum(1)\n    short_order = (short_ma&lt;mid_ma) &amp; (mid_ma&lt;long_ma)\n    short_order = short_order.sum(1)\n    entry = long_order &gt; short_order\n    cond = ~close.isna()\n    position = cond &amp; entry\n    return position\n\n\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\nsma20 = close.average(20)\nrev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\n\ncond1 = (close &gt; close.shift(20)) &amp; (close &gt; close.shift(60))\ncond2 = (rev.average(3) &gt; rev.average(12)).sustain(3)\n\nbuy = cond1 &amp; cond2\nsell = sma20 &lt; sma20.shift()\n\nposition = pd.DataFrame(np.nan, index=buy.index, columns=buy.columns)\nposition[buy] = 1\nposition[sell] = 0\nposition = position.ffill().fillna(0).astype(bool)\nposition = position &amp; ls_order_position()\nreport = sim(position, resample=\"D\", name=\"ls_order_position\",upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim import numpy as np   # \u5e02\u5834\u591a\u7a7a\u6392\u5217\u5bb6\u6578 def ls_order_position(short=5,mid=10,long=30):     close = data.get(\"price:\u6536\u76e4\u50f9\")     short_ma = close.average(short)     mid_ma = close.average(mid)     long_ma = close.average(long)     long_order = (short_ma&gt;=mid_ma) &amp; (mid_ma&gt;=long_ma)     long_order = long_order.sum(1)     short_order = (short_ma short_order     cond = ~close.isna()     position = cond &amp; entry     return position   close = data.get(\"price:\u6536\u76e4\u50f9\") sma20 = close.average(20) rev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')  cond1 = (close &gt; close.shift(20)) &amp; (close &gt; close.shift(60)) cond2 = (rev.average(3) &gt; rev.average(12)).sustain(3)  buy = cond1 &amp; cond2 sell = sma20 &lt; sma20.shift()  position = pd.DataFrame(np.nan, index=buy.index, columns=buy.columns) position[buy] = 1 position[sell] = 0 position = position.ffill().fillna(0).astype(bool) position = position &amp; ls_order_position() report = sim(position, resample=\"D\", name=\"ls_order_position\",upload=False) report.display() <pre>Series([], Name: 2022-07-06 00:00:00, dtype: float64)</pre> <pre>Timestamp('2022-07-06 00:00:00')</pre> In\u00a0[16]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport pandas as pd\n\nrev = data.get(\"monthly_revenue:\u7576\u6708\u71df\u6536\")\nrev_rf = data.get(\"monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)\")\nvol = data.get(\"price:\u6210\u4ea4\u80a1\u6578\")/1000\n\n# \u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1\nfull_cash_delivery_stock_filter = data.get(\"etl:full_cash_delivery_stock_filter\")\n\nrev_recent_3 = rev.rolling(3).sum()\nvol_avg = vol.average(10)\ncond1 = (rev_recent_3/rev_recent_3.rolling(24, min_periods=12).max())==1\ncond2 = vol_avg &gt; 300\ncond_all = cond1 &amp; cond2 &amp; full_cash_delivery_stock_filter \nresult = rev_rf*(cond_all)\nposition = result[result&gt;0].is_largest(10).reindex(rev.index_str_to_date().index, method=\"ffill\")\nreport = sim(position=position,stop_loss=0.3,position_limit=0.1, upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim import pandas as pd  rev = data.get(\"monthly_revenue:\u7576\u6708\u71df\u6536\") rev_rf = data.get(\"monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)\") vol = data.get(\"price:\u6210\u4ea4\u80a1\u6578\")/1000  # \u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1 full_cash_delivery_stock_filter = data.get(\"etl:full_cash_delivery_stock_filter\")  rev_recent_3 = rev.rolling(3).sum() vol_avg = vol.average(10) cond1 = (rev_recent_3/rev_recent_3.rolling(24, min_periods=12).max())==1 cond2 = vol_avg &gt; 300 cond_all = cond1 &amp; cond2 &amp; full_cash_delivery_stock_filter  result = rev_rf*(cond_all) position = result[result&gt;0].is_largest(10).reindex(rev.index_str_to_date().index, method=\"ffill\") report = sim(position=position,stop_loss=0.3,position_limit=0.1, upload=False) report.display() <pre>INFO:finlab.data:etl:full_cash_delivery_stock_filter -- Daily data usage: 659.8 / 5000 MB\n</pre> <pre>1906    0.1\n2530    0.1\n2607    0.1\n4946    0.1\n6111    0.1\n6241    0.1\n6259    0.1\n6446    0.1\n6715    0.1\n8097    0.1\nName: 2022-06-10 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-06-10 00:00:00')</pre> In\u00a0[53]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\u71df\u696d\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\n\u6295\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\n\u878d\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u7c4c\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\").deadline()\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\n\nposition = (\u71df\u696d\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u6295\u8cc7\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u878d\u8cc7\u73fe\u91d1\u6d41 &lt; 0) &amp; (roe &gt; 5) &amp; (close &gt; 10)\n\n# \u904e\u6ffe KY\u80a1\nsc = data.get(\"security_categories\")\nposition_col = position.columns\nky_filter = position_col[~position_col.isin(list(sc[sc[\"name\"].str.contains(\"KY\")][\"stock_id\"]))]\nposition = position[ky_filter]\n\nreport = sim(position,resample=\"M\",name=\"\u73fe\u91d1\u6d41\u6b63\u6578\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  \u71df\u696d\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() \u6295\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() \u878d\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u7c4c\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() roe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\").deadline() close = data.get(\"price:\u6536\u76e4\u50f9\")  position = (\u71df\u696d\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u6295\u8cc7\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u878d\u8cc7\u73fe\u91d1\u6d41 &lt; 0) &amp; (roe &gt; 5) &amp; (close &gt; 10)  # \u904e\u6ffe KY\u80a1 sc = data.get(\"security_categories\") position_col = position.columns ky_filter = position_col[~position_col.isin(list(sc[sc[\"name\"].str.contains(\"KY\")][\"stock_id\"]))] position = position[ky_filter]  report = sim(position,resample=\"M\",name=\"\u73fe\u91d1\u6d41\u6b63\u6578\", upload=False) report.display() <pre>stock_id\n1539    0.043478\n2303    0.043478\n2504    0.043478\n2636    0.043478\n3093    0.043478\n3131    0.043478\n3169    0.043478\n3557    0.043478\n4506    0.043478\n4945    0.043478\n5534    0.043478\n6195    0.043478\n6278    0.043478\n6281    0.043478\n6294    0.043478\n6506    0.043478\n6542    0.043478\n6683    0.043478\n6706    0.043478\n6747    0.043478\n6761    0.043478\n8084    0.043478\n8421    0.043478\nName: 2022-07-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre>"},{"location":"tools/basic_strategy_temp/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/basic_strategy_temp/","title":"\u80a1\u50f9\u5275\u65b0\u9ad8\u52d5\u80fd\u00b6","text":""},{"location":"tools/basic_strategy_temp/","title":"\u6708\u71df\u6536\u516c\u544a\u622a\u6b62\u65e5\u63db\u80a1 &amp; \u672c\u76ca\u6210\u9577\u6bd4\u7b56\u7565\u00b6","text":"<p>position\u7684dataframe\u7528\u71df\u6536\u7684index\uff0c\u4e0d\u8981\u7528\u6536\u76e4\u50f9\u7684index\u3002 resample\u8a2dD\uff0c\u5c31\u6703\u662f\u6bcf\u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1\uff08\u4e0d\u4e00\u5b9a\u662f10\u65e5\uff0c\u9047\u5047\u65e5\u53ef\u80fd\u5f80\u5f8c\uff09\uff0cresample\u8a2dD\u6703\u4f9d\u7167position\u9010\u7b46\u5224\u65b7\u9032\u5834\u8a0a\u865f\u3002</p> <p>PEG\u7b56\u7565\u6559\u5b78</p> <p>note:</p> <p>position\u52a0\u4e0areindex\u6708\u71df\u6536\u7684\u65e5\u671f\u7d22\u5f15\uff0c\u5f8c\u6703\u8b93position\u65e5\u671f\u8b8a\u6210\u6bcf\u6708\u71df\u6536\u622a\u6b62\u65e5\u3002</p> <p>resample\u4e0d\u9808\u66f4\u6539\uff0c\u4f7f\u7528\u9810\u8a2d\"D\"\uff0c\u9019\u88e1\u7684\"D\"\u60f3\u6210\u662f\u6bcf\u5217\u800c\u4e0d\u662f\u6bcf\u65e5\uff0c\u56e0\u70ba\u4f7f\u7528reindex\u8b93\u6bcf\u5217\u9593\u9694\u4e00\u500b\u6708\uff0c\u6240\u4ee5\u57f7\u884cresample=\"D\"\u5be6\u969b\u4e0a\u662f\u9694\u4e00\u500b\u6708\u3002</p>"},{"location":"tools/basic_strategy_temp/","title":"\u6280\u8853\u6307\u6a19\u9078\u80a1\u00b6","text":"<p>\u9ad8 RSI \u6280\u8853\u6307\u6a19\u7b56\u7565</p> <p>\u4e0a\u8ff0\u7b56\u7565\u6703\u9078\u51fa\u5f88\u591a\u6a94\u6a19\u7684\uff0c\u8981\u662f\u6211\u5011\u53ea\u60f3\u8981\u9078\u51fa 20 \u6a94\u8981\u600e\u9ebc\u5beb\u5462\uff1f\u9019\u500b\u7b56\u7565\u6211\u5011\u53ef\u4ee5\u5c07 RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\u7d0d\u5165\u7d44\u5408\uff0c\u4e26\u4e14\u6301\u6709\u4e00\u9031\uff0c\u4f86\u8a66\u8a66\u770b\u6548\u679c\u5982\u4f55\u3002\u6211\u5011\u53ef\u4ee5\u7528 data.indicator \u4f86\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI\uff0c\u4e5f\u53ef\u4ee5\u7528 rsi.is_largest \u4f86\u8a08\u7b97\u6b64\u80a1\u7968\u7684 RSI \u662f\u5426\u662f\u6700\u5927\u7684 20 \u6a94\u3002</p>"},{"location":"tools/basic_strategy_temp/","title":"\u5c0f\u8cc7\u65cf\u512a\u7b49\u751f\u7b56\u7565\u00b6","text":"<p>\u4e0a\u904e HaHow \u4e0a FinLab Python \u5c0f\u8cc7\u65cf\u8ab2\u7a0b\u55ce\uff1f</p> <p>\u4e5f\u53ef\u4ee5\u628a\u8ab2\u7a0b\u7684\u5167\u5bb9\u6539\u5beb\u904e\u4f86\u5594\uff5e</p>"},{"location":"tools/basic_strategy_temp/","title":"\u591a\u7a7a\u4e26\u884c\u56de\u6e2c\u00b6","text":"<p>\u82e5\u7b56\u7565\u60f3\u540c\u6642\u505a\u591a\u548c\u505a\u7a7a\uff0c\u53ef\u53c3\u8003\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u7bc4\u4f8b\u662f\u505a\u591a 2330 \u4e00\u534a\u7684\u90e8\u4f4d\uff0c\u505a\u7a7a 1101 \u4e00\u534a\u7684\u90e8\u4f4d\u3002</p>"},{"location":"tools/basic_strategy_temp/","title":"\u71df\u5efa\u7522\u696d\u9650\u5b9a\u7b56\u7565\u00b6","text":"<p>\u904b\u7528\u71df\u5efa\u80a1\"\u5408\u7d04\u8ca0\u50b5\"\u7684\u7279\u6027\u9032\u884c\u9650\u5b9a\u7522\u696d\u9078\u80a1\u3002</p> <p>\u8a73\u7d30\u6587\u7ae0\u5167\u5bb9</p>"},{"location":"tools/basic_strategy_temp/","title":"\u4e56\u96e2\u7387\u548c\u8ca1\u5831\u6ffe\u7db2\u00b6","text":""},{"location":"tools/basic_strategy_temp/","title":"\u52a0\u5165\u5927\u76e4\u6307\u6a19\u6ffe\u7db2\u00b6","text":"<p>\u5927\u76e4\u6307\u6a19\u8f49\u7a7a\u6642\uff0c\u51fa\u6e05\u6301\u80a1</p>"},{"location":"tools/basic_strategy_temp/","title":"\u71df\u6536\u52d5\u80fd &amp; \u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1\u00b6","text":"<p>\u8cb7\u9032\u8a0a\u865f\u9694\u65e5\u82e5\u70ba\u5168\u984d\u4ea4\u5272\u80a1\uff0c\u5247\u4e0d\u4ea4\u6613\u3002 \u5168\u984d\u4ea4\u5272\u80a1\u6e05\u55ae\u6bcf\u65e50815\u66f4\u65b0\u3002</p>"},{"location":"tools/basic_strategy_temp/#ky","title":"\u73fe\u91d1\u6d41\u91cf\u7b56\u7565 &amp; \u904e\u6ffe KY\u80a1\u00b6","text":"<p>\u5728\u53f0\u7b2c\u4e00\u4e0a\u5e02\u7684\u6d77\u5916\u516c\u53f8\u7d93\u5e38\u7206\u51fa\u8ca1\u52d9\u554f\u984c\uff0c\u5c0d\u6b64\u6709\u7591\u616e\u8005\uff0c\u53ef\u5728\u8ca1\u5831\u7b56\u7565\u6392\u9664KY\u80a1\u3002</p> <p>\u57fa\u672c\u9762\u6307\u6a19\u4f7f\u7528\u8ca1\u5831\u516c\u544a\u622a\u6b62\u65e5\u3002</p>"},{"location":"tools/cheap-stock-ratio/","title":"\u5927\u8dcc\u5e95\u90e8\u5224\u65b7","text":"<p>\u4f7f\u7528\u300c\u80a1\u50f9\u6de8\u503c\u6bd4\u300d\u8ddf\u300c\u672c\u76ca\u6bd4\u300d\u4fbf\u5b9c\u80a1\u6578\u91cf\u4f86\u63a8\u4f30\uff0c \u4f86\u770b\u5927\u8dcc\u662f\u5426\u5c07\u8db3\u5920\u591a\u7684\u80a1\u7968\u6253\u5165\u300c\u4fbf\u5b9c\u80a1\u300d\u3002 \u7576\u300c\u4fbf\u5b9c\u80a1\u300d\u5920\u591a\u6642\uff0c\u5c31\u4ee3\u8868\u53ef\u80fd\u5df2\u7d93\u8dcc\u7121\u53ef\u8dcc\uff0c\u800c\u76ee\u524d\u53f0\u80a1\u591a\u6bba\u591a\u7684\u60c5\u6cc1\u4e0b\uff0c\u662f\u5426\u5df2\u7d93\u662f\u6700\u4f4e\u9ede\u4e86\u5462\uff1f</p>"},{"location":"tools/cheap-stock-ratio/#_2","title":"\u300c\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1\u300d\u548c\u300c\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1\u300d","text":"<p>\u4fbf\u5b9c\u80a1\u6709\u5f88\u591a\u7a2e\uff0c\u6709\u4e9b\u53ef\u4ee5\u7528\u516c\u53f8\u7684\u6de8\u503c\u8ddf\u80a1\u50f9\u505a\u5224\u65b7 \u4e5f\u53ef\u4ee5\u662f\u516c\u53f8\u7684\u71df\u6536</p>"},{"location":"tools/cheap-stock-ratio/#_3","title":"\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1","text":"<p>\u662f\u6307\u53f0\u7063\u4e0a\u5e02\u4e0a\u6ac3\uff0c\u80a1\u50f9\u6de8\u503c\u6bd4 &lt; 0.6 \u7684\u80a1\u7968\u3002</p>"},{"location":"tools/cheap-stock-ratio/#_4","title":"\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1","text":"<p>\u662f\u6307\u53f0\u7063\u4e0a\u5e02\u4e0a\u6ac3\uff0c\u672c\u76ca\u6bd4 &lt; 8 \u7684\u80a1\u7968\u3002</p>"},{"location":"tools/cheap-stock-ratio/#_5","title":"\u7a0b\u5f0f\u78bc","text":""},{"location":"tools/cheap-stock-ratio/#_6","title":"\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1","text":"<p>\u8a08\u7b97\u300c\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1\u300d\u4f54\u6240\u6709\u4e0a\u5e02\u4e0a\u6ac3\u7684\u80a1\u7968\u6bd4\u4f8b <pre><code>from finlab import data\n# \u8a08\u7b97\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nsmall_pb_ratio = (pb &lt; 0.6).sum(axis=1) / pb.notna().sum(axis=1)\n</code></pre></p>"},{"location":"tools/cheap-stock-ratio/#_7","title":"\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1","text":"<p>\u8a08\u7b97\u300c\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1\u300d\u4f54\u6240\u6709\u4e0a\u5e02\u4e0a\u6ac3\u7684\u80a1\u7968\u6bd4\u4f8b <pre><code># \u8a08\u7b97\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\nsmall_pe_ratio = (pe &lt; 10).sum(axis=1) / pe.notna().sum(axis=1)\n</code></pre></p>"},{"location":"tools/cheap-stock-ratio/#_8","title":"\u7e6a\u88fd\u5716\u8868","text":"<p><pre><code>from finlab import plot\nplot.plot_tw_stock_candles('0050', recent_days=100000, resample='M', technical_func={\n'small_pb_ratio': lambda ohlcv: small_pb_ratio.reindex(ohlcv.index, method='ffill'),\n'small_pe_ratio': lambda ohlcv: small_pe_ratio.reindex(ohlcv.index, method='ffill'),\n})\n</code></pre> </p>"},{"location":"tools/cheap-stock-ratio/#_9","title":"\u6307\u6a19\u610f\u7fa9","text":"<p>\u7576\u53f0\u80a1\u4f4d\u65bc\u9ad8\u6a94\u6642\uff0c\u300c\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1\u300d\u8ddf\u300c\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1\u300d\u6578\u91cf\u504f\u4f4e\u3002 \u7576\u53f0\u80a1\u66b4\u8dcc\u81f3\u4f4e\u9ede\uff0c\u300c\u6de8\u503c\u6bd4\u4fbf\u5b9c\u80a1\u300d\u8ddf\u300c\u672c\u76ca\u6bd4\u4fbf\u5b9c\u80a1\u300d\u6578\u91cf\u6703\u96d9\u96d9 \u66b4\u6f32\u3002 \u5047\u5982\u4e0b\u8dcc\u6642\uff0c\u53ea\u89c0\u5bdf\u5230\u5176\u4e2d\u4e00\u500b\u6307\u6a19\u66b4\u6f32\uff0c\u4e0d\u8db3\u4ee5\u8b49\u660e\u53f0\u80a1\u5df2\u7d93\u8dcc\u81f3\u4f4e\u9ede\u3002</p>"},{"location":"tools/guide_for_beginners/","title":"\u7b56\u7565\u958b\u767c10\u5206\u9418\u4e0a\u624b","text":"<p>\u60f3\u5feb\u901f\u4e86\u89e3 FinLab \u7b56\u7565\u958b\u767c\u5de5\u5177\u7684\u7cbe\u83ef\u529f\u80fd\u55ce?</p> <p>\u770b\u9019\u4efd\u7bc4\u4f8b\u5c31\u5c0d\u4e86\u3002</p> <p>colab \u7bc4\u4f8b\u6a94\u6848\u9023\u7d50</p> In\u00a0[22]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\n\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\nclose = data.get('price:\u6536\u76e4\u50f9')\nclose.iloc[:5,:5]\n</pre> from finlab import data  pb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4') close = data.get('price:\u6536\u76e4\u50f9') close.iloc[:5,:5] <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>INFO:finlab.data:price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4 -- Daily data usage: 434.0 / 5000 MB\nINFO:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 455.0 / 5000 MB\n</pre> Out[\u00a0]: 0015 0050 0051 0052 0053 date 2007-04-23 9.54 57.85 32.83 38.40 NaN 2007-04-24 9.54 58.10 32.99 38.65 NaN 2007-04-25 9.52 57.60 32.80 38.59 NaN 2007-04-26 9.59 57.70 32.80 38.60 NaN 2007-04-27 9.55 57.50 32.72 38.40 NaN In\u00a0[\u00a0]: Copied! <pre>company_basic_info = data.get('company_basic_info')\ncompany_basic_info.head(3)\n</pre> company_basic_info = data.get('company_basic_info') company_basic_info.head(3) Out[\u00a0]: stock_id \u516c\u53f8\u540d\u7a31 \u7522\u696d\u985e\u5225 \u5916\u570b\u4f01\u696d\u8a3b\u518a\u5730\u570b \u4f4f\u5740 \u71df\u5229\u4e8b\u696d\u7d71\u4e00\u7de8\u865f \u8463\u4e8b\u9577 \u7e3d\u7d93\u7406 \u767c\u8a00\u4eba \u767c\u8a00\u4eba\u8077\u7a31 ... \u516c\u53f8\u7db2\u5740 \u6295\u8cc7\u4eba\u95dc\u4fc2\u806f\u7d61\u4eba \u6295\u8cc7\u4eba\u95dc\u4fc2\u806f\u7d61\u4eba\u8077\u7a31 \u6295\u8cc7\u4eba\u95dc\u4fc2\u806f\u7d61\u96fb\u8a71 \u6295\u8cc7\u4eba\u95dc\u4fc2\u806f\u7d61\u96fb\u5b50\u90f5\u4ef6 \u516c\u53f8\u7db2\u7ad9\u5167\u5229\u5bb3\u95dc\u4fc2\u4eba\u5c08\u5340\u7db2\u5740 \u5e02\u5834\u5225 \u4e0a\u6ac3\u65e5\u671f \u8208\u6ac3\u65e5\u671f \u516c\u53f8\u7c21\u7a31 0 1101 \u53f0\u7063\u6c34\u6ce5\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u6c34\u6ce5\u5de5\u696d \uff0d \u53f0\u5317\u5e02\u4e2d\u5c71\u5317\u8def2\u6bb5113\u865f 11913502 \u5f35\u5b89\u5e73 \u674e\u9418\u57f9 \u9ec3\u5065\u5f37 \u8cc7\u6df1\u526f\u7e3d\u7d93\u7406 ... http://www.taiwancement.com \u5f35\u4f73\u742a \u4e3b\u4efb 02-25317099\u5206\u6a5f20358 ir@taiwancement.com http://www.taiwancement.com/tw/csr/csr5-1.html sii nan nan \u53f0\u6ce5 1 1102 \u4e9e\u6d32\u6c34\u6ce5\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u6c34\u6ce5\u5de5\u696d \uff0d \u53f0\u5317\u5e02\u5927\u5b89\u5340\u6566\u5316\u5357\u8def2\u6bb5207\u865f30\u300131\u6a13 03244509 \u5f90\u65ed\u6771 \u674e\u5764\u708e \u5468\u7dad\u5d11 \u526f\u7e3d\u7d93\u7406 ... www.acc.com.tw \u9673\u97cb\u4ef2 \u6295\u8cc7\u4eba\u95dc\u4fc2\u526f\u7d93\u7406 02 27338000 ext.8336 ir@acc.com.tw http://www.acc.com.tw/tw/stakeholder/stakehold... sii nan nan \u4e9e\u6ce5 2 1103 \u5609\u65b0\u6c34\u6ce5\u80a1\u4efd\u6709\u9650\u516c\u53f8 \u6c34\u6ce5\u5de5\u696d \uff0d \u53f0\u5317\u5e02\u4e2d\u5c71\u5317\u8def2\u6bb596\u865f 11892801 \u5f35\u525b\u7db8 \u7941\u58eb\u9245 \u738b\u7acb\u5fc3 \u57f7\u884c\u526f\u7e3d\u7d93\u7406 ... www.chcgroup.com.tw \u738b\u7acb\u5fc3 \u57f7\u884c\u526f\u7e3d\u7d93\u7406 (02)2551-5211#243 ir@chcgroup.com.tw www.chcgroup.com.tw/index.php?route=system/sys... sii nan nan \u5609\u6ce5 <p>3 rows \u00d7 42 columns</p> In\u00a0[23]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('price:\u6536\u76e4\u50f9')\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')  \n\nsma20 = close.average(20)\nsma60 = close.average(60)\n\nentries = close &gt; sma20\nexits = close &lt; sma60\n\nposition = entries.hold_until(exits, nstocks_limit=10, rank=-pb, take_profit=0.4)\nbacktest_report = sim(position, upload=False)\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('price:\u6536\u76e4\u50f9') pb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')    sma20 = close.average(20) sma60 = close.average(60)  entries = close &gt; sma20 exits = close &lt; sma60  position = entries.hold_until(exits, nstocks_limit=10, rank=-pb, take_profit=0.4) backtest_report = sim(position, upload=False)  In\u00a0[24]: Copied! <pre>from finlab.backtest import sim\n\nbacktest_report = sim(position,upload=False)\n\n# \u65b0\u589e\u5c0d\u6a19\u7684\u6307\u6578\uff0c\u4f60\u7684\u7b56\u7565\u80fd\u8d0f\u5927\u76e4\u55ce?\nbacktest_report.benchmark = data.get('benchmark_return:\u767c\u884c\u91cf\u52a0\u6b0a\u80a1\u50f9\u5831\u916c\u6307\u6578').squeeze()\nbacktest_report.display()\n</pre> from finlab.backtest import sim  backtest_report = sim(position,upload=False)  # \u65b0\u589e\u5c0d\u6a19\u7684\u6307\u6578\uff0c\u4f60\u7684\u7b56\u7565\u80fd\u8d0f\u5927\u76e4\u55ce? backtest_report.benchmark = data.get('benchmark_return:\u767c\u884c\u91cf\u52a0\u6b0a\u80a1\u50f9\u5831\u916c\u6307\u6578').squeeze() backtest_report.display() <pre>1104    0.1\n1402    0.1\n1451    0.1\n2923    0.1\n2929    0.1\n3573    0.1\n4543    0.1\n5438    0.1\n6605    0.1\n8411    0.1\nName: 2022-07-06 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-06 00:00:00')</pre> In\u00a0[\u00a0]: Copied! <pre>backtest_report.creturn\n</pre> backtest_report.creturn Out[\u00a0]: <pre>date\n2007-05-07    1.000000\n2007-05-08    0.998575\n2007-05-09    0.996668\n2007-05-10    1.006912\n2007-05-11    1.014379\n                ...   \n2022-06-30    5.791745\n2022-07-01    5.536816\n2022-07-04    5.498622\n2022-07-05    5.542169\n2022-07-06    5.395311\nLength: 3742, dtype: float64</pre> In\u00a0[\u00a0]: Copied! <pre>backtest_report.position_info()\n</pre> backtest_report.position_info() Out[\u00a0]: <pre>{'1104 \u74b0\u6ce5': {'entry_date': '2022-07-06',\n  'entry_price': 0.0,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.0,\n  'status': '\u8cb7\u9032',\n  'weight': 0.0},\n '1402 \u9060\u6771\u65b0': {'entry_date': '2022-07-06',\n  'entry_price': 0.0,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.0,\n  'status': '\u8cb7\u9032',\n  'weight': 0.0},\n '1451 \u5e74\u8208': {'entry_date': '2022-04-22',\n  'entry_price': 21.0,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.07142857142857095,\n  'status': '\u8cb7\u9032',\n  'weight': 0.10060208160861868},\n '2201 \u88d5\u9686': {'entry_date': '2022-06-20',\n  'entry_price': 49.75,\n  'exit_date': '2022-07-06',\n  'next_weight': 0.0,\n  'return': -0.14572864321608014,\n  'status': '\u8ce3\u51fa',\n  'weight': 0.09758099807682835},\n '2474 \u53ef\u6210': {'entry_date': '2022-05-09',\n  'entry_price': 155.5,\n  'exit_date': '2022-07-06',\n  'next_weight': 0.0,\n  'return': 0.012861736334404794,\n  'status': '\u8ce3\u51fa',\n  'weight': 0.09850363328058616},\n '2514 \u9f8d\u90a6': {'entry_date': '2022-07-01',\n  'entry_price': 17.3,\n  'exit_date': '2022-07-06',\n  'next_weight': 0.0,\n  'return': -0.023121387283237205,\n  'status': '\u8ce3\u51fa',\n  'weight': 0.09944445830150599},\n '2923 \u9f0e\u56fa-KY': {'entry_date': '2022-07-01',\n  'entry_price': 27.5,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': -0.040000000000000036,\n  'status': '\u8cb7\u9032',\n  'weight': 0.09772624635925513},\n '2929 \u6dd8\u5e1d-KY': {'entry_date': '2022-05-19',\n  'entry_price': 12.9,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.07364341085271287,\n  'status': '\u8cb7\u9032',\n  'weight': 0.10945090553098917},\n '3252 \u6d77\u7063': {'entry_date': '2022-06-20',\n  'entry_price': 23.1,\n  'exit_date': '2022-07-06',\n  'next_weight': 0.0,\n  'return': -0.17532467532467533,\n  'status': '\u8ce3\u51fa',\n  'weight': 0.09541832353529327},\n '3573 \u7a4e\u53f0         ': {'entry_date': '2016-05-09',\n  'entry_price': 26.3,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.001901140684410274,\n  'status': '\u8cb7\u9032',\n  'weight': 0.1019434426967336},\n '4543 \u842c\u5728': {'entry_date': '2022-07-06',\n  'entry_price': 0.0,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.0,\n  'status': '\u8cb7\u9032',\n  'weight': 0.0},\n '5438 \u6771\u53cb': {'entry_date': '2022-06-20',\n  'entry_price': 14.7,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': -0.00340136054421758,\n  'status': '\u8cb7\u9032',\n  'weight': 0.10125230071234896},\n '6605 \u5e1d\u5bf6': {'entry_date': '2022-05-12',\n  'entry_price': 58.8,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.16496598639455673,\n  'status': '\u8cb7\u9032',\n  'weight': 0.09807760989784062},\n '8411 \u798f\u8c9e-KY': {'entry_date': '2022-07-06',\n  'entry_price': 0.0,\n  'exit_date': '',\n  'next_weight': 0.1,\n  'return': 0.0,\n  'status': '\u8cb7\u9032',\n  'weight': 0.0},\n 'next_trading_date': '2022-07-06',\n 'trade_at': 'close',\n 'update_date': '2022-07-06'}</pre> In\u00a0[\u00a0]: Copied! <pre>trade_record = backtest_report.get_trades()\ntrade_record.head(5)\n</pre> trade_record = backtest_report.get_trades() trade_record.head(5) Out[\u00a0]: stock_id entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return entry_price exit_price mae gmfe bmfe mdd pdays trade_index 0 3297 \u676d\u7279 2007-05-08 2007-05-28 2007-05-07 2007-05-25 0.100000 14.0 10.0 24.0 0.535874 44.60 68.50 0.000000 0.535874 0.000000 -0.044402 14.0 1 3376 \u65b0\u65e5\u8208 2007-05-08 2007-06-05 2007-05-07 2007-06-04 0.100000 20.0 10.0 30.0 -0.022727 220.00 215.00 -0.027273 0.006818 0.006818 -0.033860 2.0 2 4102 \u6c38\u65e5 2007-05-28 2007-06-05 2007-05-25 2007-06-04 0.109485 6.0 24.0 30.0 -0.046053 15.20 14.50 -0.046053 0.006579 0.006579 -0.052288 2.0 3 9962 \u6709\u76ca 2007-05-08 2007-06-05 2007-05-07 2007-06-04 0.100000 20.0 10.0 30.0 -0.065507 48.85 45.65 -0.077789 0.000000 0.000000 -0.077789 0.0 4 3311 \u958e\u6689 2007-05-08 2007-06-13 2007-05-07 2007-06-12 0.100000 26.0 10.0 36.0 0.022508 155.50 159.00 -0.025723 0.048232 0.025723 -0.055215 16.0 In\u00a0[27]: Copied! <pre>import plotly.express as px\n\ntrade_record['profit_loss'] = trade_record['return'].apply(lambda s: 'profit' if s &gt; 0 else 'loss')\nwin_ratio = round(sum(trade_record['profit_loss'] == 'profit') / len(trade_record['profit_loss']) * 100, 2)\nreturn_mean = round(trade_record['return'].mean(), 2)\nfig = px.histogram(trade_record, x=\"return\", color=\"profit_loss\", title=f'profit_loss_hist - win_ratio: {win_ratio} %')\nfig.add_vline(x=return_mean, line_width=3, line_dash=\"dash\", line_color=\"green\",\n              annotation_position=\"top left\",\n              annotation_text=f'avg_return:{return_mean}', row=1, col=1)\n</pre> import plotly.express as px  trade_record['profit_loss'] = trade_record['return'].apply(lambda s: 'profit' if s &gt; 0 else 'loss') win_ratio = round(sum(trade_record['profit_loss'] == 'profit') / len(trade_record['profit_loss']) * 100, 2) return_mean = round(trade_record['return'].mean(), 2) fig = px.histogram(trade_record, x=\"return\", color=\"profit_loss\", title=f'profit_loss_hist - win_ratio: {win_ratio} %') fig.add_vline(x=return_mean, line_width=3, line_dash=\"dash\", line_color=\"green\",               annotation_position=\"top left\",               annotation_text=f'avg_return:{return_mean}', row=1, col=1) In\u00a0[\u00a0]: Copied! <pre>from finlab.analysis.liquidityAnalysis import LiquidityAnalysis\n\n# \u4ea4\u6613\u7d00\u9304\u9032\u51fa\u5834\u6210\u4ea4\u5f35\u6578\u5927\u65bc1000\u5f35\u7684\u6bd4\u4f8b, \u6210\u4ea4\u91d1\u984d\u5927\u65bc1000000\u5143\u7684\u6bd4\u4f8b\uff0c\u6aa2\u6e2c\u8cc7\u91d1\u90e8\u4f4d\u80c3\u7d0d\u91cf\nbacktest_report.run_analysis(LiquidityAnalysis(required_volume=100000, required_turnover=1000000))\n</pre> from finlab.analysis.liquidityAnalysis import LiquidityAnalysis  # \u4ea4\u6613\u7d00\u9304\u9032\u51fa\u5834\u6210\u4ea4\u5f35\u6578\u5927\u65bc1000\u5f35\u7684\u6bd4\u4f8b, \u6210\u4ea4\u91d1\u984d\u5927\u65bc1000000\u5143\u7684\u6bd4\u4f8b\uff0c\u6aa2\u6e2c\u8cc7\u91d1\u90e8\u4f4d\u80c3\u7d0d\u91cf backtest_report.run_analysis(LiquidityAnalysis(required_volume=100000, required_turnover=1000000)) In\u00a0[1]: Copied! <pre>backtest_report.get_stats()\n</pre> backtest_report.get_stats() In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('price:\u6536\u76e4\u50f9')\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')  \n\nsma20 = close.average(20)\nsma60 = close.average(60)\n\nentries = close &gt; sma20\nexits = close &lt; sma60\n\nposition = entries.hold_until(exits, nstocks_limit=10, rank=-pb, take_profit=0.4)\nsim(position, name='\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:pb_ma')\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('price:\u6536\u76e4\u50f9') pb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')    sma20 = close.average(20) sma60 = close.average(60)  entries = close &gt; sma20 exits = close &lt; sma60  position = entries.hold_until(exits, nstocks_limit=10, rank=-pb, take_profit=0.4) sim(position, name='\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:pb_ma')"},{"location":"tools/guide_for_beginners/#1","title":"1.\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/guide_for_beginners/#2","title":"2.\u53d6\u5f97\u8cc7\u6599\u00b6","text":""},{"location":"tools/guide_for_beginners/#2-1","title":"2-1.\u6642\u9593\u5e8f\u5217\u00b6","text":""},{"location":"tools/guide_for_beginners/#2-2","title":"2-2.\u975e\u6642\u9593\u5e8f\u5217\u00b6","text":""},{"location":"tools/guide_for_beginners/#3","title":"3.\u64b0\u5beb\u7b56\u7565\u00b6","text":""},{"location":"tools/guide_for_beginners/#3-1","title":"3-1.\u7b56\u7565\u689d\u4ef6\u00b6","text":"<p>\u50f9\u683c &gt; 20 \u65e5\u5747\u7dda\u5165\u5834, \u50f9\u683c &lt; 60 \u65e5\u5747\u7dda\u51fa\u5834\uff0c\u6700\u591a\u6301\u670910\u6a94\uff0c\u8d85\u904e 10 \u500b\u9032\u5834\u8a0a\u865f\uff0c\u5247\u4ee5\u80a1\u50f9\u6de8\u503c\u6bd4\u5c0f\u7684\u80a1\u7968\u512a\u5148\u9078\u5165\u3002</p>"},{"location":"tools/guide_for_beginners/#3-2hold_until-function","title":"3-2.hold_until function\u00b6","text":"<p>\u9019\u5927\u6982\u662f\u6240\u6709\u7b56\u7565\u64b0\u5beb\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u8a9e\u6cd5\u7cd6\uff0c\u4e0a\u8ff0\u8a9e\u6cd5\u4e2d entries \u70ba\u9032\u5834\u8a0a\u865f\uff0c\u800c exits \u662f\u51fa\u5834\u8a0a\u865f\u3002\u6240\u4ee5 entries.hold_until(exits) \uff0c\u5c31\u662f\u9032\u5834\u8a0a\u865f\u70ba True \u6642\uff0c\u8cb7\u5165\u4e26\u6301\u6709\u8a72\u6a94\u80a1\u7968\uff0c\u76f4\u5230\u51fa\u5834\u8a0a\u865f\u70ba True \u5247\u8ce3\u51fa\u3002</p> <p>\u6b64\u51fd\u5f0f\u6709\u5f88\u591a\u7d30\u90e8\u8a2d\u5b9a\uff0c\u53ef\u4ee5\u8b93\u4f60\u6700\u591a\u9078\u64c7 N \u6a94\u80a1\u7968\u505a\u8f2a\u52d5\u3002\u53e6\u5916\uff0c\u7576\u8d85\u904e N \u6a94\u9032\u5834\u8a0a\u865f\u767c\u751f\uff0c\u4e5f\u53ef\u4ee5\u6309\u7167\u5ba2\u5236\u5316\u7684\u6392\u5e8f\uff0c\u9078\u64c7\u512a\u5148\u9078\u5165\u7684\u80a1\u7968\u3002\u6700\u5f8c\uff0c\u53ef\u4ee5\u6301\u5916\u8a2d\u5b9a\u505c\u640d\u505c\u5229\uff0c\u4f86\u589e\u52a0\u51fa\u5834\u7684\u6642\u6a5f\u9ede\u3002\u4ee5\u4e0b\u662f hold_until \u7684\u53c3\u6578\u8aaa\u660e\uff1a</p> <ul> <li>exit (pd.Dataframe): \u51fa\u5834\u8a0a\u865f\u3002</li> <li>nstocks_limit (int): \u6301\u6709\u6a94\u6578\u4e0a\u9650\u3002</li> <li>stop_loss (float): \u505c\u640d\u57fa\u6e96\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0b\u8dcc 10% \u6642\u51fa\u5834\u3002</li> <li>take_profit (float): \u505c\u5229\u57fa\u6e96\u3002\u7bc4\u4f8b\uff1a0.1\uff0c\u4ee3\u8868\u6210\u672c\u50f9\u4e0a\u6f32 10% \u6642\u51fa\u5834\u3002</li> <li>trade_at (str): \u505c\u640d\u505c\u5229\u53c3\u8003\u50f9\u3002\u53ef\u9078 close \u6216 open\u3002</li> <li>rank (pd.Dataframe): \u7576\u5929\u9032\u5834\u8a0a\u865f\u8d85\u904e nstocks_limit \u6642\uff0c\u4ee5 rank \u6578\u5b57\u8d8a\u5927\u7684\u80a1\u7968\u512a\u5148\u9032\u5834\u3002</li> </ul>"},{"location":"tools/guide_for_beginners/#4","title":"4.\u56de\u6e2c\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-1","title":"4-1.\u986f\u793a\u7b56\u7565\u56de\u6e2c\u7d50\u679c\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-2","title":"4-2.\u53d6\u5f97\u5831\u916c\u7387\u5e8f\u5217\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-3","title":"4-3.\u53d6\u5f97\u8fd1\u671f\u6301\u6709\u90e8\u4f4d\u8207\u9810\u671f\u63db\u80a1\u8cc7\u8a0a\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-4","title":"4-4.\u53d6\u5f97\u4ea4\u6613\u7d00\u9304\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-4-1trade_record","title":"4-4-1.trade_record\u91cd\u9ede\u6b04\u4f4d\u8aaa\u660e\u00b6","text":"<ul> <li>exit_sig_date:\u9032\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>entry_sig_date:\u51fa\u5834\u8a0a\u865f\u7522\u751f\u65e5\u3002</li> <li>entry_date:\u9032\u5834\u65e5\u3002</li> <li>exit_date:\u51fa\u5834\u65e5\u3002</li> <li>period:\u6301\u6709\u5929\u6578\u3002</li> <li>position: \u6301\u6709\u4f54\u6bd4\u3002</li> <li>return:\u5831\u916c\u7387\u3002</li> <li>mdd:\u6301\u6709\u671f\u9593\u6700\u5927\u56de\u64a4\u3002</li> <li>mae:\u6301\u6709\u671f\u9593\u6700\u5927\u4e0d\u5229\u5e45\u5ea6\u3002</li> <li>g_mfe:\u6301\u6709\u671f\u9593\u6700\u5927\u6709\u5229\u5e45\u5ea6\u3002</li> <li>b_mfe:mae\u767c\u751f\u524d\u7684\u6700\u5927\u6709\u5229\u5e45\u5ea6\u3002</li> </ul>"},{"location":"tools/guide_for_beginners/#4-5-","title":"4-5.\u4ea4\u6613\u7d00\u9304\u61c9\u7528-\u7e6a\u88fd\u5831\u916c\u7387\u5206\u4f48\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-6","title":"4-6.\u7b56\u7565\u6d41\u52d5\u6027\u98a8\u96aa\u6aa2\u6e2c\u00b6","text":""},{"location":"tools/guide_for_beginners/#4-7","title":"4-7.\u53d6\u5f97\u7b56\u7565\u7d71\u8a08\u6307\u6a19\u00b6","text":"<p>\u53d6\u5f97\u6578\u64da\u5982\u590f\u666e\u7387\u3001\u7d22\u63d0\u8afe\u6bd4\u7387\u3001\u6700\u5927\u56de\u6a94\u3001\u8fd1\u671f\u5831\u916c\u7387\u7d71\u8a08...</p> <p>\u7b56\u7565\u6307\u6a19\u89e3\u6790:</p> <p>\u590f\u666e\u503c(sharpe_value)\u5c0f\u65bc\u96f6\uff0c\u4ee3\u8868\u8ce0\u9322\u7684\u610f\u601d\uff0c\u4ee5\u4e00\u500b\u7c21\u6613\u7684\u9078\u80a1\u7b56\u7565\u4f86\u8aaa\uff0c\u4e00\u822c\u4eba\u6ce2\u6bb5\u5be6\u55ae\u64cd\u4f5c\uff0c\u53ef\u80fd\u662f0.7\uff0c\u4ee5\u4e00\u500bETF\u4f86\u8aaa\uff0c\u53ef\u80fd 0.9 \u5c31\u5df2\u7d93\u5f88\u4e0d\u932f\u4e86\uff0c\u800c\u4ee5\u7db2\u8def\u4e0a\u4ed8\u8cbb\u9078\u80a1\u7b56\u7565 1.3 \u53ef\u80fd\u6703\u662f\u6bd4\u8f03\u7406\u60f3\u7684\u6578\u503c\uff0c\u7576\u7136\u4e5f\u6709\u771f\u7684\u5f88\u53b2\u5bb3\u7684\u9078\u80a1\u7b56\u7565\uff0cSharpe\u53ef\u4ee5\u5230 2 \u6216 3\u3002</p> <p>\u7372\u5229\u5cf0\u614b(kurt)\u662f\u8ddf\u4e00\u822c\u7684\u9ad8\u65af\u5206\u4f48\u505a\u6bd4\u8f03\uff0c\u6bd4\u9ad8\u65af\u5206\u4f48\u66f4\u5c16 kurt \u8d8a\u9ad8\uff0c\u901a\u5e38\u4ee3\u8868\u7b56\u7565\u7e3e\u6548\u8d8a\u7a69\u5b9a\uff0c\u800c\u4e00\u822c\u80a1\u7968\u800c\u8a00\u5927\u76e4\u7684kurt\u5927\u7d04\u5728 1~2 \u5de6\u53f3\uff0c\u5927\u65bc 2 \u57fa\u672c\u4e0a\u7b97\u662f\u52c9\u5f37\u582a\u7528\uff0c5\u4ee5\u4e0a\u5c31\u7b97\u9084\u4e0d\u932f\u3002\u504f\u614b\u7684\u8a71\u4e5f\u662f\u8ddf\u9ad8\u65af\u5206\u4f48\u6bd4\u8f03\uff0c\u8d8a\u504f\u5411\u53f3\u908a\u8d8a\u5c0f\uff0c\u901a\u5e38 -0.5 \u4ee5\u4e0b\u7b97\u662f\u52c9\u5f37\u582a\u7528\uff0c-1\u5de6\u53f3\u7b97\u662f\u9084\u4e0d\u932f</p>"},{"location":"tools/guide_for_beginners/#5-strategy","title":"5.\u4e0a\u50b3 strategy\u00b6","text":"<p>sim \u4e2d\u7684 \u53c3\u6578 upload \u9810\u8a2d\u70ba True\uff0c\u57f7\u884c\u5b8c\u56de\u6e2c\u5f8c\u6703\u5728\u5e73\u53f0\u7db2\u9801\u6a21\u986f\u793a\u9078\u80a1\u6e05\u55ae\u3002</p> <p>\u8907\u88fd\u4e0b\u5217cell\u7684\u7a0b\u5f0f\u78bc\uff0c\u8cbc\u5230 finlab \u91cf\u5316\u5e73\u53f0\uff0c\u624d\u53ef\u8a2d\u5b9a\u6bcf\u65e5\u81ea\u52d5\u66f4\u65b0\u7b56\u7565\u6e05\u55ae\u3002</p>"},{"location":"tools/important_info_search/","title":"\u91cd\u8a0a\u516c\u544a\u641c\u5c0b - \u696d\u5916\u640d\u5931","text":""},{"location":"tools/important_info_search/#_1","title":"\u8ca1\u5831\u696d\u5916\u8f49\u6295\u8cc7\u8667\u640d\u98a8\u96aa","text":"<p>\u53f0\u80a12022Q2\u5927\u8dcc\uff0c7-8\u6708\u6703\u958b\u59cb\u9678\u7e8c\u767c\u5e03Q2\u8ca1\u5831\uff0c\u8981\u6ce8\u610f\u6709\u4e9b\u559c\u6b61\u64cd\u4f5c\u77ed\u671f\u6295\u8cc7\u7684\u516c\u53f8\u82e5\u6709\u5728Q2\u91cd\u8a0a\u516c\u544a\u8655\u5206\u640d\u5931\uff0c\u8ca1\u5831\u5c07\u6703\u9762\u81e8\u696d\u5916\u8f49\u6295\u8cc7\u8667\u640d\u3002 \u53e6\u5916\u8f49\u6295\u8cc7\u6709\u50f9\u8b49\u5238\u4f54\u8cc7\u7522\u6bd4\u4f8b\u9ad8\u7684\u4e5f\u8981\u6ce8\u610f\u91d1\u878d\u8a55\u50f9\u640d\u5931\u7684\u98a8\u96aa\u3002\u7b49\u8ca1\u5831\u958b\u724c\u5df2\u7d93\u6162\u4e86\uff0c\u6709\u4e9b\u529f\u8ab2\u53ef\u4ee5\u63d0\u65e9\u505a\u3002</p> <p>FinLab\u8cc7\u6599\u5eab\u6709\u91cd\u8a0a\u7684\u6b77\u53f2\u8cc7\u6599\uff0c\u8abf\u8cc7\u6599\u770b\u770b\u54ea\u4e9b\u516c\u53f8Q2\u6709\u8655\u5206\u6709\u50f9\u8b49\u5238\u640d\u5931\u7684\u9a37\u64cd\u4f5c\u3002</p> <p>\u5b98\u65b9\u7684\u95dc\u9375\u5b57\u67e5\u8a62\u7cfb\u7d71\u4e0d\u597d\u7528\uff0c\u4e0a\u5e02\u6ac3\u88ab\u5206\u958b\uff0c\u9084\u662f\u81ea\u5df1\u7528\u7a0b\u5f0f\u641c\u5c0b\u6bd4\u8f03\u5feb\u3002</p>"},{"location":"tools/important_info_search/#pandas-contains","title":"pandas contains \u8a9e\u6cd5","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u7a0b\u5f0f\u78bc\uff0c\u7528pandas\u7684contains\u505a\u6a21\u7cca\u6bd4\u5c0d\uff0c\u627e\u51fa\u6a19\u984c\u8207\u5167\u5bb9\u542b\u6709\u95dc\u9375\u5b57\u7684\u91cd\u8a0a\u516c\u544a\u3002</p> <p><pre><code>from finlab import data\ninfo = data.get('important_info_announcement')\nreport = info[(info.index&gt;'2022-04') &amp; (info['title'].str.contains('\u8655\u5206')) &amp; (info['title'].str.contains('\u6709\u50f9\u8b49\u5238'))  &amp; (info['info'].str.contains('\u8655\u5206\u640d\u5931'))]\n</code></pre> \u7d50\u679c\u767c\u73fe1268\u6f22\u4f86\u7f8e\u98df\u7684\u554f\u984c\u6bd4\u5176\u4ed6\u5bb6\u5927\u689d\uff1a</p> <p>\u91cd\u8a0a\u516c\u544a</p> <p><pre><code>\u516c\u544a\u672c\u516c\u53f8\u4e00\u5e74\u5167\u7d2f\u7a4d\u8655\u5206\u540c\u4e00\u6709\u50f9\u8b49\u5238\u9054\u5be6\u6536\u8cc7\u672c\u984d20%\n1.\u8b49\u5238\u540d\u7a31:\n2603\u9577\u69ae\u6d77\u904b\u80a1\u4efd\u6709\u9650\u516c\u53f8\n2.\u4ea4\u6613\u65e5\u671f:111/6/29~111/7/1\n3.\u4ea4\u6613\u6578\u91cf\u3001\u6bcf\u55ae\u4f4d\u50f9\u683c\u53ca\u4ea4\u6613\u7e3d\u91d1\u984d:\n1,000,000\u80a1\uff1b\u65b0\u53f0\u5e6385.3\u5143~95\u5143\uff1b\u65b0\u53f0\u5e6392,814,600\u5143\n4.\u8655\u5206\u5229\u76ca\uff08\u6216\u640d\u5931\uff09\uff08\u53d6\u5f97\u6709\u50f9\u8b49\u5238\u8005\u4e0d\u9069\u7528\uff09:\n\u8655\u5206\u640d\u5931\u65b0\u53f0\u5e6334,601,955\u5143\n\u8fc4\u76ee\u524d\u70ba\u6b62\uff0c\u4f9d\u300c\u516c\u958b\u767c\u884c\u516c\u53f8\u53d6\u5f97\u6216\u8655\u5206\u8cc7\u7522\u8655\u7406\u6e96\u5247\u300d\u7b2c\u4e09\u689d\u6240\u5217\u4e4b\u6709\u50f9\u8b49\u5238\u6295\n\u8cc7\uff08\u542b\u672c\u6b21\u4ea4\u6613\uff09\u5360\u516c\u53f8\u6700\u8fd1\u671f\u8ca1\u52d9\u5831\u8868\u4e2d\u7e3d\u8cc7\u7522\u53ca\u6b78\u5c6c\u65bc\u6bcd\u516c\u53f8\u696d\u4e3b\u4e4b\u6b0a\u76ca\u4e4b\u6bd4\u4f8b\n\u66a8\u6700\u8fd1\u671f\u8ca1\u52d9\u5831\u8868\u4e2d\u71df\u904b\u8cc7\u91d1\u6578\u984d:\n\u5360\u7e3d\u8cc7\u7522\u6bd4\u4f8b\uff1a16.19%(\u542b\u5176\u4ed6\u6709\u50f9\u8b49\u5238\u6295\u8cc7)\n\u5360\u80a1\u6771\u6b0a\u76ca\u6bd4\u4f8b\uff1a37.09%(\u542b\u5176\u4ed6\u6709\u50f9\u8b49\u5238\u6295\u8cc7)\n\u71df\u904b\u8cc7\u91d1\uff1a770,504\u5343\u5143\n</code></pre> \u770b\u8d77\u4f86\u662f\u9910\u98f2\u696d\u4e0d\u666f\u6c23\uff0c\u60f3\u9760\u8f49\u6295\u8cc7\u7576\u6c34\u624b\u640f\u4e00\u628a\uff0c111/6/27~111/6/29\u5148\u516c\u544a\u5927\u8cb7\u9577\u69ae\uff0c\u7d50\u679c\u77ed\u77ed\u5e7e\u5929\u5c31\u505c\u640d\u51fa\u5834\uff0c\u640d\u5931\u4e863400\u842c\uff0c \u7528\u8cc7\u80a1\u65784272.37\u842c\u80a1\u4f86\u7b97\uff0c\u5f71\u97ffeps\u7d04 -0.8\uff0c\u672c\u696d\u5df2\u7d93\u5920\u6158\u4e86\uff0c\u73fe\u5728\u53c8\u591a\u4e00\u7b46\u696d\u5916\u8667\u640d\u3002 1268\u6f22\u4f86\u7f8e\u98df\u9019\u5247\u91cd\u8a0a\u4f86\u6709\u500b\u91cd\u9ede\u5728\u6709\u50f9\u8b49\u5238\u6295\u8cc7\u4f54\u80a1\u6771\u6b0a\u76ca\u592a\u9ad8\u4e86\uff0c\u9019\u6b21\u64cd\u4f5c\u9577\u69ae\u5c31\u9054\u5be6\u6536\u8cc7\u672c\u984d20%\uff0c\u98a8\u96aa\u5f88\u5927\u554a\uff01</p> <p>\u67e5\u4e00\u4e0b\u4ed6\u8f49\u6295\u8cc7\u660e\u7d30\uff0c\u4e0a\u5e02\u6ac3\u7684\u9084\u6709\u4e2d\u92fc\u3001\u5ee3\u9054\u3001\u74b0\u7403\u6676\u5713...\u6700\u8fd1\u90fd\u8dcc\u5230\u7206\u70b8\uff0c\u6301\u6709\u6210\u672c\u6709\u8208\u8da3\u7684\u4eba\u53ef\u4ee5\u53bb\u67e5\uff0c\u4e4b\u5f8c\u6709\u6c92\u6709\u8655\u5206\u640d\u5931\uff1f\u5c31\u7b97\u4e0d\u8ce3\uff0c Q2 \u8cc7\u7522\u8ca0\u50b5\u8868\u4e0b\u7684\"\u900f\u904e\u640d\u76ca\u6309\u516c\u5141\u50f9\u503c\u8861\u91cf\u4e4b\u91d1\u878d\u8cc7\u7522\u9019\u9805\u6b04\u4f4d\"\u7684\u6578\u5b57\u6e96\u5099\u96e3\u770b\u4e86\u3002 \u9664\u4e861268\u6f22\u4f86\u7f8e\u98df\uff0c\u6700\u8fd1\u4e5f\u6709\u4e00\u4e9b\u516c\u53f8\u505c\u640d\u53f0\u7a4d\u96fb\u3002</p> <p>\u9806\u9053\u67e5\u4e00\u4e0b\u4eca\u5e74\u54ea\u4e9b\u516c\u53f8\u6700\u8fd1\u4e5f\u5f88\u591a\u53f0\u80a1\u6709\u50f9\u8b49\u5238\u7684\u64cd\u4f5c\uff0c\u9664\u4e862323\u4e2d\u74b0\u6295\u9867 (\u5149\u789f\u672c\u696d\u4e0d\u592a\u884c\uff0c\u4e00\u5929\u5230\u665a\u767c\u80a1\u7968\u4ea4\u6613\u91cd\u8a0a) \uff0c 2704\u570b\u8cd3\u4e5f\u767c\u4f48\u591a\u6b21\uff0c\u548c1268\u6f22\u4f86\u7f8e\u98df\u4e00\u6a23\u90fd\u662f\u89c0\u5149\u696d\uff0c\u662f\u4e0d\u662f\u53c8\u4e00\u9846\u96f7\uff1f\u4e00\u67e5\u4e4b\u4e0b\u767c\u73fe\u662f\u8ce3\u6389\u6301\u80a1\u4e0d\u5c11\u7684\u4e2d\u4fe1\u91d1\uff0c\u5be6\u73fe\u7372\u5229\uff0c \u628a\u8cc7\u91d1\u8f49\u5230\u53f0\u7a4d\u96fb\u4e0a\uff0c\u76ee\u524d\u6210\u70ba574T\u5927\u5b78\u9577...\u77ed\u7dda\u4e5f\u8ce0\u8d85\u904e20%\u3002</p> <p>\u91cd\u8a0a\u516c\u544a</p> <p><pre><code>1.\u8b49\u5238\u540d\u7a31:\n\u53f0\u7a4d\u96fb \u666e\u901a\u80a1\n2.\u4ea4\u6613\u65e5\u671f:111/3/10~111/4/8\n3.\u4ea4\u6613\u6578\u91cf\u3001\u6bcf\u55ae\u4f4d\u50f9\u683c\u53ca\u4ea4\u6613\u7e3d\u91d1\u984d:\n\u4ea4\u6613\u6578\u91cf(\u80a1):540,000\u3001\u6bcf\u55ae\u4f4d\u50f9\u683c(\u5143):574.72\u3001\u4ea4\u6613\u7e3d\u91d1\u984d(\u5143):310,346,683\n</code></pre> \u9019\u4e9b\u672c\u696d\u6578\u64da\u504f\u5f31\u3001\u559c\u6b61\u5728\u8f49\u6295\u8cc7\u7422\u78e8\u7684\u516c\u53f8\u5728Q2\u8ca1\u5831\u5bb9\u6613\u5403\u5230\u82e6\u982d\uff0c\u6700\u597d\u5148\u907f\u958b\u96f7\u5305\uff0c\u6709\u4e9b\u71df\u6536\u6578\u5b57\u770b\u8d77\u4f86\u9084\u597d\uff0c\u4f46\u696d\u5916\u6295\u8cc7\u70b8\u5f48\u4e00\u7206\u5c31\u628a\u672c\u696d\u7372\u5229\u5403\u5149\u3002 -- \u53f0\u80a1\u5e02\u5834\u6709\u6642\u6c92\u6548\u7387\uff0c\u9019\u985e\u8655\u5206\u516c\u544a\u82e5\u662f\u4e2d\u5c0f\u578b\u51b7\u9580\u80a1\u6240\u767c\uff0c\u6295\u8cc7\u4eba\u5e38\u5728\u7576\u4e0b\u7121\u611f\uff0c\u5728\u8ca1\u5831\u767c\u4f48\u5f8c\u624d\u5f8c\u77e5\u5f8c\u89ba\uff0c\u6c92\u4ed4\u7d30\u767c\u73fe\u5148\u524d\u7684\u91cd\u8a0a\u65e9\u5c31\u958b\u724c\uff0c \u50cf\u662f\u53bb\u5e746523\u7684\u9054\u723e\u819a\uff0c2020\u5e74\u5e95\u5c31\u91cd\u8a0a\u516c\u544a\u8655\u5206\u4e2d\u570b\u5b50\u516c\u53f8\u80a1\u6b0a\u7684\u7372\u5229\uff0c\u53ef\u4ee5\u6709\u6642\u9593\u5728\u516c\u544a\u8ca1\u5831\u524d\u4f48\u5c40\uff0c\u4e4b\u5f8c\u8ca1\u5831\u548c\u80a1\u5229\u958b\u724c\uff0c\u72c2\u98c6\u4e00\u6ce2\u3002 \u9019\u53ef\u4e0d\u53ef\u4ee5\u8a2d\u8a08\u6210\u4e8b\u4ef6\u578b\u7b56\u7565\u7684SOP\u5462\uff1f\u6709\u8208\u8da3\u7684\u4eba\u53ef\u4ee5\u53c3\u8003\u4e00\u4e0b\u3002</p>"},{"location":"tools/ml_example/","title":"\u6a5f\u5668\u5b78\u7fd2\u7bc4\u4f8b\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin &gt; log.txt\n!pip install git+https://github.com/microsoft/qlib.git &gt; log.txt\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin &gt; log.txt !pip install git+https://github.com/microsoft/qlib.git &gt; log.txt In\u00a0[1]: Copied! <pre>from finlab import data\nfrom finlab.ml import feature as mlf\nfeatures = mlf.combine({\n  'pb': data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4'),\n  'pe': data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\n}, resample='W')\n\nfeatures.head()\n</pre> from finlab import data from finlab.ml import feature as mlf features = mlf.combine({   'pb': data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4'),   'pe': data.get('price_earning_ratio:\u672c\u76ca\u6bd4') }, resample='W')  features.head() Out[1]: pb pe datetime instrument 2010-01-10 1101 1.52 19.45 1102 1.47 14.92 1103 0.77 39.89 1104 0.90 71.60 1107 NaN NaN In\u00a0[5]: Copied! <pre>from finlab.ml import label as mll\n\nlabel = mll.return_percentage(features.index, resample='W', period=12)\n</pre> from finlab.ml import label as mll  label = mll.return_percentage(features.index, resample='W', period=12) In\u00a0[6]: Copied! <pre>import finlab.ml.qlib as q\n\nis_train = features.index.get_level_values('datetime') &lt; '2020-01-01'\n\nX_train, y_train = features[is_train], label[is_train]\nX_test = features[~is_train]\n\nmodel = q.XGBModel()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\n</pre> import finlab.ml.qlib as q  is_train = features.index.get_level_values('datetime') &lt; '2020-01-01'  X_train, y_train = features[is_train], label[is_train] X_test = features[~is_train]  model = q.XGBModel() model.fit(X_train, y_train) y_pred = model.predict(X_test) <pre>[929:MainThread](2024-04-02 15:11:21,936) INFO - qlib.timer - [log.py:127] - Time cost: 0.554s | Loading data Done\nINFO:qlib.timer:Time cost: 0.554s | Loading data Done\n[929:MainThread](2024-04-02 15:11:22,010) INFO - qlib.timer - [log.py:127] - Time cost: 0.039s | DropnaLabel Done\nINFO:qlib.timer:Time cost: 0.039s | DropnaLabel Done\n[929:MainThread](2024-04-02 15:11:23,366) INFO - qlib.timer - [log.py:127] - Time cost: 1.345s | CSZScoreNorm Done\nINFO:qlib.timer:Time cost: 1.345s | CSZScoreNorm Done\n[929:MainThread](2024-04-02 15:11:23,372) INFO - qlib.timer - [log.py:127] - Time cost: 1.429s | fit &amp; process data Done\nINFO:qlib.timer:Time cost: 1.429s | fit &amp; process data Done\n[929:MainThread](2024-04-02 15:11:23,379) INFO - qlib.timer - [log.py:127] - Time cost: 1.997s | Init data Done\nINFO:qlib.timer:Time cost: 1.997s | Init data Done\n/usr/local/lib/python3.10/dist-packages/xgboost/core.py:160: UserWarning: [15:11:23] WARNING: /workspace/src/learner.cc:742: \nParameters: { \"n_estimators\" } are not used.\n\n  warnings.warn(smsg, UserWarning)\n</pre> <pre>[0]\ttrain-rmse:0.99957\tvalid-rmse:0.99967\n[20]\ttrain-rmse:0.99827\tvalid-rmse:0.99963\n[40]\ttrain-rmse:0.99762\tvalid-rmse:0.99988\n[60]\ttrain-rmse:0.99731\tvalid-rmse:1.00019\n</pre> <pre>[929:MainThread](2024-04-02 15:11:30,023) INFO - qlib.timer - [log.py:127] - Time cost: 0.088s | Loading data Done\nINFO:qlib.timer:Time cost: 0.088s | Loading data Done\n[929:MainThread](2024-04-02 15:11:30,028) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | fit &amp; process data Done\nINFO:qlib.timer:Time cost: 0.000s | fit &amp; process data Done\n[929:MainThread](2024-04-02 15:11:30,033) INFO - qlib.timer - [log.py:127] - Time cost: 0.097s | Init data Done\nINFO:qlib.timer:Time cost: 0.097s | Init data Done\n</pre> In\u00a0[12]: Copied! <pre>from finlab.backtest import sim\n\nclose = data.get('price:\u6536\u76e4\u50f9')\n\nposition = y_pred[close &gt; close.average(60)].is_largest(10)\n\nsim(position, resample='Q')\n</pre> from finlab.backtest import sim  close = data.get('price:\u6536\u76e4\u50f9')  position = y_pred[close &gt; close.average(60)].is_largest(10)  sim(position, resample='Q') Out[12]: <pre>&lt;finlab.core.report.Report at 0x7d6181883340&gt;</pre>"},{"location":"tools/%E4%B9%96%E9%9B%A2%E7%8E%87%E5%92%8C%E8%B2%A1%E5%A0%B1%E6%BF%BE%E7%B6%B2/","title":"\u4e56\u96e2\u7387\u548c\u8ca1\u5831\u6ffe\u7db2","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n# \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\")\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\nposition = ((close / close.shift(60)).is_largest(30) &amp; (roe &gt; 0))\n\n# \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample=\"M\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  # \u4e0b\u8f09 ROE \u8ddf\u6536\u76e4\u50f9 roe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\") close = data.get(\"price:\u6536\u76e4\u50f9\") position = ((close / close.shift(60)).is_largest(30) &amp; (roe &gt; 0))  # \u56de\u6e2c\uff0c\u6bcf\u6708(M)\u8abf\u6574\u4e00\u6b21 report = sim(position, resample=\"M\", upload=False) report.display() <pre>INFO:finlab.data:fundamental_features:ROE\u7a05\u5f8c -- Daily data usage: 655.7 / 5000 MB\n</pre> <pre>1319    0.055556\n1522    0.055556\n1524    0.055556\n2305    0.055556\n2364    0.055556\n2482    0.055556\n2736    0.055556\n2929    0.055556\n2939    0.055556\n4543    0.055556\n5258    0.055556\n6113    0.055556\n6199    0.055556\n6472    0.055556\n6655    0.055556\n6715    0.055556\n8097    0.055556\n9802    0.055556\nName: 2022-07-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre>"},{"location":"tools/%E4%B9%96%E9%9B%A2%E7%8E%87%E5%92%8C%E8%B2%A1%E5%A0%B1%E6%BF%BE%E7%B6%B2/#1","title":"1.\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E4%B9%96%E9%9B%A2%E7%8E%87%E5%92%8C%E8%B2%A1%E5%A0%B1%E6%BF%BE%E7%B6%B2/#2","title":"2.\u4e56\u96e2\u7387\u548c\u8ca1\u5831\u6ffe\u7db2\u00b6","text":""},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/","title":"\u5982\u4f55\u5206\u6790\u56e0\u5b50","text":"In\u00a0[1]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nmarketcap = data.get('etl:market_value')\nrevenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\nprice = data.get('etl:adj_close')\n\ncond1 = marketcap.rank(pct=True, axis=1) &lt; 0.3\ncond2 = (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &gt; 0.7\ncond3 = (price / price.shift(20)).rank(pct=True, axis=1) &gt; 0.7\n\npos = cond1 &amp; cond2 &amp; cond3\n\nreport = sim(pos, resample='ME', upload=False)\nreport.creturn.plot()\n</pre> from finlab import data from finlab.backtest import sim  marketcap = data.get('etl:market_value') revenue = data.get('monthly_revenue:\u7576\u6708\u71df\u6536') price = data.get('etl:adj_close')  cond1 = marketcap.rank(pct=True, axis=1) &lt; 0.3 cond2 = (revenue.average(3) / revenue.average(12)).rank(pct=True, axis=1) &gt; 0.7 cond3 = (price / price.shift(20)).rank(pct=True, axis=1) &gt; 0.7  pos = cond1 &amp; cond2 &amp; cond3  report = sim(pos, resample='ME', upload=False) report.creturn.plot() <pre>Your version is 1.3.0, please install a newer version.\nUse \"pip install finlab==1.4.0\" to update the latest version.\n</pre> <pre>\u8acb\u5f9e https://ai.finlab.tw/api_token \u8907\u88fd\u9a57\u8b49\u78bc:\n\n\u8f38\u5165\u6210\u529f!\n\u4e4b\u5f8c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u81ea\u52d5\u767b\u5165\nimport finlab\nfinlab.login(\"YOUR API TOKEN\")\n</pre> Out[1]: <pre>&lt;Axes: xlabel='date'&gt;</pre> In\u00a0[2]: Copied! <pre>from finlab import data\nimport finlab.ml.feature as feature\nimport finlab.ml.label as label\n\nfeatures =  feature.combine({\n    'marketcap': cond1,\n    'revenue': cond2,\n    'momentum': cond3\n}, resample='ME')\n\n# \u8a08\u7b97\u672a\u4f86 1M \u7684\u6a19\u7c64\nlabels = label.excess_over_mean(index=features.index, resample='ME')\n\nfeatures.dropna().head()\n</pre> from finlab import data import finlab.ml.feature as feature import finlab.ml.label as label  features =  feature.combine({     'marketcap': cond1,     'revenue': cond2,     'momentum': cond3 }, resample='ME')  # \u8a08\u7b97\u672a\u4f86 1M \u7684\u6a19\u7c64 labels = label.excess_over_mean(index=features.index, resample='ME')  features.dropna().head() Out[2]: marketcap revenue momentum datetime instrument 2013-04-30 1101 False True True 1102 False True True 1103 False True False 1104 False True False 1108 False True False In\u00a0[3]: Copied! <pre>labels.dropna().head()\n</pre> labels.dropna().head() Out[3]: <pre>datetime    instrument\n2007-04-30  1101          0.042548\n            1102          0.081764\n            1103         -0.016863\n            1104         -0.047492\n            1108         -0.002247\ndtype: float64</pre> In\u00a0[\u00a0]: Copied! <pre>from finlab.tools.factor_analysis import calc_factor_return\nfrom finlab.plot import plot_line\n\nplot_line(calc_factor_return(features, labels).cumsum(), unit='.0%', title='Factor Cumulative Return')\n</pre> from finlab.tools.factor_analysis import calc_factor_return from finlab.plot import plot_line  plot_line(calc_factor_return(features, labels).cumsum(), unit='.0%', title='Factor Cumulative Return') Out[\u00a0]: <p>\u5716\u4e2d\uff0c\u53ef\u4ee5\u89c0\u5bdf\u6708\u71df\u6536\u56e0\u5b50\u6548\u679c\u986f\u8457\u6bd4\u8f03\u597d\uff0c\u4f46\u5e02\u503c\u56e0\u5b50\u6548\u679c\u8f03\u5dee\u3002</p> In\u00a0[8]: Copied! <pre>from finlab.tools.factor_analysis import calc_centrality\n\n\n\nplot_line(calc_centrality(calc_factor_return(features, labels), 12), title='Centrality')\n</pre> from finlab.tools.factor_analysis import calc_centrality    plot_line(calc_centrality(calc_factor_return(features, labels), 12), title='Centrality') <pre>Rolling Centrality: 148it [00:00, 733.93it/s]                        \n</pre> Out[8]: <p>\u4e0a\u5716\u4e2d\uff0c\u7576\u5e02\u503c\u56e0\u5b50\u76ee\u524d\u64c1\u64e0\u5ea6\u8f03\u4f4e\uff0c\u53ef\u4ee5\u63db\u4e00\u500b\u56e0\u5b50\uff0c\u8b93\u7b56\u7565\u66f4\u7a69\u5b9a\u3002</p> <p>\u53e6\u5916\uff0c\u4e5f\u53ef\u4ee5\u5bc6\u5207\u89c0\u5bdf\u5e02\u503c\u56e0\u5b50\uff0c\u7b49\u64c1\u64e0\u5ea6\u4e0a\u5347\u6642\uff0c\u99ac\u4e0a\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\u3002</p> In\u00a0[9]: Copied! <pre>from finlab.tools.factor_analysis import calc_shapley_values\n\n\nplot_line(calc_shapley_values(features, labels))\n</pre> from finlab.tools.factor_analysis import calc_shapley_values   plot_line(calc_shapley_values(features, labels)) <pre>WARNING\tfinlab.tools.factor_analysis:factor_analysis.py:calc_shapley_values()- Feature and label date indices do not match exactly\nCalculating Shapley values: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 7/7 [00:01&lt;00:00,  6.42it/s]\n</pre> Out[9]: In\u00a0[10]: Copied! <pre>from finlab.tools.factor_analysis import calc_ic\n\nfeatures =  feature.combine({\n    'marketcap': -marketcap, # \u5c0f\u5e02\u503c\n    'revenue': revenue.average(3) / revenue.average(12),\n    'momentum': price / price.shift(20)\n}, resample='ME')\n\nplot_line(calc_ic(features, labels, rank=True))\n</pre> from finlab.tools.factor_analysis import calc_ic  features =  feature.combine({     'marketcap': -marketcap, # \u5c0f\u5e02\u503c     'revenue': revenue.average(3) / revenue.average(12),     'momentum': price / price.shift(20) }, resample='ME')  plot_line(calc_ic(features, labels, rank=True)) Out[10]:"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/","title":"\u5982\u4f55\u5206\u6790\u56e0\u5b50\u00b6","text":"<p>\u7814\u7a76\u56e0\u5b50\u5206\u6790\uff0c\u589e\u6e1b\u4fee\u6539\u56e0\u5b50\uff0c\u4e0d\u518d\u9760\u611f\u89ba \u4ee5\u4e0b\u662f FinLab Package \u63d0\u4f9b\u7684\u56e0\u5b50\u5206\u6790\u6d41\u7a0b\uff1a</p> <pre><code>\u539f\u59cb\u6578\u64da\n    \u2502\n    \u251c\u2500\u2500\u2500 \u7279\u5fb5\u5de5\u7a0b \u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u7279\u5fb5 (Features)\n    \u2502\n    \u2514\u2500\u2500\u2500 \u6a19\u7c64\u5de5\u7a0b \u2500\u2500\u2500\u2500\u2192 \u8d85\u984d\u5831\u916c (Labels)\n                \u2502\n                \u251c\u2500\u2500\u2500 calc_factor_return() \u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u5831\u916c\n                \u2502      \u2502\n                |      \u2514\u2500\u2500 calc_centrality() \u2500\u2192 \u56e0\u5b50\u96c6\u4e2d\u5ea6\n                \u2502\n                \u251c\u2500\u2500\u2500 calc_shapley_values() \u2500\u2500\u2500\u2192 \u56e0\u5b50\u8ca2\u737b\u5ea6\n                \u2502\n                \u2514\u2500\u2500\u2500 calc_ic() \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 \u56e0\u5b50\u76f8\u95dc\u6027(IC)\n</code></pre> <ol> <li>\u5148\u7522\u751f\u7279\u5fb5\u8207\u6a19\u7c64(features, labels)\uff0c\u7279\u5fb5\u662f\u56e0\u5b50\uff0c\u6a19\u7c64\u662f\u80a1\u7968\u7684\u8d85\u984d\u5831\u916c</li> <li>\u8a08\u7b97\u56e0\u5b50\u5831\u916c: <code>calc_factor_return(features, labels)</code></li> <li>\u8a08\u7b97\u56e0\u5b50\u64c1\u64e0\u5ea6: <code>calc_centrality(factor_return, window)</code></li> <li>\u8a08\u7b97\u56e0\u5b50\u8ca2\u737b\u5ea6: <code>calc_shapley_values(features, labels)</code></li> <li>\u8a08\u7b97\u56e0\u5b50\u76f8\u95dc\u6027(IC): <code>calc_ic(features, labels)</code></li> <li>\u8a08\u7b97\u56e0\u5b50\u76f8\u95dc\u6027(RankIC): <code>calc_rank_ic(features, labels)</code></li> </ol>"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/","title":"\u7bc4\u4f8b\u7b56\u7565\u00b6","text":"<p>\u6b64\u7b56\u7565\u662f\u7531\u975e\u5e38\u57fa\u672c\u7684\u4e09\u500b\u56e0\u5b50\u7d44\u6210:</p> <ol> <li>\u5e02\u503c</li> <li>\u71df\u6536</li> <li>\u52d5\u80fd</li> </ol> <p>\u6211\u5011\u5148\u4f86\u770b\u6b64\u7b56\u7565\u7684\u7e3e\u6548:</p>"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/","title":"\u5206\u6790\u56e0\u5b50\uff0c\u5148\u7522\u751f\u7279\u5fb5\u8207\u6a19\u7c64\u00b6","text":""},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/#factor-return","title":"\u56e0\u5b50\u5831\u916c\uff08Factor Return\uff09\u4ecb\u7d39\u00b6","text":"<p>\u56e0\u5b50\u5831\u916c\uff08Factor Return\uff09\u662f\u8861\u91cf\u67d0\u56e0\u5b50\u5728\u4e00\u6bb5\u6642\u9593\u5167\u6240\u5e36\u4f86\u8d85\u984d\u5831\u916c\u7684\u6307\u6a19\uff0c\u5e38\u7528\u65bc\u8a55\u4f30\u56e0\u5b50\u7684\u6709\u6548\u6027\u8207\u6295\u8cc7\u50f9\u503c\u3002</p> <p>\u5728\u672c\u5206\u6790\u6d41\u7a0b\u4e2d\uff0c\u6703\u5148\u6839\u64da\u4e0d\u540c\u7684\u56e0\u5b50\uff08\u5982\u5e02\u503c\u3001\u71df\u6536\u6210\u9577\u3001\u52d5\u80fd\u7b49\uff09\u5efa\u7acb\u7279\u5fb5\uff0c\u4e26\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7684\u56e0\u5b50\u5831\u916c\u3002\u900f\u904e\u7d2f\u7a4d\u56e0\u5b50\u5831\u916c\u7684\u8d70\u52e2\uff0c\u53ef\u4ee5\u89c0\u5bdf\u8a72\u56e0\u5b50\u7684\u9577\u671f\u8868\u73fe\u8207\u7a69\u5b9a\u6027\uff0c\u9032\u4e00\u6b65\u4f5c\u70ba\u56e0\u5b50\u7be9\u9078\u8207\u7d44\u5408\u7684\u91cd\u8981\u4f9d\u64da\u3002</p> <p>\u4e0b\u65b9\u5c07\u4ee5\u5716\u8868\u65b9\u5f0f\u5c55\u793a\u5404\u56e0\u5b50\u7684\u7d2f\u7a4d\u5831\u916c\u8868\u73fe\u3002</p>"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/#factor-centrality","title":"\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Factor Centrality\uff09\u4ecb\u7d39\u00b6","text":"<p>\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Factor Centrality\uff09\uff0c\u662f\u7528\u4f86\u91cf\u5316\u300c\u5171\u540c\u6027\u300d\u7684\u6307\u6a19\u3002</p> <p>\u56e0\u5b50\u96c6\u4e2d\u5ea6\uff08Centrality\uff09\u5b9a\u7fa9\u5982\u4e0b\uff1a</p> <p>$$ \\text{Centrality}_i = \\frac{\\lambda_i}{ \\sum_{j=1}^{k}\\lambda_j} $$</p> <p>\u5176\u4e2d\uff0c$\\lambda_j$ \u70ba\u56e0\u5b50\u5c0d\u65bc\u7b2c\u4e00\u4e3b\u6210\u5206\u7684\u4f54\u6bd4\uff0c$k$ \u70ba\u56e0\u5b50\u7e3d\u6578\u3002</p> <p>\u6b64\u6307\u6a19\u53cd\u6620\u4e86\u56e0\u5b50\u5831\u916c\u7684\u5171\u540c\u6027\uff0c</p> <ul> <li>\u6578\u503c\u8d8a\u5927\u8868\u793a<ul> <li>\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\uff0c\u5728\u8fd1\u671f\u7e3e\u6548\u6bd4\u8f03\u597d\u3002</li> <li>\u96c6\u4e2d\u5ea6\u8d8a\u9ad8\uff0c\u8fd1\u800c\u589e\u52a0\u672a\u4f86\u56de\u6a94\u7684\u98a8\u96aa\uff0c\u9700\u5bc6\u5207\u89c0\u5bdf\u3002</li> </ul> </li> <li>\u6578\u503c\u8d8a\u5c0f\u8868\u793a<ul> <li>\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\uff0c\u5728\u8fd1\u671f\u7e3e\u6548\u8f03\u5dee\u3002</li> <li>\u96c6\u4e2d\u5ea6\u8d8a\u4f4e\uff0c\u672a\u4f86\u56de\u6a94\u7684\u98a8\u96aa\u8f03\u4f4e\u3002</li> <li>\u53ef\u4ee5\u5728\u56e0\u5b50\u64c1\u64e0\u5ea6\u8f03\u4f4e\u7684\u6642\u5019\uff0c\u5bc6\u5207\u89c0\u5bdf\uff0c\u7b49\u64c1\u64e0\u5ea6\u4e0a\u5347\u6642\uff0c\u99ac\u4e0a\u5229\u7528\u6b64\u56e0\u5b50\u9078\u80a1\u3002</li> </ul> </li> </ul>"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/#shapley-values","title":"Shapley Values\u00b6","text":"<p>Shapley Values \u662f\u4e00\u7a2e\u7528\u65bc\u91cf\u5316\u5404\u500b\u56e0\u5b50\u5c0d\u6295\u8cc7\u7d44\u5408\u5831\u916c\u7684\u8ca2\u737b\u5ea6\uff0c\u662f\u4e00\u7a2e\u516c\u5e73\u5206\u914d\u7684\u6578\u5b78\u65b9\u6cd5\u3002</p> <p>\u6211\u5011\u679a\u8209\u6240\u6709\u53ef\u80fd\u7684\u56e0\u5b50\u7d44\u5408\uff0c\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u7d44\u5408\u7684\u5831\u916c\uff0c\u4e26\u8a08\u7b97\u6bcf\u500b\u56e0\u5b50\u5c0d\u5831\u916c\u7684\u8ca2\u737b\u5ea6\u3002</p> <p>\u6211\u5011\u751a\u81f3\u53ef\u4ee5\u8a08\u7b97\u51fa\uff0c\u6bcf\u500b\u56e0\u5b50\u3001\u6bcf\u500b\u6642\u9593\u9ede\uff0c\u5c0d\u5831\u916c\u7684\u8ca2\u737b\u5ea6\u3002</p> <p>\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0cShapley Values \u7684\u8a08\u7b97\u6642\u9593\u8907\u96dc\u5ea6\u70ba $O(2^n)$\uff0c\u5176\u4e2d $n$ \u70ba\u56e0\u5b50\u500b\u6578\uff0c\u56e0\u6b64\u8a08\u7b97\u6642\u9593\u8f03\u9577\uff0c\u5728\u56e0\u5b50\u500b\u6578\u8f03\u591a\u6642\uff0c\u5efa\u8b70\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u3002</p>"},{"location":"tools/%E5%9B%A0%E5%AD%90%E6%93%81%E6%93%A0%E5%BA%A6%28%E8%B3%87%E7%94%A2%E9%9B%86%E4%B8%AD%E5%BA%A6%E5%88%86%E6%9E%90%29/#icinformation-coefficient","title":"\u56e0\u5b50 IC\uff08Information Coefficient\uff09\u4ecb\u7d39\u00b6","text":"<p>\u56e0\u5b50 IC\uff08Information Coefficient\uff09\u662f\u8861\u91cf\u56e0\u5b50\u9810\u6e2c\u80fd\u529b\u7684\u91cd\u8981\u6307\u6a19\uff0c\u5e38\u7528\u65bc\u8a55\u4f30\u56e0\u5b50\u8207\u672a\u4f86\u5831\u916c\u4e4b\u9593\u7684\u76f8\u95dc\u6027\u3002</p> <p>IC \u7684\u8a08\u7b97\u516c\u5f0f\u5982\u4e0b\uff1a</p> <p>$$ IC = \\text{corr}(\\text{Factor Score}, \\text{Future Return}) $$</p> <p>\u5176\u4e2d\uff0c$\\text{corr}$ \u8868\u793a\u76f8\u95dc\u4fc2\u6578\uff08\u901a\u5e38\u70ba\u76ae\u723e\u68ee\u76f8\u95dc\uff09\uff0c$\\text{Factor Score}$ \u70ba\u56e0\u5b50\u5206\u6578\uff0c$\\text{Future Return}$ \u70ba\u672a\u4f86\u4e00\u6bb5\u671f\u9593\u7684\u8cc7\u7522\u5831\u916c\u3002</p> <p>IC \u6578\u503c\u7bc4\u570d\u901a\u5e38\u5728 -1 \u5230 1 \u4e4b\u9593\uff1a</p> <ul> <li>IC \u8d8a\u63a5\u8fd1 1\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u6709\u5f88\u5f37\u7684\u6b63\u5411\u9810\u6e2c\u80fd\u529b\u3002</li> <li>IC \u8d8a\u63a5\u8fd1 -1\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u6709\u5f88\u5f37\u7684\u53cd\u5411\u9810\u6e2c\u80fd\u529b\u3002</li> <li>IC \u63a5\u8fd1 0\uff0c\u8868\u793a\u56e0\u5b50\u5c0d\u672a\u4f86\u5831\u916c\u5e7e\u4e4e\u6c92\u6709\u9810\u6e2c\u80fd\u529b\u3002</li> </ul> <p>\u5728\u91cf\u5316\u9078\u80a1\u4e2d\uff0cIC \u662f\u5224\u65b7\u56e0\u5b50\u6709\u6548\u6027\u7684\u91cd\u8981\u4f9d\u64da\uff0cIC \u8d8a\u9ad8\u7684\u56e0\u5b50\u901a\u5e38\u66f4\u503c\u5f97\u7d0d\u5165\u6295\u8cc7\u7d44\u5408\u3002</p>"},{"location":"tools/%E5%A4%9A%E7%A9%BA%E5%B0%8D%E6%B2%96/","title":"\u591a\u7a7a\u5c0d\u6c96","text":"In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[8]: Copied! <pre>from finlab import data\nfrom finlab import backtest\n\npb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')\n\n# \u80a1\u50f9\u6de8\u503c\u6bd4\u524d20%\u4f4e\nposition = pb &lt; pb.quantile_row(0.2)\n\nposition /= position.sum(axis=1)\n\n# \u591a\u55ae\u7e3d\u90e8\u4f4d70%\nposition *= 0.7\n\n# \u7a7a\u55ae\u7e3d\u90e8\u4f4d30%\nposition['0050'] = -0.3\n\nreport=backtest.sim( position, upload=False, resample='Q')\nreport.display()\n</pre> from finlab import data from finlab import backtest  pb = data.get('price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4')  # \u80a1\u50f9\u6de8\u503c\u6bd4\u524d20%\u4f4e position = pb &lt; pb.quantile_row(0.2)  position /= position.sum(axis=1)  # \u591a\u55ae\u7e3d\u90e8\u4f4d70% position *= 0.7  # \u7a7a\u55ae\u7e3d\u90e8\u4f4d30% position['0050'] = -0.3  report=backtest.sim( position, upload=False, resample='Q') report.display() <pre>WARNING:finlab.data:price_earning_ratio:\u80a1\u50f9\u6de8\u503c\u6bd4 -- Daily data usage: 251.8 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily data usage: 251.8 / 5000 MB\n</pre> <pre>1102    0.002023\n1103    0.002023\n1104    0.002023\n1108    0.002023\n1109    0.002023\n          ...   \n9929    0.002023\n9934    0.002023\n9944    0.002023\n9946    0.002023\n0050   -0.300000\nName: 2022-12-31 00:00:00, Length: 347, dtype: float64</pre> <pre>Timestamp('2022-12-31 00:00:00')</pre> In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E5%A4%9A%E7%A9%BA%E5%B0%8D%E6%B2%96/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E5%A4%9A%E7%A9%BA%E5%B0%8D%E6%B2%96/","title":"\u653e\u7a7a\u6307\u6578\u4fdd\u8b77\u591a\u55ae\u6301\u80a1\u00b6","text":"<p>\u64d4\u5fc3\u5927\u76e4\u6307\u6578\u4e0b\u8dcc\u5f71\u97ff\u9577\u62b1\u80a1\uff0c\u53c8\u4e0d\u60f3\u8ce3\u6389\u624b\u4e2d\u50f9\u503c\u80a1\u7684\u4fdd\u8b77\u65b9\u6cd5\u3002</p>"},{"location":"tools/%E5%A4%A7%E7%9B%A4%E6%8C%87%E6%A8%99%E6%BF%BE%E7%B6%B2/","title":"\u5927\u76e4\u6307\u6a19\u6ffe\u7db2","text":"In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[9]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport numpy as np\nimport pandas as pd\n\n\n# \u5e02\u5834\u591a\u7a7a\u6392\u5217\u5bb6\u6578\ndef ls_order_position(short=5,mid=10,long=30):\n    close = data.get(\"price:\u6536\u76e4\u50f9\")\n    short_ma = close.average(short)\n    mid_ma = close.average(mid)\n    long_ma = close.average(long)\n    long_order = (short_ma&gt;=mid_ma) &amp; (mid_ma&gt;=long_ma)\n    long_order = long_order.sum(1)\n    short_order = (short_ma&lt;mid_ma) &amp; (mid_ma&lt;long_ma)\n    short_order = short_order.sum(1)\n    entry = long_order &gt; short_order\n    cond = ~close.isna()\n    position = cond &amp; entry\n    return position\n\n\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\n\n# \u591a\u982d\u6392\u5217\nbuy = (close &gt; close.shift(20)) &amp; (close &gt; close.shift(60))\n\n# \u5957\u5165\u5927\u76e4\u6307\u6a19\nposition = buy &amp; ls_order_position()\nreport = sim(position, name=\"ls_order_position\",upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim import numpy as np import pandas as pd   # \u5e02\u5834\u591a\u7a7a\u6392\u5217\u5bb6\u6578 def ls_order_position(short=5,mid=10,long=30):     close = data.get(\"price:\u6536\u76e4\u50f9\")     short_ma = close.average(short)     mid_ma = close.average(mid)     long_ma = close.average(long)     long_order = (short_ma&gt;=mid_ma) &amp; (mid_ma&gt;=long_ma)     long_order = long_order.sum(1)     short_order = (short_ma short_order     cond = ~close.isna()     position = cond &amp; entry     return position   close = data.get(\"price:\u6536\u76e4\u50f9\")  # \u591a\u982d\u6392\u5217 buy = (close &gt; close.shift(20)) &amp; (close &gt; close.shift(60))  # \u5957\u5165\u5927\u76e4\u6307\u6a19 position = buy &amp; ls_order_position() report = sim(position, name=\"ls_order_position\",upload=False) report.display()  <pre>Series([], Name: 2022-09-19 00:00:00, dtype: float64)</pre> <pre>Timestamp('2022-09-19 00:00:00')</pre> In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E5%A4%A7%E7%9B%A4%E6%8C%87%E6%A8%99%E6%BF%BE%E7%B6%B2/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E5%A4%A7%E7%9B%A4%E6%8C%87%E6%A8%99%E6%BF%BE%E7%B6%B2/","title":"\u52a0\u5165\u5927\u76e4\u6307\u6a19\u6ffe\u7db2\u00b6","text":"<p>\u5927\u76e4\u6307\u6a19\u8f49\u7a7a\u6642\uff0c\u51fa\u6e05\u6301\u80a1</p>"},{"location":"tools/%E5%B0%8F%E8%B3%87%E6%97%8F%E5%84%AA%E7%AD%89%E7%94%9F/","title":"\u5c0f\u8cc7\u65cf\u512a\u7b49\u751f","text":"In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[2]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\u80a1\u672c = data.get('financial_statement:\u80a1\u672c')\nprice = data.get('price:\u6536\u76e4\u50f9')\n\u5e02\u503c = \u80a1\u672c * price / 10 * 1000\n\ndf1 = data.get('financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa')\ndf2 = data.get('financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa')\n\u81ea\u7531\u73fe\u91d1\u6d41 = (df1 + df2).rolling(4).mean()\n\n\u7a05\u5f8c\u6de8\u5229 = data.get('fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229')\n\u6b0a\u76ca\u7e3d\u8a08 = data.get('financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d')\n\u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 = \u7a05\u5f8c\u6de8\u5229/ \u6b0a\u76ca\u7e3d\u8a08\n\n\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')\n\n\u7576\u6708\u71df\u6536 = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')* 1000\n\u7576\u5b63\u71df\u6536 = \u7576\u6708\u71df\u6536.rolling(4).sum()\n\u5e02\u503c\u71df\u6536\u6bd4 = \u5e02\u503c / \u7576\u5b63\u71df\u6536\n\n\ncondition1 = (\u5e02\u503c &lt; 1e10)\ncondition2 = \u81ea\u7531\u73fe\u91d1\u6d41 &gt; 0\ncondition3 = \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 &gt; 0\ncondition4 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 0\ncondition5 = \u5e02\u503c\u71df\u6536\u6bd4 &lt; 5\n\nposition = condition1 &amp; condition2 &amp; condition3 &amp; condition4 &amp; condition5\nreport = sim(position, resample='M', name=\"\u512a\u7b49\u751f\u7b56\u7565\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  \u80a1\u672c = data.get('financial_statement:\u80a1\u672c') price = data.get('price:\u6536\u76e4\u50f9') \u5e02\u503c = \u80a1\u672c * price / 10 * 1000  df1 = data.get('financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa') df2 = data.get('financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa') \u81ea\u7531\u73fe\u91d1\u6d41 = (df1 + df2).rolling(4).mean()  \u7a05\u5f8c\u6de8\u5229 = data.get('fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229') \u6b0a\u76ca\u7e3d\u8a08 = data.get('financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d') \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 = \u7a05\u5f8c\u6de8\u5229/ \u6b0a\u76ca\u7e3d\u8a08  \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')  \u7576\u6708\u71df\u6536 = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')* 1000 \u7576\u5b63\u71df\u6536 = \u7576\u6708\u71df\u6536.rolling(4).sum() \u5e02\u503c\u71df\u6536\u6bd4 = \u5e02\u503c / \u7576\u5b63\u71df\u6536   condition1 = (\u5e02\u503c &lt; 1e10) condition2 = \u81ea\u7531\u73fe\u91d1\u6d41 &gt; 0 condition3 = \u80a1\u6771\u6b0a\u76ca\u5831\u916c\u7387 &gt; 0 condition4 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 0 condition5 = \u5e02\u503c\u71df\u6536\u6bd4 &lt; 5  position = condition1 &amp; condition2 &amp; condition3 &amp; condition4 &amp; condition5 report = sim(position, resample='M', name=\"\u512a\u7b49\u751f\u7b56\u7565\", upload=False) report.display() <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:financial_statement:\u80a1\u672c -- Daily data usage: 54.2 / 5000 MB\nWARNING:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 75.7 / 5000 MB\nWARNING:finlab.data:company_basic_info -- Daily data usage: 76.6 / 5000 MB\nWARNING:finlab.data:financial_statements_upload_detail:upload_date -- Daily data usage: 78.2 / 5000 MB\nWARNING:finlab.data:financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa -- Daily data usage: 79.6 / 5000 MB\nWARNING:finlab.data:financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa -- Daily data usage: 81.0 / 5000 MB\nWARNING:finlab.data:fundamental_features:\u7d93\u5e38\u7a05\u5f8c\u6de8\u5229 -- Daily data usage: 82.3 / 5000 MB\nWARNING:finlab.data:financial_statement:\u80a1\u6771\u6b0a\u76ca\u7e3d\u984d -- Daily data usage: 83.7 / 5000 MB\nWARNING:finlab.data:fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 -- Daily data usage: 85.2 / 5000 MB\nWARNING:finlab.data:monthly_revenue:\u7576\u6708\u71df\u6536 -- Daily data usage: 88.4 / 5000 MB\nWARNING:finlab.data:etl:adj_close -- Daily data usage: 116.8 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily data usage: 116.9 / 5000 MB\n</pre> <pre>stock_id\n1258    0.005464\n1259    0.005464\n1336    0.005464\n1413    0.005464\n1454    0.005464\n          ...   \n8930    0.005464\n9906    0.005464\n9924    0.005464\n9960    0.005464\n9962    0.005464\nName: 2022-10-31 00:00:00, Length: 183, dtype: float64</pre> <pre>Timestamp('2022-10-31 00:00:00')</pre>"},{"location":"tools/%E5%B0%8F%E8%B3%87%E6%97%8F%E5%84%AA%E7%AD%89%E7%94%9F/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E5%B0%8F%E8%B3%87%E6%97%8F%E5%84%AA%E7%AD%89%E7%94%9F/","title":"\u5c0f\u8cc7\u65cf\u512a\u7b49\u751f\u7b56\u7565\u00b6","text":"<p>\u4e0a\u904e HaHow \u4e0a FinLab Python \u5c0f\u8cc7\u65cf\u8ab2\u7a0b\u55ce\uff1f</p> <p>\u4e5f\u53ef\u4ee5\u628a\u8ab2\u7a0b\u7684\u5167\u5bb9\u6539\u5beb\u904e\u4f86\u5594\uff5e</p>"},{"location":"tools/%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99%E9%81%B8%E8%82%A1/","title":"\u6280\u8853\u6307\u6a19\u9078\u80a1","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin &gt; log.txt\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n# \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\nrsi = data.indicator('RSI', timeperiod=20)\nposition = rsi.is_largest(20)\n\n# \u56de\u6e2c\uff0c\u6bcf\u9031(W)\u8abf\u6574\u4e00\u6b21\nreport = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\", upload=False)\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim  # \u9078\u51fa RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968 rsi = data.indicator('RSI', timeperiod=20) position = rsi.is_largest(20)  # \u56de\u6e2c\uff0c\u6bcf\u9031(W)\u8abf\u6574\u4e00\u6b21 report = sim(position, resample='W', name=\"\u9ad8RSI\u7b56\u7565\", upload=False) report.display() <pre>00632R    0.05\n00643K    0.05\n00664R    0.05\n00674R    0.05\n00676R    0.05\n00686R    0.05\n020004    0.05\n020015    0.05\n02001R    0.05\n2364      0.05\n2936      0.05\n2939      0.05\n3205      0.05\n5102      0.05\n5904      0.05\n6655      0.05\n6796      0.05\n8234      0.05\n8427      0.05\n9188      0.05\nName: 2022-07-10 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-10 00:00:00')</pre>"},{"location":"tools/%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99%E9%81%B8%E8%82%A1/#1","title":"1.\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E6%8A%80%E8%A1%93%E6%8C%87%E6%A8%99%E9%81%B8%E8%82%A1/#2-rsi","title":"2.\u9ad8 RSI \u6280\u8853\u6307\u6a19\u7b56\u7565\u00b6","text":"<p>\u4e0a\u8ff0\u7b56\u7565\u6703\u9078\u51fa\u5f88\u591a\u6a94\u6a19\u7684\uff0c\u8981\u662f\u6211\u5011\u53ea\u60f3\u8981\u9078\u51fa 20 \u6a94\u8981\u600e\u9ebc\u5beb\u5462\uff1f\u9019\u500b\u7b56\u7565\u6211\u5011\u53ef\u4ee5\u5c07 RSI \u6700\u5927\u7684 20 \u6a94\u80a1\u7968\u7d0d\u5165\u7d44\u5408\uff0c\u4e26\u4e14\u6301\u6709\u4e00\u9031\uff0c\u4f86\u8a66\u8a66\u770b\u6548\u679c\u5982\u4f55\u3002\u6211\u5011\u53ef\u4ee5\u7528 data.indicator \u4f86\u8a08\u7b97\u6240\u6709\u80a1\u7968\u7684 RSI\uff0c\u4e5f\u53ef\u4ee5\u7528 rsi.is_largest \u4f86\u8a08\u7b97\u6b64\u80a1\u7968\u7684 RSI \u662f\u5426\u662f\u6700\u5927\u7684 20 \u6a94\u3002</p>"},{"location":"tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/","title":"\u672c\u76ca\u6210\u9577\u6bd4(\u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1)","text":"In\u00a0[3]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[4]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nrev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536')\nrev_ma3 = rev.average(3)\nrev_ma12 = rev.average(12)\n\n# \u71df\u6536\u8da8\u52e2\u591a\u982d\u7b56\u7565\ncond1 = rev_ma3/rev_ma12 &gt; 1.1\ncond2 = rev/rev.shift(1) &gt; 0.9\ncond_all = cond1 &amp; cond2\n\npe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4')\n\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')\n\n# \u672c\u76ca\u6210\u9577\u6bd4\npeg = (pe/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387)\n\n# \u672c\u76ca\u6210\u9577\u6bd4\u548c\u539f\u8a0a\u865f\u76f8\u4e58\uff0c\u82e5\u4e0d\u6301\u6709\u5247\u76f8\u4e58\u5f8c\u7b49\u65bc0\nposition = peg*(cond_all)\n\n# \u539f\u8a0a\u865f\u70ba0\u7684\u4e0d\u8981\u9078\uff0c\u82e5\u6c92\u52a0\u9019\u884c\u4e14\u7b56\u7565\u53ea\u9078\u52307\u6a94\uff0c\u4e4b\u5f8c\u9084\u662f\u6703\u90783\u6a94\u8a0a\u865f\u70ba0(\u4e0d\u6301\u6709)\u7684\u88dc\u8db310\u6a94\uff0c\u57f7\u884c\u9019\u884c\u5c31\u6703\u6392\u9664\u8a0a\u865f\u70ba0\u3002\nposition = position[position&gt;0]\n\n# \u9078\u80a1\u6311\u672c\u76ca\u6210\u9577\u6bd4\u524d10\u5c0f\u7684\nposition = position.is_smallest(10)\n</pre> from finlab import data from finlab.backtest import sim  rev = data.get('monthly_revenue:\u7576\u6708\u71df\u6536') rev_ma3 = rev.average(3) rev_ma12 = rev.average(12)  # \u71df\u6536\u8da8\u52e2\u591a\u982d\u7b56\u7565 cond1 = rev_ma3/rev_ma12 &gt; 1.1 cond2 = rev/rev.shift(1) &gt; 0.9 cond_all = cond1 &amp; cond2  pe = data.get('price_earning_ratio:\u672c\u76ca\u6bd4') \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = data.get('fundamental_features:\u71df\u696d\u5229\u76ca\u6210\u9577\u7387')  # \u672c\u76ca\u6210\u9577\u6bd4 peg = (pe/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387)  # \u672c\u76ca\u6210\u9577\u6bd4\u548c\u539f\u8a0a\u865f\u76f8\u4e58\uff0c\u82e5\u4e0d\u6301\u6709\u5247\u76f8\u4e58\u5f8c\u7b49\u65bc0 position = peg*(cond_all)  # \u539f\u8a0a\u865f\u70ba0\u7684\u4e0d\u8981\u9078\uff0c\u82e5\u6c92\u52a0\u9019\u884c\u4e14\u7b56\u7565\u53ea\u9078\u52307\u6a94\uff0c\u4e4b\u5f8c\u9084\u662f\u6703\u90783\u6a94\u8a0a\u865f\u70ba0(\u4e0d\u6301\u6709)\u7684\u88dc\u8db310\u6a94\uff0c\u57f7\u884c\u9019\u884c\u5c31\u6703\u6392\u9664\u8a0a\u865f\u70ba0\u3002 position = position[position&gt;0]  # \u9078\u80a1\u6311\u672c\u76ca\u6210\u9577\u6bd4\u524d10\u5c0f\u7684 position = position.is_smallest(10) In\u00a0[5]: Copied! <pre># \u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1\nposition = position.reindex(rev.index_str_to_date().index, method='ffill')\n\nreport = sim(position=position, name=\"\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:peg_rev\", stop_loss=0.1, upload=False)\nreport.display()\n</pre> # \u6708\u71df\u6536\u622a\u6b62\u65e5\u63db\u80a1 position = position.reindex(rev.index_str_to_date().index, method='ffill')  report = sim(position=position, name=\"\u7b56\u7565\u6559\u5b78\u7bc4\u4f8b:peg_rev\", stop_loss=0.1, upload=False) report.display() <pre>1451    0.1\n1475    0.1\n1584    0.1\n2612    0.1\n2641    0.1\n2702    0.1\n3706    0.1\n5432    0.1\n6199    0.1\n9906    0.1\nName: 2022-08-10 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-08-10 00:00:00')</pre>"},{"location":"tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/#1","title":"1.\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/#2","title":"2.\u672c\u76ca\u6210\u9577\u6bd4\u7b56\u7565\u00b6","text":"<p>PEG\u7b56\u7565\u6559\u5b78</p>"},{"location":"tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/#3","title":"3.\u6708\u71df\u6536\u516c\u544a\u622a\u6b62\u65e5\u63db\u80a1\u00b6","text":"<p>position\u7684dataframe\u7528\u71df\u6536\u7684index\uff0c\u4e0d\u8981\u7528\u6536\u76e4\u50f9\u7684index\u3002</p>"},{"location":"tools/%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94/#note","title":"note:\u00b6","text":"<p>position\u52a0\u4e0areindex\u6708\u71df\u6536\u7684\u65e5\u671f\u7d22\u5f15\uff0c\u5f8c\u6703\u8b93position\u65e5\u671f\u8b8a\u6210\u6bcf\u6708\u71df\u6536\u622a\u6b62\u65e5\u3002</p> <p>resample\u4e0d\u9808\u53e6\u5916\u8a2d\u5b9a\uff0c\u4f7f\u7528\u9810\u8a2d\"None\"\uff0c\u4e0d\u57f7\u884c\u518d\u5e73\u8861\u3002position\u60f3\u6210\u662f\u6bcf\u5217\u800c\u4e0d\u662f\u6bcf\u65e5\uff0c\u56e0\u70ba\u4f7f\u7528reindex\u8b93\u6bcf\u5217\u9593\u9694\u4e00\u500b\u6708\uff0c\u6240\u4ee5\u57f7\u884c\u4e0a\u662f\u9694\u4e00\u500b\u6708\u7522\u751f\u63db\u80a1\u8a0a\u865f\u3002</p>"},{"location":"tools/%E7%87%9F%E5%BB%BA%E7%94%A2%E6%A5%AD%E5%B0%88%E7%94%A8%E6%8C%87%E6%A8%99/","title":"\u71df\u5efa\u7522\u696d\u5c08\u7528\u6307\u6a19","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin &gt; log.txt\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport pandas as pd\n\n# \u9650\u5b9a\u56de\u6e2c\u7522\u696d\u7bc4\u570d\nwith data.universe(category='\u5efa\u6750\u71df\u9020'):\n\n    # \u8cc7\u6599\u5f15\u5165\n    close = data.get('price:\u6536\u76e4\u50f9')\n    contract_debt = data.get('financial_statement:\u5408\u7d04\u8ca0\u50b5_\u6d41\u52d5')\n    contract_debt_gr = (contract_debt/(contract_debt.shift())-1)\n    equity = data.get('financial_statement:\u80a1\u672c')\n\n    # \u8a08\u7b97\u5408\u7d04\u8ca0\u50b5\u4f54\u80a1\u672c\u7684\u6bd4\u7387\uff0c\u6bd4\u7387\u8d8a\u9ad8\u4ee3\u8868\u672a\u4f86\u6f5b\u5728\u8ca2\u737b\u6bcf\u80a1\u71df\u6536\u8d8a\u9ad8\n    ce_ratio = (contract_debt / equity)\n\n    # \u9078\u80a1\u689d\u4ef6\n    cond1 = ce_ratio &gt; 0.5\n    cond2 = (contract_debt_gr &gt; 0.05) &amp; (contract_debt_gr&lt;0.5)\n    cond_all = cond1 &amp; cond2\n\n    result = ce_ratio * cond_all\n    position = result[result &gt; 0].is_largest(5)\n    \n    # position_limit \u9650\u5b9a\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u670930%\u90e8\u4f4d\uff0c\u907f\u514d\u6a19\u7684\u6578\u904e\u5c11\u6642\u7522\u751f\u91cd\u58d3\u7684\u975e\u7cfb\u7d71\u6027\u98a8\u96aa\n    report = sim(position,resample='M',position_limit=0.3,stop_loss=0.1,fee_ratio=1.425/1000*0.3,name=\"\u71df\u5efa\u80a1\u5408\u7d04\u8ca0\u50b5\u7b56\u7565\",upload=False)\n\nreport.display()\n</pre> from finlab import data from finlab.backtest import sim import pandas as pd  # \u9650\u5b9a\u56de\u6e2c\u7522\u696d\u7bc4\u570d with data.universe(category='\u5efa\u6750\u71df\u9020'):      # \u8cc7\u6599\u5f15\u5165     close = data.get('price:\u6536\u76e4\u50f9')     contract_debt = data.get('financial_statement:\u5408\u7d04\u8ca0\u50b5_\u6d41\u52d5')     contract_debt_gr = (contract_debt/(contract_debt.shift())-1)     equity = data.get('financial_statement:\u80a1\u672c')      # \u8a08\u7b97\u5408\u7d04\u8ca0\u50b5\u4f54\u80a1\u672c\u7684\u6bd4\u7387\uff0c\u6bd4\u7387\u8d8a\u9ad8\u4ee3\u8868\u672a\u4f86\u6f5b\u5728\u8ca2\u737b\u6bcf\u80a1\u71df\u6536\u8d8a\u9ad8     ce_ratio = (contract_debt / equity)      # \u9078\u80a1\u689d\u4ef6     cond1 = ce_ratio &gt; 0.5     cond2 = (contract_debt_gr &gt; 0.05) &amp; (contract_debt_gr&lt;0.5)     cond_all = cond1 &amp; cond2      result = ce_ratio * cond_all     position = result[result &gt; 0].is_largest(5)          # position_limit \u9650\u5b9a\u55ae\u6a94\u6a19\u7684\u6700\u591a\u6301\u670930%\u90e8\u4f4d\uff0c\u907f\u514d\u6a19\u7684\u6578\u904e\u5c11\u6642\u7522\u751f\u91cd\u58d3\u7684\u975e\u7cfb\u7d71\u6027\u98a8\u96aa     report = sim(position,resample='M',position_limit=0.3,stop_loss=0.1,fee_ratio=1.425/1000*0.3,name=\"\u71df\u5efa\u80a1\u5408\u7d04\u8ca0\u50b5\u7b56\u7565\",upload=False)  report.display() <pre>stock_id\n2540    0.2\n2548    0.2\n3056    0.2\n5213    0.2\n6186    0.2\nName: 2022-05-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-05-31 00:00:00')</pre>"},{"location":"tools/%E7%87%9F%E5%BB%BA%E7%94%A2%E6%A5%AD%E5%B0%88%E7%94%A8%E6%8C%87%E6%A8%99/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E7%87%9F%E5%BB%BA%E7%94%A2%E6%A5%AD%E5%B0%88%E7%94%A8%E6%8C%87%E6%A8%99/","title":"\u71df\u5efa\u7522\u696d\u9650\u5b9a\u7b56\u7565\u00b6","text":"<p>\u904b\u7528\u71df\u5efa\u80a1\"\u5408\u7d04\u8ca0\u50b5\"\u7684\u7279\u6027\u9032\u884c\u9650\u5b9a\u7522\u696d\u9078\u80a1\u3002</p> <p>\u8a73\u7d30\u6587\u7ae0\u5167\u5bb9</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E4%BD%8E%E5%83%B9%E8%82%A1%E4%BD%8E%E6%B3%A2%E5%8B%95%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u4f4e\u50f9\u80a1\u4f4e\u6ce2\u52d5\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>%%capture\n!pip install finlab\n</pre> %%capture !pip install finlab In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('us_price:close')\nhigh = data.get('us_price:high')\nlow = data.get('us_price:low')\nvol =  data.get('us_price:volume')\nmarketcap = data.get('us_daily_metrics:marketcap')\n\n\n# \u6536\u76e4\u50f9\u8fd15\u65e5\u81f3\u5c11\u67091\u65e5\u5275\u6536\u76e4\u50f9\u8fd1100\u65e5\u5275\u65b0\ncondition1 = (close == close.rolling(100).max()).sustain(5,1)\n# \u8fd160\u65e5\u80a1\u50f9\u9ad8\u4f4e\u5340\u9593\u572825%\u5167\ncondition2 = (1 - low.rolling(60).min()/high.rolling(60).max()) &lt; 0.25\n# \u6536\u76e4\u50f9\u4f4e\u65bc\u6574\u9ad4\u5e02\u5834\u5206\u7d1a\u768450%\ncondition3 = close &lt;= close.quantile_row(0.5)\n# \u6210\u4ea4\u5747\u91cf\u4e0d\u80fd\u592a\u4f4e\ncondition4 = vol.average(10) &gt; 10000\n\nposition = condition1 &amp; condition2 &amp; condition3 &amp; condition4\nposition *= vol\nposition = position[position &gt; 0].is_smallest(10)\n\nreport = sim(position, resample=\"2w\", fee_ratio=0, tax_ratio=0, position_limit=0.1, stop_loss=0.05, name=\"\u7f8e\u80a1\u4f4e\u50f9\u80a1\u4f4e\u6ce2\u52d5\u7b56\u7565\")\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('us_price:close') high = data.get('us_price:high') low = data.get('us_price:low') vol =  data.get('us_price:volume') marketcap = data.get('us_daily_metrics:marketcap')   # \u6536\u76e4\u50f9\u8fd15\u65e5\u81f3\u5c11\u67091\u65e5\u5275\u6536\u76e4\u50f9\u8fd1100\u65e5\u5275\u65b0 condition1 = (close == close.rolling(100).max()).sustain(5,1) # \u8fd160\u65e5\u80a1\u50f9\u9ad8\u4f4e\u5340\u9593\u572825%\u5167 condition2 = (1 - low.rolling(60).min()/high.rolling(60).max()) &lt; 0.25 # \u6536\u76e4\u50f9\u4f4e\u65bc\u6574\u9ad4\u5e02\u5834\u5206\u7d1a\u768450% condition3 = close &lt;= close.quantile_row(0.5) # \u6210\u4ea4\u5747\u91cf\u4e0d\u80fd\u592a\u4f4e condition4 = vol.average(10) &gt; 10000  position = condition1 &amp; condition2 &amp; condition3 &amp; condition4 position *= vol position = position[position &gt; 0].is_smallest(10)  report = sim(position, resample=\"2w\", fee_ratio=0, tax_ratio=0, position_limit=0.1, stop_loss=0.05, name=\"\u7f8e\u80a1\u4f4e\u50f9\u80a1\u4f4e\u6ce2\u52d5\u7b56\u7565\") # report.display() <pre>/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 10.96% 0.81 -14.34% 55.0% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id CSLM CONSILIUM ACQUISITION CORP I LTD 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.000000 10.47 NaN -0.000955 0.000000 0.000000 -0.000955 0.0 0.1 0.0 ENTF ENTERPRISE 40 TECHNOLOGY ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.000943 10.61 NaN 0.000000 0.000943 0.000000 0.000000 4.0 0.1 0.0 FNVT FINNOVATE ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.003791 10.55 10.590 0.000000 0.003791 0.000000 0.000000 3.0 0.1 0.0 GFGD GROWTH FOR GOOD ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.001448 10.36 10.375 0.000000 0.002896 0.000000 -0.001444 4.0 0.1 0.0 IOAC INNOVATIVE INTERNATIONAL ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 -0.012739 10.99 10.850 -0.012739 0.054595 0.054595 -0.063848 2.0 0.1 0.0 IVCP SWIFTMERGE ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.006744 10.38 10.450 -0.015414 0.008671 0.008671 -0.023878 2.0 0.1 0.0 MCAC MONTEREY CAPITAL ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.000000 10.41 NaN 0.000000 0.000000 0.000000 0.000000 0.0 0.1 0.0 PUCK GOAL ACQUISITIONS CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 0.002913 10.30 10.330 0.000000 0.002913 0.000000 0.000000 1.0 0.1 0.0 SCAQ STRATIM CLOUD ACQUISITION CORP 2023-06-05 NaT 2023-06-02 NaT 0.1 5.0 1615.0 -1.0 0.001946 10.28 10.300 0.000000 0.001946 0.000000 0.000000 3.0 0.1 0.1 TLGA TLG ACQUISITION ONE CORP 2023-05-22 NaT 2023-05-19 2023-06-18 0.1 14.0 1606.0 -1.0 0.000000 10.52 10.520 -0.019011 0.000000 0.000000 -0.019011 0.0 0.1 0.0 ALPA ALPHA HEALTHCARE ACQUISITION CORP III NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 ANZU ANZU SPECIAL ACQUISITION CORP I NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 AOGO AROGO CAPITAL ACQUISITION CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 BMAC BLACK MOUNTAIN ACQUISITION CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 CORS CORSAIR PARTNERING CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 FRBN FORBION EUROPEAN ACQUISITION CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 ICNC ICONIC SPORTS ACQUISITION CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 SLVR SILVERSPAC INC NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 TRTL TORTOISEECOFIN ACQUISITION CORP III NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 In\u00a0[\u00a0]: Copied! <pre>position['GMFIU'].tail(10)\n</pre> position['GMFIU'].tail(10) Out[\u00a0]: <pre>date\n2023-05-26    False\n2023-05-30    False\n2023-05-31    False\n2023-06-01    False\n2023-06-02     True\n2023-06-05    False\n2023-06-06    False\n2023-06-07    False\n2023-06-08    False\n2023-06-09    False\nName: GMFIU, dtype: bool</pre> In\u00a0[\u00a0]: Copied! <pre>vol['GMFIU'].tail(10)\n</pre> vol['GMFIU'].tail(10) Out[\u00a0]: <pre>date\n2023-05-26      0.0\n2023-05-30      0.0\n2023-05-31      1.0\n2023-06-01      0.0\n2023-06-02    125.0\n2023-06-05      NaN\n2023-06-06      NaN\n2023-06-07      NaN\n2023-06-08      NaN\n2023-06-09      NaN\nName: GMFIU, dtype: float64</pre> In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E4%BD%8E%E5%83%B9%E8%82%A1%E4%BD%8E%E6%B3%A2%E5%8B%95%E7%AD%96%E7%95%A5/","title":"\u4f4e\u6ce2\u52d5\u56e0\u5b50\u00b6","text":"<p>\u4ee5\u80a1\u50f9\u9ad8\u4f4e\u5340\u9593\u8a08\u7b97\u6ce2\u52d5\u7387\uff0c\u627e\u51fa\u4f4e\u6ce2\u52d5\u3001\u5275\u65b0\u9ad8\u7684\u80a1\u7968\u3002</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E4%BD%8E%E8%82%A1%E5%83%B9%E6%B7%A8%E5%80%BC%E6%AF%94%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u4f4e\u80a1\u50f9\u6de8\u503c\u6bd4\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>%%capture\n!pip install finlab\n</pre> %%capture !pip install finlab In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\n\u6536\u76e4\u50f9 = data.get('us_price:close')\n\u80a1\u50f9\u6de8\u503c\u6bd4 = data.get('us_daily_metrics:pb')\n\n# \u689d\u4ef6 1\n\u6536\u76e4\u50f9\u5927\u65bc\u4e94 = \u6536\u76e4\u50f9 &gt; 5\n\n# \u689d\u4ef6 2\n\u5b63\u7dda = \u6536\u76e4\u50f9.rolling(60).mean()\n\u6536\u76e4\u50f9\u5728\u5b63\u7dda\u4e4b\u4e0a = \u6536\u76e4\u50f9 &gt; \u5b63\u7dda\n\n# \u689d\u4ef6 3\n\u7e3d\u689d\u4ef6 = (\u6536\u76e4\u50f9 * \u80a1\u50f9\u6de8\u503c\u6bd4)[\u6536\u76e4\u50f9\u5927\u65bc\u4e94&amp;\u6536\u76e4\u50f9\u5728\u5b63\u7dda\u4e4b\u4e0a].is_smallest(20)\n\n\nreport = sim(\u7e3d\u689d\u4ef6, resample='Q', fee_ratio=0, tax_ratio=0, live_performance_start='2019-01-01', name='\u7f8e\u80a1\u4f4e\u80a1\u50f9\u6de8\u503c\u6bd4')\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim   \u6536\u76e4\u50f9 = data.get('us_price:close') \u80a1\u50f9\u6de8\u503c\u6bd4 = data.get('us_daily_metrics:pb')  # \u689d\u4ef6 1 \u6536\u76e4\u50f9\u5927\u65bc\u4e94 = \u6536\u76e4\u50f9 &gt; 5  # \u689d\u4ef6 2 \u5b63\u7dda = \u6536\u76e4\u50f9.rolling(60).mean() \u6536\u76e4\u50f9\u5728\u5b63\u7dda\u4e4b\u4e0a = \u6536\u76e4\u50f9 &gt; \u5b63\u7dda  # \u689d\u4ef6 3 \u7e3d\u689d\u4ef6 = (\u6536\u76e4\u50f9 * \u80a1\u50f9\u6de8\u503c\u6bd4)[\u6536\u76e4\u50f9\u5927\u65bc\u4e94&amp;\u6536\u76e4\u50f9\u5728\u5b63\u7dda\u4e4b\u4e0a].is_smallest(20)   report = sim(\u7e3d\u689d\u4ef6, resample='Q', fee_ratio=0, tax_ratio=0, live_performance_start='2019-01-01', name='\u7f8e\u80a1\u4f4e\u80a1\u50f9\u6de8\u503c\u6bd4') # report.display() <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:us_price:close -- Daily usage: 1104.2 / 5000 MB\nWARNING:finlab.data:us_daily_metrics:pb -- Daily usage: 1164.6 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily usage: 1207.9 / 5000 MB\nWARNING:finlab.data:us_tickers -- Daily usage: 1213.3 / 5000 MB\nWARNING:finlab.data:us_price:adj_close -- Daily usage: 1255.0 / 5000 MB\nWARNING:finlab.data:world_index:adj_close -- Daily usage: 1256.7 / 5000 MB\n/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 13.72% 0.55 -38.88% 53.7% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id ABC AMERISOURCEBERGEN CORP 2023-01-03 NaT 2022-12-30 2023-06-30 0.05 110.0 1510.0 -1.0 0.084789 164.290 178.220 -0.096902 0.084789 0.028425 -0.121863 54.0 0.05 0.00 AON AON PLC 2023-01-03 NaT 2022-12-30 2023-06-30 0.05 110.0 1510.0 -1.0 0.049763 299.420 314.320 -0.045321 0.122737 0.088738 -0.123133 102.0 0.05 0.00 AZO AUTOZONE INC 2023-01-03 NaT 2022-12-30 2023-06-30 0.05 110.0 1510.0 -1.0 -0.027918 2431.060 2363.190 -0.051175 0.124468 0.124468 -0.156201 67.0 0.05 0.00 CTGO CONTANGO ORE INC 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 0.108765 28.410 31.500 -0.119676 0.151003 0.094685 -0.195820 35.0 0.05 0.00 FICO FAIR ISAAC CORP 2023-01-03 NaT 2022-12-30 NaT 0.05 110.0 1510.0 -1.0 0.310425 591.190 774.710 -0.009016 0.341768 0.030193 -0.071310 108.0 0.05 0.05 FTNT FORTINET INC 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 0.025637 66.310 68.010 -0.087770 0.074800 0.031368 -0.115514 33.0 0.05 0.00 GDNR GARDINER HEALTHCARE ACQUISITIONS CORP 2022-07-01 NaT 2022-06-30 2023-06-30 0.05 237.0 1383.0 -1.0 0.077543 9.930 10.700 0.000000 0.082578 0.000000 -0.011268 232.0 0.05 0.00 HCA HCA HEALTHCARE INC 2023-01-03 NaT 2022-12-30 NaT 0.05 110.0 1510.0 -1.0 0.117512 243.210 271.790 0.000000 0.181407 0.000000 -0.080883 109.0 0.05 0.05 HUDA HUDSON ACQUISITION I CORP 2023-04-03 NaT 2023-03-31 NaT 0.05 48.0 1572.0 -1.0 0.008309 10.230 10.315 -0.001955 0.008309 0.000000 -0.001955 43.0 0.05 0.05 MCD MCDONALDS CORP 2023-04-03 NaT 2023-03-31 NaT 0.05 48.0 1572.0 -1.0 0.016481 282.140 286.790 -0.000851 0.056461 0.056461 -0.054249 45.0 0.05 0.05 MPRA MERCATO PARTNERS ACQUISITION CORP 2023-01-03 NaT 2022-12-30 2023-06-30 0.05 110.0 1510.0 -1.0 0.028348 10.230 NaN 0.000000 0.028348 0.000000 -0.005780 108.0 0.05 0.00 MSCI MSCI INC 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 -0.149847 557.370 473.850 -0.180114 0.000000 0.000000 -0.180114 0.0 0.05 0.00 NVAC NORTHVIEW ACQUISITION CORP 2022-10-03 NaT 2022-09-30 2023-06-30 0.05 173.0 1447.0 -1.0 0.043260 9.940 10.370 0.000000 0.071429 0.000000 -0.028638 166.0 0.05 0.00 ORCL ORACLE CORP 2023-04-03 NaT 2023-03-31 NaT 0.05 48.0 1572.0 -1.0 0.169612 93.920 109.850 -0.002236 0.169612 0.027151 -0.043952 44.0 0.05 0.05 ORLY O REILLY AUTOMOTIVE INC 2022-10-03 NaT 2022-09-30 NaT 0.05 173.0 1447.0 -1.0 0.262883 718.190 906.990 -0.010332 0.339618 0.019800 -0.108000 171.0 0.05 0.05 PUCK GOAL ACQUISITIONS CORP 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 0.007805 10.250 10.330 -0.004878 0.007805 0.000000 -0.004878 31.0 0.05 0.00 RETA REATA PHARMACEUTICALS INC 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 -0.000426 93.840 93.800 -0.155797 0.122869 0.122869 -0.248173 27.0 0.05 0.00 TDG TRANSDIGM GROUP INC 2023-01-03 NaT 2022-12-30 NaT 0.05 110.0 1510.0 -1.0 0.278441 625.770 800.010 0.000000 0.320054 0.000000 -0.102902 109.0 0.05 0.05 TENK TENX KEANE ACQUISITION 2023-04-03 NaT 2023-03-31 2023-06-30 0.05 48.0 1572.0 -1.0 0.014016 10.345 NaN 0.000000 0.014016 0.000000 -0.000479 44.0 0.05 0.00 WINA WINMARK CORP 2023-04-03 NaT 2023-03-31 NaT 0.05 48.0 1572.0 -1.0 0.104913 327.510 361.870 -0.025923 0.126775 0.066990 -0.087080 35.0 0.05 0.05 BLBD BLUE BIRD CORP NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 BSIG BRIGHTSPHERE INVESTMENT GROUP INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 CAR AVIS BUDGET GROUP INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 GPP GREEN PLAINS PARTNERS LP NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 HLT HILTON WORLDWIDE HOLDINGS INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 IVCA INVESTCORP INDIA ACQUISITION CORP NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 LII LENNOX INTERNATIONAL INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 LYV LIVE NATION ENTERTAINMENT INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 MCK MCKESSON CORP NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 SPLK SPLUNK INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 VRSN VERISIGN INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 VVI VIAD CORP NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.00 0.05 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E4%BD%8E%E8%82%A1%E5%83%B9%E6%B7%A8%E5%80%BC%E6%AF%94%E7%AD%96%E7%95%A5/","title":"\u50f9\u503c\u56e0\u5b50\u00b6","text":"<p>\u57fa\u672c\u9762\u7b56\u7565\u3002\u4e3b\u8981\u9032\u5834\u689d\u4ef6\u70ba\u4f4e\u80a1\u50f9\u6de8\u503c\u6bd4\u3001\u80a1\u50f9\u4f4d\u65bc\u5b63\u7dda\u4e4b\u4e0a\u3002\u904e\u6ffe\u4f4e\u50f9\u80a1\u3002\u6bcf\u5b63\u63db\u80a1\uff0c\u6301\u6709\u6a94\u657820\u6a94\u3002\u689d\u4ef6\u8a2d\u5b9a\u7c21\u55ae\uff0c\u537b\u6709\u76f8\u7576\u4e0d\u932f\u7684\u8868\u73fe!</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E6%8A%84%E5%BA%95%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u5e03\u6797\u901a\u9053\u6284\u5e95\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin <pre>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nCollecting ta-lib-bin\n  Downloading ta_lib_bin-0.4.26-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.9 MB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 2.9/2.9 MB 29.5 MB/s eta 0:00:00\nRequirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from ta-lib-bin) (1.22.4)\nInstalling collected packages: ta-lib-bin\nSuccessfully installed ta-lib-bin-0.4.26\n</pre> In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('us_price:close')\nlow = data.get('us_price:low')\nhigh = data.get('us_price:high')\n\nupperband,middleband,lowerband = data.indicator(\"BBANDS\",adjust_price=False, resample=\"D\", market='US_STOCK', timeperiod=30,nbdevup=float(2.5),nbdevdn=float(2.5),matype=0)\n\nentries = (lowerband &gt; close) &amp; (close &gt; close.average(90)) &amp; (close &gt; 3)\nexits = (close &gt; middleband) | close.isna()\n\n# \u4ee5150\u65e5\u4f4e\u9ede\u8207\u9ad8\u9ede\u6bd4\u503c\u505a\u6392\u5e8f\uff0c\u53ea\u7be9\u51fa\u6578\u503c\u8f03\u5927\u7684\u524d10\u6a94\nrank = low.rolling(150).min() / high.rolling(150).max()\nposition = entries.hold_until(exits, nstocks_limit=10, rank=rank)\nreport = sim(position, resample='W', position_limit=0.1, name='\u7f8e\u80a1_\u5e03\u6797\u901a\u9053\u6284\u5e95\u7b56\u7565')\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('us_price:close') low = data.get('us_price:low') high = data.get('us_price:high')  upperband,middleband,lowerband = data.indicator(\"BBANDS\",adjust_price=False, resample=\"D\", market='US_STOCK', timeperiod=30,nbdevup=float(2.5),nbdevdn=float(2.5),matype=0)  entries = (lowerband &gt; close) &amp; (close &gt; close.average(90)) &amp; (close &gt; 3) exits = (close &gt; middleband) | close.isna()  # \u4ee5150\u65e5\u4f4e\u9ede\u8207\u9ad8\u9ede\u6bd4\u503c\u505a\u6392\u5e8f\uff0c\u53ea\u7be9\u51fa\u6578\u503c\u8f03\u5927\u7684\u524d10\u6a94 rank = low.rolling(150).min() / high.rolling(150).max() position = entries.hold_until(exits, nstocks_limit=10, rank=rank) report = sim(position, resample='W', position_limit=0.1, name='\u7f8e\u80a1_\u5e03\u6797\u901a\u9053\u6284\u5e95\u7b56\u7565') # report.display() <pre>/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 17.25% 0.64 -41.3% 70.0% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id BOAC BLUESCAPE OPPORTUNITIES ACQUISITION CORP 2023-06-05 NaT 2023-06-02 NaT 0.1 5.0 1615.0 -1.0 0.000000 9.970 9.97 0.000000 0.003009 0.00000 -0.003000 3.0 0.1 0.1 DKDCU DATA KNIGHTS ACQUISITION CORP 2023-05-30 NaT 2023-05-26 2023-06-11 0.1 9.0 1611.0 -1.0 0.007498 10.670 NaN 0.000000 0.007498 0.00000 0.000000 4.0 0.1 0.0 DSAQ.U DIRECT SELLING ACQUISITION CORP 2023-03-27 NaT 2023-03-24 2023-06-11 0.1 53.0 1567.0 -1.0 0.019857 10.374 NaN 0.000000 0.019857 0.00000 0.000000 2.0 0.1 0.0 ELP ENERGY CO OF PARANA 2023-06-05 NaT 2023-06-02 2023-06-11 0.1 5.0 1615.0 -1.0 0.092266 7.370 8.05 0.000000 0.092266 0.00000 0.000000 4.0 0.1 0.0 LIVBU LIV CAPITAL ACQUISITION CORP II 2023-05-15 NaT 2023-05-12 2023-06-11 0.1 19.0 1601.0 -1.0 0.006667 10.500 NaN 0.000000 0.006667 0.00000 0.000000 2.0 0.1 0.0 MACAU MORINGA ACQUISITION CORP 2023-05-30 NaT 2023-05-26 2023-06-11 0.1 9.0 1611.0 -1.0 0.000000 10.250 NaN 0.000000 0.000000 0.00000 0.000000 0.0 0.1 0.0 NUBIU NUBIA BRAND INTERNATIONAL CORP 2023-05-30 NaT 2023-05-26 NaT 0.1 9.0 1611.0 -1.0 -0.016901 10.650 10.47 -0.016901 0.000000 0.00000 -0.016901 0.0 0.1 0.1 SINT SINTX TECHNOLOGIES INC 2023-02-13 NaT 2023-02-10 2023-06-11 0.1 82.0 1538.0 -1.0 -0.437500 2.880 1.62 -0.531250 0.156250 0.15625 -0.594595 2.0 0.1 0.0 UPTDU TRADEUP ACQUISITION CORP 2023-05-30 NaT 2023-05-26 NaT 0.1 9.0 1611.0 -1.0 0.000000 10.550 10.55 0.000000 0.000000 0.00000 0.000000 0.0 0.1 0.1 VHAQ VIVEON HEALTH ACQUISITION CORP 2023-06-05 NaT 2023-06-02 2023-06-11 0.1 5.0 1615.0 -1.0 0.012323 10.955 11.09 0.000000 0.012323 0.00000 0.000000 4.0 0.1 0.0 MTRY MONTEREY INNOVATION ACQUISITION CORP NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 NLST NETLIST INC NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 WING WINGSTOP INC NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E6%8A%84%E5%BA%95%E7%AD%96%E7%95%A5/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E7%BE%8E%E8%82%A1_%E5%B8%83%E6%9E%97%E9%80%9A%E9%81%93%E6%8A%84%E5%BA%95%E7%AD%96%E7%95%A5/","title":"\u6284\u5e95\u7b56\u7565\u00b6","text":"<p>\u53f0\u7248\u7684\u8b77\u570b\u795e\u5c71\u9006\u52e2\u6284\u5e95\u7b56\u7565\u5927\u5bb6\u61c9\u8a72\u4e0d\u964c\u751f\uff0c\u904b\u7528\u65bc\u7f8e\u80a1\u4e2d\uff0c\u6211\u5011\u52a0\u5165\u589e\u52a0\u7ad9\u4e0a90\u65e5\u5747\u7684\u689d\u4ef6\uff0c\u4e26\u52a0\u5165\u6392\u5e8f\u9078\u51fa10\u6a94\u6301\u6709\uff0c\u6bcf\u5468\u63db\u80a1\u3002\u53ef\u518d\u81ea\u884c\u8a2d\u5b9a\u505c\u640d\u505c\u5229\u5594</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u672c\u76ca\u6210\u9577\u6bd4\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>%%capture\n!pip install finlab\n</pre> %%capture !pip install finlab In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\u672c\u76ca\u6bd4 = data.get('us_daily_metrics:pe')\n\u71df\u6536= data.get('us_fundamental:revenue')\n\u71df\u696d\u5229\u76ca = data.get('us_fundamental:opinc')\n\n\ndef \u6210\u9577\u7387(s):\n    return ((s-s.shift(4)) / s.shift(4).abs()) * 100\n\n\u71df\u6536\u6210\u9577\u7387 = \u6210\u9577\u7387(\u71df\u6536)\n\u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = \u6210\u9577\u7387(\u71df\u696d\u5229\u76ca)\npeg = (\u672c\u76ca\u6bd4/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387)\n\ncond1 = \u672c\u76ca\u6bd4 &gt; 0\ncond2 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 20\ncond3 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; \u71df\u6536\u6210\u9577\u7387\n\ncond_all = cond1 &amp; cond2 &amp; cond3\nposition = peg*cond_all\nposition = position[position &gt; 0].is_smallest(10)\n\nreport = sim(resample='W', position=position, fee_ratio=0, tax_ratio=0, stop_loss=0.1, name='\u7f8e\u80a1\u672c\u76ca\u6210\u9577\u6bd4', live_performance_start='2021-06-01')\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim  \u672c\u76ca\u6bd4 = data.get('us_daily_metrics:pe') \u71df\u6536= data.get('us_fundamental:revenue') \u71df\u696d\u5229\u76ca = data.get('us_fundamental:opinc')   def \u6210\u9577\u7387(s):     return ((s-s.shift(4)) / s.shift(4).abs()) * 100  \u71df\u6536\u6210\u9577\u7387 = \u6210\u9577\u7387(\u71df\u6536) \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 = \u6210\u9577\u7387(\u71df\u696d\u5229\u76ca) peg = (\u672c\u76ca\u6bd4/\u71df\u696d\u5229\u76ca\u6210\u9577\u7387)  cond1 = \u672c\u76ca\u6bd4 &gt; 0 cond2 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; 20 cond3 = \u71df\u696d\u5229\u76ca\u6210\u9577\u7387 &gt; \u71df\u6536\u6210\u9577\u7387  cond_all = cond1 &amp; cond2 &amp; cond3 position = peg*cond_all position = position[position &gt; 0].is_smallest(10)  report = sim(resample='W', position=position, fee_ratio=0, tax_ratio=0, stop_loss=0.1, name='\u7f8e\u80a1\u672c\u76ca\u6210\u9577\u6bd4', live_performance_start='2021-06-01') # report.display() <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:us_daily_metrics:pe -- Daily usage: 1042.8 / 5000 MB\nWARNING:finlab.data:us_fundamental:revenue -- Daily usage: 1047.4 / 5000 MB\nWARNING:finlab.data:us_fundamental:opinc -- Daily usage: 1052.1 / 5000 MB\nWARNING:finlab.data:us_fundamental:datekey -- Daily usage: 1057.2 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily usage: 1057.3 / 5000 MB\nWARNING:finlab.data:us_tickers -- Daily usage: 1062.7 / 5000 MB\nWARNING:finlab.data:us_price:adj_close -- Daily usage: 1146.0 / 5000 MB\nWARNING:finlab.data:world_index:adj_close -- Daily usage: 1166.3 / 5000 MB\nWARNING:finlab.data:us_price:close -- Daily usage: 1207.8 / 5000 MB\n/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 36.47% 0.72 -42.34% 43.82% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id ALPS ALPINE SUMMIT ENERGY PARTNERS INC 2023-05-22 NaT 2023-05-19 NaT 0.111111 14.0 1606.0 -1.0 -0.158661 0.687 0.578 -0.158661 0.002911 0.002911 -0.161103 1.0 0.111111 0.1 CEIX CONSOL ENERGY INC 2023-05-30 NaT 2023-05-26 2023-06-11 0.111111 9.0 1611.0 -1.0 0.155808 54.490 62.980 -0.009727 0.159112 0.000000 -0.009727 7.0 0.111111 0.0 FCNCA FIRST CITIZENS BANCSHARES INC 2023-05-15 NaT 2023-05-12 NaT 0.100000 19.0 1601.0 -1.0 0.015016 1265.960 1284.970 -0.014819 0.043564 0.043564 -0.055945 15.0 0.111111 0.1 IMPP IMPERIAL PETROLEUM INC/MARSHALL ISLANDS 2023-06-05 NaT 2023-06-02 NaT 0.111111 5.0 1615.0 -1.0 0.134078 3.580 4.060 0.000000 0.134078 0.000000 -0.010000 4.0 0.111111 0.1 ISIG INSIGNIA SYSTEMS INC 2023-05-15 NaT 2023-05-12 NaT 0.100000 19.0 1601.0 -1.0 -0.070088 7.990 7.430 -0.076345 0.000000 0.000000 -0.076345 0.0 0.111111 0.1 LBRT LIBERTY ENERGY INC 2023-04-24 NaT 2023-04-21 NaT 0.100000 34.0 1586.0 -1.0 -0.012292 13.830 13.660 -0.151121 0.000000 0.000000 -0.151121 0.0 0.111111 0.1 PDCE PDC ENERGY INC 2023-06-05 NaT 2023-06-02 2023-06-11 0.111111 5.0 1615.0 -1.0 0.019258 70.620 71.980 0.000000 0.025772 0.000000 -0.006350 4.0 0.111111 0.0 PSHG PERFORMANCE SHIPPING INC 2023-05-08 NaT 2023-05-05 NaT 0.111111 24.0 1596.0 -1.0 -0.052000 0.750 0.711 -0.057333 0.080000 0.080000 -0.127160 17.0 0.111111 0.1 WTM WHITE MOUNTAINS INSURANCE GROUP LTD 2023-05-15 NaT 2023-05-12 NaT 0.100000 19.0 1601.0 -1.0 0.013726 1412.680 1432.070 -0.066278 0.034587 0.000000 -0.066278 6.0 0.111111 0.1 PSIX POWER SOLUTIONS INTERNATIONAL INC NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.1 SIG SIGNET JEWELERS LTD NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.1 SLCA US SILICA HOLDINGS INC NaT NaT 2023-06-11 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.1 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E6%9C%AC%E7%9B%8A%E6%88%90%E9%95%B7%E6%AF%94%E7%AD%96%E7%95%A5/","title":"\u7372\u5229\u56e0\u5b50\u00b6","text":"<p>\u696d\u5229\u76ca\u6210\u9577\u7387\u5927\u65bc\u71df\u6536\u5e74\u589e\u7387\uff0c\u4ee3\u8868\u516c\u53f8\u8ffd\u6c42\u672c\u696d\u7372\u5229\uff0c\u800c\u4e0d\u5f37\u8abf\u71df\u6536\u3002 \u672c\u76ca\u6210\u9577\u6bd4\u4f7f\u7528\u300c\u71df\u696d\u5229\u76ca\u6210\u9577\u7387\u300d\u53d6\u4ee3\u300c\u7a05\u5f8c\u6de8\u5229\u6210\u9577\u7387\u300d\uff0c\u66f4\u5f37\u8abf\u9078\u51fa\u672c\u696d\u7372\u5229\u6210\u9577\u6027\u9ad8\uff0c\u4f30\u503c\u76f8\u5c0d\u4f4e\u7684\u80a1\u7968\u3002</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E7%87%9F%E6%94%B6%E7%AA%81%E7%A0%B4%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u71df\u6536\u7a81\u7834\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n!pip install ta-lib-bin\n</pre> !pip install finlab &gt; log.txt !pip install ta-lib-bin <pre>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nCollecting ta-lib-bin\n  Downloading ta_lib_bin-0.4.26-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.9 MB)\n     \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 2.9/2.9 MB 26.3 MB/s eta 0:00:00\nRequirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from ta-lib-bin) (1.22.4)\nInstalling collected packages: ta-lib-bin\nSuccessfully installed ta-lib-bin-0.4.26\n</pre> In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('us_price:close')\nadj_close = data.get('us_price:adj_close')\nvol = data.get('us_price:volume')\nrev = data.get('us_fundamental:revenue')\n\ndef \u6210\u9577\u7387(s):\n    return ((s-s.shift(4)) / s.shift(4).abs()) * 100\n\nrev_yoy_growth = \u6210\u9577\u7387(rev)\n\n\n# \u8fd11\u5b63\u71df\u6536\u5275\u8fd11\u5e74\u4f86\u65b0\u9ad8\ncondition1 = rev == rev.rolling(4, min_periods=2).max()\n# \u8fd15\u65e5\u5167\u81f3\u5c11\u67092\u65e5\u80a1\u50f9\u5275100\u65e5\u65b0\u9ad8\ncondition2 = (close == close.rolling(100).max()).sustain(5,2)\n# 5\u65e5\u6210\u4ea4\u5747\u91cf\u5927\u65bc500000\u80a1\ncondition3 = vol.average(5) &gt; 500000\n\nposition = condition1 &amp; condition2 &amp; condition3\n\n# \u7b26\u5408\u9078\u80a1\u689d\u4ef6\u7684\u540d\u55ae\u4e2d\uff0c\u518d\u9078\u51fa\u5b63\u71df\u6536\u5e74\u589e\u7387\u524d10\u5f37\nposition *= rev_yoy_growth\nposition = position[position&gt;0].is_largest(10)\n\n# # \u8a2d\u5b9aposition_limit\u907f\u514d\u91cd\u58d3\nreport = sim(position=position,resample='2W',stop_loss=0.2,take_profit=0, position_limit=0.1, fee_ratio=0, tax_ratio=0, name=\"\u7f8e\u80a1_\u71df\u6536\u7a81\u7834\u7b56\u7565\")\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('us_price:close') adj_close = data.get('us_price:adj_close') vol = data.get('us_price:volume') rev = data.get('us_fundamental:revenue')  def \u6210\u9577\u7387(s):     return ((s-s.shift(4)) / s.shift(4).abs()) * 100  rev_yoy_growth = \u6210\u9577\u7387(rev)   # \u8fd11\u5b63\u71df\u6536\u5275\u8fd11\u5e74\u4f86\u65b0\u9ad8 condition1 = rev == rev.rolling(4, min_periods=2).max() # \u8fd15\u65e5\u5167\u81f3\u5c11\u67092\u65e5\u80a1\u50f9\u5275100\u65e5\u65b0\u9ad8 condition2 = (close == close.rolling(100).max()).sustain(5,2) # 5\u65e5\u6210\u4ea4\u5747\u91cf\u5927\u65bc500000\u80a1 condition3 = vol.average(5) &gt; 500000  position = condition1 &amp; condition2 &amp; condition3  # \u7b26\u5408\u9078\u80a1\u689d\u4ef6\u7684\u540d\u55ae\u4e2d\uff0c\u518d\u9078\u51fa\u5b63\u71df\u6536\u5e74\u589e\u7387\u524d10\u5f37 position *= rev_yoy_growth position = position[position&gt;0].is_largest(10)  # # \u8a2d\u5b9aposition_limit\u907f\u514d\u91cd\u58d3 report = sim(position=position,resample='2W',stop_loss=0.2,take_profit=0, position_limit=0.1, fee_ratio=0, tax_ratio=0, name=\"\u7f8e\u80a1_\u71df\u6536\u7a81\u7834\u7b56\u7565\") # report.display()   <pre>/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 26.63% 0.77 -39.57% 51.69% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id APLD APPLIED DIGITAL CORP 2023-05-22 NaT 2023-05-19 NaT 0.1 14.0 1606.0 -1.0 -4.934602e-02 8.41 7.995 -0.057075 1.521998e-01 0.080856 -0.174923 9.0 0.1 0.1 CTIC CTI BIOPHARMA CORP 2023-06-05 NaT 2023-06-02 NaT 0.1 5.0 1615.0 -1.0 2.220446e-16 9.05 9.050 -0.001105 2.220446e-16 0.000000 -0.001105 2.0 0.1 0.1 ELF ELF BEAUTY INC 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 -5.708306e-03 105.11 104.510 -0.015508 1.788602e-02 0.017886 -0.032807 2.0 0.1 0.0 HRZN HORIZON TECHNOLOGY FINANCE CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 5.838198e-03 11.99 12.060 0.000000 2.001668e-02 0.000000 -0.013900 4.0 0.1 0.0 INTR INTER &amp; CO INC 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 1.395349e-01 3.01 3.430 0.000000 1.395349e-01 0.000000 -0.036697 4.0 0.1 0.0 MVIS MICROVISION INC 2023-06-05 NaT 2023-06-02 NaT 0.1 5.0 1615.0 -1.0 2.570356e-01 5.33 6.700 0.000000 4.352720e-01 0.000000 -0.124183 4.0 0.1 0.1 OMER OMEROS CORP 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 3.305785e-02 7.26 7.500 -0.028926 4.269972e-02 0.000000 -0.028926 2.0 0.1 0.0 OUST OUSTER INC 2023-05-22 NaT 2023-05-19 2023-06-18 0.1 14.0 1606.0 -1.0 -1.107595e-01 6.32 5.620 -0.110759 1.487342e-01 0.148734 -0.225895 9.0 0.1 0.0 PIII P3 HEALTH PARTNERS INC 2023-06-05 NaT 2023-06-02 2023-06-18 0.1 5.0 1615.0 -1.0 -1.488550e-01 5.24 4.460 -0.148855 0.000000e+00 0.000000 -0.148855 0.0 0.1 0.0 SYM SYMBOTIC INC 2023-06-05 NaT 2023-06-02 NaT 0.1 5.0 1615.0 -1.0 2.537096e-01 34.37 43.090 0.000000 2.537096e-01 0.000000 0.000000 4.0 0.1 0.1 ADVM ADVERUM BIOTECHNOLOGIES INC NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 CCL CARNIVAL CORP NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 IMPP IMPERIAL PETROLEUM INC/MARSHALL ISLANDS NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 LI LI AUTO INC NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 NU NU HOLDINGS LTD NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 SAGE SAGE THERAPEUTICS INC NaT NaT 2023-06-18 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E7%87%9F%E6%94%B6%E7%AA%81%E7%A0%B4%E7%AD%96%E7%95%A5/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E7%BE%8E%E8%82%A1_%E7%87%9F%E6%94%B6%E7%AA%81%E7%A0%B4%E7%AD%96%E7%95%A5/","title":"\u52d5\u80fd\u56e0\u5b50\u8207\u7372\u5229\u56e0\u5b50\u00b6","text":"<p>\u5c0b\u627e\u71df\u6536\u8207\u80a1\u50f9\u540c\u6b65\u5275\u9ad8\u7684\u80a1\u7968</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E7%A0%94%E7%99%BC%E6%88%90%E9%95%B7%E8%82%A1%E7%AD%96%E7%95%A5/","title":"\u7f8e\u80a1 \u7814\u767c\u6210\u9577\u80a1\u7b56\u7565","text":"In\u00a0[\u00a0]: Copied! <pre>%%capture\n!pip install finlab\n!pip install ta-lib-bin\n</pre> %%capture !pip install finlab !pip install ta-lib-bin In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\nclose = data.get('us_price:close')\nrevenue = data.get('us_fundamental:revenue')\neps = data.get('us_fundamental:eps')\n# \u7814\u767c\u8cbb\u7528\nrnd = data.get('us_fundamental:rnd')\n# \u6295\u8cc7\u4eba\u6295\u5165\u8cc7\u672c\ninvcap = data.get('us_fundamental:invcap')\n\n# \u9078\u51fa\u7814\u767c\u8cbb\u7528\u6210\u9577\u70ba\u6392\u540d\u524d10%\u500b\u80a1\ncondition1 = rnd.pct_change() &gt; rnd.pct_change().quantile_row(0.9)\ncondition2 =  eps &gt; eps.average(2)\ncondition3 = invcap &gt; invcap.average(2)\ncondition4 = close &gt; close.average(250)\n\n# \u518d\u4ee5ESP\u53ca\u6295\u8cc7\u4eba\u6295\u5165\u8cc7\u672c\u589e\u52a0\u3001\u6536\u76e4\u50f9\u7ad9\u4e0a\u5e74\u7dda\u70ba\u6ffe\u7db2\nposition = condition1 &amp; condition2 &amp; condition3 &amp; condition4\n\n# \u6700\u5f8c\u4ee5\u71df\u6536\u6210\u9577\u7387\u4f5c\u70ba\u6392\u5e8f\u7be9\u9078\u51fa\u6700\u5927\u7684\u524d15\u540d\u6a19\u7684\nrevenue_growth = revenue.pct_change().index_str_to_date()\nposition *= revenue_growth\nposition = position.is_largest(10)\nreport = sim(position, resample='M', name='\u7f8e\u80a1\u7814\u767c\u6210\u9577\u80a1\u7b56\u7565', stop_loss=0.15, position_limit=0.2)\n# report.display()\n</pre> from finlab import data from finlab.backtest import sim  close = data.get('us_price:close') revenue = data.get('us_fundamental:revenue') eps = data.get('us_fundamental:eps') # \u7814\u767c\u8cbb\u7528 rnd = data.get('us_fundamental:rnd') # \u6295\u8cc7\u4eba\u6295\u5165\u8cc7\u672c invcap = data.get('us_fundamental:invcap')  # \u9078\u51fa\u7814\u767c\u8cbb\u7528\u6210\u9577\u70ba\u6392\u540d\u524d10%\u500b\u80a1 condition1 = rnd.pct_change() &gt; rnd.pct_change().quantile_row(0.9) condition2 =  eps &gt; eps.average(2) condition3 = invcap &gt; invcap.average(2) condition4 = close &gt; close.average(250)  # \u518d\u4ee5ESP\u53ca\u6295\u8cc7\u4eba\u6295\u5165\u8cc7\u672c\u589e\u52a0\u3001\u6536\u76e4\u50f9\u7ad9\u4e0a\u5e74\u7dda\u70ba\u6ffe\u7db2 position = condition1 &amp; condition2 &amp; condition3 &amp; condition4  # \u6700\u5f8c\u4ee5\u71df\u6536\u6210\u9577\u7387\u4f5c\u70ba\u6392\u5e8f\u7be9\u9078\u51fa\u6700\u5927\u7684\u524d15\u540d\u6a19\u7684 revenue_growth = revenue.pct_change().index_str_to_date() position *= revenue_growth position = position.is_largest(10) report = sim(position, resample='M', name='\u7f8e\u80a1\u7814\u767c\u6210\u9577\u80a1\u7b56\u7565', stop_loss=0.15, position_limit=0.2) # report.display() <pre>/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> <pre>/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 25.17% 0.77 -34.71% 41.38% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id TIO TINGO GROUP INC 2023-06-01 2023-06-06 2023-05-31 2023-06-05 0.1 3.0 1613.0 1616.0 -0.580952 3.150 1.32 -0.580952 0.000000 0.000000 -0.580952 0.0 0.0 0.1 ALAR ALARUM TECHNOLOGIES LTD 2023-06-01 NaT 2023-05-31 2023-06-30 0.1 7.0 1613.0 -1.0 -0.133627 2.724 2.36 -0.137298 0.000000 0.000000 -0.137298 0.0 0.1 0.0 ASUR ASURE SOFTWARE INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 -0.026917 12.260 11.93 -0.026917 0.041599 0.041599 -0.065779 4.0 0.1 0.1 EH EHANG HOLDINGS LTD 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.030870 10.690 11.02 0.000000 0.035547 0.000000 -0.026388 6.0 0.1 0.1 GHSI GUARDION HEALTH SCIENCES INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 -0.018003 6.110 6.00 -0.018003 0.014730 0.014730 -0.032258 2.0 0.1 0.1 INVA INNOVIVA INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.014493 13.110 13.30 -0.003814 0.046529 0.006865 -0.030612 5.0 0.1 0.1 MRNS MARINUS PHARMACEUTICALS INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.443213 7.220 10.42 0.000000 0.443213 0.000000 0.000000 6.0 0.1 0.1 RXDX PROMETHEUS BIOSCIENCES INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.001712 198.650 198.99 0.000000 0.001712 0.000000 -0.000151 6.0 0.1 0.1 VTSI VIRTRA INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.078811 7.740 8.35 0.000000 0.078811 0.000000 -0.012706 6.0 0.1 0.1 WWD WOODWARD INC 2023-06-01 NaT 2023-05-31 NaT 0.1 7.0 1613.0 -1.0 0.040160 107.570 111.89 0.000000 0.053361 0.000000 -0.015708 6.0 0.1 0.1 UUUU ENERGY FUELS INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.0 0.1 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E7%A0%94%E7%99%BC%E6%88%90%E9%95%B7%E8%82%A1%E7%AD%96%E7%95%A5/","title":"\u7814\u767c\u8cbb\u7528\u50ac\u5316\u5291\u00b6","text":"<p>\u6295\u5165\u8f03\u591a\u8cc7\u6e90\u9032\u884c\u7814\u767c\u7684\u516c\u53f8\uff0c\u6703\u8f03\u53d7\u5e02\u5834\u9752\u775e\u800c\u88ab\u7d66\u4e88\u8f03\u9ad8\u7684\u4f30\u503c\u55ce\uff1f</p>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E8%BC%95%E9%87%8F%E7%89%88%E8%B6%85%E7%B4%9A%E7%B8%BE%E6%95%88/","title":"\u7f8e\u80a1 \u8f15\u91cf\u7248\u8d85\u7d1a\u7e3e\u6548","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n# \u8cc7\u6599\u5f15\u5165\nclose = data.get('us_price:close')\nrevenue = data.get('us_fundamental:revenue')\neps = data.get('us_fundamental:eps')\nvolume = data.get('us_price:volume')\nlow = data.get('us_price:low')\nhigh = data.get('us_price:high')\n</pre> from finlab import data from finlab.backtest import sim  # \u8cc7\u6599\u5f15\u5165 close = data.get('us_price:close') revenue = data.get('us_fundamental:revenue') eps = data.get('us_fundamental:eps') volume = data.get('us_price:volume') low = data.get('us_price:low') high = data.get('us_price:high') <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:us_price:close -- Daily usage: 1298.2 / 5000 MB\nWARNING:finlab.data:us_fundamental:revenue -- Daily usage: 1302.8 / 5000 MB\nWARNING:finlab.data:us_fundamental:eps -- Daily usage: 1307.3 / 5000 MB\nWARNING:finlab.data:us_price:volume -- Daily usage: 1359.1 / 5000 MB\nWARNING:finlab.data:us_price:low -- Daily usage: 1404.2 / 5000 MB\nWARNING:finlab.data:us_price:high -- Daily usage: 1449.6 / 5000 MB\n</pre> In\u00a0[\u00a0]: Copied! <pre># \u6280\u8853\u9762\u689d\u4ef6\ncond1 = (close.average(50) &gt; close.average(150))\ncond2 = close &gt; high.rolling(250).max()*0.75\n\n# \u57fa\u672c\u9762\u689d\u4ef6\nrevenue_cond = (revenue &gt; revenue.average(3))\neps_cond = (eps &gt; eps.average(3))\n\nresult = cond1 &amp; cond2 &amp; revenue_cond &amp; eps_cond\n\n# \u524d\u9762\u689d\u4ef6\u53d6\u4ea4\u96c6\u5f8c\u518d\u4ee5\u76f8\u5c0d\u5f37\u5ea6\u6392\u540d\u9078\u51fa\u524d10\u6a94\nrs = close / close.shift(250)\nresult = result * rs\nresult = result[result &gt;0].is_largest(10)\n\n# \u6700\u5f8c\u518d\u7be9\u51fa\u4ea4\u6613\u91cf\u8f03\u4f4e(\u6e96\u5099\u5674\u767c)\u7684\u500b\u80a1\nresult = result &amp; (volume &lt; volume.average(30))\nreport = sim(result, resample='M', tax_ratio=0, fee_ratio=0, stop_loss=0.15, take_profit=0.2)\n# report.display()\n</pre> # \u6280\u8853\u9762\u689d\u4ef6 cond1 = (close.average(50) &gt; close.average(150)) cond2 = close &gt; high.rolling(250).max()*0.75  # \u57fa\u672c\u9762\u689d\u4ef6 revenue_cond = (revenue &gt; revenue.average(3)) eps_cond = (eps &gt; eps.average(3))  result = cond1 &amp; cond2 &amp; revenue_cond &amp; eps_cond  # \u524d\u9762\u689d\u4ef6\u53d6\u4ea4\u96c6\u5f8c\u518d\u4ee5\u76f8\u5c0d\u5f37\u5ea6\u6392\u540d\u9078\u51fa\u524d10\u6a94 rs = close / close.shift(250) result = result * rs result = result[result &gt;0].is_largest(10)  # \u6700\u5f8c\u518d\u7be9\u51fa\u4ea4\u6613\u91cf\u8f03\u4f4e(\u6e96\u5099\u5674\u767c)\u7684\u500b\u80a1 result = result &amp; (volume &lt; volume.average(30)) report = sim(result, resample='M', tax_ratio=0, fee_ratio=0, stop_loss=0.15, take_profit=0.2) # report.display() <pre>WARNING:finlab.data:us_fundamental:datekey -- Daily usage: 1454.7 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily usage: 1496.3 / 5000 MB\nWARNING:finlab.data:us_tickers -- Daily usage: 1506.2 / 5000 MB\nWARNING:finlab.data:us_price:adj_close -- Daily usage: 1552.6 / 5000 MB\nWARNING:finlab.data:world_index:adj_close -- Daily usage: 1558.3 / 5000 MB\n/usr/local/lib/python3.10/dist-packages/finlab/analysis/alphaBetaAnalysis.py:22: RuntimeWarning:\n\ninvalid value encountered in double_scalars\n\n</pre> annualized_rate_of_return sharpe max_drawdown win_ratio 40.06% 1.04 -41.55% 52.3% entry_date exit_date entry_sig_date exit_sig_date position period entry_index exit_index return trade_price@entry_date trade_price@exit_date mae gmfe bmfe mdd pdays weight next_weights stock_id JFIN JIAYIN GROUP INC 2023-06-01 2023-06-06 2023-05-31 2023-06-05 0.142857 3.0 1613.0 1616.0 0.107937 6.30 6.98 0.000000 0.269841 0.000000 -0.127500 3.0 0.000000 0.000000 AEHR AEHR TEST SYSTEMS 2023-06-01 NaT 2023-05-31 2023-06-30 0.142857 7.0 1613.0 -1.0 0.104075 38.53 42.54 0.000000 0.104075 0.000000 -0.032918 6.0 0.142857 0.000000 GOCO GOHEALTH INC 2023-06-01 NaT 2023-05-31 NaT 0.142857 7.0 1613.0 -1.0 0.010283 19.45 19.65 -0.001028 0.028278 0.028278 -0.028500 5.0 0.142857 0.166667 IMGN IMMUNOGEN INC 2023-06-01 NaT 2023-05-31 2023-06-09 0.142857 7.0 1613.0 -1.0 0.211009 14.17 17.16 0.000000 0.211009 0.000000 -0.042941 6.0 0.142857 0.000000 IMPP IMPERIAL PETROLEUM INC/MARSHALL ISLANDS 2023-06-01 NaT 2023-05-31 NaT 0.142857 7.0 1613.0 -1.0 0.173410 3.46 4.06 0.000000 0.173410 0.000000 -0.032432 6.0 0.142857 0.166667 RXDX PROMETHEUS BIOSCIENCES INC 2023-06-01 NaT 2023-05-31 2023-06-30 0.142857 7.0 1613.0 -1.0 0.001712 198.65 198.99 0.000000 0.001712 0.000000 -0.000151 6.0 0.142857 0.000000 SEAC SEACHANGE INTERNATIONAL INC 2023-06-01 NaT 2023-05-31 NaT 0.142857 7.0 1613.0 -1.0 0.097944 8.27 9.08 0.000000 0.114873 0.000000 -0.020607 6.0 0.142857 0.166667 ELF ELF BEAUTY INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.166667 HIPO HIPPO HOLDINGS INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.166667 SYM SYMBOTIC INC NaT NaT 2023-06-30 NaT NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN 0.000000 0.166667 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tools/%E7%BE%8E%E8%82%A1_%E8%BC%95%E9%87%8F%E7%89%88%E8%B6%85%E7%B4%9A%E7%B8%BE%E6%95%88/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E7%BE%8E%E8%82%A1_%E8%BC%95%E9%87%8F%E7%89%88%E8%B6%85%E7%B4%9A%E7%B8%BE%E6%95%88/","title":"\u8f15\u91cf\u7248\u8d85\u7d1a\u7e3e\u6548\u00b6","text":"<p>\u5df2\u7d93\u770b\u904e\u6211\u5011\u7684\u8d85\u7d1a\u7e3e\u6548\u5f71\u7247\u53ca\u6587\u7ae0\u4e86\u55ce\uff1f</p> <p>\u9019\u908a\u91cd\u65b0\u6fc3\u7e2e\u4e86\u4e3b\u8981\u9032\u5834\u908f\u8f2f\u4e26\u6539\u70ba\u6bcf\u6708\u63db\u80a1\uff0c\u4e5f\u53ef\u4ee5\u518d\u81ea\u884c\u505a\u5176\u4ed6\u8abf\u6574\u770b\u7e3e\u6548\u80fd\u5426\u66f4\u597d\u5594</p>"},{"location":"tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/","title":"\u80a1\u50f9\u5275\u65b0\u9ad8\u52d5\u80fd","text":"In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[2]: Copied! <pre>from finlab.backtest import sim\nfrom finlab import data\n\n# \u6a19\u7684\u7bc4\u570d\u70ba\u4e0a\u5e02\u6ac3\u666e\u901a\u80a1\nwith data.universe(market='TSE_OTC'):\n    # \u53d6\u5f97\u6536\u76e4\u50f9\n    close = data.get(\"price:\u6536\u76e4\u50f9\")\n    # \u80a1\u50f9\u5275\u8fd1200\u65e5\u65b0\u9ad8\n    position = (close == close.rolling(200).max())\n    # \u6bcf\u5169\u9031\u518d\u5e73\u8861\uff0c\u55ae\u6a94\u6700\u5927\u6301\u80a1\u6bd4\u4f8b\u9650\u523620%\uff0c\u505c\u640d20%\n    report = sim(position, resample=\"2W\", position_limit=0.2, stop_loss=0.2, name=\"\u80a1\u50f9\u5275\u65b0\u9ad8\u7b56\u7565\", upload=False)\n    report.display()\n</pre> from finlab.backtest import sim from finlab import data  # \u6a19\u7684\u7bc4\u570d\u70ba\u4e0a\u5e02\u6ac3\u666e\u901a\u80a1 with data.universe(market='TSE_OTC'):     # \u53d6\u5f97\u6536\u76e4\u50f9     close = data.get(\"price:\u6536\u76e4\u50f9\")     # \u80a1\u50f9\u5275\u8fd1200\u65e5\u65b0\u9ad8     position = (close == close.rolling(200).max())     # \u6bcf\u5169\u9031\u518d\u5e73\u8861\uff0c\u55ae\u6a94\u6700\u5927\u6301\u80a1\u6bd4\u4f8b\u9650\u523620%\uff0c\u505c\u640d20%     report = sim(position, resample=\"2W\", position_limit=0.2, stop_loss=0.2, name=\"\u80a1\u50f9\u5275\u65b0\u9ad8\u7b56\u7565\", upload=False)     report.display() <pre>\u8f38\u5165\u6210\u529f!\n</pre> <pre>WARNING:finlab.data:security_categories -- Daily data usage: 339.0 / 5000 MB\nWARNING:finlab.data:price:\u6536\u76e4\u50f9 -- Daily data usage: 360.5 / 5000 MB\nWARNING:finlab.data:etl:adj_close -- Daily data usage: 388.9 / 5000 MB\n</pre> <pre>2732    0.2\n2754    0.2\n3289    0.2\n4102    0.2\n5288    0.2\nName: 2022-10-09 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-10-09 00:00:00')</pre> In\u00a0[3]: Copied! <pre>from finlab.backtest import sim\nfrom finlab import data\nwith data.universe(market='TSE_OTC'):\n    close = data.get(\"price:\u6536\u76e4\u50f9\")\n    # \u8fd15\u65e5\u5167\u67093\u65e5\u4ee5\u4e0a\u7684\u80a1\u50f9\u5275\u524d200\u65e5\u65b0\u9ad8\n    position = (close == close.rolling(200).max()).sustain(5,3)\n    report = sim(position, resample=\"2W\", position_limit=0.2, stop_loss=0.2, name=\"\u5275\u65b0\u9ad8\u5ef6\u7e8c\u52d5\u80fd\u7b56\u7565\", upload=False)\n    report.display()\n</pre> from finlab.backtest import sim from finlab import data with data.universe(market='TSE_OTC'):     close = data.get(\"price:\u6536\u76e4\u50f9\")     # \u8fd15\u65e5\u5167\u67093\u65e5\u4ee5\u4e0a\u7684\u80a1\u50f9\u5275\u524d200\u65e5\u65b0\u9ad8     position = (close == close.rolling(200).max()).sustain(5,3)     report = sim(position, resample=\"2W\", position_limit=0.2, stop_loss=0.2, name=\"\u5275\u65b0\u9ad8\u5ef6\u7e8c\u52d5\u80fd\u7b56\u7565\", upload=False)     report.display() <pre>5288    0.2\n6101    0.2\n8996    0.2\nName: 2022-10-09 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-10-09 00:00:00')</pre>"},{"location":"tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/","title":"\u80a1\u50f9\u5275\u65b0\u9ad8\u52d5\u80fd\u00b6","text":""},{"location":"tools/%E8%82%A1%E5%83%B9%E5%89%B5%E6%96%B0%E9%AB%98%E5%8B%95%E8%83%BD/","title":"\u5275\u65b0\u9ad8\u5ef6\u7e8c\u52d5\u80fd\u7b56\u7565\u00b6","text":""},{"location":"tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/","title":"\u904e\u6ffeKY\u80a1\u8ca1\u5831","text":"In\u00a0[\u00a0]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[\u00a0]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\n\n\u71df\u696d\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\n\u6295\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\n\u878d\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u7c4c\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline()\nroe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\").deadline()\nclose = data.get(\"price:\u6536\u76e4\u50f9\")\n\nposition = (\u71df\u696d\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u6295\u8cc7\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u878d\u8cc7\u73fe\u91d1\u6d41 &lt; 0) &amp; (roe &gt; 5) &amp; (close &gt; 10)\n</pre> from finlab import data from finlab.backtest import sim  \u71df\u696d\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u71df\u696d\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() \u6295\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u6295\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() \u878d\u8cc7\u73fe\u91d1\u6d41 = data.get(\"financial_statement:\u7c4c\u8cc7\u6d3b\u52d5\u4e4b\u6de8\u73fe\u91d1\u6d41\u5165_\u6d41\u51fa\").deadline() roe = data.get(\"fundamental_features:ROE\u7a05\u5f8c\").deadline() close = data.get(\"price:\u6536\u76e4\u50f9\")  position = (\u71df\u696d\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u6295\u8cc7\u73fe\u91d1\u6d41 &gt; 0) &amp; (\u878d\u8cc7\u73fe\u91d1\u6d41 &lt; 0) &amp; (roe &gt; 5) &amp; (close &gt; 10) In\u00a0[\u00a0]: Copied! <pre># \u904e\u6ffe KY\u80a1\nsc = data.get(\"security_categories\")\nposition_col = position.columns\nky_filter = position_col[~position_col.isin(list(sc[sc[\"name\"].str.contains(\"KY\")][\"stock_id\"]))]\nposition = position[ky_filter]\n\nreport = sim(position,resample=\"M\",name=\"\u904e\u6ffeKY\u80a1\u8ca1\u5831\", upload=False)\nreport.display()\n</pre> # \u904e\u6ffe KY\u80a1 sc = data.get(\"security_categories\") position_col = position.columns ky_filter = position_col[~position_col.isin(list(sc[sc[\"name\"].str.contains(\"KY\")][\"stock_id\"]))] position = position[ky_filter]  report = sim(position,resample=\"M\",name=\"\u904e\u6ffeKY\u80a1\u8ca1\u5831\", upload=False) report.display() <pre>stock_id\n1539    0.043478\n2303    0.043478\n2504    0.043478\n2636    0.043478\n3093    0.043478\n3131    0.043478\n3169    0.043478\n3557    0.043478\n4506    0.043478\n4945    0.043478\n5534    0.043478\n6195    0.043478\n6278    0.043478\n6281    0.043478\n6294    0.043478\n6506    0.043478\n6542    0.043478\n6683    0.043478\n6706    0.043478\n6747    0.043478\n6761    0.043478\n8084    0.043478\n8421    0.043478\nName: 2022-07-31 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-07-31 00:00:00')</pre>"},{"location":"tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/","title":"\u73fe\u91d1\u6d41\u91cf\u7b56\u7565\u00b6","text":""},{"location":"tools/%E9%81%8E%E6%BF%BEKY%E8%82%A1%E8%B2%A1%E5%A0%B1/#ky","title":"\u904e\u6ffe KY \u80a1\u00b6","text":"<p>\u5728\u53f0\u7b2c\u4e00\u4e0a\u5e02\u7684\u6d77\u5916\u516c\u53f8\u7d93\u5e38\u7206\u51fa\u8ca1\u5831\u7591\u616e\uff0c\u5c0d\u6b64\u654f\u611f\u8005\uff0c\u53ef\u5728\u8ca1\u5831\u7b56\u7565\u6392\u9664KY\u80a1\u3002</p> <p>\u57fa\u672c\u9762\u6307\u6a19\u4f7f\u7528\u8ca1\u5831\u516c\u544a\u622a\u6b62\u65e5\u3002</p>"},{"location":"tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/","title":"\u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1","text":"In\u00a0[1]: Copied! <pre>!pip install finlab &gt; log.txt\n</pre> !pip install finlab &gt; log.txt In\u00a0[4]: Copied! <pre>from finlab import data\nfrom finlab.backtest import sim\nimport pandas as pd\n\nrev = data.get(\"monthly_revenue:\u7576\u6708\u71df\u6536\")\nrev_rf = data.get(\"monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)\")\nvol = data.get(\"price:\u6210\u4ea4\u80a1\u6578\")/1000\n\nrev_recent_3 = rev.rolling(3).sum()\nvol_avg = vol.average(10)\ncond1 = rev_recent_3==rev_recent_3.rolling(24, min_periods=12).max()\n\n# \u6210\u4ea4\u91cf\u689d\u4ef6\uff0c\u6392\u9664\u6d41\u52d5\u6027\u904e\u5c0f\ncond2 = vol_avg &gt; 300\n</pre> from finlab import data from finlab.backtest import sim import pandas as pd  rev = data.get(\"monthly_revenue:\u7576\u6708\u71df\u6536\") rev_rf = data.get(\"monthly_revenue:\u53bb\u5e74\u540c\u6708\u589e\u6e1b(%)\") vol = data.get(\"price:\u6210\u4ea4\u80a1\u6578\")/1000  rev_recent_3 = rev.rolling(3).sum() vol_avg = vol.average(10) cond1 = rev_recent_3==rev_recent_3.rolling(24, min_periods=12).max()  # \u6210\u4ea4\u91cf\u689d\u4ef6\uff0c\u6392\u9664\u6d41\u52d5\u6027\u904e\u5c0f cond2 = vol_avg &gt; 300 In\u00a0[3]: Copied! <pre># \u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1\nfull_cash_delivery_stock_filter = data.get(\"etl:full_cash_delivery_stock_filter\")\n\ncond_all = cond1 &amp; cond2 &amp; full_cash_delivery_stock_filter \nresult = rev_rf*cond_all\nposition = result[result&gt;0].is_largest(10).reindex(rev.index_str_to_date().index, method=\"ffill\")\nreport = sim(position=position,stop_loss=0.3,position_limit=0.1, upload=False)\nreport.display()\n</pre> # \u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1 full_cash_delivery_stock_filter = data.get(\"etl:full_cash_delivery_stock_filter\")  cond_all = cond1 &amp; cond2 &amp; full_cash_delivery_stock_filter  result = rev_rf*cond_all position = result[result&gt;0].is_largest(10).reindex(rev.index_str_to_date().index, method=\"ffill\") report = sim(position=position,stop_loss=0.3,position_limit=0.1, upload=False) report.display() <pre>WARNING:finlab.data:etl:full_cash_delivery_stock_filter -- Daily data usage: 310.5 / 5000 MB\nWARNING:finlab.data:etl:adj_close -- Daily data usage: 338.9 / 5000 MB\nWARNING:finlab.data:security_categories -- Daily data usage: 338.9 / 5000 MB\n</pre> <pre>1603    0.1\n2607    0.1\n2734    0.1\n4148    0.1\n4911    0.1\n4931    0.1\n6541    0.1\n6733    0.1\n6768    0.1\n8069    0.1\nName: 2022-09-12 00:00:00, dtype: float64</pre> <pre>Timestamp('2022-09-12 00:00:00')</pre>"},{"location":"tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/","title":"\u5b89\u88dd\u5957\u4ef6\u00b6","text":""},{"location":"tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/","title":"\u71df\u6536\u52d5\u80fd\u00b6","text":""},{"location":"tools/%E9%81%8E%E6%BF%BE%E5%85%A8%E9%A1%8D%E4%BA%A4%E5%89%B2%E8%82%A1/","title":"\u904e\u6ffe\u5168\u984d\u4ea4\u5272\u80a1\u00b6","text":"<p>\u8cb7\u9032\u8a0a\u865f\u9694\u65e5\u82e5\u70ba\u5168\u984d\u4ea4\u5272\u80a1\uff0c\u5247\u4e0d\u4ea4\u6613\u3002 \u5168\u984d\u4ea4\u5272\u80a1\u6e05\u55ae\u6bcf\u65e50815\u66f4\u65b0\u3002</p>"}]}